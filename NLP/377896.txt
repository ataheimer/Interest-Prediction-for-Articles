t demonstr scalabl molecular dynam applic petaflop comput a ibm blue gene project endeavor develop cellular architectur comput million concurr thread execut one major challeng project demonstr applic success exploit massiv amount parallel start sequenti version well known molecular dynam code develop new applic exploit multipl level parallel blue gene cellular architectur perform analyt simul studi behavior applic execut larg number thread result demonstr class applic execut effici larg cellular machin b introduct sever teraflopscal machin deploy variou industri government academ site high perform comput commun start look next big step petaflopscal machin least two differ approach advoc develop first gener machin one hand project like htmt propos use thousand high speed processor hun dred gigahertz hand project like ibm blue gene advanc idea use larg number million modest speed processor hundr megahertz two approach seen extrem wide spectrum choic particularli interest analyz feasibl latter blue gene style approach massiv parallel machin built today rel straightforward way adopt cellular architectur basic buildingblock contain processor memori interconnect support prefer implement singl silicon chip replic mani time follow regular pattern combin logic memori microelectron process soon deliv chip hundr million transistor sever research group advanc processorinmemori design reli technol ogi use build block cellular machin exampl includ illinoi flexram berkeley project nevertheless sheer size build cellular machin deliv petaflop floatingpoint oper per second quit challeng enterpris justifi demonstr applic execut effici machin paper report result analyt simulationbas studi behavior comput molecular dynam applic analyz behavior applic cellular architectur million concurr thread ex ecut design ibm blue gene project one exampl class applic inde exploit multipl level massiv parallel offer petaflopscal cellular machin discuss parallel applic deriv serial version molecular dynam code develop univers pennsylvania applic rewritten new partit techniqu take advantag multipl level parallel develop analyt model perform applic compar direct simul measur quantit result molecular dynam code demonstr class applic success exploit petaflop scale cellular machin term absolut perform simul indic achiev petaflop floatingpoint oper per second petaop oper per second sustain perform term speed molecular dynam comput integr equat motion typic problem atom rate one timestep everi s problem use sequenti version code solv power workstat peak perform mflop second per time step thu machin time total peak floatingpoint perform uniprocessor achiev speedup rest paper organ follow section give brief overview cellular machin consid level necessari understand molecular dynam applic parallel effici execut section introduc parallel molecular dynam algorithm use also present analyt perform model execut algorithm cellular architectur section describ simul experiment infrastructur use infrastructur deriv experiment perform result present togeth result analyt model section section discuss chang blue gene architectur motiv work final section present conclus petaflop cellular machin interest investig machin like ibm blue gene would perform class molecular dynam applica tion fundament premis architectur blue gene perform obtain exploit massiv amount parallel rather fast execut particular thread control premis signific technolog architectur impact first individu processor kept simpl facilit design larg scale replic singl silicon chip instead spend transistor watt enhanc singlethread perform real estat power budget use add processor architectur also character memori centric enough thread execut provid order fulli consum memori bandwidth toler latenc individu loadstor oper singl silicon chip consist mani replic unit natur fault toler ant replic approach also improv yield fabrica tion even larg chip use thu reduc cost moreov allow machin grace degrad continu oper individu unit fail build block cellular architectur node node implement singl silicon chip contain memori process element interconnect element node view singlechip sharedmemori multiprocessor de sign node contain mb share memori instruct unit instruct unit associ one thread exe cution give simultan thread execut one node execut instruct strictli order group thread share one data cach one floatingpoint unit data cach configur blue gene kb way set associ call group thread floatingpoint unit cach proce sor simplif necessari keep instruct unit simpl result larg number die floatingpoint unit node pipelin complet multipli add everi cycl mhz clock cycl translat gflop peak perform per floatingpoint unit gflop peak perform per node node also six channel commun direct interconnect six node bit wide channel oper mhz commun bandwidth gb per channel direct achiev node commun stream data channel larger system built interconnect multipl node regular pattern system design use six commun channel node interconnect threedimension mesh configur node connect two neighbor along axi x z node face along edg mesh fewer connect use mesh topolog regular built without addit hardwar directli connect commun channel node commun channel neighbor threedimension mesh node build system node sinc node attain peak comput rate gflop entir system deliv peak comput rate approxim petaflop see figur applic run petaflop machin must exploit inter intranod parallel first applic decompos multipl task task assign particular node discuss previous task commun messag second task decompos multipl thread thread oper subset problem assign task thread task interact sharedmemori molecular dynam algorith goal molecular dynam algorithm determin state molecular system evolv time given molecular system set n atom state atom time describ mass charg q posit x t veloc v t evolut system govern equat motion subject initi condit x atom i f forc act atom x initi posit veloc respect atom i notat repres set posit atom time t equat integr numer particular choic time step t posit atom fx j tg time use comput forc f time t forc use comput acceler time t veloc acceler time final use comput new posit veloc time t respect particular molecular dynam approach chose system simul shape form box replic indefinit three dimen sion give rise period system illustr two dimens figur r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r figur molecular system simul period structur principl need consid interact among infinit number atom thread mhz chip board rack processor system rack processor petaflop gigaflop board chip figur blue gene cellular architectur hierarchi entir system consist node million processor connect threedimension mesh molecular dynam algorithm forc appli atom time vector sum pairwis interact atom atom system pairwis interact take sever form describ divid two main group intramolecular forc intermolecular forc intramolecular forc occur adjac closebi atom molecul model use three differ type intramolecular forc bond bend torsion intermolecular forc occur pair atom take two form lennardjon or van der wall forc electrostat or coulomb forc lennardjon forc decay rapidli distanc therefor given atom i enough consid lennardjon interact atom insid sphere center atom i radiu sphere call cutoff radiu note sphere atom may includ atom neighbor replic box comput electrostat forc one take account period natur molecular system one commonli use approach ewald summat method comput electrostat forc divid two fast converg sum real space part reciproc space also call kspace part f r real space part f r t interact comput atom atom insid sphere center atom i lennardjon forc although cutoff radiu could dif ferent pair atom whose distanc within cutoff commonli store link list also known verlet list gener list usual perform everi sever timestep atom move slowli frequenc gener optim problem sinc comput cost amort sever timestep discuss gener verlet list paper comput reciproc space first set k reciproc space vector comput then k k comput k fourier transform point charg distribut structur factor particular valu k n number atom q x charg posit atom i respect k term also call kfactor paper contribut reciproc space part electrostat forc act atom comput summat valu k also call kforc paper exact formula function f k import structur paral leliz the precis express specifi note atom need perform summat k k valu k depend posit atom system internod parallel effici parallel molecular dynam algorithm requir variou forc distribut evenli among comput node molecular dynam applic use extens decomposit intermolecular forc describ new parallel formul kspace decomposit although cellular machin threedimension mesh node view p node logic twodimension mesh c column r row particular use c two threedimension mesh embed use describ later now consid twodimension logic mesh partit set atom two way target partit r set ft g size l jaj r sourc partit c set fs l jaj c replic target set across row twodimension everi node row contain copi atom target set ti similarli replic sourc set across column everi node column j contain copi atom sourc set sj configur node nij row column j logic mesh assign sourc set sj target set ti shown figur k k k k k k figur forc decomposit adopt molecular dynam applicationeach target set ti replic along node row sourc set sj reciproc space vector set kj replic along node column j use decomposit describ abov node nij comput local commun lennardjon real space electrostat forc exert atom sourc set sj atom target set ti previous mention interact atom closer certain cutoff radiu actual comput word let f lj lm lennardjon forc atom l m let f r lm real part electrostat forc atom l m then node nij comput f lj lm f r distanc atom l less cutoff radiu lennardjon electrostat forc respect node nij also comput partial vector sum lennardjon real part electrostat forc act upon atom target set f lj ms j f lj f r ms j f r comput reciproc space electrostat forc set k reciproc space vector partit c set g size l jkj c replic set kj along node column j logic mesh also shown figur actual comput perform three phase kfactor phase everi node nij comput contribut atom ti k k kj is node nij comput lt comput sum contribut along column twodimension mesh constitut second phase sum comput allreduc oper everi node obtain valu sum contribut reduct everi node nij valu k k number item kfactor reduct comput along column j equal size reciproc space vector set kj third final phase also call kforc phase k valu use node comput contribut describ equat atom set ti is node nij comput intermolecular forc comput perform all reduct forc along row twodimension logic mesh is node nij row obtain valu f r f lj result everi node row obtain result forc atom ti note number item forc vector reduct comput along row equal size number atom target set ti comput intramolecular forc bond bend torsion replic everi column logic mesh note everi column entir set atom form union set partit atom among ti set adjac atom molecul assign adjac target set commun requir comput intramolecular forc updat posit atom molecul split adjac row twodimension logic mesh comput forc atom ti comput new posit veloc final updat posit atom sj atom ti perform broadcast oper along column twodimension mesh broadcast phase node nij send posit atom ti sj node column j correspondingli receiv posit atom sj ti sj node column interact atom close togeth need evalu often interact atom far apart reason use multitimestep algorithm similar respa reduc frequenc intermolecular forc comput illustr concept figur comput time step divid sequenc short intermedi long step precis configur comput time step consist ten compon four short step follow intermedi step follow four short step follow long step short step intramolecular bond bend forc comput intermedi step intramolecular forc bond bend torsion comput togeth lennardjon real space electrostat forc within short cutoff radiu comput intermolecular forc requir reduct along row final long step intra intermolecular forc includ kspace electrostat comput long step requir reduct along column for kfactor along row for intermolecular forc within step comput thread node wait barrier indic b figur posit atom receiv node updat thread comput forc requir step parallel synchron updat share vector forc use critic region thread wait second barrier forc step comput updat posit veloc atom figur also present summari perform number discuss section focu embed twodimension logic mesh threedimension mesh consid twodimension mesh row column column logic mesh node map onto one physic plane threedimension cellular machin shown figur note logic column embed one physic plane broadcast posit reduct kfactor reciproc space column logic mesh interfer broadcast reduct logic column use x dimens threedimension mesh reduct forc along row twodimension mesh perform adjac plane threedimension physic mesh use disjoint wire z dimens node logic row assign plane also need perform reduct one wire need row along x dimens intranod parallel intranod parallel molecular dynam code exploit multithread simplic set forc bond bend torsion lennardjon electrostat comput node static partit among thread node is n forc forc certain type comput n thread comput thread node thread comput l n forc thread forc movement atom partit way natom atom target set node thread respons move l n atom thread atom forc act atom target set node comput ad forc accumul atom lennardjon real electrostat forc comput act one target atom bond bend torsion intramolecular forc comput howev act atom target set respec tive updat forc accumul perform thread thread need acquir lock accumula tor therefor lennardjon real electrostat forc comput thread acquir one lock bond bend torsion comput thread need acquir lock respect parallel kspace comput differ perform four step insid node start first comput contribut atom target set kfactor assign node comput static schedul thread perform l n atom thread comput evalu kfactor sum contribut atom done binari reduct tree third step complet comput kfactor within node prepar reduct across column final after column reduct perform kforc atom comput comput static schedul thread comput l n atom thread forc form perform model molecular dynam comput base previou discuss molecular dynam algo rithm section deriv analyt perform model behavior algorithm cellular architectur like ibm blue gene section compar result perform model direct measur simul also use model evalu impact certain architectur featur let ts execut time short step let execut time intermedi step let l execut time long step then total execut time one comput time step as shown figur comput number short step one comput time step decompos time step two part comput time expos commun time sil expos commun time part commun time overlap comput comput time model let n bond n bend total number bond bend re spectiv need comput node short step let n thread number comput thread avail node let bond bend time take comput one bond one bend respect let tmove time need updat atom posit veloc let natom number target atom assign node final let barrier n time take perform barrier oper n thread time short step express p shown equat figur let n torsion number torsion need comput node intermedi step let n ljshort n esshort number lennardjon real part electrostat forc within short cutoff respect need comput node intermedi step let lj es time take comput one lennardjon one real part electrostat forc respect time intermedi step express shown equat figur let n ljlong n eslong number lennardjon real part electrostat forc within long cutoff respect need comput node long step let n kfactor number k term node is size k set node let eta n kfactor time take comput one atom contribut k term node let redux n kfactor broadcast posit put adjac bond bend move atom time put adjac bond bend move atom time broadcast posit move atom move atom byte transmit bond bend real elect short cutoff lennardjon short cutoff torsion forc reduct bend bond lennardjon long cutoff long cutoff real elect forc reduct kspace forc torsion kfactor reduc kfactor comput thread comput instthread comput instthread long step short step short step repeat done intermedi step figur flowchart molecular dynam comput complet long time step comput perform molecular dynam applic z threedimension physic mesh logic mesh row x col vertic broadcast horizont reduct figur map column logic mesh physic machin left commun pattern vertic broadcast posit horizont reduct forc right time take add two set contribut k term let kfactor n kfactor time take final comput k term node final let kforc time take comput kforc one atom time long step express l shown equat figur commun time model domin commun oper molecular dynam code forc reduct along row kfactor reduct posit broadcast along column twodimension logic mesh reduct broadcast implement cellular machin organ node within logic row logic column accord span binari tree shown figur figur root tree mark black circl refer figur a b note node column logic mesh consist four adjac strand node physic mesh refer figur c d note node row logic mesh consist eight strand node physic mesh strand node apart commun atom posit evalu intramolecular forc make small contribut total commun alway perform neighbor node along column logic mesh want comput time four commun oper oper vector element let posit time broadcast posit along column kfactor redux time reduc kfactor along column forc time reduc forc along row put time put new posit neighbor row time oper decompos latenc time transfer time latenc time time complet oper first element vector transfer time rate element process time thread thread natom thread thread thread natom thread tmove thread thread thread thread thread natom thread tmove thread n ljlong thread n eslong thread natom thread thread natom thread kforc n kfactor figur analyt express comput time short intermedi long step r node r node node r node r node node a column fanin tree b column fanout tree c row fanin tree d row fanout tree figur fanin fanout tree reduct broadcast oper along column a b reduct oper along row c d number element vector equat form latenc posit kfactor latenc kfactor redux latenc latenc n sourc n kfactor number sourc atom kfactor assign column respect n target number target atom assign row n put number put neighbor node perform triplet complex time transfer one triplet forc posit one complex number kfactor respect posit forc byte long three doubleprecis floatingpoint number kfactor long two doubleprecis floatingpoint hop c number hop node node column root fanin fanout tree intracolumn oper let hop time go hop node cellular machin interconnect latenc posit hop c t hop factor two account round trip let n add c number addit need perform reduc item origin node column get root fanin tree let add time add one item latenc kfactor hop c t hop add c t add analysi forc reduct along row similar let hop r number hop node row root fanin fanout tree intrarow oper let n add r number addit need perform reduc item origin node row get root fanin tree latenc hop r t hop add r t add deriv worst case estim expos commun time si case overlap comput commun upper bound expos commun time factor come short step within comput time step simul environ complement analyt model describ abov execut molecular dynam applic instructionlevel simul blue gene machin proprietari instruct set typic risc loadstor architectur three regist instruct model applic code c compil gcc version compil properli modifi gener code instruct set thread creation manag insid node perform applic level use call pthreadcompat librari internod commun accomplish proprietari commun librari implement put onesid commun broadcast reduc oper node machin run resid system kernel execut supervisor privileg purpos kernel twofold first protect machin resourc thread memori commun channel accident corrupt misbehav applic program resourc use reliabl error detect debug perform monitor second isol applic librari detail underli hardwar commun protocol minim impact evolutionari chang area actual applic run user privileg invok kernel servic inputoutput internod commun instructionlevel simul architectur accur execut kernel applic code model featur node commun node instanc pro cess simul model one node multipl instanc use simul system multipl node intern multipl simul instanc commun mpi result execut applic instructionlevel simul produc detail trace instruct execut also produc histogram instruct mix one trace one histogram produc everi node simul instructionlevel simul time inform and therefor directli produc perform estim instead use trace produc simul feed two perform tool one tool cach simul event visual provid measur cach behavior tool trace analyz detect depend conflict instruct trace produc estim actual machin cycl necessari execut code trace analyz execut instruct model resourc usag instruct trace analyz instruct predefin execut latenc instruct compet share resourc thread node execut instruct program order thu resourc instruct avail thread tri issu instruct issu delay thread stall resourc becom avail memori oper trace analyz use probabilist cach model hit rate valu valid run trace cach simul perform paramet simul architectur shown tabl paramet earli estim may chang lowlevel logic design complet tabl interpret follow delay instruct decompos two part execut cycl latenc cycl execut unit kept busi number execut cycl issu anoth instruct result avail number executionlat cycl resourc util instruct latenc period exampl float point add execut cycl latenc cycl mean fpu busi cycl execut instruct other instruct may alreadi pipelin next cycl execut anoth instruct howev result addit avail cycl anoth exampl integ divis take execut cycl latenc cycl mean occupi exclus integ unit cycl result avail immedi execut period complet thread issu instruct everi cycl unless stall depend result previou instruct memori oper latenc oper depend deep memori hierarchi go fetch result memori distribut within chip access local memori faster access memori across chip memori share thread within chip address other local memori latenc oper depend physic locat memori memori access determin local global base effect address howev blue gene processor use scrambl global access may local memori again model scrambl probabili tical p probabl global access local memori p number processor chip configur simul petaflop machin easi task straightforward simul entir machin would requir simul process one simul node howev molecular dynam applic structur allow us simul complet one node entir machin extrapol perform result machin present previous molecular dynam code run twodimension logic mesh node node simul atom interact two set atom target set sourc set particular decomposit method use commun node occur intrarow intracolumn onli thu simul one row provid inform behavior row logic twodimension mesh similarli simul one column provid inform behavior column logic twodimension mesh reduc number node need simul one row j plu one column minu one instanc node i j illustr figur still need provid correct valu incom messag boundari subsystem simul so modifi commun layer fake commun except node row j column balanc work distribut node i j perform set oper similar perform node system therefor perform node i j extrapol tabl estim instruct perform paramet blue gene isa type instruct character number cycl keep execut unit busi column execut latenc complet column latenc instruct type execut latenc branch integ multipli divid float point add multipli convers float point divid squar root float point prefetch memori oper cach hit memori oper share local memori oper share remot oper obtain perform entir system use instruct level simul simul node column row j collect analyz trace inform node i j j node node chip simul inform detail figur strategi perform estim simul one row column logic mesh experiment result test case code assembl molecular system human carbon anhydras hca enzym play import role diseas glaucoma hca enzym solvat water molecul total atom system use molecular dynam code run simul describ abov comput evolut system start experiment coordin taken nmr structur carbon anhydras describ molecular system prepar take crystallograph configur hca enzym protein data bank identif label httpwwwrcsborgpdb solvat box water size a charmm forc field use treat interact atom proteinwat system newtonian dynam gener standard condit room temperatur atm pressur use standard verlet algorithm solver tabl list valu variou paramet use analyt perform model section tabl show number forc comput per comput time step serial version code also show number forc comput singl node particip parallel execut mesh scale factor column show ratio two valu tabl list number instruct requir forc comput forc requir use lock discuss section number instruct acquir releas lock shown tabl number instruct treebas multithread barrier function number thread particip barrier shown figur data tabl figur provid inform need estim perform analyt perform model section tabl a summar valu variou primit commun paramet obtain intrins characterist architectur applic tabl b contain result valu deriv paramet obtain equat abov number comput thread instruct cycl barrier time figur cost barrier function number thread particip tabl summar total instruct count per node variou thread configur obtain architectur simul configur differ number thread alloc perform comput number floatingpoint unit alloc comput l n threadm addit thread includ number alloc perform commun system servic tabl list total number load store branch integ instruct logic instruct system call floatingpoint instruct execut thread node case floatingpoint instruct detail number multiplyadd fmad multipli tabl number forc comput node one time step simul hca protein long real cutoff short cutoff show result singl node execut column row logic mesh singl node one node mesh item item scale factor target atom electrostat forc real part long cutoff lennardjon forc long cutoff electrostat forc real part short cutoff lennardjon forc short cutoff kfactor sine cosin kspace bond bend torsion tabl measur paramet comput variou forc paramet instruct descript forc lock total tmove comput new posit veloc atom comput bond forc atom bend comput bend forc atom comput torsion forc atom comput lennardjon forc comput realpart electrostat forc eta comput one atom contribut kfactor redux comput one reduct step kfactor kfactor final stage comput kfactor kforc comput fourierspac electrostat forc subtract instruct instruct perform two floatingpoint oper total number floatingpoint oper shown row flop total number instruct row total note that expect number floatingpoint instruct chang significantli number thread hand number load branch increas significantli number thread thread spend time wait barrier lock tabl identifi major sourc overhead note addit instruct execut multithread belong two oper barrier lock addit lock instruct repres content lock increas larger number thread increas number instruct spent barrier two sourc first number thread increas total time barrier increas illustr figur addit larger number thread typic make load balanc difficult faster thread wait time barrier slower thread total overhead row tabl equal differ number instruct multithread singlethread execut effect overal perform achiev barrier overhead andor lock overhead avoid discuss section tabl summar addit perform result configur differ number comput thread test configur list number instructionsthread short step intermedi step long step see figur show number instructionsthread kfactor k forc compon long step also show total number instructionsthread comput cycl per time step determin architectur simul trace analyz cpi clock per instruct comput ratio two last number cpf clock per floatingpoint instruct measur averag number clock per floatingpoint instruct perspect floatingpoint unit comput cycl dn thread e n float total number floatingpoint instruct n cycl number comput cycl dn thread e number floatingpoint unit util thread share one floatingpoint unit number machin cycl internod commun tabl obtain equat independ number thread total number cycl per time step obtain ad comput commun cycl comput multithread speedup ratio total cycl singl multithread execut final effici comput ratio speedup rel singlethread exe cution number thread low cpihigh cpf number one thread indic good thread unit util low floatingpoint unit util configur eight activ thread per floatingpoint unit perform roughli two time work per floatingpoint unit singl thread doe tabl summari commun cost paramet a primit paramet paramet valu descript sourc number sourc atom assign column target number target atom assign row kfactor number kfactor assign column number put nearest neighbor machin cycl transfer byte interconnect machin cycl transfer byte interconnect hop machin cycl cross one node cellular interconnect machin cycl complet one floatingpoint addit hop c maximum number hop insid column add c maximum number add insid column hop r maximum number hop insid row add r maximum number add insid row b deriv paramet paramet machin cycl descript latenc posit latenc broadcast first posit latenc kfactor redux latenc reduc first kfactor latenc forc latenc reduc first forc latenc put latenc memori nearest neighbor posit total time broadcast posit kfactor redux total time reduc kfactor forc total time reduc forc put total time put posit nearest neighbor l commun time long step commun time short step upper bound expos commun time per time step curv figur indic number instruc tionsthread deriv analyt perform model execut differ compon molecular dynam ap plicat marker figur indic measur made simul valu plot accumul is valu compon ad previou compon therefor top curv figur also repres total number instruct cycl comput time step top curv figur repres total number instruct cycl kspace comput figur show contribut short intermedi reciproc space kspace final long rang real part electrostat lennardjon forc total comput time step figur show contribut kfactor kforc compon total kspace comput good fit analysi simul indic analyt model inde captur behavior applic time chart bottom figur summar comput perform molecular dynam applic first two time line show number instructionsthread thread execut entir comput time step take approxim instructionsthread short step take instruct intermedi step take instruct long step take instruct next time line summar commun behavior obtain simul show total number byte transmit simul node along axe physic threedimension mesh note much data transmit along x z axe along axi result particular embed twodimension logic mesh threedimension physic mesh bottom line show total number cycl estim time one iter step result cach simul shown figur plot averag cach miss rate differ cach size set associ valu configur comput thread result show probabilist model data cach hit rate valid way setassoci cach size kb associ kb larger cach result section indic molecular dynam simul atom run full petaflop cellular machin good perform possibl exploit node thread more run full comput time step figur cycl nscycl code run petaop petaflop howev state result present approxim simul detail cycl level simul feasibl slow perform simul lack detail logic design machin rather trace analyz use estim inform depth variou pipelin use queu model congest key share resourc expect chang softwar algorithm mathemat tabl instruct count sampl node i j instruct class thread thread thread thread thread thread thread load store branch integ op logic op system floatingpoint op fmad flop total instruct tabl instruct sampl node i j function thread thread thread thread thread thread thread barrier lock barrierlock total overhead number comput thread instruct cycl thousand node perform atom problem x mesh short intermedi kspace long total figur perform compon molecular dynam code solid line repres valu analyt model marker measur simul method significantli improv perform code simul hand also expect mani surpris challeng proceed simul actual system architectur impact sinc complet work describ paper blue gene architectur evolv chang motiv silicon real estat constraint exampl number thread per floatingpoint unit reduc total threadsnod memori also reduc mb mbnode import chang howev motiv number comput thread instruct cycl thousand node perform atom problem x mesh kfactor kforc kspace total figur perform compon kspace computa tion solid line repres valu analyt model marker measur simul result perform evalu work discuss chang tabl figur show direct cost lock barrier respect evalu impact final perform molecular dynam code measur would perform code free lock barrier ob viousli code would execut correctli result shown figur show larg number thread instruct count could reduc lock barrier result blue gene architectur includ fast hardwar barrier atom mem tabl instruct cycl count one comput thread sampl node i j cpi averag number machin cycl per instruct cpf number machin cycl per floatingpoint instruct thread thread thread thread thread thread thread short intermedi long kfactor kforc instructionsthread comput cycl cpi internod commun cycl total cycl effici cach size byte miss rate cach miss rate x cach size associ byteslin figur data cach simul result trace collect execut molecular dynam code ori updat hardwar barrier allow synchron thread node less machin cycl anoth architectur enhanc motiv work bswitch shown tabl overal impact commun cycl small less total howev achiev goal necessari perform reduct broadcast minim softwar overhead motiv develop bswitch microprogram data stream switch oper doubl word bit level cycl b switch rout data input combin output also perform floatingpoint oper stream direct stream data tofrom memori node diagram bswitch shown figur conclus estim execut molecular dynam code system atom full petaflop cellular system number comput thread instruct cycl thousand node perform atom problem x mesh lock barrier lock barrier lock barrier lock barrier figur impact barrier lock perform molecular dynam code differ line repres differ configur lock barrier scale envis ibm blue gene project sequenti version applic execut stime step mflop workstat parallel version execut stime step petaflop machin correspond parallel speedup machin time faster effici result agreement estim deriv exercis demonstr class molecular dynam applic exhibit enough parallel exploit million concurr thread execut reason effici demon strate broad line valid massiv parallel cellular system design one approach achiev one petaflop comput power also provid us clear understand repres molecular dynam applic code accur perform model still much work refin improv result fpu input fifo input fifo output fifo output fifo output fifo output fifo output fifo output fifo memori fifo memori fifo control input fifo input fifo input fifo input fifo regist file bswitch figur bswitch devic stream data input port and memori output port and memori bswitch incorpor fpu perform arithmet logic oper directli data stream present here simul upgrad repres detail hardwar design perform model need upgrad valid cycl faith simul commun analysi need reflect overlap comput commun node failur machin scale address algorithm method continu improv r comput simul liquid blue gene project program macromolecular energi minim die berechnung optisch und elektrostatisch gitterpotential flexram toward advanc intellig memori system cmd cmm md code case intellig ram iram fast parallel algorithm shortrang molecular dynam novel bind mode hydroxam inhibitor human carbon anhydras ii hybrid technolog multithread parallel molecular dynam implic massiv parallel machin toward costeffect dsm organ exploit processormemori integr molecular dynam system multipl time scale revers multipl time scale molecular dynam comput experi classic fluid tr comput simul liquid fast parallel algorithm shortrang molecular dynam parallel molecular dynam ctr jeffrey s vetter frank mueller commun characterist largescal scientif applic contemporari cluster architectur journal parallel distribut comput v n p septemb jeffrey vetter dynam statist profil commun activ distribut applic acm sigmetr perform evalu review v n june chingtien ho larri stockmey new approach faulttoler wormhol rout meshconnect parallel comput ieee transact comput v n p april georg almsi clin cacav jo g castao monti denneau derek lieber jo e moreira henri s warren jr dissect cyclop detail analysi multithread architectur acm sigarch comput architectur new v n march s kumar c huang g zheng e bohm a bhatel j c phillip h yu l v kal scalabl molecular dynam namd ibm blue genel system ibm journal research develop v n p januari