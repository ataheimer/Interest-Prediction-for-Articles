t adapt precondit gmre algorithm a restart gmre algorithm propos saad schultz siam j sci statist comput pp one popular iter method solut larg linear system equat axb nonsymmetr spars matrix algorithm particularli attract good precondition avail present paper describ two new method determin precondition spectral inform gather arnoldi process iter restart gmre algorithm method seek determin invari subspac matrix associ eigenvalu close origin move eigenvalu higher rate converg iter method achiev b introduct mani problem appli mathemat engin give rise larg linear system equat spars nonsymmetr nonsingular matrix a often desir sometim necessari solv system iter method let x initi approxim solut let r associ residu vector introduc krylov subspac associ matrix vector r mani popular iter method determin mth iter xm xm gamma x refer method krylov subspac iter method see eg freund et al recent review let iter xm gener krylov subspac iter method residu error r associ xm satisfi residu polynomi pm determin iter method satisfi denot euclidean norm r n well associ induc matrix norm r nthetan restart gener minim residu algorithm saad schultz describ section one popular krylov subspac iter method solut linear system nonsymmetr matrix residu polynomi determin algorithm satisfi depart mathemat comput scienc kent state univers kent oh email jbaglamamcskentedu research support part nsf grant f dmr alcom depart mathemat scienc steven institut technolog hoboken nj email nacalvettinanetornlgov research support part nsf grant dm z comput scienc depart stanford univers stanford ca x depart mathemat comput scienc kent state univers kent oh email reichelmcskentedu research support part nsf grant dm j baglama et al denot set polynomi p degre analysi implement restart gmresm algorithm modif thereof continu receiv consider attent see eg algorithm particularli attract suitabl precondition nthetan matrix avail see eg recent discuss precondition matrix gamma good precondition applic iter method interest precondit linear system equat give higher rate converg comput iter applic iter method origin linear system moreov would like precondition gamma properti w r n vector gamma w rapidli evalu matrix gamma sometim refer left precondition present paper describ two new adapt method determin precondition iter restart gmresm algorithm standard implement restart gmresm algorithm base arnoldi process describ section allow spectral inform gather iter use inform determin approxim invari subspac associ eigenvalu close origin precondition essenti remov influenc eigenvalu rate converg focu effect precondition spectrum a howev known rate converg iter comput gmresm algorithm also determin pseudospectra a see nachtig et al eas present ignor effect precondition pseudospectra present paper precondition particularli effect cluster eigenvalu larg influenc rate converg illustr found section determin well applic precondition requir evalu matrixvector product matrix addit need arnoldi process evalu certain residu error implement use recurr formula implicitli restart arnoldi ira method describ sorensen recent lehoucq precondition combin precondition also applic known effici precondition avail differ method adapt determin precondition iter restart gmresm algorithm recent describ erhel et al util recurr formula ira method precondit scheme allow flexibl choic precondition requir less comput memori method describ anoth adapt precondit method present kharchenko yeremin method differ scheme approxim invari subspac determin morgan also use approxim invari subspac improv rate converg restart gmresm algorithm instead construct precondition append approxim invari subspac krylov subspac gener arnoldi process feel new algorithm attract simplic ira method algorithm base typic determin adequ approxim invari subspac fairli rapidli adapt precondition let matrix spectral factor yield bound a denot spectrum a note bound would decreas abl replac a subset precondition roughli effect definit assum eigenvalu order accord let scale good approxim scale determin iter discuss below arnoldi process determin decomposit form vm r nthetam mthetam upper hessenberg matrix refer arnoldi decomposit a throughout paper e j denot jth axi vector appropri dimens j denot ident matrix order j vm e column vm span krylov subspac km a r defin futur refer defin let matrix v k r nthetak consist first k column vm let column matrix wngammak span r n nspanfv k g spanfv k g denot span column v k assum w ngammak thu column matrix v k wngammak form orthogon basi r n introduc matrix use invers matric form k n left precondi tioner form invers given below proposit let q r nthetan orthogon matrix partit accord submatrix v consist k first column q submatrix w consist remain column assum nonsingular matrix nonsingular invers given j baglama et al proof matrix written theta ngammak therefor theta ngammak show column matrix v proposit span invari subspac a eigenvalu matrix gamma express term eigenvalu a corollari let matric v w h proposit assum moreov column matrix v span invari subspac associ eigenvalu eigenvalu multipl least k proof matrix similar theta ng formula represent yield theta thu spectrum gamma consist eigenvalu multipl latter eigenvalu least k result analog corollari right precondition shown erhel et al remark applic precondition form simplifi fact thu matrix w comput follow exampl compar bound rate converg iter determin gmresm algorithm appli origin linear system precondit linear system precondition assum condit corollari hold exampl assum spectral factor form eigenvalu real posit let eigenvalu order accord yield lim sup min adapt precondition tm z chebyshev polynomi first kind degre interv equal follow wellknown properti chebyshev polynomi see eg section precondition assum condit corollari hold precondition elimin influenc k smallest eigenvalu rate converg gmresm algorithm specif gmresm algorithm appli precondit linear system yield sequenc residu vector bound lim sup where usual r bound shown first note lim sup appli bound righthand side actual comput determin precondition krylov subspac spanfv k g close invari subspac comput exampl suggest gmresm algorithm requir fewer iter determin accur approxim solut appli precondit linear system precondition appli origin unprecondit system verifi numer experi present section construct precondition section describ determin approxim invari subspac associ eigenvalu use recurs formula ira method sorensen first present arnoldi process algorithm arnoldi process input k m upper hessenberg matrix h output upper hessenberg matrix nthetam h j v endfor jwe may assum vector f gener algorithm nonvanish f column matrix v j gener span invari subspac a v j use construct precondition describ exampl input algorithm initi vector f j baglama et al provid note f defin matrix orthogon column sequel use matrix m matrix hessenbergtyp whose lead theta princip submatrix hm whose m st row numer difficulti aris comput vector f j al gorithm comput done modifi gramschmidt process one reorthogon neglect enforc orthogon vector f j vector give rise spuriou eigenvalu matrix hm ie eigenvalu cannot consid approxim eigenvalu a given arnoldi decomposit initi vector recurs formula ira method use comput vector monic polynomi degre evalu new matrixvector product matrix a coeffici jmgammak scale factor chosen kv mgammak discuss select zero z j below recurs formula ira method truncat version recurs formula qr algorithm explicit shift zero z j chosen shift see eg chapter descript qr algorithm therefor sometim refer zero z j shift thu let decomposit given determin qr factor r upper triangular put also hessenberg matrix multipl equat e yield ae equat display relationship initi arnoldi vector v vector v appli shift obtain decomposit adapt precondition denot orthogon matrix associ shift z j introduc partit hmgammak equat first k column righthand side lefthand side give v mgammak mgammak follow v mgammak thu arnoldi decomposit a construct vector v mgammak written descript ira method base recurs formula qr algorithm explicit shift implement base qr algorithm implicit shift reason numer stabil see chapter descript qr algorithm use implicit shift allow applic complex conjug shift without use complex arithmet first appli arnoldi process comput arnoldi decomposit use recurs formula ira method determin arnoldi decomposit purpos comput determin accur approxim invari subspac associ eigenvalu would like choos zero z z mgammak mgammak first column v mgammak k defin in close to invari subspac associ eigenvalu let f m denot eigenvalu upper hessenberg matrix hm order avm orthogon project a consid m j approxim eigenvalu a order forc vector v mgammak invari subspac associ k eigenvalu smallest magnitud choos zero ie z j chosen avail approxim eigenvalu largest magnitud select zero discuss sorensen calvetti j baglama et al et al lehoucq zero refer exact shift numer experi indic order shift accord adequ sens comput matric h mgammak close k eigenvalu hm smallest magnitud let f k j eigenvalueeigenvector pair h mgammak k introduc vector approxim eigenvalueeigenvector pair residu error accept spanfv k g approxim invari subspac kf mgammak ffl subspac paramet purpos matrix h mgammak k make bound invari scale a inequ satisfi appli algorithm arnoldi decomposit input order determin new arnoldi decomposit theta upper hessenberg matrix hm appli recurs formula ira method zero chosen hm largest magnitud give arnoldi decomposit form check whether inequ satisfi comput repeat fashion hold obtain way arnoldi decomposit form matric k h k that gener spanfv k g accur approxim invari subspac associ k eigenvalu smallest magnitud a h k accur approxim set f j g k accuraci approxim depend paramet ffl subspac distribut eigenvalu a departur normal a matric v k h k obtain use defin first precondition use describ section combin ira process restart gmre algorithm richardson iter improv avail approxim solut determin precondition gamma comput precondition appli method outlin precondit system order determin approxim invari subspac associ eigenvalu smallest magnitud matrix simultan improv avail approxim solut yield new precondition gamma system gamma equival new precondition system comput continu manner determin precondition form specifi integ ff form precondition make natur scale hold approxim scale achiev scale linear system factor j m eigenvalu adapt precondition largest magnitud one matric hm gener algorithm comput precondition gamma remark certain matric techniqu achiev scale may avail instanc one may abl use gershgorin disk inequ matrix norm induc vector norm see chapter detail latter topic iter method section describ two algorithm adapt precondit detail one them algorithm combin ira process richardson iter gmre algorithm scheme algorithm appli richardson iter first recal restart gmresm algorithm saad schultz solut linear system equat algorithm restart gmresm algorithm input m initi approxim solut x output approxim solut xm associ residu vector r krm kkr solut comput algorithm input matric vm hm defin respect also avail comput solut ym hm yk endwhilew describ improv avail approxim solut richardson iter appli recurs formula ira method arnoldi decomposit iter carri without evalu matrixvector product matrix a let x avail approxim solut richardson iter written relax paramet would like paramet ffi j approxim solut x j converg rapidli solut j increas futur refer note residu vector written theorem let x approxim solut let r consid arnoldi decomposit initi vector k appli recurs formula ira method zero z m residu vector associ iter comput richardson iter relax paramet j baglama et al given m q denot orthogon matrix r upper triangular matrix associ zero z ira recurs formula moreov v m proof first show substitut v represent show turn case obtain replac vmq equat multipli equat obtain e show analog substitut show continu manner yield m case treat separ arnoldi decomposit similarli obtain v m choos ae m complet proof prior develop gmresm algorithm saad introduc full orthogon algorithm galerkin method solut let x approxim solut let r associ residu vector consid arnoldi decomposit let v theorem fom algorithm determin improv approxim solut xm solv linear system let follow result show approxim solut determin richardson iter theorem let vector x r arnoldi decomposit theorem assum arnoldi decomposit exist adapt precondition kfm k matrix hm arnoldi decomposit nonsingular let let relax paramet richardson iter reciproc valu eigenvalu hm then exact arithmet approxim solut xm determin richardson iter equal approxim solut comput fom algorithm proof substitut use fact linear system written hm introduc polynomi f g bilinear form construct g j polynomi degre j particular equat yield show pm residu polynomi degre fom algorithm therefor satisfi pm combin formula yield ident show eigenvalu f m hm zero gm particular m therefor pm written pm follow comparison show step richardson iter relax paramet j applic fom algorithm correspond residu polynomi therefor equival implement iter method base follow observ corollari let x j gamma approxim solut let r associ residu vector let arnoldi decomposit initi vector j eigenvalu h let x approxim solut j baglama et al obtain one step richardson iter relax paramet q let applic recurs formula ira method shift q yield arnoldi decomposit av triangular matrix qr factor h moreov h proof corollari follow theorem fact use exact shift eigenvalu reduc matrix h eigenvalu origin matrix h except shift latter result shown sorensen lemma corollari show appli shift one time determin requir residu vector first column matric v avail arnoldi decomposit analog result establish complex conjug shift latter case recurs formula ira method implement use qr algorithm implicit doubl shift obviat need use complex arithmet doubl step richardson iter complex conjug relax paramet also carri without use complex arithmet notat simplic algorithm iter method use doubl shift doubl step howev implement algorithm use comput exampl section doe algorithm adapt precondit gmresm algorithm richardson iter input toler comput approxim solut ffl solut toler approxim invari subspac ffl subspac dimens largest krylov subspac determin dimens k approxim invari subspac comput maximum number ff precondition gamma j comput maximum number fi arnoldi decomposit order determin precondition output comput approxim solut x associ residu vector r j precondition comput algorithm initi vector comput eigenvalu f m matrix hm arnoldi decomposit order accord scale matrix righthand side linear system factor j m j equat approxim satisfi appli shift m mgamma arnoldi decomposit comput residu vector gamma r j describ corollari give mgamma adapt precondition endfor bound satisfi goto use arnoldi decomposit gamma av mgammak k input algorithm appli arnoldi process comput arnoldi decomposit endfor fi improv approxim solut gmresk updat precondition k well matric avail comput solut k r k min gamma r jk solut done endfor ff kr j kkr solut appli algorithm initi vector matric vm hm defin respect comput solut ym r jm endwhilein algorithm comput matrixvector product matrix appli arnoldi process evalu residu vector r line label examin storag requir algorithm count number nvector store storag necessari repres matrix ignor sinc independ iter method use precondition requir storag n theta k matrix v k limit number precondition ff thu precondition gamma defin requir storag ff k nvector particular matrix gamma actual form line mark algorithm interpret symbol mean storag matrix gamma formula evalu matrixvector product gamma updat gmresm algorithm whileloop algorithm requir addit storag vector x j r j matrix vm r nthetam equival storag m nvector vector algorithm scale factor store first column matrix vm last column vm contain vector fm scale factor righthand side vector b also store therefor total storag requir algorithm ff algorithm obtain replac richardson iter algorithm gmre algorithm replac make residu error decreas smoothli iter proceed howev iter precondition gener algorithm same found j baglama et al former algorithm seldom give faster converg illustr section therefor feel algorithm interest storag requir algorithm essenti algorithm notat simplic iti algorithm use doubl shift howev implement algorithm use comput exampl section doe algorithm adapt precondit gmresm algorithm input toler comput approxim solut ffl solut toler approxim invari subspac ffl subspac dimens largest krylov subspac determin dimens k approxim invari subspac comput maximum number ff precondition gamma j comput maximum number fi arnoldi decomposit order determin precondition output comput approxim solut x associ residu vector r j precondition comput algorithm initi vector appli gmresm determin matric vm hm defin respect comput solut ym comput eigenvalu f m matrix hm arnoldi decomposit order accord scale matrix righthand side linear system factor j m j equat approxim satisfi appli shift m mgamma arnoldi decomposit use ira formula give arnoldi decomposit mgamma endfor bound satisfi goto use arnoldi decomposit gamma av mgammak k input algorithm appli arnoldi process comput arnoldi decomposit appli gmresm determin matric vm hm defin respect comput solut ym endfor fi improv approxim solut gmresk updat precondition k well ma adapt precondition trice v k avail comput solut k r k min gamma r jk solut done endfor ff kr j kkr solut appli algorithm initi vector matric vm hm defin respect comput solut ym r jm endwhileth comment regard line label algorithm also appli algorithm numer experi numer experi present section carri hp comput use matlab exampl chose initi approxim solut x b vector b randomli gener uniformli distribut entri open interv purpos experi compar algorithm restart paramet chosen latter algorithm allow least much comput storag former two algorithm also compar algorithm gmre algorithm without restart refer latter scheme full gmre termin iter iter method soon residu vector r j determin ffl solut algorithm chose input paramet valu ffl subspac storag requir algorithm choic paramet nvector compar scheme restart gmre algorithm requir storag nvector v xm see algorithm storag count assum residu vector r algorithm scale factor store first column matrix v exampl let matrix r theta partit accord r theta circul matrix first row gamma entri diagon matrix r theta uniformli distribut random number interv matrix zero matrix appropri order thu j baglama et al matrix eigenvalu circl center gamma radiu remain eigenvalu uniformli distribut open interv figur show denot last precondition comput algorithm shift eigenvalu shown unscal matrix a eigenvalu gamma also unscal matrix associ precondition unscal precondition map eigenvalu smallest magnitud approxim signr n j n j illustr figur figur show iter converg rapidli precondition remov mani eigenvalu circl fz g remark plot m determin algorithm look roughli plot eigenvalu precondition shown figur graph algorithm figur continu curv gener evalu kr j k everi valu j residu vector r j defin ie everi step richardson iter in everi minim residu error gmre algorithm graph algorithm figur dash curv gener evalu kr j k everi minim residu error gmre algorithm number matrixvector product matrix report tabl howev number actual requir algorithm piecewis linear graph gmre figur obtain linear interpol node node mark circl column size krylov subspac tabl display paramet use algorithm column precondition show number precondition gamma use suffici accur solut found number bound ff column vector precondition paramet k algorithm column label total vector use count number nvector storag graph figur dashdot curv full gmre obtain appli gmresm solut increas valu order improv initi approxim solut x approxim solut xm suffici small residu error kr k determin figur show logarithm rel residu error kr k kkr k exampl consid theta block bidiagon matrix gammay gammay gammay eigenvalu given j gamma figur analog figur respect tabl analog tabl distribut eigenvalu gamma figur indic toler ffl subspac use comput larg determin accur approxim invari subspac a nevertheless adapt precondition eigenvalu closest origin remov algorithm yield faster converg restart gmre algorithm see figur exampl let pore matrix harwellbo matrix collect matrix nonsymmetr order nonzero entri purpos shift obtain matrix posit eigenvalu figur analog figur respect tabl analog tabl see eigenvalu matrix close origin other larg magnitud figur illustr precondition move eigenvalu away origin approxim signr n j n j neg figur show rate converg exampl let diagon matrix order diagon entri figur analog figur respect tabl analog tabl figur illustr precondition move smallest eigenvalu a except one away origin figur show rate converg exampl exampl abov chose shift accord ie determin approxim subspac associ eigenvalu smallest magnitud present exampl illustr algorithm easili modifi determin approxim invari subspac specif use algorithm solv linear system equat exampl chose shift eigenvalu largest real part matric hm gener iter thu sought determin invari subspac associ eigenvalu smallest real part figur analog figur show a dot m gamma eigenvalu circl remov number matrixvector product requir stop criterion satisfi less number matrixvector product report tabl conclus paper describ new precondit method well suit use restart gmresm algorithm numer comput exampl indic iter gener method converg significantli faster iter determin restart gmre algorithm requir comput storag algorithm describ version precondit method eigenvalu j smallest magnitud matrix map approxim easi modifi precondition eigenvalu map acknowledg work paper carri last three author visit comput scienc depart ip eth would like thank walter gander martin gutknecht make visit possibl would like thank marcu grote discuss code extract matric harwellbo matrix collect richard lehoucq provid us refer j baglama et al r principl minim iter solut matrix eigenvalu problem cambridg univers press iter method comput eigenvalu larg symmetr matrix newton basi gmre implement parallel implement gmre al gorithm implicitli restart lanczo method larg symmetr eigenvalu problem deflat augment krylov subspac techniqu parallel implement restart gmre iter algorithm nonsymmetr system linear equat numer stabil gmre parallel gmre version gener spars matric restart gmre precondit deflat iter solut linear system matrix comput gmrescr arnoldilanczo matrix approxim problem parallel precondit spars approxim invers eigenvalu translat base precondition gmresk method analysi implement implicitli restart arnoldi iter restart gmre method augment eigenvector hybrid gmre algorithm nonsymmetr linear system krylov subspac method solv larg unsymmetr system linear equat precondit krylov subspac method cfd applic gmre gener minimum residu algorithm solv nonsymmetr linear system implicit applic polynomi filter kstep arnoldi method introduct numer analysi superlinear converg behaviour gmre tr ctr d loghin d ruiz a touhami adapt precondition nonlinear system equat journal comput appli mathemat v n p may ronald b morgan restart blockgmr deflat eigenvalu appli numer mathemat v n p juli paul j harri ke chen effici precondition iter solut galerkin boundari element equat threedimension exterior helmholtz problem journal comput appli mathemat v n p juli