t comput densiti markov chain via simul a introduc new class densiti estim term lookahead densiti estim perform measur associ markov chain lookahead densiti estim given transient steadyst quantiti lookahead densiti estim converg faster especi multidimension problem empir give visual superior result rel standard estim kernel densiti estim sever numer exampl demonstr potenti applic lookahead densiti estim given b introduct visual becom increasingli popular mean enhanc one understand stochast system particular rather report mean distribut one often find use conclus may drawn see densiti underli random variabl consid problem comput densiti perform measur associ markov chain chain finit state space typic amount comput estim finit number probabl standard method may appli easili case see below chain evolv gener state space howev problem straightforward gener statespac markov chain aris natur simul discreteev system hen derson glynn simpl exampl consid custom wait time singleserv queue traffic intens ae see section sequenc custom wait time form markov chain evolv state space gener mani discreteev system may research second author support us armi research offic contract no daag nation scienc foundat grant no dm describ gener semimarkov process process view markov chain gener state space see eg henderson glynn gener statespac markov chain also preval theori control system see chapter meyn tweedi paper outgrowth of consider extend glynn henderson introduc new methodolog stationari densiti estim gener overview densiti estim iid observ see prakasa rao devroy devroy yakowitz consid stationari densiti estim problem markov chain state space ae ir stationari distribut densiti respect lebesgu measur show certain condit kernel densiti estim point x asymptot normal distribut error proport nh socal bandwidth n simul runlength one condit need establish result hn n henc rate converg kernel densiti estim typic strictli slower n gamma depend dimens see remark contrast estim propos converg rate n gamma independ dimens d fact estim propos sever appeal featur rel easi comput compar say nearestneighbour kernel densiti estim tune paramet need select unlik bandwidth kernel densiti estim exampl wellestablish steadyst simul output analysi techniqu may appli analyz estim error estim converg rate n gamma independ dimens state space n simul runlength rel mild assumpt lookahead densiti estim consist estim densiti itself also deriv densiti see theorem estim use obtain new quantil estim varianc estim correspond quantil estim rigor converg theori converg rate n gamma section empir estim yield superior represent stationari densiti compar method exampl section first introduc central idea behind lookahead densiti estim familiar context although problem subsum treatment section separ develop prove help understand lookahead approach let irreduc posit recurr markov chain finit state space s y stationari probabl point s goal estim stationari densiti delta finit state space context stationari densiti coincid stationari probabl y s estim y standard estim idelta indic function argument true otherwis estim n y simpli proport time markov chain x spend state y notic howev one could also estim y p delta delta transit matrix x estim n y strongli consist estim y seen note strong law posit recurr markov chain discret state space notic quantiti p xi y is effect look ahead see whether next iter markov chain equal y motiv name lookahead densiti estim remaind paper assum gener statespac not necessarili discret unless otherwis specifi refer densiti tri estim target densiti associ distribut target distribut section lookahead densiti estim develop sever perform measur associ transient simul pointwis asymptot behaviour deriv steadyst perform measur similarli consid section section turn global converg behaviour lookahead densiti estim particular give condit lookahead densiti estim converg target densiti l q sens theorem uniformli converg theorem differenti theorem section consid comput sever featur target distribut includ mode target densiti quantil target distribut final section give three exampl lookahead densiti estim comput densiti transient perform measur markov chain take valu state space s sinc focu section transient perform measur permit chain possess transit probabl nonstationari recal transit kernel qx delta probabl measur x s qdelta dy suitabl measur if discret state space q correspond transit matrix permit x nonstationari transit probabl assert exist sequenc transit kernel as basic assumpt is a exist oefinit measur fl function remark assumpt automat satisfi finit countabl infinit remark given paper concern densiti estim case fl lebesgu measur subset ir interest us howev import note restrict us context fact exampl section show appar subtleti fact use remark x stationari transit probabl p discuss steadyst densiti estim see section clearli wish restrict chain describ sever differ comput set idea paper appli follow adopt gener notat pz delta denot fldensiti rv z word pz delta function properti rang z also given initi distribut s let p delta probabl distribut pathspac x x initi distribut problem comput densiti xr r let p xr delta fldensiti xr note z z z expect oper correspond p comput densiti p xr y simul n iid replic x p then strong law larg number togeth guarante as n p xr y inde comput lookahead estim p n y remark suppos weaken assum exist densiti mstep transit probabl distribut provid r m write p xr y easili comput via independ replic x given subset s let ag first entranc time a problem comput densiti xt suppos p start c initi distribut then z z a z again strong law larg number ensur n x s independ replic x p ag import class transient perform measur concern cumul cost specif sequenc realvalu rv gamman may interpret cost associ run x gammai cumul cost correspond time interv n assum that condit x gammai independ rv condit distribut gammai depend x xi gamma xi import special case aris ir case automat satisfi fx may view cost associ spend unit amount time x s we permit addit gener cost structur standard ingredi gener theori addit function markov chain creat difficulti theori proceed discuss cumul cost cn note problem natur analogu here howev need replac a exist oefinit measur fl function problem comput densiti gammar ir densiti p gammar y consist estim n independ replic x problem comput densiti gammat here densiti p gammat y consist estim via n usual independ replic x p first entranc time x set a addit consist p n y p n y permit us solv coupl addit comput problem relat densiti cumul cost rv introduc earlier problem comput densiti cr assum fl lebesgu measur then r may use write z z z ygammaz z z evid strong law larg number togeth guarante as n p n y consist estim p cr y lebesgu densiti cr problem comput densiti ct earlier assum argument use establish ident thu strong law prove consist estim point construct unbias densiti estim six densiti comput problem describ abov turn develop asymptot valid confid region densiti key recogn six estim may repres p here index set either ir depend estim consider let py i y point y py i ddimension vector jth compon p y j straightforward applic multivari central limit theorem clt yield follow result point select e ij y k ddimension multivari normal random vector mean vector zero covari matrix sigma y j kth element given cov y j y k proposit suggest approxim p y n larg denot nonrigor relat ha approxim distribut as sigma y squar root choleski factor nonneg definit symmetr matrix sigma y sinc easili estim consist x sampl covari matrix follow may use construct asymptot valid confid region py i remark equat impli error lookahead densiti estim decreas rate n gamma dimensionindepend rate stand sharp contrast heavili dimensiondepend rate exhibit densiti estim includ kernel densiti estim see prakasa rao converg rate estim typic nh bandwidth paramet dimens minim mean squar error bandwidth hn typic chosen order n gammad error kernel densiti estim decreas rate n gammad even one dimens asymptot rate slower exhibit lookahead densiti estim higher dimens differ even appar see exampl section comput densiti steadyst perform measur extend lookahead estim methodolog steadyst context order concept steadyst welldefin assum x stationari transit probabl transit kernel introduc section independ n word assum exist transit kernel p p defin a proposit a stationari distribut x possess densiti respect fl proof let stationari distribut x note use repres stationari distribut densiti respect fl appropri interpret clear context then suitabl measur z z z z z follow stationari distribut fldensiti delta valu z s accord proposit densiti y may express expect name see relat suggest use estim n y n comput y n y requir simul x time establish law larg number clt n y requir x posit recurr suitabl sens a assum exist subset b s posit scalar b integ probabl distribut delta s determinist function ev ix b depend whether x b languag gener statespac markov chain theori ensur x geometr ergod harri recurr markov chain see meyn tweedi detail condit typic satisfi reason behav markov chain choos b compact set determin satisfi condit known lyapunov function condit mani chain potenti choic v someth form v great deal ingenu may necessari order construct v see exampl section illustr verif a case ensur x possess uniqu stationari distribut remark assumpt stronger condit necessari obtain law larg number clt below howev applic particularli straightforward suffici condit verifi offer spirit consist point select s let n y y ddimension vector jth compon n y j theorem assum a a suppos n also exist nonneg definit symmetr matrix ddimension standard brownian motion denot weak converg d proof proof follow directli result meyn tweedi strong law consequ theorem lemma lemma togeth impli exist squar integr with respect solut poisson equat enabl applic theorem yield result remark equat impli error lookahead densiti estim estim stationari densiti decreas rate n gamma rate observ remark case independ observ furthermor exactli independ set exist estim includ kernel densiti estim converg slower rate see yakowitz converg rate estim typic nh bandwidth paramet dimens euclidian state space sinc hn converg rate slower n gamma yakowitz give optim in term minim mean squar error choic bandwidth hn howev iid sequenc special case markov chain and note remark fastest possibl root mean squar error converg rate set order n gammad rate heavili dimens depend largedimension problem one might expect slow converg kernel densiti estim obtain confid region densiti vector y sever differ approach possibl sigmay posit definit exist consist estim sigma n y sigmay theorem assert ir larg n sigma n y defin set fx w confid region y easili obtain x enjoy regen structur regen method steadyst simul output analysi provid one mean construct consist estim sigmay see exampl bratley fox schrage altern approach exploit function clt provid theorem ensur asymptot valid method multivari batch mean see munoz glynn detail remark discuss section gener comput densiti gamma stationari distribut particular suppos x satisfi a ir defin a methodolog section gener suitabl global behaviour lookahead densiti estim previou section focus pointwis converg properti lookahead densiti estim specif show finit collect point either ir depend estim lookahead densiti estim converg as rate converg describ clt rate dimens independ section turn estim global converg properti assum throughout remaind paper complet separ metric space in particular includ state space reason subset ir k let fl section let either ir depend estim consid then function f ir may defin q l q norm kfk q z two function f f measur distanc f f first analyz lookahead densiti estim introduc section theorem suppos e r kp delta gamma pdelta ik q n proof evid y note n due convex jxj q satisfi right hand side converg as expect e j y gamma py ij q consequ righthand side uniformli integr also y lefthand side converg zero as sinc lefthand side domin uniformli integr sequenc follow ejp n fl ae y also take expect side yield inequ ejp righthand side integr y hypothesi domin converg theorem appli give z ejp henc ekp delta gamma pdelta ik q consequ kp delta gamma pdelta ik q n theorem follow turn next obtain analog result steadyst densiti estim n delta section theorem suppos z x s q hold initi distribut densiti respect fl n proof condit guarante z see theorem meyn tweedi so y proof follow pattern theorem argument yield conclus ffl almost everi x therefor domin converg theorem allow us conclud z n udelta densiti desir conclus remark note hypothes theorem automat satisfi converg estim densiti l q ensur given runlength n error given size occur small with respect fl set turn question lookahead densiti estim converg limit uniformli uniform converg especi import visual context one guarante error estim uniformli small graph estim densiti close graph limit focu attent steadyst densiti estim n similar result deriv densiti estim analog argument theorem suppos forc p theta continu bound hold compact set k sup n proof fix ffl sinc tight see billingsley exist compact set kffl assign ffl mass complement write second term righthand side may bound kffl as limit supremum ffl first term note k compact kffl theta k compact p therefor uniformli continu there uniform continu exist ffiffl whenev theta k within distanc ffiffl ffl sinc k compact find finit collect point k open ball radiu ffiffl center k exist collect jpxj so k let ffl henc k obtain uniform bound let n appli strong law harri chain n gamma send ffl obtain desir conclus remark compact theorem yield uniform converg n s continu hypothesi p the bounded automat set next result establish uniform converg n s provid assum px delta vanish infin theorem suppos hold uniformli continu bound assum x ffl exist compact set kx ffl whenev ffl hold sup n proof fix ffl choos ffiffl whenev lie within distanc ffiffl choos kffl proof theorem let x kffl finit collect point open ball radiu ffiffl centr x kffl x exist k note k compact theorem establish sup n deal construct sequenc x kffl x n closest point within collect fx then send n allow us conclud y k inequ yield lim sup sup togeth impli theorem follow consequ theorem improv theorem converg probabl as converg basic scheff theorem see exampl p serfl corollari condit theorem z n proof result immedi fl finit measur sinc j n delta gamma deltaj uniformli bound converg zero as theorem fl infinit measur like lebesgu measur theorem assert n delta delta as pathbypath may argu z z sinc integrand domin delta integr one therebi permit applic domin converg theorem pathbypath import characterist lookahead densiti estim smoothli approxim densiti comput specif suppos either consid densiti one realvalu rv associ estim p n delta p n delta p n delta p n delta sinc work subset euclidian space reason measur smooth term deriv densiti real loss gener assum ir lookahead densiti estim develop take form sequenc random function g both estim section section admit represent estim kth deriv target densiti comput natur estim therefor dy k pn dy quit weak condit problem shown estim comput kth deriv target densiti consist see discuss result prove lookahead densiti estim comput densiti also approxim deriv densiti consist fashion word smoothli approxim target densiti illustr type condit need order ensur lookahead densiti estim smoothli approxim target densiti consid steadyst densiti estim section let p x dy px y theorem suppos hold continu differenti bound deriv hold differenti densiti delta sup n compact k s furthermor jp x yj v x x s exist dy n proof note z lie deriv assum bound bound converg theorem ensur limit exist bound continu exactli argument use prove theorem use obtain clt immedi consequ theorem meyn tweedi import implic theorem lookahead densiti estim comput deriv accur fact densiti estim converg rate n gamma independ dimens state space furthermor independ order deriv estim remark also known kernel densiti estim smoothli approxim target densiti see prakasa rao p scott p choic bandwidth minim mean squar error kernel densiti deriv estim larger case estim target densiti itself result rate converg kernel densiti deriv estim advers affect order deriv dimens state space exampl one dimens kernel densiti deriv estim rth order deriv converg best rate rate fastest estim first deriv even then slower rate converg lookahead densiti deriv estim discuss abov comput special featur target distribut use lookahead densiti estim discuss earlier comput densiti use element develop visual tool comput simul section focu comput certain featur target distribut lookahead densiti estim appli advantag comput rel likelihood two point section introduc number differ lookahead densiti estim write gener pn delta lookahead densiti estim pn delta estim target densiti pdelta say pair point y repres likelihood point rel joint clt develop proposit theorem use obtain clt suit abl construct largesampl confid interv rel likelihood estim n covari matrix n consist estim as with exampl regen method confid interv rel likelihood base easili obtain otherwis one turn batch mean method produc confid interv see munoz glynn comput mode densiti mode densiti provid inform region within random variabl interest attain highest likelihood given target distribut densiti pdelta goal comput modal locat modal valu py discuss earlier section lookahead densiti estim gener pn delta obviou estim is cours maxim pn delta natur estim py pn y assum maxim n select measur denot domain pdelta analysi involv use taylor expans requir ir theorem pdelta uniqu mode locat sup as n exist fflneighbourhood ffl pdelta pn delta twice continu differenti as sup kygammay kffl as n sup kygammay kffl as n hn y hy hessian pn delta pdelta y respect hy neg definit n p n y then as n n proof almost sure converg n immedi consequ relat weak converg statement observ rpn y local maxima pn delta pdelta respect to precis valid n larg n lie fflneighbourhood specifi relat so rpn y rpn y as n follow n y gammay lie line segment join n sinc rpn n as establish weak converg n y evid first term converg zero probabl consequ relat converg togeth principl see billingsley exampl impli desir joint converg result remark uniform converg theori section pn deriv easili appli verifi relat remark clt establish theorem show lookahead estim mode converg asymptot rate n gamma independ dimens state space compar favour rate converg kernel estim mode kernel estim mode converg rate nh d bandwidth hn chosen appropri see theorem prakasa rao p remark construct confid interv base theorem coupl altern assum first fix one consist estim covari matrix aris joint clt relat for exampl done transient context set regen process steadyst simul estim covari structur one comput correspond covari estim evalu point n transient problem consid section typic easi verifi covari matrix continu y use estim associ n place covari asymptot valid steadyst context straightforward theoret establish continu covari although one suspect valid great gener one potenti avenu adopt method glynn lecuy consist estim covari matrix fix avail as might occur nonregen steadyst simul one potenti appeal method batch mean see munoz comput quantil target distribut focu special case ir target distribut realvalu rv set suppos dy let py dy target distribut import special featur distribut pth quantil f specif p defin pth quantil f quantiti signific literatur comput quantil iglehart consid quantil estim context regen simul prove central limit theorem standard estim seila introduc batch quantil method regen process avoid difficulti associ estim procedur propos iglehart approach suggest heidelberg lewi base socal maximum transfor mation mix assumpt underli process requir regen structur hesterberg nelson refer therein discuss use control variat obtain varianc reduct quantil estim avramidi wilson obtain varianc reduct estim quantil use antithet variat latin hypercub sampl kappenman integr invert kernel densiti estim pdelta case observ iid approach similar kappenman invert integr lookahead densiti estim let pn delta lookahead densiti estim set pn y dy natur estim quantil q p theorem suppos pq pdelta continu ffl neighbourhood q sup as n n proof recal kpn delta gamma pdeltak n see remark henc sup x n follow qn q n lie qn q relat impli pn n pq n result follow relat remark similar issu discuss remark aris construct confid interv base theorem again possibl consist estim varianc paramet aris clt relat either transient context set regen steadyst simul see thi recal lookahead densiti estim pn delta may express sequenc random function g pn y dy n evid sampl mean sequenc realvalu rv sequenc either iid regen depend context therefor standard method may appli estim varianc paramet clt relat comment remark relat continu varianc paramet appli directli here particular one must establish varianc rv n relat continu function q estim varianc q estim varianc q n asymptot valid natur ask perform lookahead quantil estim compar standard quantil estim eas exposit remaind section specialis case markov chain take valu ir suppos forc interest comput distribut function stationari distribut x natur approach estim q first estim f empir distribut function fn choos estim qn q p altern use lookahead methodolog one could estim q f gamma proof follow proposit rest primarili observ estim fn fn relat principl extend condit mont carlo bratley et al p glasserman let p densiti stationari distribut respect lebesgu measur let var denot varianc oper associ path space x x initi distribut proposit suppos hold condit theorem satisfi then fn q n n standard normal rv addit x stochast monoton oe oe proof observ w ir z q theorem meyn tweedi impli n similarli theorem also give n x stochast monoton view appli theorem glynn iglehart achiev result the requir uniform integr follow fact combin result theorem proposit see reason condit n also shown reason condit oe henderson glynn proposit assert oe context steadyst quantil estim stochast monoton markov chain lookahead quantil estim may typic expect achiev varianc reduct standard quantil estim remark wellknown wait time sequenc singleserv queue stochast monoton markov chain thu result section may appli context exampl present three exampl applic lookahead densiti estim first exampl exampl steadyst densiti estim illustr establish a exampl wellknown sequenc custom wait time exclud servic fifo singleserv queue markov chain state space particular w satisfi lindley recurs p asmussen iid sequenc n v n servic time nth custom un interarriv time nth st custom verifi a proceed follow defin yet determin constant note let us assum moment gener function oet ee ty exist neighbourhood zero oet finit suffici small t stabil must ey impli oe henc exist ff oeff choos k x k see ev w jw also see x k ev w jw thu verifi condit set verifi condit note ey impli exist fi follow condit w take point mass see condit verifi therefor establish follow result proposit moment gener function exist neighbourhood ey satisfi specialis mm queue arriv rate servic rate traffic intens ae transit kernel w given px probabl measur assign unit mass origin note pdelta delta bound max follow after possibl scale function condit theorem satisfi lookahead densiti estim therefor converg rate n gamma stationari densiti w defin suitabl kernel densiti estim slightli problemat due presenc point mass stationari distribut need select kernel bandwidth estim point mass use mean number visit run length n estim y use densiti standard normal rv choic hn modulo multipl constant yield optim rate meansquar converg case observ iid prakasa rao p seem reason choic context exampl chose traffic intens ae remov effect initi bia note estim affect thi simul stationari version w sampl w stationari distribut exact lookahead kernel wait time densiti densiti estim mm queue figur densiti estim run length densiti estim x togeth exact densiti plot simul runlength figur observ follow visual lookahead densiti estim appear far better represent true densiti kernel densiti estim kernel densiti estim sever local mode perform near origin particularli poor even run length previou exampl onedimension densiti estim problem result suggest rate converg lookahead densiti estim insensit underli dimens problem howev rate converg kernel densiti estim known advers affect dimens see remark assess differ perform multidimension set provid follow exampl exact lookahead kernel wait time densiti densiti estim mm queue figur densiti estim run length exampl let sequenc dimension iid normal random vector zero mean covari matrix ident matrix defin markov chain induct markov chain x veri special case linear state space model defin p meyn tweedi chose model exampl steadyst densiti easili comput particular stationari distribut x normal mean zero covari matrix thu x stationari densiti exp estim densiti dimens use kernel densiti estim lookahead densiti estim estim construct simul sampl path length sampl x stationari distribut remov initi bia estim mean squar error mse densiti estim repeat simul time kernel densiti estim chose use multivari standard normal distribut kernel bandwidth rational behind choic bandwidth tabl report root mse two estim percentag true densiti valu observ dimens increas rate converg kernel densiti estim deterior rapidli contrast rate converg lookahead densiti estim remain constant for increas runlength factor rel error decreas factor approxim independ dimens problem remark possibl construct lookahead densiti estim far complic linear state space model one consid here critic ingredi easili satisfi estim runlength tabl root mse estim percentag exampl innov vector w k known densiti respect lebesgu measur final exampl applic stochast activ network san exampl easili captur within markov chain framework therefor give idea potenti applic lookahead densiti estim methodolog exampl exampl estim densiti network complet time the length longest path sourc sink simpl stochast activ network taken avramidi wilson consid san figur independ task durat sourc node sink node label arc give mean task durat assum task densiti with respect lebesgu measur network complet time l densiti pdelta with respect lebesgu measur figur stochast activ network mean task durat shown besid task suppos sampl task durat except task comput length l longest path sourc node node respect f where given task ab f ab denot task durat distribut function f ab ab delta f ab delta lebesgu densiti then strong law larg number ensur lookahead densiti estim f strongli consist estim py purpos simul experi assum task durat exponenti distribut mean indic figur result densiti estim depict figur run length complet time densiti estim network complet time densiti figur estim network complet time densiti remark approach taken exampl clearli gener san arc enter sink node densiti with respect lebesgu measur remark one need base lookahead densiti estim arc incid sink exampl one might instead focu arc leav sourc exampl arc correspond task one would condit longest path node sink acknowledg r appli probabl queue converg probabl measur guid simul nonparametr densiti estim l view cours densiti estim filter mont carlo estim stationari densiti markov chain likelihood ratio gradient estim stochast recurs quantil estim depend sequenc regen steadyst simul discreteev system asymptot result steadyst quantil estim markov chain control variat probabl quantil estim simul stabl stochast system improv distribut quantil estim markov chain stochast stabil batch mean methodolog estim quantil steadyst distribut multivari standar time seri output analysi simul experi batch mean methodolog estim nonlinear function steadyst mean nonparametr function estim multivari densiti estim theori batch approach quantil estim regen simul approxim theorem mathemat statist nonparametr densiti estim nonparametr densiti regress estim markov sequenc without mix assumpt tr ctr shane g henderson simul mathemat random number gener mathemat simul proceed nd confer winter simul decemb arlington virginia