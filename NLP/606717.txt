t spars approxim invers smoother geometr algebra multigrid a spars approxim invers consid smoother geometr algebra multigrid method base spaialgorithm mj grote t huckl siam j sci comput construct spars approxim invers matrix a minim frobeniu norm lead new hierarchi inher parallel smoother spai spai spai geometr multigrid perform spai usual compar gaussseidel smooth difficult situat neither gaussseidel simpler spai spai smoother adequ reduct automat improv spai smoother need combin algebra coarsen strategi jw ruge k stben in sf mccormick ed multigrid method siam pp result method yield robust parallel algebra multigrid iter easili adjust even nonexpert numer exampl demonstr use spai smoother sequenti parallel environmentessenti advantag spaismooth are improv robust inher parallel order independ possibl local adapt b introduct multigrid method reli subtl interplay smooth coars grid correct care combin yield ecient multigrid solver larg linear system result discret partial dierenti equat standard smoother multigrid usual consist step basic iter method shall consid smoother base spars approxim invers henc start linear system let denot spars approxim correspond basic iter method sinc approxim invers known explicitli iter step requir one addit v matrixvector multipli therefor easi parallel cheap evalu spars recent variou algorithm propos attempt comput directli spars approxim invers compar studi variou approxim invers precondition refer benzi tuma approxim invers techniqu also gain import smoother multigrid method first introduc benson frederickson shown eectiv variou dicult ellipt problem unstructur grid tang wan advantag spars approxim invers smoother classic smoother damp jacobi gaussseidel ilu inher parallel possibl local adapt improv robust shall consid spars approxim invers spai smoother base spaialgorithm grote huckl spaialgorithm comput approxim invers explicitli minim frobeniu norm comput applic smoother inher parallel sinc eectiv sparsiti pattern gener unknown priori spaialgorithm attempt determin promis entri dynam strategi prove eectiv gener precondition mani dicult illcondit problem moreov provid mean adjust smoother local automat necessari nevertheless choos priori sparsiti pattern comput cost greatli reduc possibl choic includ power a suggest huckl chow henc shall investig follow hierarchi spars approxim invers smoother spai spai spai spai spai sparsiti pattern xed diagon spai wherea spai sparsiti pattern a spai sparsiti pattern determin automat spaialgorithm paramet control accuraci amount llin structur geometr grid dicult use complex geometri applic code design often turn larg unstructur grid yet lack natur grid hierarchi prevent use standard geometr multi grid context algebra multigrid amg often seen promis method solv largescal problem origin amg algo rithm rst introduc s ruge stuben use simpl gaussseidel iter smoother determin coars grid space sophist way improv robust method iter fail converg automat way improv smoother altern investig use smoother base spars approxim invers spai inher parallel perform also easili adjust even nonexpert thu aim gener inher parallel algebra multigrid method section brie review spaialgorithm show spars approxim invers use smoother within multigrid iter heurist green function interpret underpin eectiv smoo ther rigor result smooth properti approxim invers prove summar section next present section detail descript algebra coarsen strategi use togeth key compon algorithm ecient implement final section compar perform spai smooth gaussseidel smooth variou test problem either within geometr algebra multigrid set smooth classic smoother consid sequenc nest grid nest mesh wish solv n n linear system multigrid method detail multigrid see hackbusch section wessel multigrid iter result recurs applic twogrid method twogrid method consist presmooth step level coars grid correct level postsmooth step level lead iter error e m r prolong restrict oper respect denot smoother nest nite element space galerkin discret use galerkin product represent hold otherwis one still use dene coarsegrid problem given r p shall alway use x initi guess multigrid vcycl iter proce rel residu drop prescrib toler kb x m kbk tol calcul averag rate converg m expect multigrid converg behavior achiev number multigrid iter m necessari achiev xed toler essenti independ number grid level typic smoother form w approxim cheap invert cours w never comput explicitli let diagon l lower triangular part u upper triangular part a then damp jacobi smooth correspond wherea gaussseidel smooth correspond paramet chosen maxim reduct high frequenc compon error optim valu problem depend usual unknown priori although gaussseidel typic lead faster converg dicult implement parallel smooth step requir solut lower triangular system neither jacobi gaussseidel smooth lead satisfactori converg one either resort sophist matrix depend prolong restrict oper robust smoother base incomplet lu ilu factor unfortun ilusmooth inher sequenti therefor dicult implement parallel also dicult improv local say near boundari singular without aect llin everywher lu factor spaismooth altern invert w propos comput explicitli spars approxim invers a use smooth drop grid index simplifi notat yield spaismooth comput minim ki mak frobeniu norm given sparsiti pattern contrast w matrix comput explicitli therefor applic spai requir matrixvector multipl easi parallel requir solut upper lower triangular system moreov frobeniu norm natur lead inher parallel row comput independ one anoth inde sinc solut separ n independ leastsquar problem e k denot kth unit vector spars leastsquar problem small sinc eectiv sparsiti pattern unknown priori origin spai algorithm begin diagon pattern augment progress sparsiti pattern reduc residu r addit reduct norm r k involv two step first algorithm identi set potenti new candid base sparsiti current spars residu r k second algorithm select protabl entri usual less entri comput candid cheap upper bound reduct kr k k new entri select ad k small leastsquar problem solv augment set indic algorithm proce row satis toler set user control llin qualiti precondition larger valu lead sparser less expens approxim invers also less eectiv smoother higher number multigrid cycl lower valu usual reduc number cycl cost comput may becom prohibit moreov denser result higher cost per smooth step optim valu minim total time depend problem discret desir accuraci comput architectur detail origin spaialgorithm found addit spai shall also consid follow two greatli sim pli spaismooth xed sparsiti pattern spai di agon spai sparsiti pattern a solv leastsquar problem thu minim ki mak frobeniu norm sparsiti pattern chosen priori elimin search eectiv sparsiti pattern thu greatli reduc cost comput approxim invers spai smoother coincid smoother tang wan diagon calcul directli simpli given kk k kth row note alway wellden nonsingular contrast damp jacobi spai parameterfre summar shall consid follow hierarchi spaismooth minim ki mak frobeniu norm certain sparsiti pattern diagon given spai sparsiti pattern a spai sparsiti pattern determin automat via spai algorithm row satis given approxim invers lead smooth step found mani situat spai spai yield ampl smooth howev ad exibl provid automat criterion improv smoother via spaialgorithm remain use inde spai spai use initi guess spai thu local improv upon need reduc matric inher small block structur typic discret system partial dierenti equat blockspaialgorithm greatli reduc cost comput green function interpret approxim invers yield eectiv smoother problem come partial dierenti equat mesh paramet h tend zero solut linear system h u tend solut underli dierenti equat appropri boundari condit matrix h correspond discret version dierenti oper l let h k denot kth row solv linear system e h k kth unit vector h h k tend green function l denot adjoint dierenti oper x x k delta center x k exhibit correspond h k recal l formal dene ident u v appropri function space equat continu counterpart relat conclud similarli combin lead discret counterpart comparison show h k correspond gx x k kth row m h approxim invers h solv equiva lentli min henc h k approxim kth column h k discret norm xed sparsiti pattern h k nonzero entri usual lie neighborhood x k correspond mesh point x j close x k therefor appropri scale invers power h see h approxim gx x k local continu l partial dierenti oper gx x k typic singular x k decay smoothli necessarili rapidli increas distanc jx x k j clearli slower decay denser h must approxim well decienc spars approxim invers precondition also point tang time howev suggest spars approxim invers obtain minim ki mak frobeniu norm natur yield smoother multigrid inde eectiv precondition must approxim uniformli entir spectrum l contrast eectiv smoother need captur highfrequ behavior yet highfrequ behavior correspond singular local behavior gx x k precis approxim h k illustr fact consid standard vepoint stencil discret laplacian grid figur follow page compar gaussseidel approxim invers l two explicit approxim invers spai spai recal gaussseidel poor precondition problem remain excel smoother captur highfrequ behavior similarli spai spai yield local oper with shall see good smooth properti despit resembl gaussseidel spai approxim invers note onesided former contrast symmetri latter gaussseidel spai fig row follow oper top left gaussseidel invers comput spai bottom left comput spai bottom right theoret properti contrast heurist interpret previou section shall summar rigor result smooth properti simplest smoother spai multigrid converg theori rest two fundament condit smooth properti denit function lim approxim properti section gener smooth approxim properti togeth impli converg twogrid method multigrid wcycl contract number independ level number moreov symmetr posit denit prob lem condit also impli multigrid vcycl converg independ see hackbusch sect detail approxim properti independ smoother depend discret prolong oper p restrict oper r approxim properti shown hold larg class discret ellipt boundari valu problem symmetr posit denit problem smooth properti usual hold classic smoother damp jacobi symmetr gaussseidel incomplet choleski smooth properti shown hold spai smoother reason assumpt matrix a precis symmetr posit denit spai smoother satis smooth properti either weakli diagon domin seven nonzero odiagon entri per row furthermor two diagon smoother spai damp jacobi optim relax paramet lead ident smoother discret laplacian period boundari condit space dimens special situat parameterfre spai smoother automat yield scale diaga minim smooth factor sens optim gener situat howev smoother dier boundari condit even constant coecient equispac mesh comparison two diagon smoother via numer experi show spai attract altern damp jacobi inde spai parameterfre typic lead slightli better converg rate damp jacobi algebra multigrid multigrid mg method sensit subtl interplay smooth coarsegrid correct standard geometr multigrid method appli dicult problem say strong anisotropi interplay disturb error longer smooth equal well direc tion although manual intervent select coars grid sometim overcom diculti remain cumbersom appli practic unstructur grid complex geometri contrast algebra multigrid approach compens decient smooth sophist choic coarser grid interpol oper base matrix mani amg variant exist dier coarsen strategi interpol use introduct variou amg method found follow ruge stuben describ algebra coarsen strategi interpol oper shall combin spai smoother section use numer experi coarsen strategi x anisotrop stencilh fig error gaussseidel smooth step problem describ section smooth error compon align anisotropi read stencil fundament principl underli coarsen strategi base observ interpol perform along smooth error compon symmetr mmatric error smooth well along larg neg odiagon entri matrix therefor grid point p may identifi among neighbor point q good candid interpol compar magnitud correspond entri pq lead follow relat point p neighbor q connect graph matrix a condit notat interpret pq max apr ja pr j p q p strongli depend q pq q strongli uenc p pq weakli depend q pq q weakli uenc p paramet control threshold discrimin strong weak connect typic denit posit odiagon entri necessarili weak relat p q p q symmetr symmetr next dene set depend point p set uenc point p set weak depend point p everi level coarsen strategi must divid p set point level two disjoint set c coars point also present coarser level f ne point absent coarser level choic c f induc cfsplit coars grid correct heavili depend accur interpol accur interpol guarante everi f point surround sucient mani strongli depend c point typic congur shown figur q strong depend depend c point f point strong depend indic solid arrow weak depend repres dash arrow c point repres solid circl wherea f point repres dash circl henc strong depend point c point therefor q q good candid interpol p fig ideal coarsen congur interpol coarsen algorithm attempt determin cfsplit maxim f toc depend f point coarsen goal minim set c coarsen goal import strike good balanc two con ict goal overal comput eort depend converg rate also amount work per multigrid cycl clearli optim cf split minim total execut time howev sinc converg rate gener unpredict coarsen algorithm mere attempt meet coarsen goal heurist fashion so complex must exceed on log n retain overal complex multigrid iter coars grid select greedi heurist split p c f everi step greedi heurist move promis candid p c forc neighbor point f procedur repeat point distribut everi step requir olog n oper complex comput exceed on log n desir overal complex on log n reach greedi heurist describ base follow two principl correspond coarsen goal promis candid p becom c point highest number uenc ji p j uenc p ad f choic support coarsen goal f point eventu least one strong c depend keep number c point low coarsen goal algorithm prefer c point near recent chosen f point henc u enc given higher prioriti start point undecid point algorithm proce select u promis c point highest prioriti prioriti point p dene equat ect prefer choos next c point point uenc mani previous select f point key advantag possibl updat prioriti local o time result desir overal complex on log n summar coars grid select algorithm algorithm coars grid select procedur set priorityp ji p j end u u select p u maxim p riorityp q p all depend p end q p all uenc p r q all depend q end end procedur implement step ecient o time maintain list q point sort prioriti togeth list point indic q moreov list boundari b prioriti occur q enabl immedi updat sort list q figur show possibl segment list q b i index q posit q priorityp posit q index b fig three list q i b enabl ecient implement coarsen algorithm setup phase coarsen algorithm b comput sort prioriti step simpli choos last element q step implement exchang point whose prioriti must either increment decrement left rightmost neighbor q prioriti prioriti adjust q remain sort b updat accordingli follow suggest k stuben shall skip second pass origin coarsen algorithm enforc even stronger f toc depend high comput cost involv interpol grid function u h dene ner grid interpol grid function uh dene coarser grid c follow henc valu c point simpli transfer coarser level wherea valu f point interpol c neighbor four dierent depend possibl f point neighbor shown figur standard interpol see choic weight w pq interpol p base equat pp e pq e inde ae smooth eect minim error e declar algebra smooth see detail clearli cannot interpol p surround f point wherea weakli depend c point includ either rough natur error direct thu connect q q figur alway ignor interpol correspond interpol weight set zero w pq cancel weak depend neglect entri weakli depend neighbor ad diagon henc equat becom pp e pq e strong c depend q figur caus diculti valu uh avail coars grid locat divis pp yield weight pq pp howev strong f depend q figur avail interpol must rst interpol c point strongli depend so replac qq qq everi q q f everi point r q yield weight pq pp qr qq point q direct indirect neighbor p appli two weight calcul separ ad other q strong depend depend c point f point q indirect interpol direct interpol ignor ignor fig four dierent depend possibl p neighbor algorithm describ determin coars grid level basi a approxim invers fact inform contain use determin coars grid level interpol weight suggest meurant measur comput cost memori requir compar perform variou smoother cannot limit compar number multigrid iter also need estim addit amount work due smoother so calcul total densiti ratio nonzero entri grid level smooth appli addit amount work due smoother proport rapidli reduc number point one level next matric must also remain reason spars measur instanc galerkin coars grid approxim enlarg standard ve point stencil nest grid ninepoint stencil subsequ level result valu geometr multigrid semicoarsen togeth onedimension interpol use increas two result present follow section comput matlab implement shall evalu ecienc variou approach compar respect valu numer result illustr use versatil spai smooth shall consid variou standard test problem case dierenti equat consid discret nest level standard nite dierenc equispac mesh geometr multigrid use regularli rene sequenc equispac grid singl unknown remain center domain algebra multigrid coarser level obtain coars grid select algorithm describ section denit strong depend section algorithm proce number grid point drop twenti coars grid oper obtain via galerkin product formula geometr multigrid p correspond standard linear interpol wherea amg p obtain describ section use multigrid vcycl iter two pre two postsmooth step multigrid iter proce rel residu satis prescrib toler rotat ow problem rst consid convectiondius problem ux boundari u repres scalar quantiti advect rotat ow eld convect domin h linear system ceas symmetr posit denit problem lie outsid classic multigrid theori use center secondord nite dierenc diusion discret convect rstorder upwind ensur numer stabil tabl geometr mg converg rate rotat ow problem grid dierent valu symbol indic multigrid iter diverg smoother gaussseidel spai spai spai spai tabl converg rate q obtain standard mg smoother yield accept converg rate diusion domin case howev multigrid iter diverg gaussseidel spai smooth contrast spai smoother still yield converg method use spai smooth acceler converg even further increas onli reduc diusion even spai smoother yield converg iter although result valu quit high construct spai remain parallel fulli auto matic remark symmetr gaussseidel smooth lead converg multigrid iter yet approach gener easili unstructur grid parallel result sinc spai smoother inher parallel straightforward appli within parallel version geometr mg data distribut among processor via domain decomposit wellknown work ecient number multigrid applic platform shall use ethbeowulf cluster consist dual cpu pentium iii processor node connect via mbit gb switch network commun done mpi appli parallel multigrid implement rotat flow problem node total executiontim second grid time includ setup construct spai smoother requir solut sixteen million small independ leastsquar problem shown tabl use coarsest level consist singl mesh point lead diverg multigrid iter increas resolut coarsest level mesh point one obtain converg multigrid iter tabl scalabl parallel mg use spai problem size number processor increas factor total time increas onli gridsiz number processor total time sec obtain good speedup parallel mg code import perform coars grid agglomer see loss ecienc coarser grid level although implement agglomer strategi comput scale reason well long problem size match size parallel architectur see tabl rotat ow problem algebra coarsen clearli align ow direct larger dot correspond c point coarser level b local anisotrop diusion semicoarsen appar center domain fig exampl algebra coarsen two model problem consid amg result none approach howev entir satisfactori vanish vi cositi overcom lack robust small appli algebra coarsen strategi describ section figur a display coars level select algorithm tabl spai spai yield converg without particular tune spai tabl amg converg result rotat ow problem vari grid smoother q q q gaussseidel tabl amg converg rate rotat ow problem smoother gaussseidel spai spai spai gridsiz q q q q smoother yield compromis spai spai smoother storag requir converg rate lie obtain xed sparsiti pattern spai spai lower valu reduc converg rate even further poor converg rate obtain gaussseidel could probabl improv either smooth c point f point use symmetr gaussseidel result tabl demonstr robust spai smooth in deed converg rate obtain combin spaiamg approach remain bound local anisotrop diusion section consid local anisotrop problem ux boundari diusion coecient x except insid squar x y constant tabl observ geometr multigrid diculti small valu unidirect smooth error align strong anisotropi standard isotrop interpol fail tabl local anisotrop diusion geometr mg converg rate q vari grid smoother q q q gaussseidel amg result amg overcom diculti perform automat semicoarsen oper depend interpol direct strong coupl correspond smooth error compon wellknown eg amg solv problem littl diculti result tabl verifi fact accept densiti densiti could lower even drop smallest entri interpol oper consid truncat grid transfer oper here tabl amg converg result local anisotrop diusion grid note q remain bound smoother q q q gaussseidel converg rate obtain gaussseidel spai compar spai result slightli slower converg overal spai smoother ecient smoother problem although reduct result even faster converg approxim invers becom dens thu expens again result tabl demonstr robust multigrid behavior either h tabl amg converg rate q local anisotrop diusion note q remain bound gridsiz gaussseidel conclud remark result show spars approxim invers base minim frobeniu norm provid attract altern classic jacobi gaussseidel smooth simpler smoother spai spai often provid ampl smooth compar damp jacobi gaussseidel nev ertheless situat convect domin rotat ow spai lead converg multigrid iter unlik gaussseidel demonstr improv robust implement geometr multigrid combin spai smooth enabl fast solut larg convect diusion problem massiv parallel architectur incorpor spai smoother amg obtain exibl parallel algebra multigrid method easili adjust underli problem comput architectur even nonexpert interest incorpor inform avail approxim invers coarsen strategi grid transfer oper suggest expect benet would includ improv robust local adapt multigrid compon well author current pursu issu report elsewher near futur acknowledg thank klau stuben use comment suggest r mpi implement spai precondition te block version spai precondition iter solut larg spars linear system aris certain multidimension approxim problem frequenc domain behavior set parallel multigrid smooth oper spars approxim invers precondition conjug gradient method compar studi spars approxim invers precondition approxim invers precondition via sparsespars iter priori sparsiti pattern parallel spars approxim invers precondition robust scalabl algebra multigrid parallel precondit spars approxim invers iter solut larg spars system equat approxim sparsiti pattern invers matrix precondit factor spars approxim invers precondit i numer experi algebra multilevel precondition multilevel ainv precondition parallel adapt multigrid toward e spars approxim invers smoother multi grid introduct algebra multigrid introduct multigrid method robust ilusmooth matrix prolong restrict blackbox multigrid solver tr robust ilu smooth matrixdepend prolong restrict blackbox multigrid solver multigrid method parallel computersmyampersandmdasha survey recent develop factor spars approxim invers precondit spars approxim invers precondition conjug gradient method parallel precondit spars approxim invers approxim invers precondition via sparsespars iter approxim sparsiti pattern invers matrix precondit compar studi spars approxim invers precondition toward effect spars approxim invers precondition priori sparsiti pattern parallel spars approxim invers precondition robust scalabl algebra multigrid spars approxim invers smoother multigrid robust parallel smooth multigrid via spars approxim invers coarsegrid select parallel algebra multigrid ctr michel benzi precondit techniqu larg linear system survey journal comput physic v n p novemb