t grain filter a motiv oper simplifi topograph map function studi theoret properti two kind grain filter first categori discov l vincent defin grain connect compon level set remov small area categori compos two filter maxima filter minima filter howev commut second kind filter introduc masnou work shape base connect compon level set filter addit properti act manner upper lower level set is commut invers contrast discuss relat masnou filter class connect oper introduc literatur display experi show main properti filter discuss compar them b introduct filter use simplifi imag satisfi minim set invari properti scarc actual one maxim set invari properti driven parabol partial dierenti equat t curvux curvatur level line u point x restrict regular point u howev previou lter optim in term invari among regular lter is lter driven pde properti regular desir theori drawback modifi contour and particular destroy junction import clue occlus drop requir bunch lter satisfi invari properti avail motiv studi famili lter reconstruct serra salembi introduc notion httppascalmonassefreefr c kluwer academ publish print netherland v casel p monass connect oper oper simplifi topograph map imag lter becom popular imag process becaus experiment basi claim simplifi imag preserv contour properti made attract larg number applic nois cancel segment recent becom basi morpholog approach imag video compress dierent class connect oper studi meyer serra heijman see also refer therein articl studi theoret properti two kind connect oper extrema lter shape lter simpli topograph map imag dierent sens given term topograph map maxima lter remov connect compon upper level set insuci area keep one ident ensur region maxima ltere imag minim grain size similarli minima lter remov small connect compon lower level set lter grain correspond connect compon level set small grain consid nois seen prune tree connect compon upper lower level set previou work introduc notion shape design deal symmetr upper lower level set shape also organ tree driven inclus appli imag posit minim grain size show structur tree nite shown here imag result applic extrema lter properti new tree also provid denit anoth grain lter grain shape remov small shape preserv one sucient area essenti improv extrema lter deal manner upper lower level set vocabulari mathemat morpholog lter selfdual appli continu function present articl organ follow section recal foundat mathemat morpholog underlin link morpholog lter set oper section introduc main properti extrema lter prove them section prove analog properti grain lter and particular selfdual lter continu function gener result final section illustr lter experi gener result mathemat morpholog throughout section shall consid real function dene subset ir n u real function dene ir n denot u set fx ux g ir similarli dene set u u u level set u real function x impli particular convers x famili set satisfi x level set level function u dene name x weaker hypothesi monoton x ir guichard morel show x ae almost everi ir contrast invari contrast chang restrict sens strictli increas continu ir therefor homeomorph ir onto open interv ir direct consequ imag u contrast chang g appli u gu contrast chang g indier consid function dene ir oper act function u direct consequ also written v casel p monass show famili level set g u u same level chang morpholog lter map act function u commut contrast chang g g link set oper morpholog filter oper act set necessari requir transform level set function level set function thu lter associ dene equival denot b observ inde let right hand side term equal x u denit b x deduc u hand sinc uy get immedi tux convers uy n is b n u n and therefor take intersect n get x say contrast chang g nondecreas upper semicontinu gener contrast chang use convent dene close set satis set f n close dene upper semicontinu function easi check g commut appli upper semicontinu function get contrast invari strong sens sinc g constant stretch need continu spatial invari properti ir n f map morpholog lter whose associ set oper whose structur element given famili b x x denot f morpholog oper dene f dene imag g fb x easi see f say invari respect f instanc b translat invari lter shall discuss satisfi properti respect famili structur element global invari respect area preserv map ie special ane map lter thu special ane invari depend paramet x set structur element lter x also satisfi b s x particular impli that ane map f f extrema lter definit extrema lter construct manner connect compon level set imag minimum area call extrema lter connect compon level set contain region extremum achiev two step rst connect compon upper level set ltere lower level set dene set oper ensur properti let us rst x notat let set homeomorph close unit ball ir n n v casel p monass interior note that particular compact connect local connect moreov unicoher ie a b close connect set ab connect set x denot ccx connect compon ccx x one contain point x provid x x extens c connect ccx c ccx x x c paramet repres area threshold let x subset dene lter g dene maxima lter minima lter sup show morpholog lter whose associ set oper respect denit voluntarili symmetr act upper semicontinu func tion avoid case suppos j preliminari result lemma c n nin nonincreas sequenc compact set o n nin nondecreas sequenc open set proof clear ccc x ccc n x n convers intersect continua thu continuum sinc contain x includ c get inclus n cco hand open local connect cco x open set henc cco x continuum k cco x contain x y sinc k n compact set extract nite cover k sequenc o n non decreas n k n sinc k connect contain x k cco n x conclud proposit follow properti nondecreas subset upper semicontinu compact set nonincreas sequenc compact set lower semicontinu open set o n n nondecreas sequenc open set n proof properti i direct consequ denit monoton f appli lemma observ ccf x particular n sinc monoton o now let o ju j let u lemma prove henc n larg enough ju n j conclud x u n n b two famili set say basi b b b b b b basi fx basi xg proof direct consequ denit corollari appli upper semicontinu function morpholog lter whose associ set oper v casel p monass precis proof let xg consequ proposit uy use fact b basi c shown lemma deduc u x sup uy inf take supremum b get sup u similar proof appli link proposit let u v ir ii u v v proof immedi includ detail corollari let u ir u n u uniformli uniformli proof given let n u u n use proposit ii iii iv obtain n n henc uniformli similarli prove uniformli properti proposit u upper semicontinu function also u u continu also u proof let u upper semicontinu function then u close set connect compon close sinc u nite union them close thu u upper semicontinu manner m u open set connect compon also open imag thu union open set open prove u upper semicontinu final suppos u continu prove close ir use corollari write claim c sinc open contain close set c deduc n c open empti and thu posit measur henc joj jcj prove joj then thank lemma v casel p monass n prove remain inclus right hand side equal open conclud m close prove result write claim last set coincid g n open c close jcj jo n j henc n n appli lemma get yield henc jccu prove and thu equal term right hand side term nite union close set also close proposit restrict upper semicontinu function s idempot proof let u upper semicontinu function ir clearli appli equal set u use corollari get now thank proposit m close appli corollari left hand side equal obtain sinc equal hold ir conclud proof appli proposit let u proof i case similar sucient prove rst part assert let ux observ v lower semicontinu assum max contain open set henc let choos mwhich contradict conclud proposit prove ii case similar shall prove uniformli that let us write given let small enough v casel p monass ie collect fact interpret let u upper semicontinu function jcj thu c connect compon c connect compon m u even meet set sinc m convers u connect compon u sinc c sum remark see connect compon m exactli connect compon u measur particular sinc connect compon upper level set structur tree driven inclus tree tree u prune node insuci measur observ made concern connect compon u tree tree connect compon lower level set u prune node insuci measur summar discuss follow result proposit u jxj jccu j resp u j particular result impli connect compon m thing said connect compon upper lower level set u composit lemma let u upper semicontinu function ir proof let u consequ fals would c u sinc contradict denit c c c open c c c m x belong connect compon u connect includ u jdcj get dc m contradict denit c prove claim x c ux argu abov contradict hypothesi thu may assum c let sinc c close open c d thu x mean jccu xj compon must and therefor jdj final observ m u contradict theorem oper i transform upper semicontinu function upper semicontinu function continu function continu function ii idempot upper semicontinu function proof i direct consequ equival properti prove proposit consequ proposit function u appli u get v casel p monass appli rst part lemma nd point x c v let know jdj sinc m connect prove thu equal member use idempot conclud similar proof use second part lemma prove idempot grain lter definit problem extrema lter present abov two oper act upper lower level set gener commut moreov none properti deal symmetr upper lower level set actual work two step rst upper lower level set treat or opposit order is oper selfdual definit morpholog lter associ set oper said selfdual continu function follow equival properti hold continu function u x sup bb inf yb describ structur element u show equival rst two properti suce write second one u instead u take instead see third properti equival now use contrast invari amount write mean exactli tu recal denit essenti properti satur oper definit let p xed point x call hole x connect compon x extern hole x x hole intern hole x satur x satx union x intern hole follow result prove proposit x connect satx connect connect x open resp close satx open resp close close satx connect subset x h intern resp extern hole x nest disjoint let x open close x x sato satc u upper semicontinu function call shape u element tree structur u express properti nest disjoint v casel p monass restrict denit set oper close set sinc later dene lter upper semicontinu imag k compact set dene f intern hole c jc j clearli g compact k thu alway suppos j remark dene grain lter compact set sinc sucient extens lter upper semicontinu function obvious denit sens subset preliminari result lemma g nondecreas compact set proof let k l compact set let famili intern hole c observ c hand h intern hole c includ hole h c and thu jhj observ deduc famili intern hole c resp c whose measur conclud g k g l lemma k compact proof let us denot c ii famili connect compon k let set indic jsatc j monoton inclus immedi denit ident also observ g c union c intern hole and thu connect let j subset whose cardin least let prove connect connect open close subset e dierent observ e union c j sinc set connect precis let us write prove e open close d henc connect clearli e d sinc e open open set u u union connect compon u meet c l l l set u union open set open set u union u intern hole c l open also open j j nl eg inde last equal hold would connect compon u meet c l l l by denit u c j inde meet hole h c j jhj h cannot contain c l otherwis sinc h n satc l open empti thu posit measur would jhj l j thu connect meet two dierent connect compon compon contain c l henc c j impli u c j contradict ident conclud hold ie u g therefor u d n e prove u shown set e open d appli argument prove e also close d lemma let c n nin nonincreas sequenc continua n c n h hole c exist n nondecreas sequenc hole c n proof x h n x c n n n thu n n x hole h n c n obvious h n h therefor h n h u neighborhood v connect neighborhood v u sinc h n and monoton h n may write nnn h n also v casel p monass connected v impli follow v c impli u c true neighborhood u y get impli h h n close h sinc also open union open set connected h impli theorem oper g upper semicontinu ie k n nonincreas sequenc compact set proof inclus left hand side term right hand side one due monoton g show inclus lemma n n c n insid impli due lemma show sequenc continua c n nonincreas intersect c continuum thank zoretti theorem sinc c contain compon remain show x g c take h prove h thu jsatcj moreov x belong intern hole h c sinc x g c n associ sequenc h n obtain lemma jh n j thu henc x properti lemma close set c connect compon h intern hole a then x h g proof right hand side term equal h obvious contain h suppos inclus strict set h connect h open as union open set h close h h h let h h let u connect neighborhood y claim ua otherwis would u a u meet n u g connect contradict g a conclud a g sinc g open set contain neighborhood h particular meet g n a x g h thu g g nest and g h g g thu x g g h impli g h contradict assumpt sinc g conclud h lemma let a b close set proof suppos b disjoint take compon b instead b may assum b connect result obviou g a g b empti may also assum none empti sata satb either nest disjoint disjoint sinc g sata g b satb a obviou nest without loss gener may assum sata satb sata insid hole h b get jhj jsataj sinc sata close h open open nonempti set thu posit measur yield jhj therefor sata a now suppos let x g a particular impli satc c cca set c n satc connect also n satc compact set lindelof theorem intersect famili continua written intersect sequenc them thu nd sequenc c n connect compon v casel p monass let clearli d n nonincreas sequenc continua may write thu continuum d observ b inde connect compon c a sinc yn satc obvious satc c now prove connect neighborhood u meet point a otherwis cu would connect which turn impli u c sinc n b conclud b contradict choic y prove b also observ and thu jsatdj one follow case happen iii x satc jsatcj suppos i hold x d sinc jsatdj suppos ii hold let set dene abov x x g g b x d x hole h d thank lemma write g thank lindelof theorem union open set written union sequenc g n set n sinc g obtain jg n j jsatcj conclud sup nin jg n j thu x h g g b final suppos iii hold let c claim connect compon a nite number set e intersect abov result due fact nest innit number set e write intersect intersect sequenc e n them thank lindelof theorem take n instead e n may also assum sequenc nonincreas set therefor continuum jt connect neighborhood y sinc u n u n e n sinc u connect meet complement u also meet e n a a obtain a show t a hand observ complement connect union increas sequenc connect set thu t written intersect two continua thu connect sinc unicoher thu t impli jej e and therefor satt e follow satt t have thu equal now observ x must hole h must jhj sinc otherwis x a use lemma write g and abov may write union union nondecreas sequenc set g n thu n write g n x hole h contain connect compon k case also x n sinc g n contain connect compon k b get x theorem restrict continu function g selfdual proof shall prove condit denit hold accord a may write ir and sinc g u n take intersect n get therefor v casel p monass let x n x due b x prove and thu take complement part get prove and actual equal set theorem semicontinu function upper semicontinu function continu function continu function proof show imag compact set k compact set let sequenc point g k converg x shall prove x g k shown lemma x n belong g k n k cck famili fk n n ing nite extract subsequ belong g k n close set sinc complement union hole k n hole open set thu x may assum fk n n ing innit and mayb extract subsequ km k n satg k n nite number satur two two disjoint sinc measur least thu extract subsequ necessari may assum intersect form either decreas increas sequenc sequenc satk n nin decreas intersect set satk cck shown lemma jsatk otherwis would k sucient larg n contain hole k n n thu x n satk n sinc x satk conclud desir result let us assum satk n nin increas sinc lim inf sequenc k n nonempti it contain x lim sup continuum c accord zoretti theorem sinc k compact follow c observ x k shall prove jsatk j precis satk n measur intern hole k result impli k n k k sinc connect compon k sinc assum set k n two two disjoint cannot happen twice thu may assum k n k n sequenc satk n increas k n hole k suppos hole extern hole h k sinc h open continuum l join p arbitrari point k sinc k intern hole k manner construct sequenc y n nn n lk n n l compact subsequ y n converg point lc follow k l contrari assumpt l hole k prove claim appli preced result u continu u upper semi continu sinc u also upper semicontinu u also upper semicontinu henc u lower semicontinu thu u continu proposit therefor g idempot proof conclus g idempot deriv previou statement take result amount show g u distinguish three famili among connect compon v casel p monass observ thank lemma may write intern hole c intern hole c measur reason conclus yield follow properti easi consequ denit lemma oper satis follow properti i u v function u ir lemma let u upper semicontinu function let proof let us x sinc sucient prove g v almost ir let denot famili connect compon k hk famili intern hole k observ cckjsatcj intern hole c jhj g sinc proposit connect compon k measur c ck satis jsatcj similarli sinc intern hole k contain connect compon v also measur henc famili set h hk jhj empti conclud g proposit let u proof use lemma proposit given impli u and therefor u now choos obtain u proposit follow relat connect oper want compar grain lter describ notion grain oper dene x idea shall work classic connect thu denot c famili connect set grain criterion map c c f g given two grain criteria f foreground b background associ grain oper fb dene heijman character grain oper selfdual increas inde prove fb selfdual b also prove fb increas f b increas follow condit hold x x shall say grain criterion c c f g upper semicontinu compact set c n k n decreas sequenc continua k n n v casel p monass proposit let selfdual increas grain oper ator associ grain criterion c assum c upper semicontinu proof either point x rst case deduc nonempti subset x and therefor x sinc also x second case use upper semicontinu c cbx choos observ cccx fxg contradict proposit say nontrivi translat invari increas selfdual grain oper type connect oper call atten level introduc f meyer studi particular serra prove exist increas selfdual atten level base marker final let us prove grain lter introduc correspond univers criterion dene increas selfdual lter let us recal denit connect oper that given set x denot p x partit constitut ccx ccx c famili subset x denot pdefinit oper p p connect partit p x coarser p x everi set x given connect oper p p shall say i increas x y x ii act addit connect compon x famili connect compon x iii selfdual ir n n open close set x iv bound p dicult see connect oper increas selfdual induc increas selfdual lter continu function proposit let p p connect oper suppos increas selfdual bound act addit connect compon let ker fx open close connect set then satx ker hx denot famili intern hole x proof sinc selfdual without loss gener may assum p x sinc connect oper z simpli connect z must one set f g sinc bound must either particular either satx rst case satx ker second case use addit connect compon observ begin proof now use selfdual x obvious increas ker ideal set ie x x ker ker interpret similar remark extrema lter made concern shape shape u shape u sucient measur correspond prune tree shape u experi theoret lter g dierent illustr figur second row show ltere imag u dierent stress respect notion grain dierent dierenc appear presenc hole concern natur im age dierenc would appar certain imag v casel p monass figur topleft origin imag u three constant region suppos area bottom left gu middl column u u u figur textur imag carpet size textur nested shape would import figur show complex textur figur imag ltere accord three lter paramet pixel wherea actual dierent visual equival distinguish requir eort explain fact connect compon level set hole greater area scarc word situat illustr figur frequent figur three grain lter appli imag u figur left column gu acknowledg acknowledg partial support tmr european project vi cositi solut applic refer fmrxct cnr pic project rst author acknowledg partial support pnpgc project refer bfmc v casel p monass r imag iter smooth pde random set integr geometri mathemat morpholog applic signal imag process mathemat morpholog applic signal imag process imag analysi mathemat morpholog tr introduct mathemat morpholog watersh digit space affin invari scalespac morpholog multiscal segment imag code selfdual morpholog oper filter connect oper level level fundamenta morphologica mathematica compact multiscal imag model base level set ctr renato keshet shapetre semilattic journal mathemat imag vision v n p may renato keshet adjac lattic shapetre semilattic imag vision comput v n p april