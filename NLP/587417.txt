t fast finit volum simul electromagnet problem highli discontinu coeffici a consid solv threedimension electromagnet problem paramet regim quasistat approxim appli permeabl permitt conduct may vari significantli difficulti encount includ handl solut discontinu across interfac acceler converg tradit iter method solut linear system algebra equat aris discret maxwel equat frequenc domainth present articl extend method propos earlier constant permeabl e haber u ascher d aruliah d oldenburg j comput phi pp d aruliah u ascher e haber d oldenburg math model method appl sci appear handl also problem permeabl variabl may contain signific jump discontinu order address problem slow converg reformul maxwel equat term potenti appli helmholtz decomposit either electr field magnet field null space curl oper annihil ad stabil term use gaug condit thu obtain strongli ellipt differenti oper stagger grid finit volum discret subsequ appli reformul pde system scheme work well sourc variou type even presenc strong materi discontinu conduct permeabl result discret system amen fast converg iluprecondit krylov methodsw test method use sever numer exampl demonstr robust effici also compar classic yee method use similar iter techniqu result algebra system show method significantli faster especi electr sourc b introduct need calcul fast accur solut threedimension electromagnet equat aris mani import applic area includ among other geophys survey medic imag cons quentli lot effort recent invest find appropri numer algorithm howev wide agre electromagnet phenomena gener govern maxwel equat choic numer techniqu solv equat depend paramet rang variou restrict assumpt signific degre applicationdepend present articl motiv remot sens invers problem eg geophys one seek recov materi properti especi conduct isotrop heterogen bodi base measur electr magnet field near earth surfac forward model concentr here consist maxwel equat frequenc domain frequenc rang exclud high frequenc assum timedepend e gammat equat written r r theta h gamma b r r magnet permeabl oe conduct ffl electr permitt j known sourc current densiti ae unknown volum densiti free charg work assum physic properti vari posit ffl l l typic length scale electr field e magnet field h unknown charg densiti defin c note long redund view invari system obtain take rdelta a system defin threedimension spatial domainomegagamma principl domainomega unbound ie practic bound subdomain ir use numer approxim paper use boundari condit h theta n although boundari condit possibl number difficulti aris attempt find numer solut threedimension pde system difficulti includ handl region almost vanish conduct handl differ resolut differ part spatial domain handl multipl scale length physic properti vari handl region highli vari conduct magnet permeabl electr permitt jump solut properti across interfac may occur hand natur data eg measur electr andor magnet field surfac earth one cannot hope recov fine detail structur conduct oe permeabl therefor envis accord invers problem interest possibl nonuniform tensor product grid cover domainomegagamma b oe assum smooth even constant insid grid cell may signific jump discontinu occur anywher inomega across cell interfac sourc j also assum jump across interfac rel geometr simplic result model assumpt key obtain highli effici solver forward problem denot quantiti differ side interfac subscript easili shown across interfac n theta condit impli neither e h continu normal direct b oe resp jump discontinu across cell face likewis b oee h necessarili continu tangenti di rection care must therefor exercis numer method employ util variabl defin doublevalu far popular discret maxwel equat yee method see discuss extens method employ stagger grid necessit short center first differ discret a b usual applic method electr field compon envis cell edg magnet field compon cell face see fig possibl h z x z figur stagger discret e h three dimens e compon edg hcompon face elimin compon magnet field discret equat obtain stagger discret second order pde e r theta gamma r theta e gamma relat method includ finit integr techniqu certain mix finit element method although method often present context timedomain maxwel equat issu aris appli implicit timediscret a suitabl techniqu model assumpt often similar one face here popular yee method due part conserv properti way discret system mimic continu system howev iter method solv discret system may converg slowli low frequenc due presenc rich nontrivi null space curl oper addit difficulti aris highli discontinu coeffici present two major reason difficulti first conduct essenti vanish for exampl air form part omegagamma analyt perspect specif subset maxwel equat use typic form almostsingular system region almostvanish b oe even region conduct close vanish result differenti oper strongli coupl strongli ellipt second case larg jump discontinu care must taken handl h b care sinc locat fig potenti discontinu address often slow converg iter method use equat result discret appli helmholtz decomposit first obtain potenti formul coulomb gaug condit chang variabl use also among mani other split electr field compon activ null space curl oper reformul reminisc pressurepoisson equat incompress navierstok equat yield system strongli ellipt weakli coupl pde standard precondit krylov space method directli applic address possibl signific jump conduct assum constant employ finit volum discret stagger grid akin yee method locat e h compon exchang fig normal compon e doublevalu taken care eleg way helmholtz decomposit e introduc gener current x z figur stagger discret e h three dimens e compon face hcompon edg equat curl oper replac vector laplacian accord vector ident r theta rtheta suffici smooth vector function not e paper gener approach case magnet permeabl may highli discontinu well realist case interest geophys applic although usual jump conduct domin jump permeabl role e h essenti dual possibl appli helmholtz decomposit either e h keep unknown vector function intact choos decompos electr field e refer fig locat hunknown ensu discret major departur previou work fact ident directli extend oper r theta gamma rtheta appear can howev stabil oper subtract r form basi propos method case constant magnet permeabl electr conduct formul reduc previou formul variant thereof approach deal possibl discontinu view use flux which continu cell face vortic which continu cell edg introduct unknown strongli connect mix finit element use highli discontinu problem paper laid follow section reformul maxwel equat way enabl us extend method result system amen discret use finitevolum techniqu describ section extens gener approach present articl without price price ad complic sparsiti structur result discret system correspond ad cost iter solut system briefli describ applic krylov space method solv system algebra equat section use bicgstab see eg togeth one two precondition incomplet block ludecomposit which power precondition case diagon domin linear system ssor system diagon domin direct consequ analyt formul present result numer experi section compar result obtain use method obtain use tradit yee discret sourc divergencefre case electr but magnet sourc method better two order magnitud method work well also case problem coeffici vari rapidli conclud short summari remark reformul maxwel equat maxwel equat a b view flux balanc equat ie term describ flux aris differ physic con sider equat driven conserv flux in fact origin develop therefor a b flux term balanc b gener current densiti b j defin balanc sourc flux aris magnet field a magnet flux balanc flux aris electr field context flux welldefin cell face may multivalu cell edg furthermor lead differenti oper say nontrivi null space rather devis iter method directli take account as eg transform equat discret decompos e compon activ space null space curl oper r could decompos h instead similar way would decompos both chosen concentr decomposit e substitut equat obtain r theta gamma r theta h gamma b r furthermor becom r theta gamma r theta r note across interfac distinct conduct media have addit n theta ae c electr surfac charg densiti condit differenti equat impli b hcurlomegagamma see eg not moreov roe inherit discontinu e delta n continu r delta r theta bound cf relat r theta r theta gammar hold howev vari ident extend directli must deal null space r theta differ way let us defin sobolev space equip usual norm see eg kvk the omegagamma l use right hand side b green formula yield u r theta usual notat inner product l omegagamma l omegagamma use thu u w r theta gamma r theta u u may therefor stabil a subtract vanish term r theta gamma r theta obtain strongli ellipt oper a provid w omegagamma latter condit guarante choic b below similar stabil or penalti approach studi mix success howev experi thu recommend posit discret util elabor upon point next section use c write b r theta h gamma may advantag case discontinu similarli mix formul use simpl divgrad system r elsewher final step reformul replac gaug condit c indirect one obtain upon take rdelta a simplifi use b c achiev weak coupl result pde system note replac gaug condit c similar pressur poison equat cfd complet system discret next section written r theta h gamma order complet specif system must add appropri boundari condit bc first note origin bc written r theta a theta n addit bc normal compon requir helmholtz decomposit uniqu choos correspond c thi togeth determin given e moreov sinc d obtain take rdelta a addit requir either oen oe note origin togeth pde b impli also latter relat c togeth b impli oe n bound ari condit determin oe constant pin constant arbitrarili eg requir z final note c togeth a impli turn n boundari sinc a d impli obtain j thu retriev c pin one addit point system subject boundari condit pin one point wellpos deriv discret employ finit volum techniqu stagger grid b locat cell face h cell edg oe locat cell center correspondingli discret d c center cell center e a center cell face b center cell edg variabl distribut grid cell summar tabl approxim r delta u integr first cell use gauss diverg theoremj ijk j z e ijk r delta u z e ijk case origin bc differ still use boundari condit asymptot valu infinit domain altern note possibl appli helmholtz decomposit h although gener good practic reason prefer decomposit e geophys applic j delta n vanish boundari x z j z j z h z tabl summari discret grid function scalar field approxim grid function point slightli stagger cell e ijk grid use midpoint quadratur face evalu compon surfac integr appear righthand side abov thu defin express discret d c grid cell note assum uniform grid cell may differ width direct boundari condit use end point next consid discret cell face follow defin harmon averag boe neighbor cell xdirect h x b oe assum constant cell integr evalu boe ijk boe ijk then result approxim xcompon e x next discret a write xcompon equat denot j discret center center cell xface result h z similar express c deriv yand zdirect boundari condit use close use c elimin b j a obtain discret equat domin term involv oe result stencil oe point also appli obviou quadratur singl condit d final discret edgecent b consid say xcompon b written integr equat surfac rectangl corner express left hand side integr use gauss curl theo rem right hand side averag direct obtain valu edg divid integr wish integr magnet flux potenti less smooth around edg magnet field yield z z k z k assum constant cell integr evalu h h z h z h z h z then result approxim xcompon b ia h z z c use b well c similar express deriv y zdirect substitut h obtain discret system equat a result stencil point structur discret oper r theta gamma rtheta differ discret direct discret latter interfac natur defin arithmet averag harmon averag discret describ view care extens yee method suitabl discontinu coeffici amen fast iter solut method center conserv second order accu rate note throughout use consist compact discret oper rdelta rtheta r denot correspond discret oper r h r h immedi obtain follow ident cf cours analogu vector calculu ident hold suffici differenti vector function boundari condit discret use discret oper well next note upon appli r h delta use b a obtain moreov c discret normal deriv vanish boundari well set arbitrarili one point determin j throughout domain as grid function obtain anoth conserv properti scheme name discret divergencefre a recal stabil term ad exact solut term obvious vanish now assur us correspond discret term vanish well justifi use term stabil rather penalti case nodal finit element method consid approxim solut satisfi stabil term may grow size vari order magnitud els r h delta grow undesir attempt keep approxim constant across interfac particular way averag across discontinu name arithmet averag cell edg harmon averag b oe cell face import averag view care approxim constitut relationship discontinu coeffici show that look first relat across face whose normal direct x flux flow seri therefor approxim b oe repres bulk properti flow volum given harmon averag correspond arithmet averag resist next look relat edg variabl b x flux four cell share edg flow parallel impli need approxim edg arithmet averag note also use common implement yee method ie h cell face e cell edg role b oe interchang need averag harmon b oe arithmet solut discret system elimin h b j discret equat obtain larg spars system grid function correspond oe oe b result discret oper r theta correspond discret oper rtheta likewis correspond discret oper diagon matrix result discret oper b oedelta c similarli aris cell edg cell center respect h repres discret r delta boerdelta region constant simplifi discret vector laplacian block weakli coupl interfac typic sparsiti structur h variabl contrast constant display fig structur obtain system similar although main block diagon somewhat less pleasant note long frequenc low enough diffus number satisfi where h maximum grid space matrix domin diagon block allow us develop block precondition good low frequenc base truncat ilu ilut decomposit major block thu approxim k block diagon matrix use ilut obtain spars approxim decomposit k decomposit use precondition krylov solver note although k complex approxim k real therefor need appli ilu decomposit two real matric save memori note block approxim make sens discret direct staggeredgrid discret thu sparsiti structur constant sparsiti structur variabl figur sparsiti structur matrix h correspond variabl right constant left reformul subsequ discret maxwel equat allow us easili obtain good block precondition modular manner discret not numer exampl goal section demonstr efficaci propos method compar common discret system util eg use standard krylovtyp method precondition solv result discret system vari type sourc use size jump coeffici oe precondition grid size tabl below iter denot number bicgstab iter need achiev rel accuraci number gigaflop requir ssor paramet when use equal ilu threshold when use equal gamma latter threshold current matlab implement iter involv two precondition cost roughli same exampl set deriv follow set experi let air permeabl permitt ffl assum cube constant conduct oe c permeabl c embed otherwis homogen earth conduct oe permeabl fig typic geophys applic conduct may rang four order magnitud more wherea permeabl rare chang one order magnitud therefor experi conduct oe c rang gamma sm sm permeabl c rang figur set first numer experi cube conduct oe c permeabl c embed insid homogen earth conduct oe e permeabl e also air experi two differ sourc i magnet sourc a plane wave ii electr dipol sourc x direct center fact first sourc magnet impli divergencefre sourc lie entir activ space curl oper contrast electr sourc divergencefre sourc assum oscil differ frequenc rang hz solut obtain unless otherwis note nonuniform tensor grid see fig consist cell unknown correspond grid complex unknown solv system use method describ previou section exampl a order abl compar result linear algebra solver correspond yee method discret system r theta gamma r theta b use stagger grid depict fig ie b j cell face similar discret yield discret system unknown vector e correspond grid valu b jboe matric c defin section b depend sourc order solv system well use bicgstab precondition comparison method case differ frequenc summar tabl electr sourc magnet sourc iter oper iter oper tabl iter count comput effort method a oe tradit implement yee method appli e b j exampl set use electr sourc magnet sourc tabl show method converg moder number iter sourc despit presenc signific jump oe hand tradit discret perform poorli electr sourc reason well magnet sourc slow converg direct stagger discret maxwel equat case electr sourc also report e defin grid edg result clearli show advantag formul origin yee formul even simpl precondit especi electr sourc low frequenc circumst discret first term left hand side strongli domin term residu cours bicgstab iter nontrivi compon null space oper henc reduct slow magnet sourc hand yield special situat where long discret diverg roundoff error rel small residu compon null space lead term oper also small henc number iter use tradit method much larger use method exampl b next test effect discontinu method use electr sourc record number bicgstab iter need method converg variou valu use blockilut precondit describ previou section result summar tabl note larg jump discontinu oe significantli affect rate converg iter linear system solver method larg jump discontinu decis effect result similar spirit report regard effect discontinu special multigrid method edgeel discret howev even larg discontinu number iter report tabl remain rel small compar similar experi report attribut increas number iter jump increas size correspond degrad condit number k degrad howev depend strongli grid size verifi next tabl iter count differ frequenc conduct permeabl exampl set conductivityperm structur cube halfspac exampl c next experi use cube model electr sourc evalu influenc grid number iter fix test method case modest coeffici jump case larg jump set uniform grid interv gamma consid grid record result number iter use ssor block ilu precondition result experi gather tabl observ number iter increas number un grid size ilu ssor ilu ssor tabl iter count differ grid two set problem coeffici use two precondition known increas increas appear roughli proport number unknown power growth number iter function grid size also roughli similar precondition although block ilu requir fewer iter about grid howev ilu requir memori ssor may prohibit use larg problem increas rate also similar expect valu thu increas number iter function essenti depend grid size practic how ever increas substanti may hard cope perhap unrealist larg valu use present techniqu exampl next experi consid complic earth structur employ random model use practition order simul stochast earth model two distinct valu set oe probabl p assum conduct permeabl cell probabl valu oe probabl valu particularli difficult model work with conduct permeabl may jump anywher one cell next necessarili across welldefin manifold crosssect model plot fig carri experi frequenc rang hz use random model differ conduct permeabl frequenc electr sourc domain gamma in km employ uniform grid size use block ilu ssor precondition result experi term conduct slice logsm figur set exampl set iter count summar tabl result show solut method effect even highli vari conduct befor method deterior larg variat present also see tabl block ilu precondition work well low frequenc effect high frequenc easi check case block ilu precondition fail achiev converg denot nc mean failur achiev residu gamma iter maximum grid space h satisfi oe h ae case discret lead term differenti oper longer yield domin block matrix equat therefor block ilu precondition fail thu high frequenc high conduct requir grid point order precondition effect also consist physic skin depth decreas attenu wave simul fidel finer grid summari remark paper develop fast finit volum algorithm solut maxwel equat discontinu conduct permeabl major compon approach follow ffl reformul maxwel equat helmholtz decomposit appli e stabil term ad result strongli ellipt system system written first order form allow flexibl ilu ssor ilu ssor ilu ssor tabl iter count differ frequenc conduct permeabl exampl set ensu discret final divergencefre coulomb gaug condit elimin use differenti substitut yield weakli coupl pde system enabl effici precondition larg spars algebra system result discret ffl discret use stagger grid respect continu condit care averag materi properti across discontinu discret stabil term vanish exact solut discret equat import case larg contrast ffl solut result linear system use fast precondit krylov method result algorithm test varieti problem shown dramat improv standard algorithm sourc electr good perform obtain even coeffici oe allow vari rapidli grid scale case prove challeng multigrid method project motiv us electromagnet invers problem geophys prospect solv forward problem ie maxwel equat present articl major bottleneck data invers method inde may carri dozen hundr time data invers thu extrem fast solver problem discuss paper need base algorithm describ implement carri solv realist instanc forward problem less two minut singleprocessor pc enabl deriv realist algorithm low cost invers problem acknowledg wish thank dr doug oldenburg dave moulton fruit discuss anonym refere valuabl comment first two section exposit r method forward model electromagnet quasistat problem adapt multilevel method edg element discret maxwel equat whitney form class finit element threedimension comput electromagnet multigrid solut ellipt flow problem mix hybrid finit element method finit element numer algorithm fditd fdfd simul slowli vari electromagnet feild theoret numer difficulti vector potenti method finit element magnetostat compu tation black box multigrid geomagnet induct heterogen sphere azimuth symmetr test comput respons undul km discontinu finit element method navierstok equat pressur boundari condit incompress navierstok equat fast model electromagnet use potenti multigrid method maxwel equat natur discret diverg gradient curl logic rectangular grid orthogon decomposit theorem mimet finit differ method mimet discret maxwel equat equat magnet diffus finit element method electromagnet electr conduct sandston exampl two dimension three dimension percol scalarvector potenti solut em finitediffer model theoret concept physic three dimension magnetotellur model use differ equat theori comparison integr equat solut analysi finit volum converg analysi yee scheme nonuniform grid numer implement nodal method solut eddi current problem finit element iterart method spars linear system multigrid solver steadi state navierstok equat use pressurepoisson formul comput electrodynam finitediffer timedomain method diadic green function electromagnet electromagnet theori geophys applic time domain electromagnet field comput finit differ method invers magnetotellur data one dimension conduct numer solut initi boundari valu problem involv maxwel equat isotrop media tr ctr eldad haber stefan heldmann octre multigrid method quasistat maxwel equat highli discontinu coeffici journal comput physic v n p may