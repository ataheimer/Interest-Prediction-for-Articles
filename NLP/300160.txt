t consist initi condit calcul differentialalgebra system a paper describ new algorithm calcul consist initi condit class system differentialalgebra equat includ semiexplicit indexon system consid initi condit problem two typeson differenti variabl specifi one deriv vector specifi algorithm requir minimum addit inform user outlin implement generalpurpos solver daspk differentialalgebra equat present numer experi illustr effect b introduct paper concern calcul initi condit system differentialalgebra equat dae write dae system gener form gt g y ndimension vector initi valu problem system problem find solut satisfi consist set initi condit yt two softwar packag written solv initi valu problem dae system dassl extens call daspk use variableord variabl stepsiz backward differenti formula dassl solv linear system time step dens band direct linear system method daspk linear system aris time step solv either direct linear system method precondit krylov iter method name gmre largescal system iter method combin suitabl precondition quit effect use either solver dassl daspk integr must start consist set initi condit consist requir particular gt usual compon known directli origin problem specif problem find consist initi valu challeng task present dassl daspk solver offer option find consist given initi take small artifici step backward euler method howev initi problem alway aris form even intend problem type techniqu alway success case unsatisfactori produc valu paper propos altern procedur class dae problem show method combin modifi newton method dassl newtonkrylov method yield algorithm converg nearli rapidli underli newton newtonkrylov method new method conveni user make use jacobian precondition matric alreadi requir dassl daspk consist initi problem studi gener dae system consid here howev none algorithm offer simplic conveni approach develop here research support part appli mathemat scienc subprogram offic energi research us dept energi lawrenc livermor nation laboratori contract weng center comput scienc engin l lawrenc livermor nation laboratori livermor california z depart comput scienc univers minnesota minneapoli mn work author partial support aro contract number daalg doe contract number defger nist contract number nanbd minnesota supercomput institut class problem consid gener semiexplicit indexon dae system semiexplicit indexon dae system character follow depend variabl vector split vector u size n call differenti variabl vector v size n call algebra variabl equat form g v gv nonsingular squar matrix concern initi problem find initi valu v v initi valu u u specifi easili gener class problem consid ode subsystem u may implicit thu consid system form matrix f u squar nonsingular continu refer problem form f u g v nonsingular semiexplicit indexon even though may explicit u fact main initi techniqu appli even gener class problem explain later also consid second type initi problem initi deriv specifi depend variabl unknown is must solv given exampl begin dae solut steadi state correspond specifi problem involv split vector differenti algebra part semiexplicit form equat later section refer two problem initi problem initi problem basic method central idea paper solv initi condit problem help mechan alreadi place solut dae system itself rather requir user perform special comput it consid first initi problem semiexplicit indexon system v determin given u initi point expand problem includ calcul u thu form nonlinear system nvector name gener approach solv expand problem also use newton iter solut f would requir jacobian matrix f assumpt matrix nonsingular least neighborhood desir solut cours integr dae system dassl daspk user must call upon one sever linear system algorithm solv n theta n linear system everi time step aris newtonlik method solv algebra system gt y vector contain past valu c constant set solver invers proport stepsiz h thu linear system form r residu vector deltay correct y matrix j dae system iter matrix y user encourag suppli approxim j use either newton matrix case direct method precondition case krylov method direct case j gener differ quotient approxim suppli user case system f f cf order make use j solv f pick artifici stepsiz h set then recov block f u rescal first blockcolumn j h use scale matrix ident matric size n n respect thu consid matrix hg evalu note f thu h small appropri sens expect j good approxim f x propos initi procedur carri newtonlik iter correct iter call linear system solut procedur use later solv dae system itself also requir inform compon differenti algebra order appli correct deltax vector otherwis procedur requir addit inform methodolog upon converg compon yt compon correspond u deriv differenti variabl remain compon correspond v simpli set zero integr procedur insensit sinc v appear although bdf formula depend valu error test end first step depend them unless v variabl exclud error test which option code first time step produc accur valu them next two section present procedur formal manner prove converg it initi problem given initi valu must comput initi y case simpli interest solv system assum problem wellpos provid user f g nonsingular neighborhood solut includ initi guess suppli first problem call user suppli dae iter matrix j time set matrix involv simpli stepsiz h proceed newton iter use j correct deltay final remark extens idea hessenberg index dae system way author gener problem case initi problem full scope problem idea appli gener system form satisfi f true jacobian f approxim suitabl small permut variabl wish gener system first drop requir differenti algebra compon separ block y thu assum permut matrix p size n term z system function g form vector unknown term z term order express object function f x precis introduc two project r n satisfi help project write p is p x vector contain unknown algebra compon correspond similarli vector contain unknown deriv compon correspond u where known compon compris vector write x fact g depend v mean gt thu system solv x way need requir compon g block thu allow permut q compon g qg block form cours qf howev work g henc f origin order initi procedur implicit constraint gener form problem solv suppos that permut vector z py dae system function g form gt full rank n class problem gener algebra constraint gt u need identifi explicitli system form defin project matric p p true gt defin vector w x befor system solv befor jacobian function know h u full rank nonsingular matrix mh squar nonsingular matrix size n fact index one impli b nonsingular near consist initi valu see x thu w f nonsingular hand jacobian suppli or approxim user take befor recal scale matrix defin correspond scale x thu find compar expect j work well approxim f x modifi newton iter solv f correct x take form class problem given take scope initi problem implement algorithm describ abov gener indexon system note includ fullyimplicit index one dae rank depend condit combin exclud certain indexon sy tem simpl exampl system index one wellpos given valu t fit scheme contain deriv variabl rank theta matrix h principl scheme appli gener index dae system allow p gener matrix permut constant nonsingular matrix p found transform full rank gt defin vector x function f x defin befor d defin input vector p jacobian f approxim satisfi thu procedur still work long problem suppli user wellpos howev contrast case p permut solut vector x found vector may differ in compon exampl system abov appropri matrix p make choic p input initi valu differ g t compon would alter procedur hand preserv approach would use procedur gener constant p determin consist set initi condit sens initi valu transform variabl consist initi valu deriv origin variabl may consist exampl system initi correctli wherea individu determin inform constraint deriv g t avail gener index system due complic expens find smooth p continu chang variabl later time step chosen implement extens algorithm instead restrict p class permut matric necessari user may abl bring problem form chang variabl describ abov converg theori case initi problem given question converg newton modifi newton iter aris give converg analysi iter theorem includ full modifi newton iter problem full refer fact approxim jacobian evalu everi iter first prove main converg result theorem below discuss applic initi problem section last subsect comment use newtonkrylov iter solv initi problem newton iter converg consid converg x iter includ type newton iter take ae x k full newton iter x modifi newton iter x fix function f x gener function here assum exist smooth matrixvalu function jx h cx h interest follow theorem say iter converg mild smooth assumpt function f c norm k delta k use arbitrari theorem let f r n r n continu differenti open convex set ae r n assum a exist x f x c exist ae neighborhood nx condit nx ae constant fl d exist matrixvalu function jx h cx h x d relat cx satisfi lipschitz condit nx ae constant fl c exist constant ffl h x h x nx ffl modifi newton case sequenc gener welldefin converg x condit iter obey k full newton case modifi newton case proof extens proof denni schnabel p treat full newton case exact jacobian main complic due inaccuraci iter matrix give proof give three lemma use three hypothes theorem assum lemma ffl minfa fiflg proof first note lipschitz condit f then perturb relat denni schnabel p f x nonsingular lemma ffl minfa fiflg proof lemma use again perturb relat jx h nonsingular lemma ffl minfa fiflg proof norm first term bound xk use lemma lipschitz condit f second term bound hfic sinc kcxk c previou lemma proof theorem deriv recurr give linear converg case qsuperlinear converg limit let ae oe lemma f x jx h nonsingular h valu ffl also measur nonlinear problem prove bound induct iter number k h h welldefin two term final equat first bound use lemma denni schnabel p say kf x norm first term bound fiflkx second term bound use lemma give bound fiflkx norm matrix coeffici thu obtain shown note sinc x x nx ffl use jacobian welldefin nonsingular gener induct step goe exactli obtain again thu x show iter welldefin fact give linear converg sequenc fx k g applic dae system explain section central object solv initi condit problem help mechan alreadi place integr dae system itself gener time step within dassl daspk solver involv solut linear system j deltax r matrix dae system iter order use valu j insid newton modifi newton iter solv nonlinear problem f must deriv relationship jacobian matrix f x j follow lemma gener similar relationship deriv earlier section lemma assum exist project matrix p gt defin project matrix p j gamma p function f x d given x proof next partial deriv evalu t prove lemma daspk start input initi guess correspond initi valu x x pick suitabl small valu h set h defin jx h matrix lemma satisfi note newton iter base jx h correct daspk direct method select jt suppli user possibl approxim form gener differ quotient j gamma realiz lu method case fix therefor repres modifi newton method theorem appli iter one assum differenti g respect partial deriv g respect local lipschitz continu wellpos initi problem type discuss section clear assumpt theorem hold thu iter x converg given h small enough good enough initi guess x newtonkrylov iter use newtonkrylov iter solv initi problem section use precondit gmre linear iter finitediffer approxim involv gt approxim action j arbitrari vector precondition approxim j gamma gmre comput approxim solut p k small enough step deltax k given deltax impli small reason finit differ g use instead f gmre solver daspk use finit differ g approxim j time arbitrari vector dae time step thu abl appli machineri alreadi avail user need concern j f relationship j f given lemma also clear good precondition j suffic iter consider lead us consid converg follow inexact newton iter gener function f x gener inexact newton set manner step increment k comput unimport need know k found again assum exist smooth matrixvalu function jx h cx interest follow theorem say iter converg mild smooth assumpt function f c theorem let f r n r n continu differenti open convex set ae r n assum condit ad theorem hold exist constant ffl x h sequenc gener welldefin converg linearli x proof sinc assumpt ad theorem hold choos ffl h thu x h nonsingular exist satisfi guarante given ks henc follow ks choos h smaller if necessari j fijhc residu norm condit rest proof follow along line proof theorem dembo et al linesearch algorithm order improv robust newton algorithm discuss abov also employ linesearch backtrack algorithm consid gener function let x ffi r n residu norm condit hold euclidean norm vector ffi thought approxim solut newton equat f obtain use either direct solv approxim jacobian iter method gmre given ffi shown brown saad ffi descent direct f x ie given ffi descent direct f x employ follow backtrack algorithm algorithm given fx exit otherwis go next step choos min max set go step global converg algorithm use connect inexact newton iter discuss length simplest choic s take make use choic implement here also use small decreas f requir given f defin algorithm ffi exact newton step x ie henc case condit step algorithm simpli next gmre solut mth step appli f shown condit step algorithm present context want solv nonlinear system f howev direct measur size f directli avail weight rootmeansquar wrm norm use daspk norm suggest solv instead problem matrix current approxim system jacobian matrix j direct case precondition p krylov case diagon matrix contain weight use wrm norm thu f squar wrm norm gamma f either case like f x wellscal wrm norm direct vector ffi avail us newton correct given thu case initi problem case initi problem case expect question aris whether ffi descent direct f current approxim solut x easi calcul give use assur small follow ffi descent direct f x implement implement algorithm describ initi problem new option generalpurpos dae solver daspk initi problem implement gener class indexon system describ section give detail concern implement describ briefli use new option assum reader familiar use dassl daspk detail descript solver found respect solver normal requir initi t y consist within depend variabl vector daspk denot differenti variabl denot algebra variabl specifi input paramet info daspk solv one follow two initi problem initi valu alreadi consist default given calcul option specifi user must identifi daspk differenti algebra compon y done set for differenti variabl algebra variabl solv initi problem given calcul either case initi valu given compon input initi guess unknown compon must also provid input algorithm problem requir initi stepsiz scale h determin first approxim tri initi stepsiz h use dassl daspk p sinc know advanc valu small enough achiev converg modifi newton iter set loop start initi fail divid h initi fail mxnh nomin differ valu h code return error flag user program experi initi succe usual succe initi choic h initi problem alway set loop h either case initi complet reset initi stepsiz h first step daspk base newli comput initi valu use formula given valu c initi problem solv either modifi newton method inexact newton method similar use gener time step augment linesearch algorithm describ improv global converg case initi problem given eq problem given eq must solv system f x residu dae system y x repres variabl solv jacobian matrix or precondition matrix krylov case obtain either finitediffer approxim call user subroutin calcul jacobian depend option specifi routin specifi dae jacobianprecondition exactli one need time integr newton iter given term approxim system jacobian j relax steplength linesearch algorithm given section for initi problem scale matrix absent code organ newton solver independ initi problem solv vector calcul separ routin call construct appli increment deltax follow ffl problem increment gammap p increment gammacp p ffl problem increment mean j depend choic method case direct method valu j approxim system jacobian evalu by differ quotient usersuppli routin start iter evalu j involv call backsubstitut routin case krylov method howev j refer exact system jacobian current valu j gamma f x evalu call routin precondit gmre method make use precondition p suppli user evalu start iter case inaccuraci fix approxim j p system jacobian addit potenti caus difficulti newton iter complet algorithm actual involv three loop level problem two level problem innermost level mxnit newton iter perform given valu h given valu jacobian precondition iter consid converg scale residu small norm ae current approxim system jacobian j direct case precondition matrix p krylov case test constant epconi toler newton iter subsequ time step epinit swing factor nomin equal norm use throughout weight rootmeansquar wrm norm weight form usersuppli toler see valu ae mth iter use infer converg rate converg achiev mxnit iter strategi repeat attempt depend rate converg fail rate the iter converg slowli retri newton iter current valu new valu ie j p limit mxnj attempt addit case krylov method gmre solver fail converg least two newton iter rate newton iter retri new valu p limit mxnj retri reach reduc h retri iter again new current case problem give return error flag case problem converg inner newton iter fail rate or recover failur occur retri iter reduc valu h initi problem give problem total number iter perform therefor larg mxnhmxnjmxnit problem mxnjmxnit problem current set set case direct method case krylov method howev four control option input daspk user may specifi differ valu addit option provid turn linesearch algorithm actual addit level logic ad around initi algorithm describ abov reason error weight involv converg error test depend current solut vector thu initi algorithm may succeed use weight evalu initi guess weight may differ greatli updat valu use converg vector sinc updat weight everi iter seem rather extrem adopt follow scheme weight set use input vector initi algorithm call succe updat weight call second time succe updat weight again proceed first time step either initi fail error flag return user case krylov method second initi call precondition updat unless converg failur numer experi test initi algorithm sever problem found perform much expect cours develop debug use simpl indexon system size known analyt solut first second initi problem type wide rang initi guess initi algorithm converg within limit impos direct krylov method option attempt integr system without initi option fail except initi valu consist realist test use model multispeci food web mutual competit andor predatorprey relationship spatial domain simul consid speci model speci prey speci predat predat assum infinit fast reaction rate specif model equat concentr vector are interact diffus coeffici a could function x gener choic made test problem follow domain unit squar boundari condit homogen neumann type zero normal deriv everywher coeffici uniqu stabl equilibrium guarante exist deriv appear equat speci empir stabl equilibrium appear exist ff fi posit although may uniqu test problem take consider spatial variat solut pde system togeth boundari condit discret central differenc l theta l mesh describ taken quit suffici accur spatial resolut result dae system gt y toler use run sun sparc workstat initi problem test problem report initi condit taken mildli peak function nearli satisfi constraint equat ae predat valu c determin equat f x approxim quasisteadi state qss valu origin daspk solver difficulti problem without adjust initi valu howev expect typic applic type impract find accur initi valu test prescrib flat valu preda initi guess input array invok new algorithm initi problem present problem paramet qss valu c time within vari c pred report test krylov method gmre option daspk precondition use product spatiallybas factor reactionbas factor notat given r respect reaction diffus term righthand side dae system problem form gt y ident matrix place posit correspond compon c spatial factor p sr consist gaussseidel iter reaction factor use differ quotient approxim diagon block daspk input paramet relat krylov method default valu specifi tabl below summar result daspk test new initi algorithm incorpor it valu c pred with qss denot valu tabul quantiti are number newton iter initi condit calcul number linear iter initi condit calcul total number newton iter complet integr total number linear iter complet integr total number residu evalu complet integr number nni nli measur cost initi algorithm nni nli nre measur total cost solv problem converg to correct valu initi achiev reason addit cost pred evid converg region initi problem strongli skew high side permit error least low side case c pred algorithm converg valu c correspond solut valid differ one interest here comparison initi condit calcul option select qss initi valu success case total cost figur slightli larger initi indic even approxim qss valu somewhat error unmodifi daspk solver run initi condit option on also unabl solv case except qss initi valu case total cost fail case either halt initi algorithm when initi option off fail first time step either repeat corrector converg failur repeat error test failur basi experi test howev chang default valu nrmax maximum number gmre restart c pred fail ic calcul tabl test result new initi algorithm food web problem initi problem test specifi initi time deriv ie pose steadyst problem sinc explicit timedepend righthand side consist initi valu determin solut dae problem constant time type problem much harder initi problem absenc time deriv oper moreov precondition devis dae problem less use here first describ test use direct method specifi band jacobian gener intern differ quotient two halfbandwidth equal simplic initi guess discret c valu taken spatial flat valu prey subsequ time integr issu here stop perform test varieti valu ff fi reveal case problem nontrivi region converg case tabl upper half give result case tabul counter nni defin befor converg achiev difficulti alway use full newton step at least valu prey interv c prey interv c prey algorithm fail find solut interv c prey converg incorrect solut that neg valu c interv c prey converg correct solut difficulti linesearch algorithm must choos vale refer note true steadi state valu c case rang d problem use jacobian full bandwidth quit costli attempt reduc cost also test halfbandwidth equal correspond approxim jacobian ignor diffus term howev result complet unsuccess result lump tridiagon precondition evid inaccur consid test krylov method problem choic precondition problemat term form true jacobian steadi state problem sinc initi algorithm set usersuppli precondition choic p sr use problem undefin therefor use gammar blockdiagon matrix involv reaction jacobian element tri varieti valu ff fi provid flat initi guess howev larger valu paramet found converg gmre iter much slower case initi problem expect sinc diffus term contribut significantli system complet absent precondition order achiev converg therefor increas krylov subspac paramet default valu set maximum size krylov subspac maxl number gmre restart allow nrmax allow total gmre iter linear system valu c prey algorithm appear fail valu prey at least converg correct solut c prey linear method nni nli note direct fail ic calcul direct incorrect solut direct linesearch min direct fail ic calcul direct direct direct krylov fail ic calcul tabl test result food web problem initi problem case tabul compar comput solut vector initi algorithm accur solut direct method integr tighter toler virtual steadi state valu problem test error less toler impos exampl prey maximum rel error observ user daspk caution initi problem difficult initi problem extra effort may necessari comparison problem time integr converg algorithm problem sensit initi guess qualiti approxim jacobian j precondition p j p use time step good approxim limit c case problem food web test differ precondition steadyst initi problem where serious consid user easili determin jac psol whether precondition call steadyst initi condit calcul paramet cj equal zero it nonzero situat branch accordingli appropri precondition r develop softwar time depend problem use method line differentialalgebra integr numer solut initialvalu problem differentialalgebra equat decay uniform state food web local converg theori combin inexactnewtonfinitediffer project method hybrid krylov method nonlinear system equat converg theori nonlinear newtonkrylov algorithm use krylov method solut largescal differentialalgebra system consist initi condit linear time vari singular system comput method gener higherindex nonlinear singular system differenti equat numer method unconstrain optim nonlinear equat shoot method fullyimplicit index differentialalgebra equat approxim method consist initi differentialalgebra equat zur theori und numerischen realisierung von losungmethoden bei differentialgleichungen mit angekoppelten algebraischen gleichung consist initi differentialalgebra system gmre gener minim residu algorithm solv nonsymmetr linear system tr ctr alan c hindmarsh peter n brown keith e grant steven l lee radu serban dan e shumak carol s woodward sundial suit nonlinear differentialalgebra equat solver acm transact mathemat softwar tom v n p septemb c t h baker c a h paul h tian differenti algebra equat aftereffect journal comput appli mathemat v n p march d a van beek v bo j e rooda declar unknown daebas hybrid system specif acm transact model comput simul tomac v n p januari