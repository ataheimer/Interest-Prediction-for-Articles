t integ multiflow maxim a gener twocommod flow theorem rothschild whinston oper re pp multiflow theorem lovsz acta mat akad sci hungarica pp cherkaski ekonommat metodi pp karzanov lomonosov mathemat program o i larichev ed institut system studi pp prove minmax theorem maximum multiflow origin proof quit long technic reli earlier investig metric main purpos present paper provid rel simpl proof theorem proof reli lock theorem anoth result karzanov lomonosov polymatroid intersect theorem edmond combinatori structur applic r guy h hanani n sauer j schnheim ed gordon breach pp complet also provid simplifi proof lock theorem final introduc notion node demand problem and anoth applic lock theorem deriv feasibl theorem concern itth present approach give rise combinatori polynomialtim algorithm b introduct e two undirect graph v call path g h admiss connect two node x xy f g call suppli graph h demand graph element termin element v call inner node maxim problem consist find maximum number edgedisjoint hadmiss path h consist one edg menger theorem give answer gener problem npcomplet even special case g eulerian graph call eulerian degre everi node even are howev import special case problem tractabl rothschild whinston prove maxflow mincut type theorem g inner eulerian h consist two edg we say pair g inner eulerian degre dv even everi inner node v anoth result due independ l lovasz bv cherkasskij solv maxim problem h complet graph g inner eulerian av karzanov mv lomonosov found common gener two theorem origin proof rather lengthi technic certainli much difficult two special case mention abov detail proof describ karzanov lomonosov later karzanov exhibit anoth proof base splittingoff techniqu gave rise strongli polynomi solut algorithm howev latter proof also rather complic main contribut paper rel simpl proof theorem karzanov lomonosov proof reli two ingredi socal lock theorem anoth result karzanov lomonosov depart oper research eotvo univers muzeum krt budapest hungari h research author partial support hungarian nation foundat scientif research grant otka partial carri author visit imag universit de grenobl bp grenobl cedex franc institut system analysi prospect imag universit j fourier bp grenobl cedex franc research first author partial support european project donet polymatroid intersect theorem j edmond complet also provid simplifi proof lock theorem sinc ingredi solv combinatori polynomialtim algorithm approach give rise altern strongli polynomialtim algorithm capacit maxim problem question faster karzanov follow distinguish oneel set fxg element x set x element let denot union x t vector use notat famili pairwis disjoint nonempti subset set call subpartit s two element s set x call tsset x x integervalu vector function call even valu even integ polyhedron p use notat graph e cut x denot set edg precis one endnod x cardin denot dx call degre function g let dx denot number edg one x gamma gamma x let easi prove satisfi follow ident everi pair xy subset v let b two disjoint subset v path connect element element b call a bpath path connect two distinct element call apath a b g simpli a b stand maximum number edgedisjoint a bpath menger theorem one may consid fraction version edgedisjoint path problem let g h befor hmultiflow briefli multiflow x mean famili fp path g along nonneg coeffici ff p connect endnod demand edg x call integervalu ff integ p connect element element b that is h complet bipartit graph bipartit a b speak a bflow hmultiflow x let xe e xt end call cadmiss xe ce everi e e lock problem e graph v subset termin node subset notat abbrevi a g a confus aris throughout paper assum current g inner eulerian lovasz cherkasski prove follow theorem theorem inner eulerian pair g maximum number edgedisjoint path equal equival formul follow theorem given inner eulerian pair g famili f edgedisjoint path g f contain t path end word singl famili edgedisjoint path includ maximum famili edgedisjoint simultan karzanov lomonosov extend theorem formul result let us say famili f edgedisjoint path lock subset f contain a apath furthermor say f lock famili l subset f lock member l theorem assert famili f path lock singleton alway possibl find famili edgedisjoint path lock specifi famili l answer gener no shown follow exampl l consist three pairwis cross set two subset xy call cross none fig exampl indic natur requir l crossfre famili l subset call three pairwis cross member lock theorem karzanov lomonosov karzanov lomonosov let g inner eulerian l cross free famili subset famili edgedisjoint path lock l proof slightli weaker version sketch karzanov lomonosov present proof reli idea split use alreadi karzanov technic simpler split pair adjac edg graph g mean oper replac e f new edg connect x thi way may introduc parallel edg x t result graph denot g ef proof may assum gamma l l l ad gamma l affect neither crossfre lockabl also assum g connect proceed induct number edg incid element number zero statement trivial therefor edg st go show edg theorem follow sinc induct famili f path g ef lock l path use new edg h g ef arisen split e f revis f replac p e f revis f lock l g proof sinc analog therefor claim follow ffl call set x v tight close complement tight g inner eulerian pair edg precis tight set x t x s three maxim tight tsset proof let xy z maxim tight tsset sinc l crossfre two three set x t t z t say noncross either first two case x tight contradict maxim x last case appli claim contradict exist edg st ffl let denot set neighbour s claim possibl cover two tight tsset proof suppos xy x tight tsset let ff ds symmetri may assum ff fi impli dx x t hand sinc fl posit claim edg satisfi hold proof lock theorem complet ffl ffl one may interest possibl lock theorem when rather crossfre properti assum famili l lock neg side karzanov pevzner show everi l includ three pairwis cross set graph g subset node g inner eulerian famili path lock member l hand lock theorem restrict impos relationship g famili l exampl let g planar eulerian graph let denot node outer face cyclic order defin l consist subset form though l cross free k lock theorem hold thi theorem equival planar dualiz result hurken schrijver tardo need slight extens theorem let z nonneg integervalu function famili f edgedisjoint path call mindepend everi termin end mt member f let m a denot maximum number edgedisjoint mindepend apath say famili f edgedisjoint path mlock subset f m independ contain m a apath furthermor say f mlock famili l subset f mlock member l follow theorem straightforward consequ theorem use proof theorem theorem let g innereulerian l cross free famili subset let z vector mt dt even famili f edgedisjoint path mlock l proof let g graph aris g split everi node follow sens add new node along mt parallel edg replac edg xt g xt result immedi follow theorem appli g flow polymatroid nonneg setfunct call polymatroid function b monoton increas i e b submodular ie degreefunct graph g satisfi properti typic polyhedron p b fx call polymatroid call integr everi vertex p integervalu concept polymatroid introduc j edmond prove polymatroid uniqu determin defin polymatroid function furthermor polymatroid integr b integervalu polymatroid p b face bb p b call basi polyhedron element base edmond also prove follow result theorem edmond integr polymatroid p b integervalu vector x p b integervalu basi x polymatroid intersect theorem edmond state linear system two polymatroid total dual integr tdi need follow consequ theorem edmond two polymatroid function b defin power set furthermor b integervalu maximum attain integ vector follow vector x p a p b bipartit fa bg b integralvalu x e graph endow capac function c subset node cadmiss a bflow x everi v ag f submodular monoton increas multitermin version maxflow mincut theorem vector r belong pa mx f x therefor pa polymatroid furthermor c integervalu cadmiss integervalu a bflow x e eulerian graph subset node defin c partit t denot direct sum polymatroid lemma let q integ basi p famili f edgedisjoint path connect distinct member endpoint exactli qt path f proof let x minim subset v claim set disjoint if indirectli contradict minim x claim famili f edgedisjoint path g connect distinct x s use edg induc x f contain end x k inde appli theorem pair g graph g aris g contract x node denot g sinc q basi p famili f qt connect endnod qt member f member eras edg outsid x denot f famili result path glue togeth path f path f obtain famili f path satisfi requir ffl lemma let q integ basi p integ vector q m independ famili f path mlock contain least qt path connect distinct member proof lemma q t impli m q sinc f mlock m t connect k lemma follow ffl remark sinc q basi f contain qt f contain qt path connect distinct member is number path f precis qt need fact let b two partit let l ab let h demand graph uv edg h x l includ u v setfunct defin seen polymatroid function defin b j analog b b polymatroid function let p a p b polymatroid defin b respect arbitrari even vector p a p b h t h edgedisjoint hadmiss path proof sinc g eulerian p a p a integr polymatroid appli theorem p a x obtain even base p a analog even base b p b b defin vector mt maxm t b t even henc sinc l cross free appli theorem let f denot famili mindepend path provid theorem jf go prove number h hadmiss path f least h note path hadmiss precis connect two node belong member l appli lemma choic a p p a q obtain gammam t path f endnod member a analog endnod member b henc note element need endnod exactli t member famili assur lemma comment see begin section maxim e suppli graph throughout section assum pair g inner eulerian is dv even everi stand degre function g maxim form edgedisjoint path problem consist find maximum number g h edgedisjoint hadmiss path easili get upper bound let us call subpartit v admiss x stabl clearli valu call valu subpartit let g h denot minimum valu admiss subpartit follow exampl show equal gener fig two known special case equal hold theorem show case h complet graph reformul theorem have theorem suppos g inner eulerian demand graph h complet anoth special case h consist two edg is theorem suppos g inner eulerian h consist two edg theorem rothschild whinston actual prove follow simpler form theorem rothschild whinston suppos g inner eulerian h consist two edg minimum cardin cut x g the equival two form is may prove follow sinc cut x provid admiss partit special form clearli see direct let p fx minim admiss subpartit g k minimum sinc jt j exactli two termin node connect h furthermor if say would also admiss partit whose valu bigger fx anoth optim admiss partit henc k two member p say x x contain one termin node two termin node say connect h replac x x anoth minim admiss subpartit contradict minimum choic k ffl let us call graph bistabl two partit b x xy edg h precis x belong differ part differ part b easili seen graph bistabl complement linegraph bipartit graph it also shown bistabl graph famili maxim stabl set h partit two part consist disjoint set clearli cliqu gener complet kpartit graph bistabl k also bistabl therefor theorem special case follow theorem karzanov lomonosov suppos g inner eulerian bistabl g proof slightli weaker halfintegr version sketch alreadi karzanov lomonosov reader may feel bistabl demand graph form rather peculiar class graph may larger natur class graph hold karzanov pevzner howev show bistabl contain isol node suppli graph g section outlin origin plan proof intend use polymatroid intersect theorem point attempt fail perhap help reader understand led invok lock theorem proof below proof g see direct first prove theorem follow special case graph complet eulerian suppos theorem true eulerian want prove g h g inner eulerian let k denot set node g odd degre sinc g inner eulerian k k empti done not new node t let t let e respect maximum minimum question concern g assumpt obvious optim solut maxim problem concern everi edg xt x k path solut thu optim admiss subpartit m sinc everi edg xt x belong henc mgammafxg admiss subpartit g h therefor conclud let b two partit defin bistabl graph h note stabl set h subset b let b defin sinc p a p b integr polymatroid theorem exist even vector p a p b bipartit fa bg henc g henc proof complet find admiss subpartit valu end let us assum maxim subset b gamma satisfi claim inde is bipartit fa would also satisfi contradict maxim choic a note that choic b role b fulli symmetr nonempti exist set x last equal follow definit a analog nonempti exist set j assum x j chosen minim let nonemptyg lemma k admiss subpartit valu proof clearli element belong least one member k show one is claim henc a must hold otherwis element x would violat also everi b true element y j proper subset j contradict minim choic j henc proof complet claim k subpartit assum contrari l k kl k definit k minim choic member k impli definit k admiss valu lemmata proof theorem complet ffl ffl section briefli outlin proof give rise strongli polynomi combinatori algorithm capacit case inform polynomialtim algorithm strongli polynomi number step depend magnitud occur capac cost input algorithm consist two graph e g endow nonneg ration capac function assum two partit xy f contain one x y note graph h given incid matrix one test h effici bistabl name decid first enumer whether jt j maxim stabl set h answer ye h bistabl answer no h bistabl intersect graph maxim stabl set bipartit output algorithm consist cadmiss hmultiflow x admiss subpartit v moreov c integervalu eulerian sens ffi c v even everi node v v output x integervalu well actual assum c integervalu eulerian case one multipli capac n n denot least common denomin capac c inner eulerian appli reduct describ section obtain complet eulerian case first remark proof lock theorem immedi provid polynomialtim algorithm setsystem l ab c ident difficult show that gener integervalu eulerian c everi step one split much capac possibl algorithm strongli polynomi cf karzanov follow comment use polymatroid intersect algorithm construct even vector admiss subpartit occur proof theorem disjoint set xy v let c x denot valu flow x help maxflow mincut mfmc comput c x comput strongli polynomi time set function defin analog b polymatroid defin b known polymatroid theori p c eulerian a b integervalu henc p a p b integr polymatroid therefor z integervalu vector p even vector p a p b v maximum polymatroid intersect theorem bipartit fa bg combinatori strongli polynomi algorithm due p schonsleben comput z and henc fa bg algorithm work oracl avail minim vector case oracl inde construct invok mfmc algorithm way one obtain pure combinatori strongli polynomi algorithm comput a b satisfi use proof claim proof theorem one may comput strongli polynomi time integervalu maximum multiflow admiss subpartit minimum valu karzanov describ direct way comput minim admiss subpartit method consist one mfmc comput appropri defin auxiliari digraph jv jjt j node complex ojt jjv j n denot complex mfmc comput network n node next even basi p a defin proof theorem construct jaj resp jbj mfmc comput thu vector defin comput ojt jjv j step mlock problem solv appli ojv splittingoff oper everi node v oper consist find jajjbj maximum flow g requir ojv j jajjbjjv j ojv j jt jjv j oper thu overal complex algorithm ojv one use mfmc algorithm complex upper bound run time algorithm to compar complex algorithm karzanov nodedemand problem reader might feel invok lock theorem proof contain seemingli unnecessari twist fact origin tri prove theorem use follow natur direct approach exampl show attempt fail recal polymatroid intersect theorem ensur exist maximum even vector precis g h theorem would follow exist system hfeasibl path endnod precis t them unfortun system need alway exist shown follow exampl figur demand graph h defin partit ffv admiss subpartit valu is maximum g h hand three hadmiss edgedisjoint path g name p henc valu primal dual optima easili check system path optim solut bad thing two node v v endnod one that is odd number path therefor hope obtain path first determin optim even vector intersect two polymatroid question find hadmiss path node endnod t them furthermor one must insist even sinc lock theorem true vector incident vector optim element polymatroid intersect fa g bipartit satisfi vector aris proof theorem appli obtain famili f four path name among path p nonhadmiss obtain optim solut maxim problem though direct approach maxim problem prove success led us follow problem consid sake e graph z demand function nodedemand problem consist find system hadmiss path termin endnod precis mt path call problem also vector feasibl solut exist nodedemand problem call eulerian inner eulerian mtdt even call demand graph h twocov onecov everi node belong two exactli one maxim stabl set h note bistabl graph alway twocov element circuit exampl twocov bistabl shown graph h twocov h complement line graph trianglefre graph theorem suppos nodedemand problem defin g hm eulerian h two cover feasibl follow condit hold everi stabl h proof sinc stabl h solut nodedemand problem path endnod endnod gamma s among ms path mx may end x gamma henc least ms must end outsid x follow prove suffici first observ famili l maxim stabl set h crossfre inde contradict let stabl set h pairwis cross sinc h distinct element stabl maxim stabl set containa a b c distinct element and b c well would belong two maxim stabl set contradict h twocov stabl set h proof recal m s defin maximum number edgedisjoint path connect x endnod mx ot them version menger theorem appli edgedisjoint undirect version menger theorem graph aris g ad two new node s respect t connect node x resp gamma s mx new parallel edg x denot set minimum attain then m claim follow ffl appli theorem g ml consid path system f provid theorem where l collect maxim stabl set h solut node demand problem proof let element l is maxim stabl set h sinc f lock s f contain connect gamma s show node x endnod precis mx member f path f endnod must endnod everi node x h belong maxim stabl set h x endnod precis mx member f moreov sinc everi pair nonadjac node x h belong maxim stabl set h path f may connect x y is f consist hfeasibl path ffl ffl remark condit theorem may formul equival form take see impli everi maxim stabl set z h convers claim follow inde let z maxim stabl set h includ s ms mx z follow advantag maxim stabl set twocov graph at jt j hand proof slightli easier work r solut problem multicommod flow network combinatori method solv cutdetermin multiflow problem in finit infinit set multicommod flow problem integervalu optim solut class maximum multicommod flow integervalu optim solut system flow undirect network in mathemat program complet descript class cutnondetermin maximum multicommod flow problem combinatori approach multiflow problem combinatori approach multiflow problem connect properti eulerian graph ganzzahlig polymatroid intersect algorithmen tr ctr michael lomonosov return path pack european journal combinator v n p januari