t new multivari product densiti estim a let x rdvalu random variabl unknown densiti f let x xn iid random variabl drawn f object estim fx studi pointwis converg two new densiti estim hilbert product kernel estim dn injdlog nxjxij hilbert knearest neighbor estim kddnlogdnkd jdxjxkj xk kth nearest neighbor x point order increas valu product jd xjxkj auxiliari result need permit us formul univers consist result pointwis l product kernel estim differ window width coordin rectangular partit tree estim particular show local adapt smooth factor product kernel estim may make kernel estim inconsist even standard condit bandwidth b introduct object note studi two new multivari densiti estim avoid messi problem smooth factor select in one case least invari ane transform coordin provid easi mean jointli estim margin densiti densiti f ir byproduct abl studi univers consist product kernel estim rectangular partit estim independ observ ir valu random vector x unknown densiti f classic kernel estim f h smooth factor depend upon n k absolut integr function the kernel k h observ kernel smooth factor h cancel obtain one may wonder happen situat smooth factor absent problem dealt devroy krzi zak show follow theorem hilbert estim fn x v n log n v volum unit ball ir weakli consist almost x is probabl almost x use name hilbert estim relat hilbert integr similar ker nel hilbert estim invari ane transform coordin is transpar notat fn x denot densiti estim x ir given data ir bay denot sampl size n ith coordin observ transform kernel densiti estim invari may obtain one use product kernel howev caus addit problem compon kernel requir smooth factor appli principl hilbert estim obtain product hilbert estim d log nx x ji estim smooth factor invari mention follow readili howev weak pointwis consist hold ir densiti counterexampl provid below fact product kernel estim posit smooth paramet known h h h nh fn f probabl almost x k bound compact support densiti devroy gyorfi r f almost sure k r howev less known allow individu smooth factor tend zero dierent rate allow depend upon x univers lost natur condit h would seem lim lim within condit k uniform densiti exist densiti f almost everywher probabl turn sucient condit f almost everywher pointwis converg r f log d f proof counterexampl follow section paper explor sucient condit variou type converg estim discuss context jessenmarcienkiewiczzygmund condit consist prove multivari hilbert product estim product nearest neighbor estim which hasa nearest neighbor rank invari scale axe desir featur highdimension data collect ordinari product kernel estim final treebas rectangular partit estim sum product invers uniform product iid uniform random variabl densiti given log d z d let z zn iid distribut z have lemma sn log n probabl proof result follow theorem rogozin theorem bingham goldi teugel stabil sum iid random variabl function f snan probabl r x slowli vari function chosen la n a n n take r x log xd take log xd nlog nd inde nlog ndd n log sak rariti theorem implic understand reason defin condit f help understand so reason go back theori dierenti de guzman good refer consid function f ir togeth collect b bound measur set properti everi x ir exist sequenc b diamet written diam decreas zero x collect call basi collect set b contain x denot bx defin upper lower deriv f respect de guzman p say dierenti f d f almost everywher x exampl known b collect ball hypercub dierenti integr function f form celebr lebesgu densiti theorem basi pointwis converg properti kernel estim inde densiti estim let b denot interv basi is collect product finit interv contain least two point collect bound rectangl posit measur align axe requir follow result lemma a the jessenmarcinkiewiczzygmund theorem b dierenti llog is function f ir includ densiti f inde except good account chapter de guzman p first all accord sak rariti theorem sak exist nonneg function f ir d f almost everywher x with respect b later marstrand found f properti work orient axe each orient axe dierent collect b el helou found f latter properti addit z f log thu respect b logarithm condit f nearli necessari consid standard kernel estim ir product kernel x x dierent smooth factor coordin form x x j h x x j h easi see result mention abov exist densiti f a l almost x exist h efn x note result impli h h allow depend upon x varianc fn oefn xnh h easi see nh h fn xefn x probabl almost x thu fn x probabl almost x therefor one adapt smooth factor x true longer kernel estim pointwis consist densiti turn final basi b rectangl ir rotat respect possibl orient situat extrem volatil de guzman p b even dierenti characterist function bound measur set counterexampl dierenti fail includ densiti bound measur set area c special select subset nikodym set n n measur one x n exist line lx x lx x take f implic exist inconsist kernel estim rotat kind almost everi x exist smooth factor standard condit smooth orthonorm rotat matric an x kernel estim kan xx x j almost x x x thu adapt x allow adapt rotat make kernel estim potenti inconsist even bound densiti compact support remaind paper rectangl set b b weak pointwis consist multivari hilbert product kernel estim section prove main consist theorem theorem assum f densiti r f log d f r g log s margin densiti g denot dimens domain g multivari hilbert product kernel estim weakli pointwis consist almost everywher almost x probabl proof let denot space diagon matric diagon element clearli vector ir fix x ir defin flip densiti x mean x i observ particular f f bona fide densiti support posit quadrant origin x jessenmarcinkiewiczzygmund theorem lemma a have b denot interv basi ir almost x lim impli almost x lim x z dz x x x y denot rectangl q see thi note follow let b form x y diamb while vari y x mm z mb x dz littl excurs allow us studi behavior f x instead f interestingli see flip appli estim fn leav fn unalt thu show fn f almost x equival show fn x f x x almost x remaind proof requir introduct margin densiti fs f xs thu fs margin densiti f respect compon whose index s similarli f xs margin densiti f x respect compon whose index s call x jmz point after jessen marcinkiewicz zygmund lim xs sdimension vector compos compon x whose index s b collect rectangl sdimension space lemma a almost point jmz point fix x remaind proof thu find simultan ys xs r xs ys xs z dz xs xs also recal f xs lemma b let jmz point f fx let abov let random vector densiti f let d nonempti set indic let event x condit a exist iid uniform random variabl u denot stochast domin proof assum without loss gener f x f instead f xs condit a x densiti f p note furthermor f multivari distribut function condit x x jmz point therefor wellknown f x seen appli probabl integr transform condit distribut function condit decomposit f see return proof theorem remain defin earlier enlarg data consid infinit iid sequenc distribut x let by collect indic ji ji x point let let collect first n indic j by lemma b u u lemma b lemma s righthandsid probabl asymptot thu contribut j j s d asymptot neglig assum first f then take d longer aord artifici increas data size abov thu let j n by j d note binomi n p independ u s lemma b easi see righthandsid probabl asymptot np x x log similar weak lower bound obtain let obtain sought result contribut term densiti estim s on log n as seen last chain inequ well size less d thu proof theorem complet lack strong converg f true almost x fx hilbert product kernel estim cannot possibl converg f strong sens rather prove fullblown univers theorem restrict uniform densiti real line recal follow result devroy krzi zak applic hilbert product kernel estim coincid standard hilbert kernel estim theorem let f uniform densiti then x pfn x log log n strong converg point support poor rate converg estim best seen consid point outsid support f x least distanc away support f fn x cs log n constant c depend upon k d product nearest neighbor estim knearest neighbor densiti estim fix hodg loftsgaarden que senberri x kx kth nearest neighbor x among properti wellunderstood moor yackel devroy wagner mack bhattacharya mack mack rosenblatt exampl almost x g kn x fx n k knearest neighbor densiti scaleinvari rel order distanc coordin linearli scale remedi thi introduc product knearest neighbor densiti estim log d nkd permut x x accord increas valu permut invari linear transform coordin axe but rotat interestingli product estim consid except trivial case obtain standard univari kth nearest neighbor estim choic scale perpetu caus concern estim product kth nearest neighbor estim particularli use prove weak consist theorem k k k log n r f log d f r g log d g lowerdimension margin f almost x that is jmz point f lowerdimension margin f g kn x fx probabl proof theorem sketch rough outlin mimick proof theorem note first may wish consid flip densiti x fy x coordin least equal x consid small squar size coordin bottom lower vertex x show kth nearest neighbor x probabl tend one squar inde y densiti f x jmz point q approxim distribut u s iid uniform random variabl f u densiti log d zd z distribut function z log d zd z see order statist sampl size n drawn q approxim distribut f inv nf x f inv nf x forth f inv invers distribut function good approxim f inv u ud log d ud thu kth nearest neighbor valu concentr probabl d kn d concentr follow k need show probabl kth nearest neighbor squar tend one end show nearest neighbor among point coordin outsid squar coordin squar distanc alway measur q asymptot much larger d without loss gener fix first m d coordin x also jmz point margin densiti last coordin given first coordin outsid squar remain one insid and assum small enough nearest neighbor distanc asymptot order n log dm n thu improb kth nearest neighbor point coordin outsid small squar conclud sketch proof product kernel estim section consid product kernel estim defin univari kernel r k smooth factor h ni determinist sequenc product kernel estim interest oer scale invari h ni s proport scale eg make h ni proport weight sum n may introduc big dierenc h ni s fact dierenc may desir situat like one let f product two univari densiti smooth one jag one densiti one may want pick dierent smooth factor even dierent order kernel case h n h n may tend zero dierent rate densiti local product densiti as resembl uniform densiti realli import consid product kernel individu pick smooth paramet interest literatur oer littl help respect univers consist properti estim respect pointwis l converg natur condit h ni s would appear lim lim section prove two basic consist result abl find vast literatur theorem let fn product kernel estim let compon kernel k absolut integr natur condit lim f theorem let fn product kernel estim let kernel k bound compact support riemann approxim is l sens k closur space function finit weight sum indic finit interv then natur condit lim almost x provid r f log d note condit kernel satisfi kernel k continu bound compact support bit eort extend theorem includ kernel k k ox x perhap easiest proof theorem transpar one use embed devic devroy where embed use handl l consist variabl kernel estim may summar follow lemma lemma b let f g two densiti ir let densiti estim base iid sampl size n drawn f assum sup constant c then g n densiti estim base upon iid sampl size n drawn g proof consid uniform poisson point process ir let u v typic point process keep point v fu v gu t almost sure finit number point with poisson t distribut may order point accord increas valu obtain u first n valu u j yn first n valu u j v j gu j now throw away poisson point process need coupl two sampl interestingli x iid drawn f yn iid drawn g also everi i r maxf g dx r maxf g one tripl u gener common point sampl thu number common point stochast greater binomi n p random variabl number point one sampl seen sampl binomi n p random variabl expect valu exceed n may assum fn gn base coupl x j j sampl respect r f n gn cnn n appli triangl inequ n n time proof theorem first verifi lemma b appli kernel estim kernel k inde n z z n lemma b appli kernel k nonneg simpli lemma then suce prove theorem continu densiti g compact support densiti dens l space densiti inde pick g continu compact support r f g let fn g n denot product kernel estim base sampl drawn densiti f g respect appli lemma b arbitrari suce therefor prove theorem g sinc k measur absolut integr may approxim l sens sum indic function interv thu find finit number interv a ij coecient k ij l even pick r l also r l r k r k as defin constant fn g n two product kernel estim data dierent product kernel k i i i d again arbitrari natur suce consid kernel product finit sum weight indic function interv let n bound number indic compon kernel easi see then form cartesian grid interv estim equival kernel estim kernel shorthand notat rectangl ir vertic j b j j real number also r denot volum a j b j introduc notat note j bona fide kernel integr one have let fn denot kernel estim kernel l f continu densiti compact support f nj kernel estim kernel j upper bound tend zero mean individu term tend zero thu suce prove theorem kernel indic function rectangl theorem ef nj f bound f almost x domin converg conclud proof theorem proof theorem let x jmz point f let kernel proport indic bound rectangl necessarili contain origin vertic r vari coordin turn see z point ir denot volum z p let mn denot diagon matrix element h n h nd diagon lemma condit thu r k conclud efn fx rn q therefor r xmnr f rn x jmz point lemma turn gener kernel take work gener result reason big class kernel easi verifi last chain inequ condit bound kernel varfn x point x efn x fx thu theorem valid bound kernel impli efn x fx almost x find finit collect rectangl r constant sup x larg posit integ thi integr note efn last step use first part proof kernel indic rectangl sinc arbitrari proof complet treebas rectangular partit densiti estim let sequenc partit ir rectangl which open close x let x denot rectangl x belong partit estim f given lebesgu measur denot number data point fall set assum sequenc partit pick data collect present estim contain standard histogram estim inde treebas densiti estim purpos section discuss univers consist pointwis l l consist rather gener theorem aboujaoud a c theorem special case howev includ here proof short use new tool l converg dealt aboujaoud b irrelev here gener consist theorem partit estim estim partit space via order statist hanna abou jaoud via multivari rectangular partit gessaman dicult problem univers converg point view pointwis converg give theorem below theorem let fn partit densiti estim assum diaman x almost x nan x almost x lim there condit f theorem let fn partit densiti estim assum diaman x almost x nan x almost x r f log d f almost x proof let x jmz point f r fx thu lemma a theorem prove almost point fx x jmz point lemma again proof theorem simpli use result theorem bound converg inde f almost x fn bona fide determinist densiti r f see also devroy gyorfi shown may add phrase in probabl almost sure side case fn datadepend sequenc estim note condit lemma b satisfi partit estim partit depend upon data inde consid two determist sampl dier ith point let correspond partit estim call fn gn let an x an x denot cardin x sampl aan z aan a a n an n so let fn gn denot partit estim base sampl drawn densiti f g respect g densiti pick later appli lemma b point pick pick larg r f g theorem almost x egn xgx g bound e r g bound converg thu arbitrari proof complet acknowledg author thank attent refere point shortcut proof r condit necessair et susant de converg l en probabilit de lhistogramm pour une densit an approxim densiti function on l error histogram densiti estim multidimension case cambridg univers press real variabl method fourier analysi the equival weak strong complet converg l kernel densiti esti mate a note l consist variabl kernel estim the hilbert kernel regress estim on hilbert densiti estim the strong uniform consist nearest neighbor densiti estim recouvr du tore q par de ouvert aleatoir discriminatori analysi a consist nonparametr multivari densiti estim base statist equival block consist condit probabl estim integr densiti estim note dierenti multipl integr a nonparametr estim multivari densiti function asymptot normal multivari knn densiti estim multivari knearest neighbor densiti estim a counterexampl theori strong dierenti consist properti nearest neighbor densiti function esti mator on estim probabl densiti function mode the distribut first ladder moment height fluctuat random walk remark nonparametr estim densiti function on strong deriv function interv a use converg theorem probabl distribut empir process applic statist measur integr tr hilbert kernal regress estim