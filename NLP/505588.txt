t algebra approach ip traceback a present new solut problem determin path packet travers internet call traceback problem denialofservic attack articl refram traceback problem polynomi reconstruct problem use algebra techniqu code theori learn theori provid robust method transmiss reconstruct b introduct denial servic attack design prevent legitim access resourc context internet attack flood victim connect random packet prevent legitim packet get through internet denial servic attack becom preval recent due near untrac rel eas execut also avail tool stacheldraht tfn greatli simplifi task coordin hundr even thousand compromis host attack singl target attack difficult trace hint victim sourc given packet sourc address easili forg although ingress filter help prevent packet leav border network without sourc address border network attack counter choos legitim border network address random traceback problem also difficult mani attack launch compromis system find sourc attack packet may lead attack disregard problem find person respons attack victim abl determin path attack packet near realtim would much easier quickli stop attack even find partial path inform would use attack could throttl far router paper present new scheme provid traceback data router emb inform randomli packet similar techniqu use savag et al major differ scheme base algebra techniqu advantag provid scheme offer flexibl design power techniqu use filter attack gener nois separ multipl path scheme share similar backward compat increment deploy properti previou work specif scheme encod path inform point polynomi use algebra method code theori reconstruct polynomi victim appear power new approach ip traceback problem note although studi traceback mechan motiv denial servic attack applic well method might use analysi legitim traffic network exampl congest control robust rout algorithm dynam network reconfigur might benefit realtim traceback mechan rest paper organ follow section discuss relat work section contain overview problem assumpt section present approach algebra code path section give detail specif scheme section provid mathemat analysi victim reconstruct task section discuss issu encod mark data ip packet give conclus futur work relat work idea randomli encod traceback data ip packet first present savag et al propos scheme adjac router would randomli insert adjac edg inform id field packet key insight traceback data could spread across multipl packet larg number packet expect also includ distanc field allow victim determin distanc particular edg host prevent spoof edg closer nearest attack biggest disadvantag scheme combinatori explos edg identif step feasibl parameter work song perrig provid depth analysi scheme mani notabl propos ip traceback sinc origin propos bellovin propos router creat addit icmp packet traceback inform random public key infrastructur verifi sourc packet scheme also use nonauthent mode although attack easili forg part rout farther victim closest attack song perrig improv packet mark scheme cope multipl attack unfortun scheme requir victim current map upstream router attack although song perrig describ map maintain addit increment deploy requir router attack path particip although song perrig note also suffic upstream map indic router particip doeppner klein koyfman propos ad traceback inform ip option besid larg space overhead solut would caus seriou problem current router unabl process ip packet option hardwar r r r r figur exampl network also caus other issu exampl ad option may requir packet fragment burch cheswick scheme use udp packet requir particip intermedi isp scheme howev assum denial servic attack come singl sourc network differ us aim distinguish multipl attack host lee park analyz packet mark scheme gener paper contain gener tradeoff mark probabl recov path length packet receiv appli probabilist mark scheme includ one paper refer reader savag paper discuss method detect prevent ip spoof denial servic attack algebra techniqu appli origin develop field code theori machin learn overview algebra code theori refer reader survey sudan book berlekamp overview paper address savag et al call approxim traceback problem is would like recov path attack victim allow path invalid prefix exampl network shown figur true path attack victim v r r r allow techniqu also produc path form r r r r r true path suffix recov path famili algebra scheme motiv assumpt use previou work attack abl send packet multipl attack act togeth attack awar traceback scheme attack must send least thousand packet rout host gener stabl packet reorder lost router much perpacket comput router compromis router particip algebra code path present seri scheme use algebra approach encod traceback inform scheme base princip reconstruct polynomi prime field basic idea polynomi f x degre prime field gfp recov f x given f x evalu d uniqu point let bit ip address router path p associ packet id x j jth packet somehow evalu f p packet travel along path accumul result comput run total along way enough packet path reach destin f p reconstruct interpol interpol calcul might simpl set linear equa tion packet receiv destin travel path otherwis need employ sophist interpol strategi succeed even presenc incorrect data data multipl path method develop origin use code theori learn theori naiv way evalu f p w would jth router add j w n j accumul kept run total unfortun would requir router know posit path total length path could elimin need router know total length path while still requir router know posit path reorder coeffici f howev even better stick origin order use altern mean comput polynomi specif comput f p w router r j multipli amount accumul w add return result accumul pass packet next router path horner rule exampl wr wr wr wr notic router need know total length path posit path comput f p determinist path encod simplest scheme use algebra techniqu encod entir path begin path let fullpath router path calcul fullpath random valu pass packet r router ip address p smallest prime larger valu fullpath pass packet along x j next router packet destin fullpath equal r n x reconstruct solv follow matrix equat gfpb b b fullpath n fullpath n fullpath nc c c long x s distinct matrix vandermond matrix and thu full rank solvabl on field oper assum get uniqu x j packet recov path length packet downsid howev scheme would requir log bit per packet the first term encod run fullpath second term encod x j j valu even modest maximum path length space requir bit count bit record number router path bit x coordin coordin point polynomi far exce number bit avail us ip header could split router ip address c chunk add dlog ce bit indic chunk repres given packet anoth approach would router add chunk packet is router would updat fullpath c time substitut chunk ip address order destin could trivial reconstruct ip address interpol recov r r success chunk r j would increas degre f factor c would impact perform reconstruct algorithm random path encod scheme requir fullpath impli way router know first particip router particular path current internet architectur reliabl way router inform must therefor extend scheme mitig problem revis scheme router first flip weight coin came tail router would assum first router simpli follow fullpath algorithm present abov ad ip address or ip address chunk data hand coin came head router would assum first router randomli choos x j use path refer state mark mode overal approach might call reset paradigm also use savag et al traceback solut destin would receiv number differ polynomi repres suffix full path exampl network packet could contain r could chang mark strategi slightli whenev router receiv packet still flip weight coin now instead simpli go mark mode one packet coin come head router could stay mark mode next packet receiv gener reset behavior could follow markov process one problem attack caus fals path true path receiv victim due fact choic small p creat larg number packet router packet path mark mode attack thu insert path inform wish packet attack gener find path victim use tracerout exampl comput fullpath choic caus victim receiv fullpath tri reconstruct path victim indic path real path fake two solut problem increas p store hop count distanc field packet particip router would increment increas probabl make even harder receiv long path ad hop count would prevent attack forg path or suffix path closer actual distanc victim would requir dlog de bit packet scheme could also make use hmac techniqu discuss song perrig ensur edg fake would requir us either use addit space packet store hash lose increment deploy properti decid make one tradeoff scheme would compar secur multipl attack edg encod could add anoth paramet repres maximum length encod path valu set mark router decrement particip router add ip inform valu reach router add inform exampl full path encod scheme encod edg router call algebra edg encod scheme benefit chang would decreas maximum degre polynomi order reduc number packet need given set packet recov rout cost chang would add dlog bit packet cours less true path length reconstruct find arbitrari subsequ path not suffix full path encod victim still work combin subsequ properli as describ savag et al thu reconstruct scheme algebra step follow combinatori step pseudocod sampl algebra scheme section present pseudocod sampl algebra mark scheme base principl describ previou section recal router uniqu bit id algebra edg encod router pseudocod edg algebra edg encod scheme packet mark number x valu degre polynomi one mark procedur router r packet w probabl p wxval random wyval r wflag otherwis wflag wyval wyval wxval wflag edg algebra edg encod c chunk per hop packet mark dce dlogn bit degre polynomi c mark procedur router r packet w probabl p wxval random wyval rc wxvalc wflag otherwis wflag wyval wyval wxvalc wflag edg ident edg except packet also distanc field hop count follow savag et al reserv five bit distanc field packet mark dce dlogn bit degre polynomi c mark procedur router r packet w probabl p wxval random wyval rc wxvalc wflag wdist otherwis wflag wyval wyval wxvalc wflag wdist edg ident edg except second router contribut half bit router id lower degre polynomi introduc littl uncertainti reconstruct process if two router distanc victim router id agre contribut bit packet mark dce dlogn bit degre polynomi c mark procedur router r packet w probabl p wxval random wyval rc wxvalc wflag wdist otherwis wflag wyval wyval wxvalc wflag wdist algebra full path encod router pseudocod full full path encod scheme packet mark dlogn bit n number possibl x valu degre path polynomi l length path full mark procedur router r packet w probabl p wxval random wyval wyval wyval wxval router pseudocod full full path encod scheme distanc field hop count follow savag reserv five bit distanc field packet mark dlogn bit full mark procedur router r packet w probabl p wxval random wyval wdist wyval wyval wxval wdist path reconstruct victim section look close problem path reconstruct victim let k denot number attack path let l denot expect length attack path simplic assum attack path close l length main scheme savag et al which use total bit complex path reconstruct victim olk expon eight reflect combinatori task victim must tri brute forc cours room work mark scheme reconstruct complex would go down exampl use bit mark scheme and divid pad router id four bit chunk victim reconstruct task reduc olk goal design algebra scheme improv reconstruct complex savag et al two main algebra reconstruct approach consid reedsolomon list decod given polynomi degre pass least point guruswamisudan give algorithm solv problem time on n d improv olshevski shokrollahi reduc time on precis reconstruct algorithm due guruswami sudan implement number way straightforward implement would take time on recov edg receiv least dn packet howev drop on requir slightli packet dnd n scale appropri allow us trade comput time and memori accuraci recent algorithm breakthrough olshevski shokrollahi would reduc reconstruct time even further on moreov new algorithm highli paralleliz to on processor suggest distribut reconstruct task might speed thing even more noisi polynomi interplo given m find polynomi f degre f bleichenbachernguyen give algorithm solv problem whenev nd run time ident reedsolomon list decod problem give algorithm work even bound nd met type packet let us assum packet victim receiv one three possibl type true packet contain point polynomi correspond real attack path bogu packet contain point creat attack outsid peripheri never reset honest router along attack path stray packet contain point polynomi correspond normal nonattack traffic denial servic attack underway assum fraction stray packet small compar true bogu packet fals posit fals posit polynomi recov reconstruct algorithm correspond part actual attack path reedsolomon list decod expect number fals posit random sampl nmn m q noisi polynomi interpol expect number fals posit random sampl n q n main scheme savag et al expect number fals posit mark scheme distanc field must also concern bogu edg bogu path attack caus appear sam ple consid separ issu fals posit aris random moder number fals posit seriou problem consid mark scheme edg victim reconstruct set candid edg distanc set candid edg includ true edg fals posit but bogu edg attack assum attack within distanc vic tim victim attempt assembl path connect edg distanc edg distanc certainli problem unless first endpoint fals posit edg distanc match second endpoint fals posit true edg distanc let f expect number fals posit distanc let k number true edg distanc f expect fals posit distanc expect fals posit true edg distanc let number distinct router id partial router id possibl eg edg probabl accident match less m f m f k close e f f km when f close probabl unaccept high probabl accident match distanc less length longest path analyz effect approach path reconstruct approach best known algorithm impos constraint design paramet mark scheme conveni us consid separ mark scheme distanc field mark scheme not reconstruct distanc field mark scheme distanc field task victim simplifi victim select sampl packet wdist given long attack within distanc victim sampl contain true packet point polynomi last reset router distanc guruswamisudan reconstruct distanc field path reconstruct problem face victim view reedsolomon list decod problem distinct point chosen random sampl distinct point packet reach victim victim filter packet last reset distanc everi simplifi reedsolomon list decod problem creat smaller problem instanc distanc need nk packet distanc n distinct point k polynomi victim collect largest possibl sampl distinct point packet wdist everi need n n d reconstruct polynomi use guruswamisudan algorithm lastli need effici reconstruct improv savag et al least solut improv compel exampl use edg three bit chunk competit savag et al certain valu k bleichenbachernguyen reconstruct distanc field problem face victim view noisi polynomi interpol problem valu x possibl x valu set contain distinct valu occur packet within random sampl receiv packet polynomi f could polynomi correspond true attack path stray path victim could proceed follow look sampl n packet for suitabl larg n x choos set size sampl number distinct valu occur sampl greater m victim choos valu includ random victim filter packet last reset distanc everi creat smaller problem instanc distanc problem instanc number set equal n number possibl x valu size k number attack path degre polynomi d depend particular algebra encod method use fals posit k n way take one x valu set actual polynomi degre less probabl q n q size finit field essenti number distinct valu need expect number fals posit k n q n reason small basic reconstruct algorithm bleichenbachernguyen need k nd three algorithm bleichenbachernguyen work mani knd even satisfi k nd meetinthemiddl algorithm run time n dm n precomput use memori om n logq note independ k grobner basi reduct algorithm comput grobner basi reduct system k polynomi equat unknown best known grobner basi algorithm superexponenti d reason effici small eg lattic basi reduct algorithm perform lattic basi reduct dimension lattic z nk finit field size n method ineffect applic size finit field small effici savag et al need nk k interest instanti scheme respect method reconstruct exampl edg encod distinct x valu repres bit xval field bit yval field noisi polynomi problem set size k number attack path degre polynomi size finit field meetinthemiddl algorithm take time k compar favor k requir savag et al grobner basi reduct algorithm also reason effici here total size mark scheme bit howev number fals posit unaccept high here k exampl edg encod distinct x valu in bit xval field bit yval field degre polynomi run time meetinthemiddl algorithm k run time grobner basi reduct algorithm faster previou exampl expect number fals posit lower previou exampl k expect one fals posit distanc of cours risk fals posit slightli greater previou case number possibl partial router id thu slightli accident match endpoint involv bogu edg significantli wors total size mark scheme bit exampl edg encod degre polynomi use bit second router id run time meetinthemiddl k versu k savag et al number fals posit savag exampl expect posit fals posit quit manag total size mark scheme bit exampl edg encod polynomi run time meetinthemiddl k number fals posit k eg total size mark scheme bit exampl edg encod polynomi run time meetinthemiddl k number fals posit k eg quit manag total size mark scheme bit reconstruct without distanc field reconstruct mark scheme distanc field achiev scheme competit savag et al analysi begin fact simplifi assumpt distribut receiv packet victim distribut receiv packet fraction packet arriv ith attack path reach victim bogu packet let fraction packet ith attack path reach victim true packet let f fraction packet ith attack path reach victim true packet reset furthest router path assumpt encod scheme unless mark mode use f view function p fraction take maximum valu impli f encod scheme impli b fact larg fraction bogu packet arriv path seriou consequ mark scheme without distanc field let btf fraction bogu packet true packet furthest packet path victim assum arriv rate packet attack path approxim same mark mode use probabl router reset mode coupon collector bound sampl lc logc element drawn replac accord uniform distribut like contain c possibl valu small constant l guruswamisudan reconstruct without distanc field victim choos random sampl distinct point packet reach him without distanc field cannot partit packet smaller sampl last assum router use edg encod scheme assum succeed reconstruct furthest edg polynomi let us also assum search polynomi pass n distinct point n number distinct x valu actual three distinct level reconstruct success con sider a sampl n point contain least n point everi furthest edg polynomi overwhelm probabl b sampl n point contain least n point furthest edg polynomi overwhelm probabl c sampl n point contain least n point furthest edg polynomi nonneglig probabl q case a guruswamisudan algorithm need appli random sampl n point case b algorithm need appli lklogk time independ random sampl n point coupon collector problem set k furthest edg polynomi case c algorithm need appli lklogkq time independ random sampl n point case a suffic n lnklognkp p l like get complet set n possibl x valu k edg poli nomial impli lnklognk sampl suffici analysi preced subsect sampl furthest edg polynomi expect fraction packet combin guruswamisudan bound get n d lnklognkp p l assum case b suffic n nk p p l nk answer follow occup problem throw nk ball k bin expect find lnlogn ball bin ball pigeonhol principl certainli true nk lnklogn fact actual valu nk quit close thi combin guruswamisudan bound get n d lnklognp assum lnlogn dkl e case c reduc valu nk littl appear signific purpos cours a b c reduc n elimin sampl duplic point sinc mani e packet sampl could bogu packet attack remov duplic point limit benefit find solut yield mark scheme effici savag et al moreov plausibl instanti number fals posit bogu edg or bogu path unaccept high bleichenbachernguyen reconstruct without distanc field victim proceed describ start section although without distanc field packet cannot partit last reset distanc version h length type servic bit total length fragment id bit flag fragment offset time live protocol header checksum sourc ip address destin ip address figur ip header darken area repres underutil bit suppos n chosen larg enough point furthest polynomi includ high probabl probabl given includ point f least mn probabl reconstruct succe least mn n basic algorithm bleichenbach nguyen solv noisi polynomi interpol whenev nk approach seem promis k case mn n n thu reconstruct unlik succeed victim choos posit integ c probabl reconstruct succe least cn n e c un fortun either number fals posit unaccept larg success probabl unaccept small anoth approach would victim bia sampl respect frequent differ point occur packet reach him unfortun appear work well either sinc victim abl recogn true packet contain point furthest polynomi conclud mark scheme distanc field see use bleichenbachernguyen method polynomi reconstruct least use simplest algorithm possibl algorithm eg base grobner basi reduct might effect encod path data need way store traceback data ip packet tri maxim number bit avail us preserv for part backward compat ip option ip option seem like reason altern store path informa tion unfortun current router unabl handl packet option hardwar even futur router abil number problem associ approach present savag et al reason conclud store data ip option feasibl addit packet instead tri add path data exist ip packet could instead send data band use new protocol would encapsul data may limit use special case such deal ip fragment gener solut base insert addit packet requir mean authent packet becaus presum number insert packet mani order magnitud less number packet insert attack thu assum attack insert packet network victim delug fake traceback packet prevent inform gain legitim packet ip header last sourc bit ip header sever field header may exploit bit vari tradeoff shown figur found bit might possibl usedx to field type servic field bit field ip header current use allow host way give hint router kind rout import particular packet maxim throughput minim delay exampl field littl use past and limit experi found set field arbitrarili make measur differ packet deliveri propos internet standard would chang to field differenti servic field even propos ds field unus bit howev alreadi propos use bit eg id field id field field use ip permit reconstruct fragment naiv tamper field break fragment reassembl sinc less internet traffic fragment think overload field appropri indepth discuss issu relat overload found savag work unus fragment flag unus bit fragment flag field current internet standard requir zero found set bit one effect current impl mentat except receiv packet system think fragment packet still success deliv howev look system though fragment select could choos use bit id flag to field would suffic exampl given section implic use multipl field ip header simultan modest sinc lost function appear union would break due overwrit field separ impact header checksum calcul modest done hardwar use standard algorithm cours algebra mark scheme independ choic bit decis put mark data must seen condit subject chang new standard aris ipsec interoper traceback scheme ipsec consid encapsul payload esp encrypt datagram confidenti provid problem traceback scheme assum anyth surround datagram header authent header ah present issu ipv use ah content surround datagram header hash certain header field consid mutabl eg fragment offset includ hash comput unfortun mutabl field ipv header unus traceback either necessari basic ip function reus break backward compat current ip implement ipv sinc ipv nearli mani backward compat issu ipv logic place put traceback inform hopbyhop option ipv header howev scheme present still valuabl use fix number bit per packet therebi avoid gener fragment unlik case ipv set appropri bit option type field indic data option mutabl treat zero purpos authent header work best way accommod ipv bit address note due align issu one like select option length n byte n would like case conclus futur work present new algebra approach provid traceback inform ip packet approach base mathemat techniqu first develop problem relat error correct code machin learn though propos context probabilist packet mark scheme algebra approach could also appli outofpacket scheme result scheme would desir properti allow multipl router act extra packet remain small constant size mark scheme applic network manag scenario besid defens denial servic one import open problem find better instanti specif method propos particular success approach base full path trace would attract gener would interest explor resourc secur tradeoff mani parametr schemata lower bound size mark scheme would help would also interest explor use algebra geometr code mark scheme acknowledg would like thank david goldberg dan boneh valuabl discuss would also like thank dawn song adrian perrig ramarathnam venketesan glenn durfe anonym refere help comment earlier version paper r type servic internet protocol suit reconstruct algebra function mix data person commun icmp traceback messag correct algebra block code algebra code theori bleichenbach nguyen trace anonym packet approxim sourc cert coordin center denial servic attack internet protocol stacheldraht tribe flood network use router stamp identifi sourc ip packet network ingress filter defeat denial servic attack employ ip sourc address spoof improv decod reedsolomon algebraicgeometr code ip authent header ip encapsul secur payload esp art comput program effect probabilist packet mark ip traceback denial servic attack definit differenti servic field ds field ipv ipv header displac approach effici decod algebraicgeometr code numer recip fortran art scientif comput propos add explicit congest notif ecn ip practic network support ip traceback advanc authent mark scheme ip traceback provid guarante servic without per flow manag algorithm issu code theori decod reed solomon code beyond errorcorrect bound tr numer recip fortran nd ed art comput program volum rd ed decod reed solomon code beyond errorcorrect bound displac approach effici decod algebraicgeometr code provid guarante servic without per flow manag practic network support ip traceback use router stamp identifi sourc ip packet algorithm issu code theori ctr karthik lakshminarayanan daniel adkin adrian perrig ion stoica tame ip packet flood attack acm sigcomm comput commun review v n januari hikmat farhat protect tcp servic denial servic attack proceed sigcomm workshop largescal attack defens p septemb pisa itali florian p buchholz clay shield provid process origin inform aid comput forens investig journal comput secur v n p septemb david g andersen mayday distribut filter internet servic proceed th confer usenix symposium internet technolog system p march seattl wa katerina argyraki david r cheriton loos sourc rout mechan traffic polici proceed acm sigcomm workshop futur direct network architectur august portland oregon usa hain wang danlu zhang kang g shin changepoint monitor detect do attack ieee transact depend secur comput v n p octob andrey belenki nirwan ansari determinist packet mark comput network intern journal comput telecommun network v n p juli sherif khattab rami melhem daniel moss taieb znati honeypot backpropag mitig spoof distribut denialofservic attack journal parallel distribut comput v n p septemb brent water ari juel j alex halderman edward w felten new client puzzl outsourc techniqu do resist proceed th acm confer comput commun secur octob washington dc usa hassan aljifri ip traceback new denialofservic deterr ieee secur privaci v n p may zhiqiang gao nirwan ansari practic robust interdomain mark scheme ip traceback comput network intern journal comput telecommun network v n p februari christo siaterli vasili maglari one step ahead multisensor data fusion ddo detect journal comput secur v n p octob christo douligeri aikaterini mitrokotsa ddo attack defens mechan classif stateoftheart comput network intern journal comput telecommun network v n p april