t nondeterminist nonmonoton logic databas a abstractw consid paper extens datalog mechan tempor nonmonoton nondeterminist reason refer datalog show mean exampl flexibl express queri concern aggreg data cube also show iter fixpoint stabl model semant combin purpos clarifi semant datalog program support effici execut final provid concret implement strategi basi design optim techniqu tailor datalog address b introduct motiv name datalog use paper refer datalog extend mechan support limit form tempor reason mean tempor stage argument relat rang discret tempor domain style nonmonoton reason mean form stratifi negat wrt stage argument call xystratif nondeterminist reason mean nondeterminist choic construct essenti fragment ldl advoc chap reveal highli express languag applic divers area ai plan activ databas object databas semistructur inform manag web restructur data mine knowledg discoveri databas howev thorough studi semant datalog still miss provid basi sound effici implement optim techniqu preliminari studi semant datalog sketch discuss relat declar modeltheoret semant fixpoint bottomup semant discuss howev inform moreov fail achiev precis coincid two semant arbitrari program found therefor motiv indepth studi semant datalog program also explain reason miss coincid semant propos gener condit ensur coincid object contribut paper aim illustr express flexibl datalog queri languag provid declar semant datalog integr tem poral nonmonoton nondeterminist mechan justifi adopt iter fixpoint semant languag provid basi queri optim datalog thu make viabl effici implement purpos proceed follow use datalog queri languag discuss section natur pure declar semant datalog assign use notion stabl model section construct semant assign use iter procedur exploit stratif induc progress tempor argument main result paper show two semant equiva lent provid natur syntact restrict fulfil impos disciplin use tempor argument within choic construct basi result introduc section concret oper semant use relat algebra oper and section repertoir optim techniqu especi tailor datalog particular discuss possibl support effici historyinsensit tempor reason mean real sideeffect iter comput materi section base result present compact form materi section new conclus paper provid thorough account pragmat semant implement datalog relat work nondetermin introduc deduct databas mean choic construct origin propos later revis refin studi expos close relationship connect nonmonoton reason nondeterminist construct lead definit stabl model semant choic declar semant choic base stabl model semant intract gener choic amen effici implement actual support logic databas languag ldl evolut ldl side stratif crucial notion introduct nonmonoton reason deduct databas origin idea static stratif base predic depend stratifi negat refin deal dynam notion case local stratifi program modularli stratifi program dynam local stratif close connect tempor reason progress time point yield obviou stratif programsconsid instanc therefor natur non monoton tempor reason combin sever deduct databas languag howev strike mismatch appar two line nondetermin lead multipl stabl model wherea stratif lead uniqu perfect model far comprehens studi address combin two line occur datalog requir develop non determinist iter fixpoint proce dure notic howev mention except approach problem sketch refer local stratifi program augment choic present paper present instead thorough treatment program repair inconveni approach concern incomplet iter fixpoint procedur preliminari assum reader familiar concept relat databas datalog languag variou extens consid paper datalog languag unrestrict use negat bodi rule subset datalog consist predicatestratifi pro gram sens languag introduc predic may design argument call stage argument rang natur number where natur number n repres term n nil languag datalog unrestrict use negat rule bodi datalog subset negat use disciplin manner accord mechan xystratif nondeterminist choic introduc next section queri answer datalog datalog basi deduct databas essenti friendli syntax express relat queri extend queri facil relat calculu recurs datalog simplic express complex queri impact databas technolog nowaday recurs queriesview becom part sql standard recurs queri find natur applic area inform system comput transit closur travers issu billofmateri queri rout plan format graph travers on howev wide recogn express datalog recur sive rule limit sever extens along variou direct propos paper address particular two direct name nondeterminist nonmonoton reason support respect choic construct notion xystratif introduc mechan mean exampl meant point enhanc queri capabl nondeterminist choic choic construct use nondeterminist select subset answer queri obey specifi fd constraint instanc rule st adst ad majorst area facultyad area choicest ad assign student uniqu arbitrari advisor area sinc choic goal constrain st ad relat obey fd st ad there fore base relat major form tupl fsmith db gray seg base relat faculti form tupl fbrown db scott db miller seg two possibl outcom queri st adstad either fsmith brown gray millerg fsmith scott gray millerg practic system ldl one two solut comput present result thu first use choic comput nondeterminist nonrecurs queri howev choic combin recurs follow rule comput arbitrari order given relat r root fresh constant conveni use simplifi program base relat r form k tupl k possibl outcom queri ord rx y name set ford rroot root ord rroot permut ft g tupl r therefor possibl outcom mention queri relat ord r total order tupl r doubl choic constraint recurs rule specifi successor predecessor tupl r uniqu interestingli choic employ comput new determinist queri inexpress datalog well pure relat calculu remark exampl capabl express aggreg follow program comput summat aggreg relat r use arbitrari order r comput ord r sum rroot sum ry n sum rx m ord rx y total sum rn sum rx n ord rx here sum rxn use accumul n summat x respect order given ord r therefor total sum reconstruct sum rx n x last tupl order notic use stratifi negat purpos select last tupl practic languag ldl syntact sugar aggreg use abbrevi program total sum rsum x rx basi simpl exampl sophist form aggreg datacub olap function built exampl consid relat salesd depart sale problem aggreg sale along dimens date depart three aggreg pattern possibl correspond variou facet datacub date depart former two pattern correspond aggreg sale along singl dimens respect depart date obtain origin relat appli method shown abov latter pattern then obtain recurs appli method one two pattern previous comput order aggreg along remain dimens case sever dimens along aggreg simpli repeat process aggreg step along new ie still nonaggreg dimens thorough account program nondetermin deduct databas found semant choic assign use socal stabl model semant datalog program concept origin autoepistem logic appli studi negat horn claus languag gelfond lifschitz defin notion stabl model need introduc transform h which given interpret map datalog program p posit datalog program hp i next defin then said stabl model p sp gener datalog program may zero one mani stabl model multipl stabl model exploit give declar account nondetermin fact defin stabl version program given datalog program p stabl version defin program obtain p replac refer choic atom rule r h b choicex y x disjunct vector variabl appear also b atom chosen r x y chosen r predic defin follow rule chosen r diffchoic r definit fix valu x choic inhibit possibl one via diffchoic r stabl model sv p onli one them notic that construct occurr choic atom pair chosen diffchoic atom thu bound scope atom rule appear in variou stabl model transform program sv p thu correspond choic model origin program xyprogram anoth notion use paper xyprogram origin introduc languag program admit negat bodi atom unari constructor symbol use repres tempor argument usual call stage argument gener definit xyprogram follow xystratif set p rule defin mutual recurs predic xyprogram satisfi follow condit recurs predic distinguish stage argument everi recurs rule r either xrule yrule where r xrule stage argument everi recurs predic r variabl r yrule i head r stage argument sj j variabl ii goal r j stage argument iii remain recurs goal either j sj stage argument intuit rule xyprogram atom pj denot extens relat p current stage present time j wherea atom psj denot extens relat p next stage futur time sj use differ prime predic symbol p psj atom obtain socal prime version xyprogram say xyprogram xystratifi prime version stratifi program intuit depend graph prime version cycl negat edg possibl obtain order origin rule modulo stage eas present includ definit sv p case one choic atom per rule definit gener case found argument consequ xystratifi program also local stratifi therefor uniqu stabl model coincid perfect model let p xystratifi program then defin p stage argument head rg here rxi stand r replac x ie p set rule instanc p defin predic stage argument iter fixpoint procedur comput uniqu minim model p defin follow comput minim model p j comput j minim model notic j p j stratifi definit henc perfect model j comput via iter fixpoint procedur paper use name datalog refer languag xy program augment choic goal semant choic construct allow xyprogram multipl stabl model exist given program therefor need clarifi phenomenon combin iter fixpoint semant choicefre xyprogram task accomplish three step first present gener result state that whenev datalog program p stratifi hierarchi recurs cliqu ie minim set mutual recurs rule stabl model entir program p reconstruct iter construct approxim stabl model associ cliqu second observ that syntact restrict use choic construct compromis express datalog program natur stratifi hierarchi recurs cliqu use tempor argument recurs predic third observ appli gener result program thu obtain stabl model entir program comput iter fixpoint procedur follow stratif induc tempor argument given possibl infinit program p consid possibl infinit topolog sort distinct recurs cliqu q oe induc depend relat predic p given interpret use notat denot subset atom whose predic symbol predic defin cliqu q follow observ straightforward analog predic defin q i depend definit consequ interpret q i ignor next definit show transform recurs cliqu within given topolog order selfcontain program take account inform deduc previou cliqu transform resembl gelfondlifschitz transform report sect definit consid program p topolog sort recurs cliqu interpret defin defin q defin q ut idea underli transform remov cliqu q depend induc predic defin lower cliqu abbrevi q redi q red interpret clear context exampl consid program recurs cliqu rg now consid interpret fs q rg q red red follow lemma state relat model transform cliqu model program abbrevi i analog q i lemma given possibl infinit datalog program p interpret topolog sort p induc depend relat p follow statement equival sp q red q i proof sketch proof structur follow next show a sp i b sp i a rule hp i come rule r p turn appear q i i i model r hypothesi atom n i appear r also model r model hp i henc sp i b i i by hypothesi definit sp moreov readili check observ minfi j impli i g proceed induct i base case trivial induct case next show a q i i i i b vice versa a notic induct hypothesi i suffic show i by simpl case analysi b exploit induct hypothesi igamma q igamma by definit hp i show induct n n n red base case induct case n n red exist rule b red red now definit h q red exist rule q fc e l observ definit h b furthermor induct hypothesi igamma follow fb henc definit q i i i complet innermost induct obtain proceed way similar preced case see suffic verifi rule instanc r head a follow properti hold n n red convers simpli observ model q red result state arbitrari datalog program stabl model approxim cliqu accord given topolog sort local stabl model result give us intuit idea comput stabl model approxim program mean comput stabl model approxim cliqu notic lemma hold arbitrari program provid stratif hierarchi cliqu given sens result wide applic variou notion stratifi program modularli stratifi program requir cliqu q red local stratifi contrari requir cliqu is sens stratifi motiv object deal non determin justifi adopt nondeterminist stabl model semant rather determinist semant stratifi datalog program as instanc perfect model semant turn attent xyprogram result instanti claus xyprogram p possibl valu natur number stage argument yield new program sgp for stage ground precis rule stage argument rg stabl model p sgp close relat lemma let p xyprogram then interpret i proof sketch show induct nt n impli thesi base case trivial induct case observ sinc p xystratifi n hpi b i fb hsgp i vice versa n fb hpi a i ut howev depend graph sgp which obvious p induc necessarili topolog sort gener xyprogram predicatestratifi therefor lemma directli applic tackl problem distinguish predic symbol p program fragment p predic symbol fragment p j j i differenti predic symbol use tempor argument therefor pi x atom involv rule p modifi version p x precis introduc xyprogram p modifi version sop for stageout defin sop obtain program fragment p sgp extract stage argument atom ad predic symbol atom similarli modifi version soi interpret defin therefor atom pi x iff atom p x soi valu stage argument posit relat p unsurprisingli stabl model sgp sop close relat lemma let p xyprogram then interpret i proof sketch easi see sosgp henc least herbrand model sohsgp i hsop soi coincid ut aim conclud that given topolog sort sop hypothesi lemma recal that cliqu sop consist rule sop stage argument head b lemma interpret stabl model p iff construct where stabl model sop redi i ie cliqu sop reduc substitut atom deduc stage earlier i basi b abov possibl defin iter procedur construct arbitrari stabl model p union interpret defin follow iter stabl model procedur base case stabl model bottom cliqu sop induct case stabl model sop redm i ie cliqu sop reduc respect interpret call iter stabl model p observ construct close procedur call iter choic fixpoint also follow approach local stabl model turn effici construct nondeterminist fixpoint comput polynomi time unfortun desir result notion stabl model iter stabl model coincid hold full gener sens iter procedur complet arbitrari datalog program give rise inconveni mention introduct fact demonstr exampl below undisciplin use choic datalog program may caus presenc stabl model cannot comput increment hierarchi cliqu exampl consid follow simpl stabl version sv p p rule defin predic p replac by chosenx qi x diffchoicex gener sop compos one cliqu express replac sop howev eas present ignor it sinc gener case trivial deduc follow readili check sv p admit two stabl model name fq a first model iter stabl model therefor second model cannot comput use iter choic fixpoint ut technic reason problem free use choic construct inhibit possibl defin topolog sort sop base valu stage argument exampl predic depend relat depend among stage stage j i depend chosen predic predic q stage prevent problem suffic requir choic goal refer stage argument domain associ function depend program compli constraint call choicesaf follow way turn program exampl choicesaf program with differ semant syntact restrict moreov greatli compromis express queri languag possibl simul within restrict gener use choic see consider summar follow main result paper which mention restrict choicesafeti direct consequ lemma theorem correct complet iter stabl model procedur let p choicesaf datalog program interpret stabl model sv p iff iter stabl model p ut follow exampl show comput iter stabl model procedur exampl consid follow datalog version semina pro gram discuss nondeterminist comput maxim path node graph g assum graph given eig follow interpret carri stage iter stabl model procedur ag bg cg dg b theorem conclud two stabl model program clearli realist implement provid ldl comput non determinist one possibl stabl model ut oper semant translat iter stabl model procedur concret form use relat algebra oper control construct follow style associ predic p relat p name capit elementari deduct step tq i translat assign appropri relat tq i ie relat defin cliqu q togeth extension relat evalp rel denot notat singl evalu step rule predic p respect current extens relat rel show translat datalog cliqu increment three step start simpl datalog program stratifi negat introduc choic construct eventu describ translat full languag translat whole program trivial obtain gather singl translat cliqu natur order stratifi negat appli straightforwardli transform given safe stratifi datalog program neg liter refer previous comput extension relat translat complement relat wrt univers constant translat templat p defin repeat p defin q last p defin q last p translat illustr follow exampl program translat follow naiv evalu procedur eval instanc appropri ra queri repeat last last last p ad choic need translat relat algebra term oper compos nondeterminist comput follow approach partit rule sv q the stabl version q three set chosen rule diffchoic rule ie remain rule now nondeterminist fixpoint procedur comput stabl model choic program repres follow translat templat init p defin sv satur repeat p defin last p p p defin last gather choic chosen r defin c chosen termin test chosen r defin c chosen choic execut fairli follow a choos chosen b choos chosen r inhibit choic diffchoic r defin diffchoic r evaldiffchoic r step procedur tri deriv possibl atom alreadi given choic none first iter step collect candid atom chosen later atom ie reach fixpoint evalu nondeterminist choos one step propag effect choic step order forc fd impli readi repeat process exampl stabl version studentsadvisor exampl seen section follow st adst ad majorst area facultyad area chosenst ad follow translat schema then obtain follow procedur st ad chosen diffchoic st ad stad majorst area f acultyad area chosenst chosen stad majorst area f acultyad area diffchoicest ad chosen c chosen chosen f st ad g diffchoic diffchoic st g theta f ad g notic step slightli modifi i step sim plifi sinc rule recurs modulo chosen predic ii one choic rule step becom useless ignor iii step rewritten brief readabl form exactli mean shown gener schema ad xystratif analyz evalu procedur xy cliqu q easi see step n atom deriv form stage argument syntact form rule ensur rule refer atom then stage argument rule serv distinguish liter comput actual stage comput previou stage gamma therefor safe omit stage argument xyrecurs predic renam liter refer previou stage ie stage insid rule head stage ad prefix old appli exitrul stage argument valu signific must preserv denot q result rule p predic obtain p exampl program q translat new program suffic store extern regist j valu stage evalu i fire exitrul stage argument j ii evalu new rule q which stratifi possibl choic describ last two section complet evalu actual stage need store newli deriv atom p correspond old p increment j repeat process order evalu next stage result procedur follow translat templat init defin q fire exit rule exitrul fire q translat follow translat templat updat relat defin q j j simpli reduc evalu xycliqu iter evalu stage instanc step sequenti ascend order step stage instanc stratifi modulo choic broken subcliqu step translat templat if choicefre templat if choic result relat step easili obtain collect stage j relat p translat correspond p ie ad stage argument j exampl let g extension predic repres edg graph consid follow cliqu q correspond transform cliqu q is partit into exitrul r subcliqu q subcliqu g appli translat templat obtain j old old old old j j notic step b simplifi wrt translat templat q recurs iter cycl useless inde would reach satur first step exit second one optim datalog queri systemat studi queri optim techniqu realiz basi concret implement iter stabl model procedur discuss previou section sketch repertoir ad hoc optim exploit particular syntact structur program queri way use tempor argument first all observ comput translat templat never termin obviou termin condit check relat comput two consecut stage empti purpos translat templat modifi insert follow instruct step p defin q gener termin condit applic determinist cliqu assumpt extern call predic cliqu specifi particular stage ie extern call form case termin condit simplifi follow p defin q forgetfulfixpoint comput mani applic eg model updat activ rule queri issu refer final stage which repres commit state databas queri often exhibit form intend mean find valu x p final state p impli i comput next stage forget preced state last one see ii stage pi x psi uniqu quit comput process queri satisfi instanc program exampl queri deltai x deltasi comput leaf node maxim depth breadthfirst visit graph root a purpos evalu queri suffic i keep track last comput stage onli ii exit current delta empti code program exampl optim by i replac step old old ie drop instruct record previou stage ii insert step instruct old anoth interest case occur answer queri distribut along stage eg interest answer queri ignor stage argument case collect partial answer via gather predic defin copyrul instanc predic exampl collect node reachabl a queri alli x allsi amen describ optim equival queri delta x contrari allow it there fore possibl modifi program copyrul predic appli systemat space optim forgetfulfixpoint deltafixpoint comput alreadi mention presenc copi rule exampl effect copi tupl stage next one ani avoid useless space occup maintain stage modif appli origin relat order obtain actual version exampl rule repres modif all henc effect inde suffic keep track addit origin databas request rule realiz supplementari relat contain stage new tupl produc case replac copyrul deleterul form need simpli keep track neg contribut due liter qx store relat gamma obtain integr j method particularli effect larg relat illustr point let us assum program exampl modifi ad new exit rule relat all r extension predic result code follow j old old old old j j way avoid construct relat all ie replic relat r stage fact reconstruct fli need step a sideeffect comput direct combin previou two techniqu give rise form sideeffect comput let us consid ex ampl nondeterminist order array perform swap step two element violat order here array repres relat extens a ar stage nondeterminist select unord pair x element delet array atom ari p x ari p y ap pear add new atom arsi p y arsi p x repres swap pair queri allow forgetfulfixpoint comput in particular stage select queri uniqu definit predic ar compos deleterul addrul mean step i forget previous comput stage but last ii avoid copi relat ar keep track delet addit per form request updat immedi perform execut propos program then boil effici iter comput follow nondeterminist pascallik program ai conclus work report paper concern fixpointoper semant optim logic databas languag non determinist nonmonoton reason constitut start point actual implement sy tem project current progress basi ldl system develop ucla plan incorpor propos optim ldl compil purpos evalu effect propos optim realist ldl program ie whether yield better perform not evalu applic propos optim realist ldl program ie often appli experi integr propos optim classic optim techniqu magicset r toward theori declar knowledg classificationbas methodolog plan audit strategi fraud detect logic total partial order plan deduct databas approach tempor deduct databas stabl model semant logic program program non determin deduct databas queri answer non determinist non monoton logic databas deduct data model repres queri semistructur data experi logicbas knowledg discoveri support environ semant express power non determinist construct deduct databas effect semant tempor integr deduct induct mine supermarket sale data el program effici evalu nonstratifi program transform el logic framework activ rule nondetermin xystratif deduct databas in italian logic languag data knowledg base everi logic program natur stratif iter fix point model modular stratif magic set datalog program negat stabl model nondetermin logic program negat principl databas knowledgebas system activ databas rule transact consciou stabl model se mantic negat aggreg recurs rule ldl tr ctr christo nomiko pano rondogianni manoli gergatsouli tempor stratif test linear branchingtim deduct databas theoret comput scienc v n p septemb fosca giannotti giusepp manco franco turini specifi mine algorithm iter userdefin aggreg ieee transact knowledg data engin v n p octob