t design implement effici messag schedul control area network a abstractth control area network can wide use realtim control applic automobil aircraft autom factori paper present mix traffic schedul mt can provid higher schedul fixedprior scheme like deadlinemonoton dm incur less overhead dynam earliestdeadlin ed schedul also describ mt implement exist network adapt motorola toucan previou work shown mt far superior dm schedul perform paper present implement overhead measur show process need support mt consum percent cpu time consid schedul advantag make mt ideal use control applic b introduct distribut realtim system use increasingli control applic automobil aircraft robot process control system consist multipl comput node sensor actuat interconnect lan multipl lan protocol avail use includ map ttp etc control area network can gain widespread accept industri control network must carri period sporad realtim messag well nonrealtim messag messag must properli schedul network realtim messag meet deadlin coexist nonrealtim messag we limit scope paper schedul messag whose characterist like deadlin period known priori previou work regard schedul messag includ focus fixedprior schedul shin work report paper support part nsf grant mip ddm onr grant n opinion find conclus recommend author necessarili reflect view fund agenc sof data crc ack eof sof start frame crc cyclic redund code eof end frame figur variou field data frame consid earliestdeadlin ed schedul consid high overhead make ed impract can paper present schedul scheme call mix traffic schedul mt increas schedul util perform better fixedprior scheme incur less overhead ed paper goe beyond work present remov ideal assumpt made previou work also describ mt implement exist network adapt address problem control prioriti invers lowprior messag transmit ahead higherprior one within network adapt evalu differ solut problem measur variou execut overhead associ mt implement motorola processor emerald realtim oper system emerald os design use distribut embed control applic mtss implement use emerald provid basic os function interrupt handl context switch use emul network devic anoth act network adapt connect main node vme bu present detail measur execut interrupt handl task schedul context switch overhead associ mt show feasibl use mt control applic next section give overview protocol section describ variou type messag target applic workload includ realtim nonrealtim messag section give mt algorithm section discuss issu relat implement mt focus prioriti invers problem section present implement overhead measur paper conclud section control area network can specif defin physic data link layer layer isoosi refer model frame seven field shown figur concern data length dl identifi id field dl field bit wide specifi number data byte data field id field two length standard format bit wherea extend format bit control bu arbitr messag address interest former describ next make use wiredor or wiredand bu connect node in rest paper assum wiredor bu processor send messag first calcul messag id may base prioriti messag id messag must uniqu processor pass messag associ id bu interfac chip chip wait till bu idl write id bu one bit time start signific bit write bit chip wait long enough signal propag along bu read bu chip written read mean anoth node messag higher prioriti so node drop content end one winner use bu thought distribut comparison id messag differ node messag highest id select transmiss workload characterist control applic devic exchang period messag such motor drive use industri applic other eventdriven such smart sensor moreov oper may need statu inform variou devic thu gener messag time con straint so classifi messag three broad categori harddeadlin period messag harddeadlin sporad messag nonrealtim besteffort aperiod messag period messag multipl invoc one period apart note whenev use term messag stream refer period refer invoc period sporad messag minimum interarriv time mit invoc nonrealtim messag complet aperiod deadlin constraint lowspe vs highspe realtim messag messag realtim control system wide rang deadlin exampl messag control highspe drive may deadlin hundr microsecond hand messag devic temperatur sensor deadlin second physic properti measur temperatur chang slowli thu classifi realtim messag two class highspe lowspe depend tight deadlin clear section reason classif number bit requir repres deadlin messag note highspe rel term rel tightest deadlin workload messag order magnitud deadlin or within one order magnitud differ consid highspe messag other lowspe mix traffic schedul fixedprior deadlin monoton dm schedul use set messag id uniqu prioriti howev gener fixedprior scheme give lower util scheme nonpreempt earliestdeadlin ed sever reaserch use ed network schedul motiv us use ed schedul messag can mean messag id must contain messag deadlin actual logic invers deadlin bu time progress absolut deadlin valu get larger larger eventu overflow id problem solv use type wraparound scheme which present section even then pute deadlin id forc one use extend format bit id compar standard format bit id wast bandwidth negat benefit obtain go fixedprior dynamicprior schedul make ed impract can section present mt schedul combin ed fixedprior schedul overcom problem ed time epoch alreadi mention use deadlin id necessit type wraparound scheme use simpl scheme express messag deadlin rel period increas refer call start epoch soe time two consecut soe call length epoch then deadlin field messag logic invers absolut deadlin messag current time it assum node synchron clock mt idea behind mt use ed highspe messag dm lowspe one first give highspe messag prioriti lowspe nonrealtim one set signific bit id highspe messag figur a protect highspe messag type traffic uniqu field bit allow highspe messag prioriti field bit remain bit still enough encod deadlin rel latest soe solut quantiz time region encod deadlin accord region fall in distinguish messag whose deadlin fall region use dmprioriti messag uniqu code make mt hierarch schedul top level ed deadlin two messag distinguish quantiz one earlier deadlin higher prioriti nonpreempt schedul releas time constraint nphard strong sens howev zhao ramamritham show ed perform better simpl heurist deadlin dm prioritydm prioriti fix prioriti a b c figur structur id mt part a c show id highspe lowspe nonrealtim messag respect soel end epoch figur quantiz deadlin rel start epoch lower level dm messag deadlin region schedul dm prioriti calcul length region l r l longest rel deadlin highspe messag width deadlin field bit case clear figur shown worstcas situat occur messag deadlin max releas end epoch absolut deadlin lie d max beyond current soe deadlin field must encod time span use bit lead express l r use dm schedul lowspe messag fixedprior schedul nonrealtim one latter assign prioriti arbitrarili id messag shown figur b c respect secondmost signific bit give lowspe messag higher prioriti non realtim one scheme allow differ highspe messag period sporad lowspe messag period sporad nonrealtim messag suffici applic id updat protocol id highspe messag updat everi soe note id updat differ node coincid almost exactli prioriti invers occur id lowprior messag updat highprior one then small window time lowprior messag consecut zero six signific bit id mean code nonrealtim messag illeg leav gamma code higher prioriti id highprior messag avoid problem must use agreement protocol trigger id updat node clock synchron algorithm synchron clock within s simpl agreement protocol one node design broadcast messag bu messag receiv node time becaus natur bu upon receiv special messag node updat id local messag protocol two disadvantag first all much bandwidth wast transmit extra messag everi second moreov separ protocol must run elect new leader case old leader fail instead use follow protocol robust also consum less bandwidth node period timer fire everi second time node take follow action set flag inform devic driver id updat protocol begun configur network adapt receiv messag ie enter promiscu mode adjust receiv filter increment data length dl field highestprior readi messag node first incrementeddl messag sent bu serv signal node updat id messag origin dl messag less increment dl result transmiss one extra data byte devic driver receiv node strip extra byte forward messag applic describ later dl alreadi adapt allow bit dl field set or higher data byte transmit now node start receiv messag transmit bu devic driver node tabl list id messag stream system along data length messag arriv devic driver compar dl field valu tabl find messag increment dl field node receiv messag time take follow action restor receiv filter reenabl messag filter na local messag whose dl field increment period timer transmit yet decrement dl field back origin valu updat messag id reflect new soe node receiv incrementeddl messag time id updat node start time first incrementeddl messag complet nexthighestprior messag begin transmiss long node complet id updat messag complet a window least s sinc messag contain least one data byte messag updat id time next bu arbitr round begin prioriti invers occur case one node slow cannot complet id updat within window time node configur updat n th messag first incrementeddl messag transmiss n small number larg enough allow slowest node calcul new id write na n th messag transmiss protocol incur network overhead bit everi second compar bit per epoch simpl leaderbas agreement protocol recept first incrementeddl messag caus devic driver set dl field local messag back origin valu complet next transmiss also increment dl field alreadi start two messag extra data bit worstcas lead bit overhead cpu side period process incur overhead moreov network adapt filter disabl devic driver must process two messag may may meant node devic driver must perform filter softwar discard messag meant node measur variou cpu overhead section implement section present scheme implement mt motorola toucan modul featur messag buffer intern arbitr transmiss buffer base messag id such toucan repres modern na follow present brief descript toucan problem face implement realtim schedul can solut problem mt motorola toucan toucan modul develop motorola onchip inclus variou microcontrol toucan lie chip cpu interconnect cpu and onchip modul motorola intermodul bu motorola current market mc microcontrol incorpor toucan cpu core toucan messag buffer buffer configur either transmit receiv messag one buffer valid messag wait transmiss toucan pick buffer highestprior id contend bu id respect toucan differ older network adapt intel arbitr buffer use fixedprior daisychain scheme forc host cpu sort messag accord prioriti place network adapt buffer one main reason pick toucan implement mt time toucan avail mc microcontrol implement mt within emerald toucan would first port emerald mc microcontrol avoid thi instead use devic emul generalpurpos microcontrol made emul network adapt emul interfac host cpu io bu emul present host cpu interfac actual network adapt would emul receiv command host cpu perform correspond action produc result actual network adapt would thu provid accur measur variou overhead interrupt handl messag queu host cpu use board emul toucan modul connect host cpu anoth vme bu mt implement mt can goal minim averag overhead suffer host node transmit messag overhead follow compon queuingbuff messag softwar network adapt buffer unavail transfer messag network adapt handl interrupt relat messag transmiss can prioriti invers unbound adapt buffer contain lowprior messag messag sent long higherprior messag anywher els network con sequent highprior messag stay block softwar indetermin period time caus miss deadlin prioriti invers problem network schedul implement regardless schedul polici dm mt implement ensur adapt buffer alway contain highestprior messag lowerprior messag queu softwar suppos b buffer alloc messag transmiss usual b twothird total number buffer see section total number outgo messag stream b less mtss implement straightforward assign one buffer stream whenev devic driver receiv messag transmiss simpli copi messag buffer reserv stream case buffer need within devic driver also mean need adapt gener interrupt upon complet messag transmiss lead lowestposs host cpu overhead number messag stream exce b messag buffer softwar reduc host cpu overhead want buffer fewest possibl messag avoid prioriti invers mt treat lowspe highspe messag differ schedul purpos treat messag differ implement purpos well goal keep overhead frequent messag those belong highspe period stream low possibl get low averag permessag overhead implement number period highspe messag stream nhp adapt must program gener interrupt messag queu softwar wait adapt buffer becom avail case here less b reserv nhp buffer highspe period stream treat no buffer softwar remain buffer use highspe sporad lowspe nonrealtim messag messag arriv devic driver transmiss insert prioriti sort queue avoid prioriti invers devic driver must ensur l buffer alway contain l messag head queue so newlyarriv messag prioriti higher lowestprior messag buffer preempt messag overwrit it preemption increas cpu overhead necessari avoid prioriti invers preempt messag stay devic driver queue eventu transmit accord prioriti among l buffer buffer contain th lowest prioriti messag configur trigger interrupt upon messag transmiss i defin later interrupt use refil buffer queu messag must larg enough ensur bu becom idl interrupt handl buffer refil usual enough which keep bu busi s minimum note put restrict l must greater i make l less equal lead bu becom idl isr execut make buffer avail highspe period messag use lowspe messag make small portion workload highspe sporad messag either nonexist few nhp b must queue even highspe period messag softwar singl prioritysort queue outgo messag b buffer fill queue stream dedic buffer cpu overhead calcul messag id transfer messag data id network adapt note messag data copi directli user space network adapt keep overhead minimum messag queu softwar extra overhead insert messag queue includ copi fewer byte messag data user space devic driver space insert queue plu overhead handl interrupt gener upon messag transmiss interrupt overhead incur everi messag transmiss q number buffer fill queue q b l depend whether highspe period messag buffer not also messag potenti preempt one messag preempt messag alreadi copi network adapt copi again preemption overhead equival overhead transfer messag network adapt tabl summar overhead variou type messag measur overhead section note dm schedul also incur similar overhead differ id messag stream dm fix new id calcul time that implement dm toucan differ implement mt messag type overhead queu calcul id copi na queu calcul id insert prioriti queue copi na tabl summari overhead mtss implement toucan result schedul mt compar dm ed evalu publish here present measur variou mt implement overhead impact mt schedul overhead measur implement mt mhz motorola no cach emerald rto tabl data see highspe messag dedic network adapt buffer incur overhead transfer na oper overhead s calcul id highspe messag insert prioriti queue includ copi devic driver memori transfer messag na data byte preempt messag handl dequeu transmit messag miscellan paramet pass etc tabl cpu overhead variou oper involv implement mt highspe period messag queu averag permessag overhead depend number buffer use transmiss q toucan buffer these usual use messag recept id configur receiv variou messag stream need node leav buffer messag transmiss then worstcas scenario messag transmiss incur averag overhead assum calcul queu worstcas l q total number messag stream use queue lowspe non realtim messag fix id incur overhead lowspe highspe messag share queue highspe messag use dedic buffer smaller lowspe messag assum buffer avail lowspe nonrealtim messag incur overhead l q smsg highspe sporad messag overhead l q smsg number see certain node highspe period stream highspe stream lowspe nonrealtim messag highspe period messag make outgo traffic highspe sporadiclowspeednonrealtim messag averag permessag overhead come overhead significantli higher number highspe period stream larg enough highspe messag queu case permessag overhead twice much overhead highspe period stream dedic buffer fortun realtim control applic task per node the wellknown avion task workload accept typifi realtim control applic exampl task send internod messag typic send messag per task indic applic dedic buffer avail highspe messag stream result low permessag overhead s rang use simpl link list sort messag prioriti queue work well small number messag typic need queue larger number messag sort heap give lower overhead note overhead applic dm well differ dm id calcul permessag overhead s less mt id readjust end epoch tabl list cpu overhead incur id updat protocol overhead period task includ context switch cpu schedul overhead one context switch occur task wake anoth task block includ overhead measur oper overhead s period task devic driver interrupt messag arriv read messag na data byte softwar filter dl lookup id updat per messag tabl cpu overhead variou oper involv updat messag id id updat devic driver receiv two messag each incur overhead includ context switch overhead receiv first messag id highspe messag updat assum id messag need updat total overhead per epoch becom s ms id updat take cpu time motiv us increas increas increas level quantiz deadlin result reduc schedul highspe messag hand network overhead associ id updat bit per epoch decreas lead increas schedul bit per epoch consum network bandwidth mb bu impact network schedul due block effect much higher measur show extra overhead percentag point fewer workload feasibl mt for workload util without overhead such increas result sizeabl improv schedul due reduc id updat overhead offset loss schedul due coarser quantiz figur show effect increas schedul data point gener workload measur percentag found feasibl mt use schedul condit workload highspe period stream highspe sporad stream lowspe period stream lowspe sporad stream deadlin highspe messag set randomli ms rang lowspe messag set randomli ms period period messag calcul ad small random valu deadlin mit sporad stream set for lowspe highspe sporad stream differ data point obtain vari number highspe period stream lead variat workload util roughli rang result includ overhead result extra bit per epoch id updat figur show doubl ms ms network schedul actual improv slightli two highspe sporad stream workload six sporad stream use loss schedul coarser quantiz gain reduc id updat overhead percentag point fewer workload feasibl result show lighttomoder highspe sporad load increas ms continu give good perform even heavi highspe sporad load ms result slight degrad perform increas ms id updat cpu overhead reduc cpu time wherea becom cpu time conclus standard messag frame format bit id field fixedprior schedul such dm use can bit go unus idea behind mt use extra bit enhanc network schedul mt place quantiz form messag deadlin extra bit use dmprioriti messag remain bit enhanc schedul frequent messag system highspe messag mt abl feasibl schedul workload dm util percent feasibl workload lm lm lm lm figur impact chang mt schedul sinc messag id base deadlin must period updat present protocol perform updat without prioriti invers protocol consum cpu time consid larg improv network schedul mt display dm extra overhead justifi also present scheme implement mt toucan network adapt repres modern network adapt biggest challeng implement schedul be mt dm control prioriti invers within network adapt show can characterist short messag size preemption messag adapt newlyarriv higherprior outgo messag effect method avoid prioriti invers futur avenu research studi messag recept issu tri reduc averag permessag recept overhead unlik messag transmiss messag recept depend network schedul polici dm mt use messag recept overhead reduc optim interrupt handl use poll instead interrupt detect messag arriv use combin interrupt poll r nonpreempt schedul messag control area network realtim control applic schedul messag control area network realtim cim applic smart network control ttp protocol faulttoler realtim system road vehicl interchang digit inform control area network can highspe commun an insid look fundament can analyz realtim commun control area network can calcul control area network can messag respons time realtim commun computercontrol workcel emerald microkernel embed realtim system on complex fixedprior schedul period realtim task on nonpreempt schedul period sporad task simpl integr heurist algorithm schedul task time resourc constraint a scheme realtim channel establish widearea network realtim commun multihop network on abil establish realtim channel pointtopoint packetswitch network implement distribut highresolut realtim clock use canbu mc user manual commun control architectur overview the end emul network devic evalu adapt design build predict avion plarform ada case studi gener avion softwar specif tr