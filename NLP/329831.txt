t decis analysi augment probabl simul a provid gener mont carlo method find altern maximum expect util decis analysi defin artifici distribut product space altern state show optim altern mode impli margin distribut altern draw sampl artifici distribut may use exploratori data analysi tool approxim identifi optim altern illustr method import type influenc diagram b introduct decis analysi simul decis analysi provid framework solv decis make problem uncer tainti base find altern maximum expect util conceptu simpl actual solut maxim problem may extrem involv eg probabl model complex set altern continu sequenc decis includ therefor particular probabl model studi multivari gaussian shachter kenley inclus continu variabl simpl problem carri discret miller rice smith summari first moment deriv smith approxim mean gaussian mixtur poland complic problem may hope exact solut method may turn approxim method specif simul observ pearl p cooper principl simul method solv bayesian network bn may use solv decis problem repres influenc diagram id mean sequenti instanti decis node comput expect valu cooper note that given instanti decis node comput expect valu valu node reformul comput posterior distribut artifici creat addit random node problem solv bn summar exampl shachter peot exact algorithm eg use cliqu join tree lauritzen spiegelhalt cutset condit pearl arc revers shachter prove intract mani realworld network lead approxim infer algorithm base simul method includ short run algorithm logic sampl henrion likelihood weight shachter peot improv modif bound varianc aa algorithm pradhan dagum long run algorithm use markov chain mont carlo method like gibb sampl pearl hrycej york hybrid strategi brewer et al howev matzkevich abramson note coupl outlin simul method specif id jenzarli charn shenoy wherea first one combin stochast dynam program gibb sampl latter simul iid observ small set chanc variabl decis node instead use entir distribut becom intract continu decis space includ recent statist literatur problem ie find optim action decis problem consid muller parmigiani carlin kadan gelfand among other again approach use mont carlo simul evalu expect util given instanti node augment probabl simul paper propos scheme differ import way mention approach sinc use simul evalu expect util loss given instanti decis node accomod continu variabl especi decis variabl unless discret carri probabl distribut conjug framework contrast go step defin artifici distribut node includ decis node show simul artifici augment probabl model equival solv origin decis problem specif strength propos method gener algorithm can principl accomod arbitrari probabl model util function long possibl pointwis evalu probabl densiti util function chosen valu involv node evalu probabl densiti constant factor suffic idea augment probabl model transform optim problem simul problem entir new exampl shachter peot propos similar approach involv augment probabl model includ decis node thu transform origin optim problem simul problem best knowledg approach describ first solv simul problem systemat exploit markov chain mont carlo simul method recent develop statist literatur method start consid artifici distribut space altern state distribut defin way margin space altern proport expect util altern and consequ optim altern coincid mode margin then propos simul base strategi follow step i draw sampl artifici distribut ii marginalis space altern and iii find mode sampl way approxim optim altern key issu sampl artifici distribut introduc markov chain mont carlo mcmc algorithm see exampl smith robert tierney tanner review mcmc method section describ basic strategi simpl exampl section technic natur provid gener method sampl approxim artifici distribut identifi mode sampl section discuss applic exampl section compar method altern scheme identifi situat call differ approach basic approach outlin basic approach assum choos uncertainti altern set a set state theta propos optim altern maximum expect util ud p d ud util function model prefer consequ p probabl distribut model belief possibl influenc action problem structur complic say heavili asymmetr dens larg influenc diagram continu nongaussian random variabl non quadrat util function andor continu set altern decis node find exact solut might analyt comput intract might need approxim solut method shall provid approxim base simul assum p pair d ud posit integr defin artifici distribut product space athetatheta densiti h proport product util probabl specif hd ud delta p note artifici distribut h chosen margin altern hd henc optim altern coincid mode margin artifici distribut h space altern consequ solv expect util maxim problem approxim follow simul base i draw random sampl distribut hd ii convert random sampl margin hd iii find mode sampl augment probabl model simul conceptu differ simul algorithm review earlier simul use pointwis evalu expect util decis altern instead simul gener artifici probabl model hdelta augment state vector d key step i iii ii sinc use simul gener hd get margin sampl hd simpli discard simul valu iii reli mainli tool exploratori data analysi describ section i shall introduc gener markov chain simul method underli idea simpl wish gener sampl distribut certain space cannot directli suppos howev construct markov chain state space straightforward simul whose equilibrium distribut desir distribut simul suffici mani iter drop initi transient phase may use simul valu chain approxim sampl desir distribut shall provid sever algorithm construct chain desir equilibrium distribut case artifici distribut h section rest section shall provid algorithm simpl exampl reader may grasp basic idea without enter technic detail reader familiar mcmc simul may skip directli section strategi propos simpl may undertaken limit case suppos condit distribut hdj hjd avail effici random variat gener then suggest follow scheme known gibb sampler statist literatur gelfand smith i start arbitrari valu step ii iii converg judg consequ result tierney robert smith have proposit util function posit integr p pair d theta interv ir n scheme defin markov chain stationari distribut h imposs give gener applic result termin iter markov chain mont carlo simul well known difficult theoret problem see eg robert polson discuss approach find number iter ensur converg total variat norm within given distanc true stationari distribut howev practic converg may judg number criteria see eg cowl carlin brook robert method implement coda best et al use exampl practic converg judg say may record next n iter simul output d use approxim sampl hd may tri assess mode illustr approach artifici exampl adapt shenoy exampl physician determin polici treat patient suspect suffer diseas d caus patholog state p that turn caus symptom exhibit physician observ whether patient exhibit symptom base inform either treat patient for p d physician util function depend t p d shown tabl valu chang origin valu adapt gener result proposit probabl diseas d patient known suffer d suffer p hand tabl probabl model pd physician util function ut hd d s probabl use step ii iii markov chain mont carlo scheme describ text proport entri appropri column row respect h section right tabl patient known suffer d suffer p patient known suffer p patient known suffer assum probabilist independ given p implement propos algorithm need find condit distribut hjd hdj case decis taken symptom exhibit exhibit mean treat not treat patient let pd probabl given descript hd d propos method goe follow i start arbitrari decis d step ii iii converg judg converg judg record next n iter algorithm use d approxim sampl margin artifici distribut leav valu record avoid serial correl sinc altern finit number need inspect histogram approxim mode simul sampl size find optim decis treat symptom present treat symptom absent note exampl propos augment probabl model simul differ simul method propos solut id use one simul joint d space simul hdelta instead mani small simul evalu expect util possibl decis one time cours previou exampl extrem simpl abl sampl hdj hjd and inspect histogram may approxim mode next section deal complex case sampl artifici distribut shall provid gener method sampl artifici distribut hdelta typ ical distribut straightforward simul from requir gener possibl high dimension model includ complex probabl util function continu decis chanc node possibl condit observ data mcmc simul scheme commonli use method known accomod gen henc choos them given enorm interest id tool structur solv decis problem see eg matzkevich abramson concentr structur id direct graph represent decis problem probabl network addit node repres decis valu notat purpos shall partit set node five subset differenti three type chanc node i decis node d repres decis made ii chanc node includ random variabl x observ prior make decis ie data avail time decis make yet observ random variabl y ie data observ make decis unobserv random variabl ie unknown paramet iii one valu node u repres util function ud x y figur provid simpl gener id scheme id solv determin decis maximum expect util x phi oe r i i deltaff i figur gener influenc diagram scheme requir margin chanc node y condit x maxim d see shachter complet descript algorithm solv id method propos applic id nonsequenti structur ie decis node must chanc node predecessor distribut depend turn decis node except technic condit requir probabl model defin influenc diagram id defin condit distribut pxj p p yj joint distribut x y via p x ppxjp yj y given observ node x typic x independ given allow given factor p depend d particular problem fit setup modif propos algorithm straightforward context probabl model solv id amount maxim expect util d p yjx relev distribut comput expect summari solv id amount find z shall solv problem approxim simul augment probabl measur probabl model d defin joint pdf mode impli margin distribut hd r correspond optim decis underli rational method simul markov chain defin h d asymptot distribut big enough t simul valu success state simul process provid approxim mont carlo sampl h d note simul defin augment probabl model hd y rather p y possibl instanti action d tradit method do consid margin distribut mont carlo sampl infer optim decis use method discuss section key issu definit markov chain desir limit distribut h that capitalis recent work numer bayesian infer concern applic markov chain mont carlo method explor high dimension distribut allow analyt solut expect margin distribut etc markov chain mont carlo simul shall provid gener algorithm valid id satisfi structur condit specifi minor technic condit discuss below algorithm describ metropoli type tierney gener new candid state probe distribut move new state stay old one accord certain probabl transit three step d y requir abl evalu util function ud x y probabl distribut p yj p pxj relev d x y typic possibl sinc definit id includ explicit specif distribut ie model like specifi wellknown distribut scheme requir specif probe distribut g g g choic probe distribut g j j conceptu arbitrari constraint result markov chain irreduc aperiod shall argu whenev possibl assum symmetr probe distribut ie satisfi exampl gajb could multivari normal distribut nb sigma sigma detail choic probe distribut discuss appendix have algorithm start valu d paramet outcom set let u gener propos djd d comput d hd y probabl set d otherwis keep let u gener propos comput y probabl set let u gener propos y comput u probabl set repeat step chain judg practic converg algorithm defin markov chain h d stationari distribut gener algorithm come price name possibl slow converg depend applic long simul run might requir attain practic converg howev fulli gener algorithm rare requir mani problem allow simpler algorithm base use pjx p yj gener propos algorithm given below requir probe distribut g djd d evalu util function algorithm gener pjx p yj simul p yj typic straightforward simul pjx not gen eral distribut explicitli specifi id need comput repeat applic bay formula sever arc revers languag id howev note simul pjx amount solv statist infer problem gener posterior distribut given data x henc appeal version posterior simul scheme appropri varieti import infer problem recent discuss bayesian literatur see eg smith robert tanner tierney start algorithm describ below gener suffici larg mont carlo sampl pjx whatev simul method appropri algorithm start valu d evalu u gener d djd igamma p djd igamma p jxp yj evalu d x comput d hd d converg practic judg step gener pjx done use simul mont carlo sampl gener algorithm algorithm simplifi x miss id ie data given time decis associ algorithm would state algorithm propos distribut step replac d djdp yj sampl p feasibl gener sinc distribut defin explicitli id find optim solut mcmc simul provid us approxim simul sampl fd y deduc approxim sampl d margin hd mode hd approxim optim altern case discret altern problem simpl sinc count number time element appear choos one highest frequenc may worthwhil retain one sever frequent decis studi detail way conduct sensit analysi case continu altern first approach may use graphic exploratori data analysi tool especi low dimension decis vector decis vector one two dimension may produc histogram or smooth version inspect identifi mode higher dimension decis vector d propos consid problem one cluster analysi mode hd correspond ds higher densiti suggest look region higher concentr sampl ds lead us comput hierarch cluster tree simul point sinc assum h densiti respect lebesgu measur ir n interest identifi region optim altern might lie suggest use complet linkag euclidean distanc classif tree cut certain height obtain correspond cluster locat largest cluster indic area best decis again befor may use keep sever larger cluster explor correspond region result cours would depend cut height explor sever height may abl identifi sever decis interest illustr approach section exampl medic decis make problem illustr algorithm case studi concern determin optim apher si design cancer patient undergo chemotherapi palmer muller describ clinic background solv problem larg scale mont carlo integr pretreat start chemotherapi stem cell cd collect allow later reconstitut white blood cell compon depend pretreat first stem cell collect process apheresi schedul fifth seventh day pretreat decis made day pretreat treatment schedul stem cell collect i collect target number cell ii minim number apheres data past patient first day new patient denot observ cd count patient day ij also shall design ith patient data combin data vector palmer muller specifi follow probabl model process likelihood base observ typic profil stem cell count day show first rise pretreat reach maximum slowli declin back toward base level shown figur model shape use nonlinear regress model let gt gamma probabl densiti function paramet chosen impli mean varianc match e rescal use gdelta e s parametr nonlinear regress profil time prior model patient specif paramet hierarch patient undergo one two possibl pretreat x f g serv covari specifi first level prior nj x hyperprior second level common case model complet prior v oe figur show observ count ij fit profil typic patient new patient denot unknown stem cell count day first day alreadi count h use notat introduc begin section observ figur three typic patient dash line connect data point solid curv plot fit profil use describ probabl model data vector futur data vector unobserv paramet model given typic profil optim decis schedul apheres day initi day final day ie decis paramet let event fail collect target number stem cell g l h volum blood process stem cell collect new pa tient let n number schedul stem cell collect util function ud x c sampl cost p penalti underachiev target need maxim expect util r note probabl model ppx yj depend decis node data x influenc belief model sinc pjx may actual sampl markov chain mont carlo method describ palmer muller use algorithm solv problem ensur posit util function add constant offset udelta found optim design futur patient belief prefer model patient undergo treatment x first observ optim apheresi schedul remain six day found given decis space two dimension simpl inspect histogram figur plot estim distribut figur grey shade show histogram simul medic problem inspect hd reveal optim decis exampl water reservoir manag problem rio insua et al describ complex multiperiod decis analysi problem concern manag two reservoir lake kariba k cahora bassa c solv simplifi version use propos mcmc approach simul augment probabl model want find given month optim valu announc releas k c turbin spillgat k respect actual amount water releas depend water avail uncertain sinc uncertainti inflow k c reservoir forecast model k c latter depend water releas k increment inflow inc which turn depend paramet fi prefer model combin util k c k depend energi deficit def final storag sto k amount water spill spi c depend energi produc ene final storag sto c initi storag k c influenc well actual releas figur show influenc diagram repres problem node doubl border either known valu determinist function predecessor requir comput valu node u show probabl model term rel sto k c ene sto c i gammapsi deltaff phi phi phi phi phi phi phi phi au deltaff j bbbbbbbn i gammapsi theta theta theta theta theta theta theta j omega omega omega omega omega omega omega oe phi phi phi phi z z z z z ae ae ae ae ae r a au b i i i i i i i ae figur influenc diagram reservoir problem notat problem includ four decis node node k fi figur show profil histogram simul hd gener algorithm decis paramet four dimension henc use four dimension cell record four dimension histogram simul state simpl inspect empir distribut allow read optim releas g solut base simul valu markov chain mont carlo scheme figur illustr also anoth featur method simpl sensit analysi procedur extra cost dark figur b suggest expect util rather flat releas turbin fix optim valu henc suggest insensit respect chang spill hand figur a one dark area estim optimum is suggest expect util fairli peak releas turbin henc sensit chang energi releas altern discuss section consid hierarch cluster tree simul output dot figur show solut base cut hierarch cluster tree simul valu hd height find cluster member optimum found g come reason close optimum estim earlier comparison altern scheme scheme describ algorithm transform origin expect util maxim problem simul problem scheme gener sens accomod arbitrari probabl model discret continu util a fd k figur a expect util function releas energi d k spill fix optim level b function spill d k releas turbin fix optima diamond indic optim decis dot indic simul largest cluster hierarch cluster tree cut height function long probabl densiti or probabl mass function util function pointwis evalu main differ simul scheme earlier consid literatur instead use simul evalu expect util loss possibl instanti decis use simul artifici auxiliari model augment origin probabl model includ artifici distribut decis node whether one approach effici depend specif consid decis problem gener comparison possibl even specif exampl perform depend heavili arbitrari choic like amount discret necessari mani method run length involv mont carlo simul chosen mcmc scheme etc howev gener observ rel effici method possibl problem altern analyt solut use method like arc revers shachter simul method use simul pointwis evalu expect util like likelihood weight shachter peot typic effici simul auxiliari probabl model bielza shenoy discuss decis problem the reactor problem possibl action chanc node less possibl joint outcom exact solut use shachter algorithm requir one arc revers largest state space use solut phase contain variabl comparison implement exampl use augment probabl simul follow algorithm use iter mcmc simul comput effort one iter approxim compar one arc revers thu exact solut clearli far effici term comput time altern consid simul comput expect util six possibl action use exampl likelihood weight consid involv numer standard error mont carlo simul size around simul altern decis would adequ thu also likelihood weight domin simul augment probabl model problem optim decis comput condit alreadi avail data x comparison chang especi posterior distribut unknown paramet significantli differ initi prior distribut ie low prior probabl evid x consid exampl applic report section amen exact method use mont carlo simul comput expect util altern decis longer gener independ sampl follow jenzarli propos could use gibb sampl comput expect util iti depend specif choic implement mcmc scheme termin criteria one would typic use order iter palmer muller discret sampl space one could principl also use logic sampl henrion howev logic sampl would advis problem sinc fraction simul experi gener variabl correspond actual observ would close zero ie px notat shachter peot similar reason likelihood weight shachter peot would fail sinc leaf node observ sampl score would proport likelihood function ie scheme would amount import sampl use prior probabl model import sampl function can howev address use bound varianc type algorithm discuss exampl pradhan dagum final mani decis problem involv continu decis variabl like exampl consid section continu decis paramet creat problem simul augment probabl model would allow straightforward applic scheme base evalu expect util one decis time even discret use say grid result number altern action render scheme difficult use conclus complex decis problem may render imposs applic exact method obtain optim decis consequ look approxim method includ simul propos simul base strategi approxim optim decis decis analysi experi exampl suggest approach may power implement algorithm fairli straightforward base scheme provid specif case may requir simpl modif one suggest section explor sampl search mode may done standard statist softwar mention discuss exampl one featur method provis simpl sensit analysi featur extra cost number challeng problem remain particularli perhap extens scheme sequenti decis straightforward approach expand model nonsequenti normal form may appli number decis node small anoth challeng problem would develop comput environ base approach would also interest develop method look mode multivari set similar idea may pursu solv tradit statist optim design problem formal point view optim design problem describ stochast optim problem explor clyde muller parmigiani special case algorithm continu sampl space nonsequenti setup appendix implement choic probe distribut g j j algorithm conceptu arbitrari constraint result markov chain irreduc aperiod statement proof propos algorithm assum g symmetr argument ie continu paramet propos use normal kernel g appropri chosen covari matrix sigma exampl diagon matrix diagon entri correspond reason step size decis paramet good valu step size found trial error valu particular setup gelman robert gilk show optim choic step size result averag accept probabl around similarli paramet discret simpl choic g djd could gener cours mani problem specif choic possibl exampl eg defin choos probabl one six possibl move i increas day ii decreas iii increas iv decreas etc symmetri g violat addit factor gdj djd would ad express accept probabl would correspond metropolishast step rather metropoli step converg proof propos scheme simpl base result tierney robert smith acknowledg research suport grant nation scienc foundat cam cicyt iberdrola foundat part took place peter muller visit upm david rio insua visit cnriami grate discuss mike wiper r a comparison graphic techniqu asymmetr decis problem a comparison hybrid strategi gibb sampl mix graphic model asses converg markov chain mont carlo algo rithm approach optim sequenti decis analysi clinic trial a forward mont carlo method solv influenc diagram use local comput explor expect util surfac markov chang a method use belief network influenc diagram markov chain mont carlo converg diagnost compar review effici metropoli jump rule bayesian statist sampl base approach calcul margin densiti propag uncertainti bayesian network probabilist logic sampl gibb sampl bayesian network solv influenc diagram use gibb sampl local comput probabl graphic structur applic expert system decis analyt network artifici intellig discret approxim probabl distribut optim design via curv fit mont carlo experi ment bayesian optim design popul model hematolog data fusion propag structur belief network probabilist reason intellig system decis analysi continu discret variabl mixtur distribut approach converg markov chain mont carlo algorithm optim mont carlo estim belief network infer bayesian method reservoir opera tion zambezi river case converg control method markov chain mont carlo algorithm simpl condit converg gibb sampler metropolishast algorithm probabilist infer influenc diagram gaussian influenc diagram simul approach gener probabilist infer belief net work decis make use probabilist infer method a comparison graphic techniqu decis analysi bayesian comput method moment method decis analysi bayesian comput via gibb sampler relat markov chain mont carlo method tool statist infer markov chain explor posterior distribut with discuss use gibb sampler expert system tr