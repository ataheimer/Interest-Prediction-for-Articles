t practic algorithm gener larg scale nonlinear optim problem a provid effect effici implement sequenti quadrat program sqp algorithm gener larg scale nonlinear program problem algorithm quadrat program subproblem solv interior point method prematur halt trust region constraint numer comput enhanc improv numer perform present includ dynam procedur adjust merit function paramet procedur adjust trust region radiu numer result comparison present b introduct seri recent paper author develop new algorithm approach solv larg nonlinear constrain optim problem propos procedur is essenc sequenti quadrat program sqp method use interior point algorithm solv quadrat subproblem achiev global converg applic special merit function trust region strategi past sever year theori support approach analyz strengthen theori present companion paper addit implement algorithm extens test varieti larg problem includ standard test problem problem engin scientif origin rang size sever hundr sever thousand variabl sever thousand constraint specif strategi develop handl paramet util algorithm deal nontrivi patholog e g linearli depend activ constraint gradient inconsist linear constraint quadrat subprob lem often occur larg scale problem paper present result effort base theoret foundat numer experi confid algorithm provid effici mean attack larg spars nonlinear program equal andor inequ constraint rigor comparison algorithm larg nonlinear problem notori difficult especi given extens set option typic avail code problem nevertheless algorithm conserv default paramet set success problem caus difficulti algorithm and consequ encourag believ competit current stage develop method solv larg problem give outlin basic procedur succeed section provid specif detail compon part implement algorithm includ strategi safeguard use also exhibit comment result numer test paper reli heavili result paper theori motiv basic idea appli comput mathemat divis nation institut standard tech nolog gaithersburg md depart mathemat scienc carnegi mellon univers pittsburgh pa z mathemat depart univers north carolina chapel hill nc assum gener nonlinear program problem form subject to gx smooth function nonlinear equal constraint includ descript order avoid distract technic modif necessari insert infer nonlinear equal constraint includ code problem test sequenti quadrat program method backbon algorithm see review techniqu kth step iter x k denot current approxim solut nlp addit xiter also maintain nonneg iter z k r measur infeas x k stage nlp model quadrat program form min subject to rgx k taken appropri approxim hessian lagrangian nlp ie h xx repres hessian respect x function appli see section discuss choic b k use numer experi form qp gener step provid search direct improv current iter two signific point made concern phase algorithm first appli interior point quadrat program solver qp specif use method found solut calcul solv sequenc low dimension quadrat program pertin detail solver properti rel use sqp method found section second tri solv qp complet accuraci iter rather often termin interior point method prematur particular halt quadrat program solver steplength exce trust region radiu modifi iter accord well improv merit function predict thu algorithm said truncat newton method sens see also particular merit function use work version discuss section strategi updat trust region radiu given section output qp solver vector determin direct step xvariabl turn yield step direct slack variabl z explain section combin step direct two variabl descent direct work version merit function also constraint thu choos steplength direct decreas merit function andor infeas iter choic steplength determin new iter x k also new valu z k strategi choos steplength algorithm detail includ modif safeguard necessari make implement robust given section result numer test contain section result demonstr overal effect procedur highlight benefici effect trust region strategi procedur final section briefli consid weak current version algorithm suggest possibl avenu research improv effici discuss theoret practic question relat larg scale nonlinear program see recent survey interior point qp solver interior point method linear program demonstr success especi larg problem recent research lead extens quadrat program particular method method optim lowdimension subspac perform well linear program extend quadrat program case see refer contain therein method good numer result quadrat program report properti make particularli compat sqp algorithm describ paper brief descript essenti featur method import purpos follow mani detail actual algorithm report may found refer quadrat program solv qp form subject to nthetan r nthetam b r assumpt necessari appli interior point algorithm problem bound full column rank exist feasibl point ie constraint consist note q indefinit assumpt fulldimension interior requir equal constraint present handl write two inequ import prerequisit solv interior point method feasibl initi point algorithm use big method construct phase problem min subject to e vector one artifici variabl clearli larg enough point s feasibl suffici larg algorithm appli reduc artifici variabl nonposit point current valu feasibl m e term drop valu artifici variabl found consist algorithm stop discuss below make use step obtain even feasibl qp note equal constraint present entir solut procedur take place phase alway present defin characterist algorithm proce solv sequenc lowdimension subspac approxim applic follow report result dimens subspac taken three follow outlin od for optim dimension subspac version algorithm variabl treat essenti compon od algorithm see howev step below depend incorpor formul given od algorithm quadrat program given feasibl point gener independ search direct matrix whose column p form solv restrict quadrat program subject to call solut set j appropri valu steplength ae stop criteria met exit go at step compon vector correspond artifici variabl becom nonposit elimin problem search direct step solut theta ad fi scalar depend current iter particular valu chosen one direct alway descent direct respect object function steplength ae set lesser distanc boundari distanc minimum object function form matrix allow effici exploit sparsiti note q posit semidefinit matrix posit definit interior point otherwis may be latter case modif similar use applic algorithm use procedur obviat need matrix b k posit definit turn allow us use hessian lagrangian finit differ approxim thereof standard stop criterion algorithm least one follow hold a rel chang two success valu object function small b rel differ primal dual object function valu small c differ two success iter small use sqp algorithm ad d length solut vector exce specifi valu addit condit implement allow trust region strategi particular criterion caus algorithm halt qp unbound case termin vector use direct context purpos point discuss next section recent version od describ contain option perform special recent step subspac optim step step gener improv effici option use result report here see section comment updat iter merit function section review definit properti merit function provid formula updat iter reader refer companion paper proof motiv concept state section iter algorithm yield pair x k approxim solut nlp z k correspond approxim slack vector step direct updat valu approxim base approxim solut quadrat program min ffi subject to rgx k obtain describ preced section vector ffi k give step direct x k determin step direct q k slack vector z k formula theta rgx k note ffi k feasibl qp theta rgx k case z k slack vector qp correspond ffi k thu slack variabl linear approxim gx k given step direct updat iter mean formula z valu steplength paramet ff observ z k fact mean z k nonneg ff algorithm nonneg slack vector iter preserv and fact sometim turn use maintain z k posit level see section import emphas ffi k determin qp quadrat approxim nlp depend choic z k z k gener sole use merit function describ below is solv slack variabl problem comment notat also order point denot iter step ffi k q k wherea convent notat would use x k z k clear context meant optim algorithm valu steplength paramet gener chosen reduc valu suitabl chosen merit function typic merit function nlp scalarvalu function unconstrain minimum x solut nlp reduct function impli progress made toward solut use determin appropri steplength given search direct merit function equalityconstrain problem deriv import properti visavi step gener sqp algorithm use slackvari formul nlp merit function inequ constrain problem construct form cx z z nonneg scalar use merit function and approxim defin below choos valu steplength paramet ff note abov approxim slack vector gener algorithm z k alway remain nonneg thu nonneg constraint z impos theoret difficulti function cx z defin play import role algorithm use measur feasibl pair x z is defin function kdeltak denot standard euclidean norm set c correspond feasibl set nlp henc close feasibl c j small j suffici small merit function desir properti solut nlp correspond constrain minimum addit small ffi k exact solut qp which impli step descent direct suffici close feasibl despit use properti two defici limit use effici algorithm first ffi k q k descent direct near feasibl and second evalu rf rg addit nontrivi comput algebra requir assess prospect point order overcom difficulti approxim merit function develop work version valu k fix k easili evalu line search algorithm choos appropri valu ff approxim merit function k essenti properti respect step stronger properti step descent direct k everywher moreov suffici small outsid ball around solut suffici reduct k impli suffici reduct we mean suffici reduct wolf condit satisfi thu abl use k surrog test progress iter toward minimum import properti step ffi k assumpt exact solut qp descent direct function r defin thu basic algorithm case qp solv exactli follow given initi valu j use step ffi k q k reduc r iter c j iter contain c j suffici reduct k yield suffici reduct reduc j if cours algorithm remain bound away zero converg follow fact wolf condit satisfi j goe zero converg follow observ radiu ball wolf condit satisfi also goe zero essenti algorithm global converg prove paper theori paper primarili interest enhanc convert theoret algorithm one practic effici requir make provis situat assumpt perform converg analysi valid adopt numer procedur reduc comput effort note below modif or even be theoret justifi believ firm foundat underli algorithm evid accumul extens numer test valid use implement algorithm trust region constraint use possibl truncat quadrat program algorithm exact solut achiev case theori describ appli step obtain approxim solut although gener converg theori base step yet avail shown theori paper approxim solut obtain od algorithm k larg result step appropri descent properti function r k particular converg achiev k goe zero suitabl manner properti justifi use truncat procedur speed algorithm import note approxim procedur also allow us handl difficulti aris sequenti quadrat program method quadrat subproblem inconsist truncat sqp algorithm section give somewhat detail descript algorithm initi assum hessian approxima posit definit matric k nonsingular linear constraint qp consist realworld applic assumpt alway valid tri make algorithm flexibl enough perform well situat assumpt fail hold describ adapt end section implement algorithm depend upon four import paramet need either comput modifi throughout cours algorithm global paramet j introduc measur size domain feasibl region direct ffi k q k descent direct true merit function current estim j maintain algorithm trust region paramet upper bound weight norm approxim solut qp posit definit diagon matrix trust region radiu updat everi iter paramet ff steplength paramet determin length step variabl x z direct ffi k q k chosen guarante progress toward solut decreas either merit function infeas final d merit function paramet must small enough guarante theoret properti describ preced section valid although theori allow arbitrarili small valu d algorithm becom slow small thu monitor throughout algorithm either increas decreas appropri outlin algorithm follow specif comment procedur justif version contain practic modif describ abov simplifi notat defin recal r given basic truncat sqp algorithm initi given x a initi slack variabl z b set k calcul basic trust region step a kffik iter use od min subject to rgx k obtain ffi k k b set theta rgx k theta rgx k otherwis c decreas necessari comput steplength paramet a choos ff k suffici reduc b reduc ff necessari r suffici reduc c reduc ff necessari updat estim global paramet a set updat variabl check termin a set z b converg criteria met quit c updat b k b k adjust merit function trust region paramet a updat necessari b adjust trust region radiu return a b go step global paramet global step base work step requir approxim merit function reduc and addit current iter lie outsid set c j requir constraint infeas also reduc possibl result descent properti describ section good estim j true merit function also reduc case estim j larg reduc valu step procedur eventu lead suffici small valu j note arrang allow step may increas merit function control way also allow step may increas constraint infeas insid c j updat procedur updat trust region radiu step b similar standard strategi use trust region algorithm see base decis chang comparison predict rel reduct pred k actual rel reduct are k function use measur progress toward solut variou formula predict rel reduct pred k suggest differ merit function especi equal constrain program problem see exampl distinct procedur use differ function comput pred k are k depend current statu algorithm linear constraint satisfi use approxim merit function comput predict actual reduct trust region constraint caus od termin phase i ie linear constraint satisfi predict actual reduct infeas use case feasibl solut qp obtain k use comput predict actual reduct method defin pred k differ standard method use unconstrain optim step find subproblem base sole merit function and moreov trust region constraint appear explicitli subproblem nevertheless updat want assess well approxim k agre k direct use quadrat approxim lagrangian object function linear constraint form approxim base quadrat approxim function k given linear approxim note k z base consider result defin predict rel reduct pred ae oe deriv respect x z steplength paramet ff k size recent accept step valu actual rel reduct are k taken differ valu k point divid valu k valid critic formula pred k depend higher order deriv therefor use avail approxim hessian lagrangian r k exampl cellcent finit differ approxim hessian lagrangian function use numer result present here unless analyt second deriv formula readili avail choic pred k use step return od feasibl situat result step domin feasibl improv compon make littl sens adjust determin k rather comparison predict actual improv constraint infeas seem appropri therefor case function rx z use comparison purpos valu pred k are k given follow case od algorithm termin phase i pred are heurist choos pred k are k appear work well specif allow trust region radiu increas even event step return od satisfi linear constraint result increas true merit function experi altern formula base sole constraint violat never employ close solut inde iter preced converg alway observ well insid c j satisfi linear constraint decreas merit function usual pose problem steplength ff steplength ff determin step al gorithm suffici decreas refer b requir wolf condit satisfi given function oe potenti step w point v condit requir ff satisfi fix oe numer experi report section employ simpl backtrack procedur with factor onehalf find ff satisfi condit k r also experi sophist line search method motiv unconstrain optim techniqu observ date suggest complic line search result littl improv algorithm except iter quit far solut adjust d choos effect valu merit function paramet essenti algorithm clear in compact set suffici small valu assur result given valid three import practic reason paramet must adjust rather fix first angl direct gener od gradient approxim merit function becom nearli orthogon step might becom small adjust avoid possibl second approxim merit chang iter possibl previou iter might accept current k ie cycl might occur worri also allevi adjust d third reason chang allow larger step seen theori verifi numer experi small form merit function forc path iter follow nearli activ constraint close caus algorithm take small step and particular slow move away nonoptim activ set make possibl increas significantli improv algorithm perform implement algorithm two opportun adjust d step solv quadrat subproblem step step taken first adjust decreas second paramet may increas decreas step angl gradient approxim merit function step direct ffi k q k comput two vector becom nearli orthogon conclud small enough ensur good decreas k decreas paramet specif comput wd gamma calcul valu w d gamma safeguard procedur allow certain percentag decreas d current version use decreas step consid modifi step taken step primari concern avoid cycl comput interv penalti paramet follow fix integ seek valu paramet d inequ impli none past iter accept approxim merit function new valu d thu cycl would possibl accomplish thi use decomposit k defin section comput valu k k consid inequ defin u l upper lower valu ensur inequ satisfi let obtain interv d l u assum interv exist case valu next step chosen interv next iter return one previou iter practic valu usual suffici prevent cycl interv exist make chang given choos avoid cycl second object junctur increas allow bigger step u larger current safe increas without worri possibl cycl howev safeguard increas two way first requir predict reduct base approxim merit function must greater predict reduct infeas linear constraint restrict prevent increas prematur due primarili larg decreas constraint infeas specif write predict reduct k see insist new valu second use maximum allow chang current factor limit growth d comput simpl procedur updat appear effect especi presenc highli nonlinear constraint poorli scale problem hessian approxim numer experiment report here use finit differ approxim hessian lagrangian although hessian lagrangian strong solut posit definit appropri subspac may indefinit gener even posit definit finit differ approxim may be experi two approach handl possibl first simpli modifi approxim hessian matrix ad nonneg element diagon ensur choleski factor matrix posit element along diagon see modif easi implement observ slow converg problem modif guarante posit definit matrix deliv qp solver take place iter get close solut gener preclud local qsuperlinear converg altern modifi approxim hessian lagrangian simpli allow od iter indefinit qp subproblem halt iter solut exce trust region radiu implement approach seem yield superior result obtain make approxim hessian posit definit especi iter close solut even though theoret prove obtain descent direct approxim hessian posit definit converg criteria converg criteria use standard similar first insist constraint satisfi close toler specif requir also requir either criterion stronger indic kkt point reach weaker criterion suggest progress slow drastic iter may may drawn close solut reason criterion usual prefer criterion lagrang multipli return quadrat program use unless trust region constraint determin approxim solut qp case use least squar approxim multipli replac neg multipli machin zero problem solv date trust region never come play iter get close solut therefor qp multipli use converg test solut inconsist quadrat subproblem one difficulti occur make linear approxim nonlinear constraint qp may inconsist case od will even run complet exit phase return posit valu artifici variabl note alway occur equal constraint present small result direct descent direct k r result step taken direct gener decreas infeas make less like inconsist set linear constraint encount subsequ iter recent version algorithm includ constraint relax procedur appear yield accept step even event inconsist linear constraint encount situat surfac numer experi present paper includ descript perturb procedur note howev encount import applic problem procedur crucial perform algorithm see exampl updat slack variabl one difficulti algorithm updat slack event sqp step satisfi linear constraint well enough ie k small enough occur qp inconsist trust region bound encount solut qp case slack variabl updat scheme would ensur nonneg slack remain non neg direct may one descent resolv dilemma opt descent ie comput q k replac neg slack use follow rule z k z k ae ffl mach g gammag ffl mach machin epsilon sometim refer close constraint see exampl linearli depend constraint gradient linearli depend constraint gradient caus mani theoret comput difficulti constrain optim theoret algorithm obtain converg even linearli depend constraint gradient provid approxim multipli becom unbound practic even though od difficulti deal problem evalu merit function comput least squar approxim lagrang multipli becom problemat comput experi show solv mani problem degeneraci constraint simpli maintain slack posit describ allow us factor crucial matric continu algorithm howev algorithm fail solv problem larg amount degeneraci linear constraint matrix wa cours problem depend observ current implement usual solv problem percent constraint gradient linearli depend degeneraci caus perform merit function deterior particular least squar approxim lagrang multipli seem especi poor result small step allow even close solut numer result modifi algorithm code fortran instal sparcstat use ieee float point arithmet bit current implement use solv wide varieti medium larg scale problem section report result set perform test design specif answer question trust region strategi procedur updat penalti paramet d conclud section result algorithm appli test problem publicli avail emphas problem solv default set paramet see tabl ie attempt made pick paramet set optim perform individu problem although mani applic analyt deriv avail use analyt deriv inform use numer experi possibl first second deriv comput use forward central finit differ respect costli onetim calcul provid zerononzero stencil hessian lagrangian jacobian matrix constraint function stencil use durat solut process problem finit differ approxim conveni use case control problem govern partial differenti equat see partial differenti equat solv use finit element method piecewis linear element evalu deriv object paramet valu z mach tabl numer valu default paramet function respect control variabl quit cumbersom case occur control problem test suit one approxim first deriv object function solv adjoint problem comput cost compar one function evalu for exampl see object function portion hessian lagrangian approxim forward finit differ set eight problem chosen first test suit problem rang size variabl constraint first four rel straightforward nonlinear program test exampl last four actual applic two discret control problem densiti estim problem statist molecular distanc problem complet descript problem found appendix problem nonlinear inequ constraint exploit sparsiti problem nlp design control percentag linear depend constraint gradient demonstr weak algorithm associ difficulti ran three version algorithm problem use posit definit modif hessian matrix discuss section without trust region strategi use unmodifi hessian trust region use unmodifi hessian result failur case trust region strategi employ addit problem run two start point one label c close solut sens variabl order magnitud solut distant start label f result numer test problem summar tabl first two column tabl give number sqp iter nli total number od iter qpi next two column contain stop criterion met valu gradient lagrangian solut unless algorithm fail which denot failur tabl feasibl condit satisfi solut stop criterion denot either depend whether satisfi condit satisfi appear column remain column give inform valu paramet run column five eight give initi maximum minimum final valu paramet final column give last iter chang result test illustr use unmodifi hessian trust region effect reduc number od iter number sqp iter trust region strategi prevent long unprofit step gener far solut use unmodifi hessian allow trust region becom inact near solut thu allow rapid local converg requir hessian posit definit often preclud rapid local qsuperlinear converg and use conjunct trust region strategi result trust region activ close solut result also show valu paramet vari sever order magnitud procedur discuss section allow valu increas decreas greatli enhanc algorithm earlier test use either fix valu allow reduct yield inferior result anoth modif algorithm reflect tabl includ descript preced section made forc od algorithm take minimum number step found trust region radiu becam small algorithm would sometim exit od one iter result poor step direct poor step would result decreas eventu algorithm would fail requir minimum number step taken od our choic problem disappear recent collect test problem becom avail test compar optim algorithm see constrain unconstrain test enviro cute quickli becom standard research establish viabil effect numer algorithm problem replac smaller well scale test problem hock schittkowski schittkowski intend use test larg scale al gorithm result cute test problem summar tabl problem solv stop condit problem abov likewis tabl format use present numer result detail descript problem structur motiv sourc see appear cute test problem set rich larg small scale unconstrain equal constrain test problem present mani larg scale problem includ inequ constraint and particularli nonlinear inequ constraint chose problem reflect class problem algorithm design solv least one inequ constraint present problem number variabl andor constraint larg enough exploit special sparsiti structur import problem select cute report corkscrew mann svanberg zigzag associ problem size record tabl worth comment much machineri develop paper deal effect handl nonlinear inequ constraint perform algorithm cute test problem set is therefor slightli deceiv sinc mani constraint problem simpl bound primal variabl pure linear for instanc approxim constraint corkscrew constraint mann constraint zigzag linear mani equal constraint although caus problem algorithm structur constraint complet exploit extra machineri code result overhead perform benefit clearli algorithm design specif deal linear equal constraint outperform algorithm problem problem algorithm appear perform best svanberg problem inequ constraint and substanti number nonlinear succeed solv four problem reason number inner outer iter howev mani algorithm enhanc contribut littl solut process measur distanc feasibl the jtube strategi nonmonoton updat penalti paramet d trust region strategi essenti dormant solut process regardless iter proxim solut feasibl fact evid enhanc small number cute test problem solv occur decreas slightli solv problem mann employ modifi hessian trust region strategi see third fourth row tabl noteworthi iter result solv problem penalti paramet artifici held fix ident iter result adjust solut appear illustr case adjust pure superfici truss c e e e e e molecc e e e e e molecf tabl modifi hessian trust region bcheat c e e e e e bcheat f e e e e e molecc molecf e e e e e tabl modifi hessian trust region trussc e e e e e molecc molecf tabl unmodifi hessian trust region problem variabl constraint corkscrew zigzag tabl minim paramet problem nli qpi conv krx lk maxd mind final last dcha tabl modifi hessian trust region problem nli qpi conv krx lk maxd mind final last dcha tabl modifi hessian trust region problem nli qpi conv krx lk maxd mind final last dcha tabl unmodifi hessian trust region futur direct paper discuss detail sqp algorithm solv larg scale nonlinear problem numer result default paramet set indic procedur implement robust effect effici converg theori provid sound theoret basi procedur nevertheless sever area techniqu use improv allow solut larger difficult problem algorithm observ current implement requir factor rg rgz rgrg latter od spars matrix packag make reason problem current consid clearli expens maintain both result report use analyt finit differ hessian approxim examin detail od reveal limit memori bfg limit memori sr could readili incorpor code done experiment techniqu result report elsewher mani problem seen degener significantli slow converg method primari culprit extrem poor multipli estim provid least squar procedur improv area certainli requir problem not report here nonlinear equal constraint occasion observ signific difficulti tri satisfi linear equal constraint ie complet phase i case success relax constraint context od accomplish simpli fix artifici variabl posit valu continu od iter approach often find od converg recent procedur mention section led improv theori support idea detail will again report elsewher r interiorpoint method gener larg scale quadrat program problem interior point method linear quadrat program problem merit function inequ constrain nonlinear program problem famili descent function constrain optim truncat sqp algorithm larg scale nonlinear program problem cute constrain unconstrain test environ function numer solut control problem origin heat transfer exact approxim boundari controlla biliti heat equat larg scale numer optim introduct overview lancelot fortran packag largescal nonlinear optim siam journal numer analysi global converg inexact newton method robust trust region algorithm nonmonoton penalti paramet scheme constrain optim new york constrain nonlinear pro gram numer method nonlinear variat problem molecular conform distanc matric optim signal set nongaussian detector test exampl nonlinear program code use optim techniqu solut partial differenti equat scienc engin solut metric stress sstress problem multidimension scale use newton method numer solut nonlinear parabol control problem reduc sqp method optim control system govern partial differenti equat comput trust region step test exampl nonlinear program code role slack variabl quasinewton method constrain optimiza tion nonparametr probabl densiti estim nonparametr function estim use illustr separ nonlinear program distanc matric tr ctr thoma f coleman jianguo liu wei yuan new trustregion algorithm equal constrain optim comput optim applic v n p februari e bradley a ogallagh j roger global solut nonlinear system use qualit reason annal mathemat artifici intellig v n p rubin gong gang xu quadrat surfac reconstruct multipl view use sqp integr imag graphic technolog kluwer academ publish norwel ma