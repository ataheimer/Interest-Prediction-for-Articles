t largescal activeset boxconstrain optim method spectral project gradient a new activeset method smooth boxconstrain minim introduc algorithm combin unconstrain method includ new linesearch aim add mani constraint work set singl iter recent introduc techniqu spectral project gradient drop constraint work set global converg prove comput implement fulli describ numer comparison assess reliabl new algorithm b introduct problem consid paper consist minim smooth bound variabl feasi depart comput scienc imeusp univers sao paulo rua matao cidad universitaria sao paulo sp brazil author support pronexoptim fapesp grant cnpq grant email egbirginimeuspbr depart appli mathemat imeccunicamp univers campina author support pronex optim fapesp grant cnpq faepunicamp email martinezimeunicampbr ble set dene boxconstrain minim algorithm use subalgorithm solv subproblem appear mani augment lagrangian penalti method gener constrain optim see promis novel applic reformul equilibrium problem see refer therein method introduc trustregion type iter x k quadrat approxim f minim trustregion box object function valu trial point sucient smaller fx k trial point accept otherwis trust region reduc dierenc that trial point face dene cauchi point wherea trial point obtain mean specic boxconstrain quadrat solver call quacan see p trustregion method boxconstrain optim introduc quacan activeset method use conjug gradient within face approxim internalfac minim project add constraint activ set orthogonaltothefac direct leav current face approxim minim face met clever physic interpret direct given numer experi suggest ecienc algorithm reli trustregion strategi strategi quacan deal constraint motiv us adapt strategi quacan gener boxconstrain problem adapt involv two main decis one hand one need choos unconstrain minim algorithm deal object function within face hand necessari dene robust ecient strategi leav face add activ constraint attempt rst decis made secant multipoint minim algorithm use author use secondord minim algorithm zhang xu paper adopt leavingfac criterion employ spectral project gradient dene see also intern minim face introduc new gener algorithm line search combin backtrack extrapol compromis everi linesearch algorithm accuraci local onedimension minim economi term function evalu backtrackinglik linesearch algorithm cheap but sometim tend gener excess small step reason backtrack complement simpl extrapol procedur here direct chosen step arbitrari provid angl condit satis implement describ paper suggest choos direct use truncatednewton approach mean search vector approxim minim quadrat approxim function current face use conjug gradient nd direct rst iter obvious descent direct properti easili monitor success conjug gradient step present research organ follow section describ unconstrain minim algorithm deal minim function box algorithm use new linesearch techniqu due techniqu possibl prove either method nish point boundari where perhap mani constraint ad converg point box gradient vanish boxconstrain algorithm describ section essenti use algorithm section work within current face spectral project gradient leav constraint spectral project gradient techniqu also allow one leav mani bound add mani other work set singl iter featur import largescal calcul section prove global converg boxconstrain algorithm comput descript code gencan given section section show numer experi use cute collect section report experi use larg problem up variabl final section make nal comment suggest line futur research section assum f ir ug set b repres close face section dimens n section dimens reduc subspac section gradient section compos deriv respect free variabl section hope use notat rf section lead confus on denot object dene gener iter algorithm start interior b and either converg unconstrain stationari point nish boundari b decreas function valu algorithm use within face boxconstrain method algorithm base line search armijolik condit extrapol given current point x k descent direct k nish line search x k d k satis sucient descent criterion direct deriv sucient larger hgx k k i sucient descent criterion hold backtrack obtain sucient descent increas direct deriv enough tri extrapol let us explain think philosophi adequ largescal boxconstrain optim pure backtrack enough prove global converg mani optim algorithm howev accept rst trial point satis armijo condit lead small step critic situat therefor step larger uniti must tri indic say worthwhil direct deriv sucient larger consid much decreas increas steplength direct k and so accept unit steplength provid satis armijo condit reason sinc usual search direct contain amount secondord inform make unitari steplength desir point view preserv satisfactori order converg unitari steplength satisfi armijo condit backtrack case judg worthwhil comput gradient new trial point would discard point accept extrapol especi use largescal problem import tri add mani constraint possibl work set so extrapol rather greedi way multipli steplength xed factor function valu decreas think algorithm present simpl way extrapol devic introduc reason balanc cost ecienc import stress line search coupl virtual minim procedur comput descent direct z ir n euclidean project z onto convex set denot p z section denot p y symbol k k repres euclidean norm throughout paper algorithm linesearch base algorithm algorithm start x intb nondimension paramet given also use small toler ab rel initi set k step comput search direct step kg k step comput step linesearch decis step comput set minf go step els go step step at point x k take go step els go step extrapol els go step backtrack step at point x k take k max x fx k go step in practic point obtain perform step algorithm extrapol els go step backtrack step extrapol step max n max set trial max els set trial n step max kp take execut algorithm step fp take step els set trial go step step backtrack step comput new step fx k take go step els go step step k max termin execut algorithm els set step remark let us explain main step algorithm motiv algorithm perform linesearch along direct satisfi anglecosin condit gener line search use direct possess secondord inform nat ural step must initi test accept sucientdesc directionalderiv condit satis rst test step ask whether x k interior box case fx k tri obtain smaller function valu multipli step xed factor project onto box procedur call extrapol x k interior backtrack interior armijo condit hold also backtrack backtrack stop armijo condit fulll hold test direct deriv condit mention abov satis too accept x k new point howev hold not judg that like take larger step along direct k produc decreas object function so case also extrapol extrapol procedur tri success project x k d k onto box increas valu entri point interior x k nd k not make sure point x test rst extrapol nish decreas function obtain anymor distanc two consecut project trial point neglig iter algorithm nish step correspond iter x k boundari b algorithm stop encount boundari point function valu decreas respect previou one x k interior b execut continu increas iter number uxdiagram figur help understand structur linesearch procedur xd int aaamax line search bbcondit xnewxd end armijo backtrack extrapol figur line search procedur extrapol aamax dist ee aaaatrial aatrialnnaa aamax nna aamax fpxaatrial d xnewpxaad end figur extrapol strategi follow theorem prove sequenc gener algorithm either stop unconstrain stationari point stop boundari b gener limit unconstrain stationari point theorem algorithm well dene gener point strictli decreas function valu fx k g sequenc gener algorithm one follow possibl hold i sequenc stop x k gx k ii sequenc stop x iii sequenc innit least one limit point everi limit point x satis gx proof let us prove rst algorithm well dene gener sequenc strictli decreas function valu see well dene prove loop step necessarili nish nite time fact step multipli nonnul direct k number greater one take maximum allow feasibl step therefor eventu boundari reach increas condit met loop step classic backtrack loop nish wellknown direct deriv argument see exit algorithm alway requir fx k sequenc strictli decreas remain prove that neither i ii hold cluster point x gener sequenc satis gx innit subset lim suppos rst ks k k bound away zero k k therefor exist ks k k k k k k therefor continu f impli lim kk suppos ks k k bound away zero k k so exist k innit subset k lim kk ks set indic k comput step analog let k k set indic k comput step k k let k k set indic k comput step k k consid three possibl i k innit ii k innit iii k innit consid rst case i ks ks k k sinc k innit take converg subsequ take limit use continu obtain sinc impli hgx di but continu consid now case iii case k innit k k exist k ks ks k lim ks k k so meanvalu theorem exist k k k divid ks k k take limit converg subsequ d obtain inequ similar so gx follow argument consid now case ii sinc consid case innit sequenc gener turn that p moreov step trial n p therefor k k write therefor meanvalu theorem k k exist k k thu k k sinc divid kd k k take converg subsequ k kd k k obtain hgx di but take limit get hgx di kgx k impli complet proof boxconstrain algorithm problem consid section minim fx subject x given let us divid feasibl set disjoint open face follow smallest ane subspac contain f parallel linear subspac v continu project gradient xi dene x f dene g p x main algorithm consid paper describ below algorithm gencan assum x arbitrari initi point min face contain current iter x k assum g p otherwis algorithm termin main iter algorithm perform test kg take place judg conveni new iter belong f the closur f and so comput x k one iter algorithm set variabl restrict free variabl f so set b previou section correspond f here hold decid constraint abandon and so new iter x k comput one iter spg method describ algorithm case comput x k comput spectral gradient coecient k follow way otherwis dene algorithm algorithm use necessari leav current face accord test algorithm spg comput next iter monoton spg iter spectral step k name dene search direct k comput x way tri rst perhap reduc coecient mean safeguard quadrat interpol procedur remark observ x f x k f x k comput algorithm case hold kg p compon correspond free variabl g same mean g p compon correspond xed variabl therefor f so f but accord spg iter impli x f nish section give theoret result roughli speak prove algorithm well dene karushkuhntuck point comput arbitrari precis moreov dual nondegeneraci innit algorithm identi face limit belong nite number iter theorem algorithm well dene proof trivial consequ fact algorithm algorithm the spg algorithm well dene theorem assum fx k g gener algorithm suppos exist k f k k then everi limit point fx k g rstorder stationari proof case x k comput algorithm k k thu theorem gradient respect free variabl tend zero straightforward project argument follow kg sinc hold impli kg p everi limit point rstorder stationari theorem suppos k f exist x k then exist limit point fx k g rstorder stationari proof see theorem theorem suppos stationari point nondegen erat f hypothesi theorem and henc thesi must hold proof see theorem theorem suppos fx k g sequenc gener algorithm let arbitrari posit number then exist k f kg p proof result direct consequ theorem implement iter k algorithm current iter x k look direct k satisfi condit use truncatednewton approach comput direct solv newtonian system call algorithm describ below r fx k follow algorithm appli problem s initi approxim solut algorithm nd point solut satis qs qs perhap nal point boundari region dene ksk l u algorithm conjug gradient paramet k max given algorithm start step test stop criteria set step comput conjug gradient direct step els comput step p step comput step step comput ug step comput step step comput new iter step comput step b k kbkk k set step set step comput set step algorithm modic one present p symmetr posit denit matric without constraint modic follow step test p k descent direct k ie hp k rq k i forc condit multipli p k necessari matrixvector product comput exactli safeguard necessari howev mani case matrixvector product ap k replac nitedier approxim reason perform test order guarante quadrat decreas along direct p k step test p inequ hold step k direct p k comput minimum among conjugategradi step maximum posit step preserv feasibl rst iter cg set k max way cg stop angl condit step iter zero cg keep current approxim solut obtain far step test whether angl condit satis new iter not condit fulll stop algorithm previou iter also stop algorithm boundari feasibl set achiev step converg criterion conjugategradi algorithm dy namic vari linearli logarithm norm continu project gradient begin valu nish f dene log log use stop criterion kg p xk algorithm paramet k max maximum number cgiter call conjugategradi algorithm also vari dynam way iter allow end process begin reason want invest larger eort solv quadrat subproblem close solut far it fact log incrementalquoti version gencan r fx k comput matrixvector product r fx k y approxim fact compon correspond free variabl comput exist xed variabl conveni exploit numer experi cute collec tion order assess reliabl gencan test method wellknown altern algorithm use nonquadrat bound constrain problem variabl cute col lection algorithm use compar gencan box quacan see also lancelot spectral project gradient method spg describ spg see also method use converg criterion kg p stop criteria inhibit gencan use algorithm algorithm algorithm use paramet the line search of algorithm default paramet mention use the line search of algorithm ie lancelot use exact second deriv use precondit conjugategradi method reason that gencan conjug gradient method comput direct also use without precondit option lancelot default one small number modic made boxquacan provid fair comparison modic were i initi trustregion radiu gencan adopt ii maximum number conjugategradi iter xed accuraci solv quadrat subproblem dynam box quacan vari done gencan iv minimum trustregion radiu min xed equal correspond paramet gencan code written fortran test done use ultrasparc sun processor mhz mega byte main memori solari oper system compil workshop compil oct fortran final use ag o optim code rst four tabl report full perform lancelot spg boxquacan gencan true hessian gencan increment quotient usual denit iter lancelot involv one function evalu howev order unifi comparison call iter whole process comput new iter lower function valu start current one therefor singl lancelot iter involv one gradient evalu but perhap sever function evalu iter sever trustregion problem solv approxim use number cgiter problem hadam sconl bound lower limit equal upper limit boxquacan run circumst perform method situat report correspond tabl tabl report method it number iter fe function evalu ge gradient evalu cg conjug gradient iter except case spg cg iter comput time cpu time second nal function valu obtain project gradient nal point next tabl repeat inform rst one compact readabl form tabl report nal function valu obtain method case least one dierenc them comput four signic digit tabl report method number fe gecg idea cg iter sometim costli gradientevalu cost certainli use incrementalquoti version gencan roughli speak gecg repres amount work use solv subproblem fe repres work done true problem tri reduc object function tabl report comput time problem least one method use second comput time use lancelot must consid warn made page lancelot requir interfac use cute tool worth note lancelot exploit much structur problem n fe ge cg time fx kg p xk d qrtquad d d chebyqad d d linvers d d tabl perform lancelot provid interfac tool consequ although gencan use less iter less function evalu less gradient evalu less conjugategradi iter lancelot sconl comput time greater one spent lancelot problem like qrdl chebyqad way lancelot take advantag sif structur also impress includ addit tabl motiv observ tabl observ number function evalu per iter larger gencan lancelot box quacan possibl reason three mani spgiter with perhap mani function evalu per iter mani tniter backtrack mani tniter extrapol classifi iter extrapol success unsuccess one success extrapol iter extrapol produc function valu smaller one correspond rst problem n fe ge time fx kg p xk d qrtquad d d hadam chebyqad d d nonscomp d d tabl perform spg trial point unsuccess extrapol correspond failur rst attempt doubl steplength therefor unsuccess ex trapol addit unnecessari function evalu done next iter correspond rst trial point accord thi report tabl follow featur gencan incrementalquoti spgit spg iter use leav current face spgfe function evalu spgiter tnit tn iter tnfe function evalu tniter tnstep it tniter unitari step accept tnstep fe function evalu tniter unitari step accept necessarili equal tnstep it tnbacktrackingit tniter backtrack necessari problem n fe ge cg time fx kg p xk d expquad d d qrtquad d d chebyqad d d d tabl perform boxquacan tnbacktrackingf function evalu iter backtrack tnextrapit success iter extrapol tnextrapf function evalu success iter extrapol tnextrap it unsuccess iter extrapol tnextrap fe function evalu unsuccess iter extrapol number necessarili equal twice correspond number iter problem n fe ge cg time fx kg p xk expquad d nonscomp d tabl perform gencan truehessian version problem n fe ge cg time fx kg p xk explin expquad d d chebyqad d nonscomp tabl perform gencan incrementalquoti version bdexp d d d qrtquad d d d d d chebyqad d d d d d deconvb d d d d qrdl d d d sconl d d d d tabl final function valu problem lancelot spg boxquacan gencanquot fe gecg fe ge fe gecg fe gecg expquad qrtquad chebyqad sconl tabl function equivalentgradi gecg evalu mccormck hadam chebyqad qrdl tabl comput time type gencan iter detail truncat newton iter spg iter tn iter step backtrack extrap extrap problem fe fe fe fe fe fe tabl gencan featur observ tabl realis that number spgiter surprisingli small therefor iter mechan leav face activ so iter number activ constraint remain increas clearli spgiter respons rel high number function evalu number iter backtrack necessari is also surprisingli small therefor extrapol respons functionalevalu phenomenon sinc unsuccess extrapol use one addit unnecessari function evalu contribut increas fe also moder fact unsuccess extrapol respons function evalu consid problem mean less evalu per problem turn mani function evalu use success extrapol consid overal perform method seem realli good featur extrem case bdexp one tniter perform give success extrapol use function evalu gave solut problem remark converg obtain problem method test except spg solv sconl thirti hour comput time method that case obtain lowest function valu gencanquot dier enc seem larg enough reveal clear tendenc alreadi mention behavior spg surprisingli good although method fail solv problem reason time behavior problem work quit ecient indic exist famili problem spg is probabl best possibl altern observ alreadi made boxquacan less success method set ex periment surpris sinc author observ method outperform lancelot quadrat problem good function far quadrat fact observ motiv present work nevertheless still larg scope improv boxquacan far take account improv solut quadrat subproblem possibl sophist strategi updat trustregion radiu incorpor experi larg problem wish place q circl radiu r rectangl way qg intersect circl circl j one point therefor given goal determin c solv problem minim subject r c r c point c center desir circl object function valu solut minim problem zero origin problem solv problem known cylind pack problem present gener direct sociometri applic tabl describ main featur medium larg scale problem type problem set randomli gener schrage random number gener seed case use observ n number variabl equal q tabl show perform gencan lancelot intern limit bigproblem instal cute forbid solut larger instanc problem use sif show cpu problem n i box tabl medium largescal classic modi cylind pack problem time gencan use sif siftim fortran subroutin fs comput function gradient use random initi point gener insid box schrage algorithm seed equal method found global solut case tabl also report number free variabl solut far found gencan gencan use fortran subroutin use sif lancelot fe ge cg time fe ge cg time fe ge cg time tabl gencan lancelot cylind pack problem tabl gencan larg problem final remark numer algorithm must analyz point view present state also consider relat possibl im provement chanc improv activeset method like one present paper come develop new unconstrain algorithm adapt known unconstrain algorithm specic characterist problem algorithm comput search direct open mani possibl mention introduct secant multipoint scheme with dierent procedur leav face consid negativecurvatur newtonian direct small problem use leav face also associ spg particularli interest altern precondit spectral project gradient method introduc extens techniqu paper gener linearli constrain optim anoth interest subject possibl research theoret point view extens straightforward converg proof oer technic diculti real diculti need project onto feasibl set extrapol step spg iter theori extrapol avoid without aect global converg project essenti spg iter sometim feasibl polytop project easi comput see case extens gencan would probabl quit ecient acknowledg author grate nick gould help use sif languag also indebt two anonym refere whose comment help us lot improv nal version paper r resolut gener nonlinear complementar problem limit memori algorithm bound constrain minim restrict opti mizat clue fast accur implement common ection surfac stack method cute constrain unconstrain test environ global converg class trust region algorithm optim simpl bound global converg augment lagrangean algorithm optim gener constraint simpl bound numer method unconstrain optim nonlinear equat compar numer perform two trustregion algorithm largescal boundconstrain minim optimis palletis cylind case matrix comput precondit spectral gradient method unconstrain optim problem barzilai borwein choic steplength gradient method barzilai borwein gradient method larg scale unconstrain minim problem portabl fortran random number gener class ind tr global converg class trust region algorithm optim simpl bound global converg augment lagrangian algorithm optim gener constraint simpl bound limit memori algorithm bound constrain optim matrix comput rd ed gradient method retard gener estim optic constant thick thin film use unconstrain optim portabl fortran random number gener trustregion method valid augment lagrangian algorithm gaussnewton hessian approxim use set hardspher problem dualitybas domain decomposit natur coarsespac variat inequ algorithm resolut gener nonlinear complementar problem class indefinit dogleg path method unconstrain minim barzilai borwein gradient method larg scale unconstrain minim problem nonmonoton spectral project gradient method convex set newton method larg boundconstrain optim problem constrain quadrat program proport project augment lagrangian adapt precis control quadrat program equal constraint ctr g birgin j m martnez structur minimalmemori inexact quasinewton method secant precondition augment lagrangian optim comput optim applic v n p januari g birgin r a castillo j m martnez numer comparison augment lagrangian algorithm nonconvex problem comput optim applic v n p may g birgin j m martnez f h nishihara d p ronconi orthogon pack rectangular item within arbitrari convex region nonlinear optim comput oper research v n p decemb