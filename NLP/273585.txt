t local refer lu decomposit partial pivot a paper present new partit algorithm lu decomposit partial pivot new algorithm call recurs partit algorithm base recurs partit matrix paper analyz local refer new algorithm local refer known wide use partit algorithm lu decomposit call rightlook algorithm analysi reveal new algorithm perform factor thetasqrtmn fewer io oper or cach miss rightlook algorithm n order matrix m size primari memori analysi also determin optim block size rightlook algorithm experiment comparison new algorithm rightlook algorithm show implement new algorithm outperform similarli code rightlook algorithm six differ risc architectur new algorithm perform fewer cach miss algorithm test benefit strassen matrixmultipl algorithm b introduct algorithm partit dens matric block oper entir block much possibl key obtain high perform comput hierarch memori system partit matrix block creat tempor local refer algorithm reduc number word must transfer primari secondari memori paper describ new partit algorithm lufactor partial pivot call recursivelypartit algorithm paper also analyz number data transfer popular partit lufactor algorithm socal rightlook algorithm use lapack perform characterist popular partit lufactor algorithm particular crout leftlook algorithm use nag librari similar rightlook algorithm analyz analysi two algorithm lead two interest conclus first simpl systemindepend formula choos block size right look algorithm almost alway optim second recursivelypartit algorithm gener asymptot less memori traffic memori rightlook algorithm even block size right look algorithm chosen optim numer experi indic recursivelypartit algorithm gener fewer cach miss run faster rightlook algorithm recursivelypartit algorithm comput lu decomposit partial pivot nbym matrix transfer thetanm word primari secondari memori size primari memori rightlook algorithm hand transfer least word number word actual transfer convent algorithm depend paramet r chosen optim part research perform author postdoctor fellow ibm tj watson research center postdoctor associ mit laboratori comput scienc work mit support part arpa grant n xerox palo alto research center coyot hill road palo alto ca s toledo lapack new algorithm optim sens number word transfer asymptot number transfer partit or block algorithm matrix multipl solut triangular system at least number column small compar size primari memori right look algorithm achiev perform matrix larg row fill primari memori recursivelypartit algorithm algorithm advantag convent algorithm blocksiz paramet must tune order achiev high perform sinc recurs like perform better memori system two level exampl comput system two level cach cach virtual memori understand main idea behind new algorithm let us look first convent rightlook lu factor algorithm algorithm decompos input matrix dnre block r column start leftmost block column algorithm iter factor block r column use column orient algorithm block factor algorithm updat entir trail submatrix paramet r must care chosen minim number word transfer memori r larger mn mani word must transfer block column factor r small mani trail submatric must updat updat requir entir trail submatrix read secondari memori main insight behind recursivelypartit algorithm need updat entir trail submatrix block column factor factor first column matrix algorithm updat next column right enabl proceed second column factor must appli updat first two column proceed algorithm updat two column proce four column factor use updat four more on word algorithm look way right everi time column factor shall see below shortsight approach pay off anoth point view new algorithm recurs algorithm know larger r the number column block smaller number data transfer requir updat trail submatric algorithm therefor choos largest possibl size m mani column fit within primari memori factor recurs use algorithm rather factor use naiv column orient algorithm left m column factor use updat right m column subsequ rest paper organ follow section describ analyz recursivelypartit algorithm section analyz blockcolumn rightlook algorithm actual perform lapack rightlook algorithm perform recursivelypartit algorithm compar section sever highend workstat section conclud paper discuss result relat research recursivelypartit lu factor recursivelypartit algorithm effici convent partit algorithm also simpler describ analyz section first describ algorithm analyz complex algorithm term arithmet oper term amount data transfer memori execut local refer lu decomposit algorithm algorithm factor nbym matrix nbyn permut matrix p nbym unit lower triangular matrix l that is ls upper triangl zero mbym upper triangular matrix u treat block matrix squar matrix order mbym that is perform pivot scale u return els recurs factor u permut solv triangular system l gamma l recurs factor p l u permut l p return u u complex analysi hard see algorithm numer equival convent columnori algorithm therefor algorithm name numer properti convent algorithm perform number float point oper nm fact variant lufactor algorithm discuss paper essenti differ schedul algorithm is dataflow graph analyz number word must transfer primari secondari memori n m size primari memori denot eas exposit assum number column power two denot number word algorithm must transfer memori iorp n m denot number word must transfer solv nbyn triangular linear system right hand side solut overwrit right hand side iot n m denot number word must transfer multipli multipli nbygammam matrix mbyk matrix add result nbyk matrix iomm n m k sinc factor algorithm use matrix multipl solut triangular linear system subroutin number io perform depend s toledo number io perform subroutin partit algorithm solv triangular linear system perform iot m m m m m io actual number io perform smaller sinc real crossov point m m incorpor improv bound analysi complic analysi littl effect final outcom number io perform standard matrixmultipl algorithm iomm n n m m m bound matrix multipl hold valu n m analysi assum use convent triangular solver matrix multipl rather socal fast strassenlik algorithm asymptot bound fast matrixmultipl algorithm better analyz recursivelypartit algorithm use induct initi analysi take account permut row algorithm perform shall return permut later section recurr govern total number word transfer algorithm first prove induct m m iorp n m nm lg m base case true assum claim true m m nm prove induct iorp n m nm mp m m m claim true base case m sinc m m sinc m assum claim true m iorp n m nm mp m local refer lu decomposit m m mp m m nm p m m mp m nm p m m mp m nm p m mp m bound number word transfer due permut comput number permut column undergo algorithm column permut either factor step permut step permut step factor step follow column permut time word brought secondari memori total number io requir permut n m bound achiev read entir column primari memori permut primari memori follow theorem summar main result section theorem given matrix multipl subroutin whose io perform satisfi equat subroutin solv triangular linear system whose io perform satisfi equat recursivelypartit lu decomposit algorithm run comput word primari memori comput lu decomposit partial pivot nbym matrix use iorp n m nm mp m io analysi rightlook lu factor put perform recursivelypartit algorithm perspect analyz perform columnblock rightlook algorithm first describ algorithm analyz number data transfer io perform s toledo bound obtain asymptot tight focu lower bound term constant number io requir solut triangular linear system smaller number io requir updat trail submatrix a rank r updat matrix ignor triangular solv analysi rightlook lu algorithm factor nbym matrix m algorithm factor r column everi iter kth iter decompos pa squar matrix order squar matrix order r kth iter algorithm perform follow step factor permut permut solv triangular system l u updat u number io requir factor nbyr matrix use columnbi column algorithm nr nr nr simplifi analysi ignor rang half matrix fit within primari memori less entir matrix use one level recurs lead thetanr io rang use fact m m rs r m r ts rs m tr m ts r m local refer lu decomposit bound ts rs underestim rs ignor small slack analysi number io algorithm perform depend relat r dimens matrix size memori r small nr updat trail submatrix domin number io algorithm perform updat trail submatrix requir least io particular first mr updat requir least r larger factor mr block r column requir least r nr nmrio number io requir rankr updat depend valu r mn r m total number io perform rankr updat least therefor number io perform algorithm least nmr minim m optim valu r lie the exact valu might deviat slightli rang sinc express deriv number io lower bound substitut optim valu r find algorithm perform least nm gamma nm io rang valu perform m m valu m yield better perform m r yet larger r m rankr updat requir io particular first mr updat requir least m nm p m m nm p m s toledo io total number io rang includ updat factor block column therefor least nm p m mmn number io minim choos smallest possibl m matrix larg compar size main memori n also possibl choos r mn case total number io least nm p m analysi summar follow valu r close maxmn m optim almost case except truli huge matric m matric m better m combin result obtain follow theorem theorem given matrix multipl subroutin whose io perform satisfi equat subroutin solv triangular linear system whose io perform satisfi equat rightlook lu decomposit algorithm run comput word primari memori comput lu decomposit partial pivot nbym matrix use least iorl n m m io first case r mn lead better perform column fit within primari memori although lower bound asymptot tight valu lower bound actual constant higher that experiment result implement test recurs partit algorithm goal experi determin whether recurs partit algorithm effici rightlook algorithm practic result experi clearli show recursivelypartit algorithm perform less io faster least comput experi conduct result experi complement analysi two algorithm analysi show recursivelypartit algorithm perform less io right look algorithm valu n analysi stop short demonstr one algorithm faster anoth three respect first bound analysi exact second analysi count total number fortran implement avail onlin anonym ftp theorylcsmitedu pubpeoplesivandgetrff code compil mani fortran compil in lude compil ibm silicon graphic digit remov recurs keyword use compil option enabl recurs see detail local refer lu decomposit io algorithm distribut io within algorithm signific final analysi use simplifi model twolevel hierarch memori captur subtleti actual memori system experi show even though analysi exact respect recursivelypartit algorithm inde faster three set experi present section first set present analyz detail experi ibm rs workstat goal set experi establish recursivelypartit algorithm faster rightlook algorithm second set experi show less detail recursivelypartit algorithm outperform lapack rightlook algorithm wide rang architectur goal second set experi establish robust perform recursivelypartit algorithm third set experi show use strassen matrix multipl algorithm speed recursivelypartit algorithm seem speed right look algorithm technic detail experi oper system ver sion compil version compil option omit paper detail fulli describ technic report detail experiment analyz first set experi perform ibm rs workstat mhz power processor kbyte way set associ level datacach mbyte direct map level cach bitwid main memori bu power processor capabl issu two doubleprecis multiplyadd instruct per clock cycl lapack right look lufactor subroutin dgetrf recurs partit algorithm compil ibm xlf compil version algorithm use bla ibm engin scientif subroutin librari essl squar matric also measur perform lufactor subroutin dgef essl interfac subroutin allow factor squar matric code style data structur use recursivelypartit algorithm one use lapack par ticular permut repres algorithm sequenc exchang case array contain matrix factor alloc static align byte boundari lead dimens matrix equal number row no pad perform algorithm assess use measur run time cach miss time measur use machin realtim clock resolut one cycl number cach miss measur use power perform monitor perform monitor hardwar subsystem processor capabl count cach miss processor event realtim clock perform monitor oblivi time share minim risk measur influenc process ran experi user use machin but connect network later verifi measur valid compar real timeclock measur user time report aix getrusag system call experi experi basi measur report base averag execut code two variant recursivelypartit algorithm two version differ way permut appli submatric one version permut appli use lapack auxiliari subroutin dlaswp sub tabl perform million oper per second mflop number cach miss per thousand float point oper cmkflop five lufactor algorithm ibm rs workstat squar matric figur lapack dgetrf block size r best run time upright letter block size smallest number cach miss ital minimum number cach miss gener coincid minimum run time see text full descript experi subroutin mflop cmkflop mflop cmkflop lapack dgetrf row exchang recursivelypartit row exchang lapack dgetrf permut column recursivelypartit permut column essl dgef routin also use lapack rightlook algorithm permut row submatrix exchang row use vector exchang subroutin dswap level bla second version permut row matrix appli entir sequenc exchang one column anoth differ amount swap inner outer loop chang suggest fred gustavson first experi whose result summar tabl design determin effect complex hierarch memori system partit algorithm four fact emerg tabl recurs partit algorithm perform less cach miss deliv higher perform rightlook algorithm essl subroutin perform less cach miss lapack recurs partit algorithm achiev best close best perform permut one column time lead less cach miss faster execut exchang row true rightlook algorithm recursivelypartit algorithm probabl result advantag stride access column column permut larg stride access row row exchang perform term time cach miss algorithm except recursivelypartit column permut wors lead dimens matrix power not perform recursivelypartit algorithm column permut improv less half percent degrad perform power probabl caus fact cach fulli associ run time depend measur number cach miss complet seen fact essl dgef perform cach miss recurs partit algorithm faster fact block size lead minimum number cach miss dgetrf lead best run time discrep caus sever factor mea sure includ miss conflict level cach tlb miss instruct schedul four case tabl minimum run time achiev valu r higher number lead minimum number cach miss exampl row exchang perform least number cach miss fastest run time achiev may mean local refer lu decomposit mflop order matrix rl optim r r cach reload per kflop order matrix rl optim r rl r fig perform mflop on left number cach miss per kflop on right lu factor algorithm ibm rs workstat graph depict perform recursivelypartit pr rightlook rl algorithm squar matric optim valu r select experiment power dash line repres perform recursivelypartit algorithm column permut cp caus discrep miss level cach larger level cach therefor may favor larger block size sinc column fit it summari experi show although implement detail memori system influenc perform algorithm recursivelyparti tion algorithm still emerg faster rightlook one implement similar way second set experi design assess perform algorithm wide rang input size perform number cach miss algorithm present figur squar matric rang order level cach larg enough store matrix order follow point emerg experi begin matric order recursivelypartit algorithm column permut faster algorithm row exchang still faster lapack dgetrf row exchang we measur perform dgetrf column permut experi perform dgetrf optim block size r essenti except although optim block size clearli lead smaller number cach miss recursivelypartit algorithm perform less cach miss essl dgef input size faster first experi experi indic caus phenomenon specul caus better instruct schedul fewer miss level cach next experi design determin sensit perform rightlook algorithm block size r use column permut strategi prove effici previou experi experi consist run algorithm rang block size squar matrix order rectangular by matrix factor rectangular mflop block size r cach reload per kflop block size r fig perform mflop on left number cach miss per kflop on right rightlook algorithm column permut function block size r order squar matrix use note yax start zero block size r reload per kflop block size r fig perform mflop on left number cach miss per kflop on right rightlook algorithm column permut function block size r dimens matrix comparison perform recurs partit algorithm problem mflop cmkflop matrix aris subproblem outofcor lu factor algorithm factor block column fit within core specif dimens matric chosen minim effect conflict memori system result result shown figur show minimum number cach miss occur higher best perform achiev even higher valu r perform sensit choic r howev valu yield essenti perform mflop result matric shown figur show minimum number cach miss occur best perform occur happen coincid exactli m sensit r greater squar case especi optim valu last experi set present figur design determin whether discrep optim block size term level cach miss local refer lu decomposit mflop block size r cach reload per kflop block size r fig perform mflop on left number cach miss per kflop on right rightlook algorithm column permut function block size r order squar matrix use machin use bigger level cach level cach machin use experi compar figur comparison perform recursivelypartit algorithm problem machin mflop cmkflop optim block size term run time caus level cach experi repeat last experi squar matric order except experi conduct machin bitwid main memori bu kbyte level cach level cach two machin ident respect discrep optim block size figur smaller discrep figur experi show discrep caus sole level cach possibl determin whether smaller discrep experi due lack level cach larger level cach robust experi second set experi show perform advantag recurs partit algorithm demonstr first set experi limit singl comput architectur experi accomplish goal show recurs partit algorithm outperform right look algorithm wide rang architectur experi set compar perform recurs partit algorithm perform lapack rightlook two size squar matric larger matric fit within main memori size chosen minim impact cach associ result measur report repres averag best run minim effect process system block size rightlook algorithm lapack default use follow machin configur ffl mhz ibm rs workstat power processor kbyte way set associ datacach mbyte direct map level cach bitwid bu use bla ibm essl ffl mhz ibm rs workstat power processor kbyte way set associ datacach bitwid bu use bla ibm essl ffl mhz silicon graphic indi workstat mip rr s toledo tabl run time second lu factor algorithm sever machin machin matrix order tabl show run time recursivelypartit rp algorithm rightlook rl algorithm row exchang column permut measur avail mark na amount main memori insuffici factor larger matrix core see text full descript experi row column row column exchang pivot exchang pivot machin rl rp rl rp rl rp rl rp ibm power cpufpu pair kbyte direct map data cach bitwid bu use sgi bla machin mbyte main memori experi includ matric order ffl mhz silicon graphic onyx workstat mip rr cpufpu pair kbyte direct map data cach per processor mbyte level cach per processor way interleav main memori system bitwid bu experi use one processor use sgi bla ffl mhz dec model alpha processor kbyte direct map cach kbyte level cach use bla dec dxml ieee float point limit amount physic memori alloc process prevent us run experi matric order ffl mhz digit alphaserv alpha processor kbyte level data cach kbyte onchip level cach mbyte level cach experi use one processor use bla dec dxml ieee float point result report tabl show recurs partit algorithm consist outperform rightlook algorithm result also show permut column almost alway faster exchang row experi use strassen algorithm perform updat trail submatrix use variant strassen algorithm improv perform recurs partit algorithm replac call dgemm level bla subroutin matrix multiplyadd call dgemmb public domain implement variant strassen algorithm replac call dgemm call strassen matrixmultipl subroutin ibm essl gave similar result dgemmb use strassen algorithm dimens input matric greater machinedepend constant author dgemmb set constant ibm rs workstat recursivelypartit algorithm column permut replac avail onlin httpwwwnetliborglinalggemmw local refer lu decomposit dgemm dgemmb reduc factor time power machin second second factor time convent matrix multipl algorithm report first line tabl second run time reduc second matrix order chang would effect rightlook algorithm sinc matric multipli least one dimens r smaller experi similar experi carri bailey lee simon show strassen algorithm acceler lapack rightlook lu factor cray ymp largest improv perform howev occur larg valu r use fastest factor matrix order exampl obtain valu like caus poor perform machin cach the cray ymp cach ibm power ma chine cach increas r caus factor time convent matrix multipl algorithm increas second sec ond replac matrix multipl subroutin dgemmb reduc solut time less second conclus recursivelypartit algorithm use instead rightlook algorithm deliv similar better perform without paramet must tune paramet choos mean possibl poor choic henc new algorithm robust section show perform rightlook algorithm sensit r best perform alway coincid block size caus smallest number cach miss choos r especi difficult machin two level memori recurs algorithm hand natur choic hierarch memori system two level recurs partit algorithm provid good opportun use fast matrix multipl algorithm strassen algorithm sinc signific fraction work perform recurs partit algorithm use multipli larg matric benefit use strassen algorithm larg rightlook algorithm perform work sever multipl smaller matric benefit strassen algorithm smaller analysi rightlook algorithm section show block size r chosen valu r optim two except singl row larg fit within primari memori valu m lead better perform column fit within primari memori r set mn minim memori traffic extrem case sourc difficulti choos good valu r hierarch memori system two level experi perform rightlook algorithm matric row column sensit choic r sensit larg squar matric typic case least one row fit within primari memori rightlook algorithm optim choic r perform factor theta data transfer recurs partit algorithm experi factor led signific differ number cach miss run time conclus valu often close optim show systemindepend way choos r comparison model implement ilaenv lapack blocksizeselect subroutin use fix valu s toledo lapack user guid advis systemdepend tune r could improv perform viewpoint lapack design seem r systemdepend paramet whose role hide low bandwidth secondari memori system updat trail submatric analysi show true role r balanc number data transfer two compon algorithm factor block column updat trail submatric design outofcor lu decomposit code often propos use block column or row algorithm mani propos choos r mn entir block column fit within primari memori approach work well column short larg number fit within primari memori perform algorithm would unaccept column fit within primari memori research suggest algorithm use less primari memori necessari store column might difficulti implement partial pivot analysi paper show possibl achiev low number data transfer even singl row column fit within primari memori wombl et al present recursivelypartit lu decomposit algorithm without pivot claim without proof pivot incorpor algorithm without asymptot increas number io algorithm perform suggest recurs algorithm would difficult implement implement instead partit leftlook algorithm use toledo gustavson describ recursivelypartit algorithm out ofcor lu decomposit partial pivot algorithm use recurs larg submatric switch leftlook variant smaller submatric that would still fit within main memori depend size main memori algorithm factor matrix amount time use outofcor leftlook algorithm fix block size acknowledg thank rob schreiber read sever earli version paper comment them thank fred gustavson ramesh agarw help suggest thank anonym refere sever help comment r use strassen algorithm acceler solut linear system gemmw portabl level bla winograd variant strassen matrixmatrix multipli algorithm note matrix multipl page environ solv system larg dens linear equat matrix comput fortran page gaussian elimin optim local refer lu decomposit partial pivot design implement solar power perform monitor power next gener risc system famili beyond core make parallel comput io practic tr ctr bradley c kuszmaul cilk provid best overal product high perform comput and hpc challeng award prove it proceed nineteenth annual acm symposium parallel algorithm architectur june san diego california usa florin dobrian alex pothen design ioeffici spars direct solver proceed acmiee confer supercomput cdrom p novemb denver colorado sivan toledo eran rabani larg electron structur calcul use outofcor filterdiagon method journal comput physic v n p juli kang su gatlin larri carter architecturecogniz divid conquer algorithm proceed acmiee confer supercomput cdrom pe novemb portland oregon unit state zizhong chen jack dongarra piotr luszczek kenneth roch selfadapt softwar numer linear algebra lapack cluster parallel comput v n p novemberdecemb bjarn stig andersen jerzi waniewski fred g gustavson recurs formul choleski factor matrix pack storag acm transact mathemat softwar tom v n p june rezaul alam chowdhuri vijaya ramachandran cacheoblivi dynam program proceed seventeenth annual acmsiam symposium discret algorithm p januari miami florida matteo frigo volker strumpen memori behavior cach oblivi stencil comput journal supercomput v n p februari vladimir rotkin sivan toledo design implement new outofcor spars choleski factor method acm transact mathemat softwar tom v n p march alexand tiskin communicationeffici parallel gener pairwis elimin futur gener comput system v n p februari lar arg michael a bender erik d demain bryan hollandminkley j ian munro cacheoblivi prioriti queue graph algorithm applic proceed thiryfourth annual acm symposium theori comput may montreal quebec canada jack dongarra victor eijkhout piotr uszczek recurs approach spars matrix lu factor scientif program v n p januari siddhartha chatterje alvin r lebeck praveen k patnala mithuna thottethodi recurs array layout fast matrix multipl ieee transact parallel distribut system v n p novemb michael a bender ziyang duan john iacono jing wu localitypreserv cacheoblivi dynam dictionari proceed thirteenth annual acmsiam symposium discret algorithm p januari san francisco california dror ironi gil shklarski sivan toledo parallel fulli recurs multifront spars choleski futur gener comput system v n p april isak jonsson bo kgstrm recurs block algorithm solv triangular systemspart i onesid coupl sylvestertyp matrix equat acm transact mathemat softwar tom v n p decemb richard vuduc jame w demmel jeff a bilm statist model empir searchbas perform tune intern journal high perform comput applic v n p februari