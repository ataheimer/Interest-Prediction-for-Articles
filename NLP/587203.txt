t practic construct modifi hamiltonian a one fruit way analyz effect discret error numer solut system differenti equat examin modifi equat equat exactli satisfi approxim discret solut actual exist gener rather defin asymptot expans power discret paramet nonetheless expans suitabl truncat result modifi equat solut remark close discret solut case hamiltonian system ordinari differenti equat modifi equat also hamiltonian integr symplect evid exist hamiltonian particular calcul obtain calcul modifi hamiltonian monitor well conserv also energi drift caus numer instabl better reveal evalu modifi hamiltonian calcul would normal complic highli depend detail method even differ use approxim deriv rel simpl procedur present here nearli independ intern structur integr obtain highli accur estim modifi hamiltonian bonu method construct modifi hamiltonian exactli conserv numer solut case quadrat hamiltonian b introduct one fruit way analyz effect discret error numer solut differenti equat examin modifi equat equat exactli satisfi approxim discret solut actual exist in gener rather defin asymptot expans power discret paramet nonetheless expans suitabl truncat result modifi equat solut remark close discret solut case hamiltonian system work r d skeel support part nsf grant dm dbi nih grant prr complet visit mathemat depart univers california san diego z ordinari differenti equat modifi equat also hamiltonian integr symplect exist modifi shadow hamiltonian indic valid statist estim calcul long time integr chaotic hamiltonian system addit modifi hamiltonian sensit indic origin hamiltonian drift energi caus instabl evid exist hamiltonian particular calcul obtain calcul modifi hamiltonian monitor well conserv calcul would normal complic highli depend detail method even differ use approxim higher deriv present rel simpl procedur nearli independ intern structur integr obtain highli accur estim modifi hamiltonian consid step step numer integr x evolv approxim solut x n xnh system ordinari differenti equat fx discret solut exist modifi equat defin asymptot expans formal numer solut x nh modifi righthandsid function f h defin uniqu postul asymptot expans f power h substitut equat numer solut expand power h equat coeffici asymptot expans gener converg except reason integr appli to linear differenti equat hamiltonian system form hamiltonian hx modifi equat integr phi h appli system hamiltonian ie f modifi hamiltonian h h x integr symplect integr symplect phi hx xj phi hx x j j theoret empir evid small error long time x h solut suitabl truncat hamiltonian h h follow assum h h hamiltonian neglect small error plot total energi function time numer integr leapfrogstorm verlet appli molecular dynam simul get graph like fig observ larg fluctuat origin hamiltonian trajectori move hypersurfac constant modifi hamiltonian small drift jump energi would obscur fluctuat plot modifi hamiltonian might reveal exampl plot modifi hamiltonian fig show clear rise energi alreadi step simul indic plot suitabl modifi hamiltonian make easier test integr algorithm instabl program bug detail numer test given section continu worth emphas concern paper stabil monitoringnot monitor enhanc accuraci goal construct approxim modifi hamiltonian conveni assembl quantiti forc energi alreadi avail numer integr consid special separ hamiltonian hq system form brute forc approach would determin asymptot expans h h quantiti avail make approxim form suitabl linear combin latter match asymptot expans one could deriv follow modifi hamiltonian leapfrog method superscript n denot evalu q n center differ oper defin ffi w averag oper defin w defin term q n p n leapfrog method easier eleg construct present sec techniqu develop split method like similar construct also possibl symplect implicit rungekutta method idea add new posit conjug momentum variabl get extend hamiltonian h h y homogen order hamiltonian jy h t thu problem reduc form approxim use numer solut extend hamiltonian system plausibl construct might use theoret due exist robust approxim techniqu eq h contain h term need achiev nd order accuraci present truncat h k design exactli conserv energi numer solut h quadrat see sec use properti typic applic includ molecular dynam domin harmon motion exist modifi hamiltonian exactli conserv quadrat hamiltonian note eq b search similar method properti central result paper quadrat hamiltonian modifi hamiltonian h h actual exist if h larg h k h h simpl deriv h h onedimension case given also note hamiltonian h k detect numer instabl case quadrat hamiltonian h modifi hamiltonian h k x defin eq comput plot function time numer solut gener leapfrog method given energi time fs th order th order th order energi nd order figur energi variou truncat modifi hamiltonian decalanin unmodifi hamiltonian classic molecular dynam test done molecular dynam program written second author compat namd limit featur facilit algorithm test first coupl experi demonstr qualiti modifi hamiltonian test problem atom peptid decalanin vacuum forc field paramet charmm protein without cutoff nonbond forc figur show plot hamiltonian nd th th th order modifi hamiltonian approxim vs time fs femtosecond step size energi sampl everi th step level graph top th order truncat one bare beneath th order one th order greatli fluctuat graph energi undul one well nd order truncat note well asymptot theori hold higher order truncationson could obtain flat plot simpli smooth origin hamiltonian figur expand vertic scale show fluctuat th th th order truncat modifi hamiltonian explan order concern initi drop energi symplect method preserv volum phase space less phase space volum lower energi infer first part trajectori simpli second half unusu fluctuat word initi condit atyp ie properli equilibr with respect origin hamiltonian particularli well reveal plot nd order truncat remain experi demonstr abil modifi hamiltonian detect instabil iti test problem set water molecul harmon restrain aradiu sphere water base tipp model without cutoff flexibl incorpor ad bond stretch angl bend harmon term cf ref energi time fs th order th order th order figur closer look higher order truncat decalanin energi time fs energi figur energi flexibl water step size fs figur show plot energi vs time fs step size energi sampl everi step note larg fluctuat make difficult determin whether energi drift figur show plot th th order modifi hamiltonian step size energi time fs th order th order figur th th order truncat step size fs fs upward energi drift obviou nd th order approxim shown neither flat normal mode analysi system show fastest frequenc period rang fs use formula p show fs step size effect period discret leapfrog dynam remark th order approxim flattest even larg step size figur show plot th th order modifi hamiltonian step size appar upward drift energi theoret instabl due reson occur leapfrog method h delta angular frequenc rang fs flexibl water augment integr assum one step size h given method appli system hamiltonian h composit exact hflow hamiltonian system hamiltonian h h hl h l x assum suffici smooth domain contain infinit time trajectori exampl leapfrog method separ hamiltonian system hq rowland method special separ hamiltonian system use h doubl timestep use u fast q h fast q energi time fs th order th order figur th th order truncat step size fs molli doubl timestep except substitut u slow aq u slow q aq local tempor averag q vibrat motion defin homogen extens hamiltonian h quadrat h homogen order extend hamiltonian yield augment system initi condit system simplifi puq extend hamiltonian simplifi augment system remark associ ff q rather fi practic import want get valu p calcul follow proposit show valu extend hamiltonian calcul know solut hy homogen extens given hamiltonian hx let yt solut extend hamiltonian system ff initi j matrix augment dimens proof differenti eq respect oe give h homogen extens h solut h includ h cours goal calcul origin hamiltonian know formula solut rather calcul modifi hamiltonian know solut at grid point formula therefor must augment integr solut grid point homogen extens modifi hamiltonian integr composit hamiltonian flow accomplish use homogen extens constitu hamiltonian specif defin augment method h composit exact flow system hamiltonian hl h l q ff lemma commut method psi h defin modifi hamiltonian h h q p modifi hamiltonian origin method phi h ie follow diagram commut homogen extens discret discret homogen extens proof modifi hamiltonian h h method psi h express asymptot expans use bakercampbellhausdorf formula formula combin hamiltonian use oper scalar multipl addit poisson bracket fh x jn x thu suffici show three commut oper form homogen extens show last these homogen extens poisson bracket exactli extend poisson bracket ff remark aim discret extend hamiltonian commut properti hold extens techniqu implicit rungekutta method would requir augment method commut hold follow corollari allow valu hamiltonian approxim known valu h t grid point proposit let x h t h t solut modifi hamiltonian h h tive jy h t proof similar prop use full step valu section present construct h k even valu k let h t solut modifi extend hamiltonian system initi condit y valu h t degre k polynomi interpol valu for larg k may prefer instead use trigonometr interpol suitabl modifi prop jh z jh gammaj h interpol k error t bracket denot th divid differ note jh z jh gammaj h jetdt gammajh z jh gammaj h h t z jh gammaj h jetdt oh k z jh gammaj h second equat obtain integr part flt def jy k t express expans form suitabl linear combin valu h kj expect one get h h first k gamma lead error term elimin linear combin h note valu contain lead term oh k use elimin error term case th order accur formula case gammah z h gammah henc given formula h h term valu h t grid point let j jth center differ h t center differ oper defin ffi averag oper defin th degre interpol divid differ form henc ss ss power s averag averag gamma yield gamma therefor nd degre interpol follow eq implement formula might calcul h k consecut valu n term quantiti n defin term center differ n obtain x n onli st higher differ fi n need exampl make concret calcul h x leapfrog method given eq leapfrog method advanc one step suppress n superscript whenc need therefor case quadrat hamiltonian follow result impli that case hx quadrat numer solut exactli conserv approxim modifi hamiltonian linear function t linear combin numer solut valu proposit assum phi h composit flow system quadrat hamiltonian psi h construct proposit quantiti ij psi sum taken finit set pair integ exactli conserv method psi h proof map psi h composit flow system homogen quadrat hamiltonian ij s sy ij psi y use intermedi valu section present construct h k odd valu k numer integr one defin sensibl midstep valu use instead full step valu get estim accur oh k assum psi gammah psi h composit exact flow homogen extend hamiltonian remark necessari midstep valu approxim yt midpoint psi h time symmetr psi gamma need psi psi h psi h composit exact flow homogen extend hamiltonian exampl leapfrog method separ half step gammah psi h psi h follow remark leapfrog method estim interv ngamma kh n k odd actual use valu energi forc shorter interv n gamma k n midstep valu valu midpoint function z h t use construct hamiltonian proposit let z h z h t jz h t proof real defin psi shflow h symplect z h hamiltonian system hamiltonian also h composit flow hamiltonian nd order homogen henc homogen order z h t t degre k polynomi interpol valu z h y befor let jh z jh gammaj h interpol k error h t z k similar befor get z jh gammaj h z h t jz k h t express expans again expect suitabl linear combin differ valu h kj yield h h first k lead error term elimin linear combin h note seem possibl combin valu obtain full step half step increas order accuraci error expans two kind averag term common cancel nd order formula z h gammah z h gammah e let b j jth center differ z h t use midstep valu rd degre interpol henc power s averag averag gamma yield therefor st degre interpol follow eq exampl calcul h x leapfrog method given eq jy n suppress n superscript e therefor exampl calcul h x leapfrog method given eq eq hffif eq b ffi q f given eq and therefor case quadrat hamiltonian proposit assum phi h composit flow system quadrat hamiltoni an psi h construct proposit psi h assum begin section quantiti ij sum taken finit set pair integ exactli conserv method psi h proof composit flow system homogen quadrat hamiltonian map ij acknowledg author grate assist justin wozniak preliminari test second order truncat henonheil hamiltonian decalanin r httpwww hamiltonian interpol near ident symplect map applic symplect integr algorithm residu acceler measur accuraci molecular dynam simul shadow mass relationship veloc momentum symplect numer integr scope method modifi equat gener verlet algorithm effici molecular dynam simul longrang interact lifespan backward error analysi numer integr asymptot expans backward analysi numer int grator longer time step molecular dynam namd greater scalabl parallel molecular dynam molecular model principl applic common molecular dynam algorithm revisit accuraci optim time step stormerleapfrog analysi accuraci langevin molecular dynam algorithm backward error analysi numer integr numer algorithm hamiltonian system numer hamiltonian problem nonlinear reson artifact molecular dynam simul integr scheme molecular dynam relat applic geometr numer method perturb integr system revers multipl time scale molecular dynam modifi equat approach stabil accuraci analysi finit differ method tr ctr robert d engl robert d skeel matthew dree monitor energi drift shadow hamiltonian journal comput physic v n p juli jess a izaguirr scott s hampton shadow hybrid mont carlo effici propag phase space macromolecul journal comput physic v n p novemb