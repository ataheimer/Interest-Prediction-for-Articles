t tight upper lower bound path length binari tree a extern path length tree t sum length path root extern node maxim path length differ delta differ length longest shortest path tight lower upper bound prove extern path length binari tree n extern node maxim path length differ delta prescrib particular upper bound given that valu delta exactli achiev infinit mani valu n improv previous known upper bound could achiev factor proport n elementari proof known upper bound also present preliminari result moreov lower bound prove exactli achiev valu n deltaleq n b introduct binari tree constitut import wide use data structur storag retriev inform cost access inform store node proport distanc node root import measur effici often consid respect binari tree extern path length externalt sum distanc extern node root relat averag cost unsuccess search tree moreov extern path length relat intern path length sum distanc intern node root correspond averag cost success search tree well known extern path length binari tree n extern node thetan lg n best case worst case bad thetan larg gap best worst case motiv studi import quantiti addit inform tree avail nievergelt wong propos upper bound extern path length tree term number extern node maximum weight balanc subtre recent klein wood obtain upper bound requir much less inform tree name deriv upper bound extern path length term n number extern node delta maximum differ length path root extern node case dipartimento di informatica ed applicazioni universita di salerno baronissi salerno itali part work done author visit ibm research divis t j watson research ctr yorktown height ny aiken comput laboratori harvard univers cambridg partial support nsf grant nsfccr part work done author visit att bell laboratori new jersey usa n also construct tree whose extern path length within on upper bound paper continu extend work present upper bound extern path length binari tree n node maximum path length differ delta construct infinit class tree whose extern path length match bound exactli moreov present lower bound extern path length tree case delta n exist tree whose extern path length match exactli bound organ paper summari result paper studi path length n deltatre extend binari tree n extern node maximum path differ delta section set notat recal elementari fact binari tree section present upper bound preliminari result section give simpl deriv upper bound present section improv result give better bound that delta exactli achiev infinit mani n section present lower bound exactli comput n extern path length tree shortest extern path length lower bound first lower bound improv banal lower bound obtain consid binari tree extern node two consecut level shortest extern path length among tree number extern node background notat section set notat recal elementari fact binari tree denot set natur number n set posit natur number n set posit real number r write dxe denot least integ greater equal x throughout paper write lg x denot logarithm base x tree consid paper extend binari tree extend binari tree obtain binari tree ad special node extern node everi node binari tree exactli two children originari node binari tree also call intern node say extern node e level l tree length uniqu path root e l let n extern node level l extern path length externalt defin as intern path length tree internalt defin sum level intern node path length binari tree maximum path length differ fringet defin as also level l other last one said dens one extern node last level dens two extern node n deltatre binari tree n extern node maximum path length differ delta delta follow n deltatre n deltatre paper give bound epln delta epln delta restrict attent case exist n deltatre case complet character see section follow simpl wellknown result extend binari tree see exampl extens use sequel fact kraft equal let l l n sequenc posit integ then exist extend binari tree n extern node level l shall say n deltatre configur l extern node level l two n deltatre configur said isomorph purpos same tree follow omit l configur either clear context immateri upper bound section present upper bound epln delta problem comput epln delta state follow find maximum l subject l constraint l find exact maximum appear easi task simpl proof known upper bound recent klein wood prove follow upper bound epln delta bound e base natur logarithm bound deriv first prove extern path length relat ratio geometr harmon mean certain integ appli theorem specht section reder bound use elementari calculu obtain upper bound epln delta allow l s rang real number end maximum l sequenc l satisfi follow constraint l x l triplet n delta x exist sequenc l satisfi three constraint call admiss clear upper bound extern path length binari tree given epln delta maxfmn delta xjn delta x admiss x follow lemma give use character maximum mn delta x lemma let n delta x admiss triplet maximum mn delta x achiev sequenc l l s one equal either x x delta proof assum way contradict maximum reach l x l defin sequenc l n follow way l l l l ffi chosen kraft equal hold gammal notic suffici small valu ffl ie path length binari tree x x delta sinc function increas x equal posit hold therefor ffl xg sequenc l n satifi three constraint definit mn delta x contradict maxim l n follow lemma provid upper bound maximum mn delta x lemma let n delta x admiss triplet then proof lemma maximum achiev l l delta kraft equal get see uniqu specifi n delta y x maximum mn delta x thu given gammay function function f delta henc lemma readi prove bound theorem e base natur logarithm proof combin lemma get ae oe function maxim concav function x easili seen use elementari calculu reach maximum for fix valu n delta delta substitut get bound de santi persiano improv upper bound achiev infinit mani valu previou section maxim carri real number now show restrict x integ get better bound bound present section improv bound two account first accur second valu delta exactli achiev infinit mani valu n bound let moreov delta exist infinit subset n delta n n n delta exist n deltatre ndelta proof analysi done section clear upper bound extern path length binari tree given lemma get integ phi ndelta x maximum ie phi ndelta x concav function x integ x satisfi definit phi x obtain x satisfi howev integ power equal z z would factor delta zgammadelta thu delta imposs henc inequ uniqu determin x prove bound path length binari tree now prove bound achiev let delta x posit integ h deltax function h deltax enjoy follow three properti a h deltax x inde inequ equival x satisfi x delta b h deltax x inde written satisfi x delta c h deltax simpl algebra show equival hold three properti delta x delta exist g h deltax y deltax y deltax actual sever deltax s instanc delta consid infinit set n delta y deltal g fix delta n n delta consid extern node level l deltal delta level l delta l first all tree exist fact deltal kraft equal satisfi definit deltal obtain h deltal y deltal y deltal definit function h deltal lg l lg jm follow comput externalt turn exactli bound fact one delta delta clear bound accur bound fact everi n delta absolut maximum function phi maximum function subject addit constraint x exampl exampl consid case binari tree satisfi bound equal larger l exampl plug bound obtain actual prove bound tight valu n see exampl simpl applic bound deriv upper bound intern path length redblack tree class redblack tree constitut import class balanc binari tree guarante worstcas search cost bound obtain is term lower order equal one present prove asymptot tight bound obtain observ redblack tree fring logn bound increas delta bound let redblack tree n intern node refer reader proof bound lower bound section present lower bound exactli achiev n delta n deal gener case let us briefli discuss case see complet treatment case easili settl exist n power case n extern node locat level lg n tree uniqu hand n tree exist n power case uniqu extern node uniqu n tree locat level dlg ne gamma dlg ne extern path length ndlg ne follow properti n tree easili prove use kraft equal lemma n tree exist c extern node level dlg ne c power and due c n none integ n n power let us consid case delta n n start character n deltatre minimum extern path length prove theorem tree belong class n deltatre particular structur comput extern path length tree structur obtain lower bound minim obtain extern path length lemma let n deltatre minimum extern path length configur l two dens level moreov two dens level two level consecut level path length binari tree proof prove proof similar assum way contradict tree two nonconsecut dens level minimum extern path length is case one two dens level last one similar now consid tree configur l still n deltatre extern path length thu cannot minimum extern path length now immedi cannot two intermedi level one extern node even consecut fact suppos three level one extern node then obvious least two must nonconsecut go further let us introduc follow notat n deltatre type unspecifi greater equal b extern node level l more precis configur l shall say n deltatre type l b extern node first b level extern node follow b level on is configur l time symbol b b denot respect b level extern node less extern node done configur omit l say tree type a b context immateri lemma let tree type l contain extern node level l exactli one extern node each type l proof consid grandpar e two extern node level l node two children one intern node parent two extern node level l b now child e cannot intern node would impli either level l extern node success level extern node thu level l exactli one extern node prove induct case also prove lemma readi complet character configur n deltatre minimum extern path length fact theorem prove tree must n delta atre defin follow definit n defin n delta atre follow way n delta gammatre n deltatre type let g n delta atre n deltatre type remark notic definit consid case log fact tree type l contain least extern node l thu a n lg n gamma also notic use kraft equal easi see n delta atre exist uniqu see also discuss follow lemma theorem n n deltatre minimum extern path length n delta atre a gamma g proof view lemma n deltatre minimum extern path length two dens level level preceed dens level except first one empti consid first case two dens level dens level first two level then lemma tree type deltagamma thu n delta gammatre instead last two level dens tree type thu n delta final two dens level intermedi then lemma tree type a thu n delta atre consid case exist one singl dens level then level first tree n delta gammatre last level tree n delta otherwis tree n delta atre g lemma a x tree u configur l exist exist configur l b x tree u configur l exist exist configur l c x tree u configur l exist exist proof prove part a lemma proof part b c similar breviti denot configur l path length binari tree b first c nonneg integ a moreov gamma l use kraft equal exist one two tree impli sum equal thu tree exist lemma impli that fix n delta a exist uniqu delta atre fact a lemma natur defin invert map tree tree greater delta therefor n delta two nonisomorph n delta atre then invert map would construct two nonisomorph tree number extern node possibl next lemma give necessari suffici condit exist n delta atre comput extern path length aim defin function f a n delta follow dlg xa n delta gamma dlg xandelta a lemma n n delta atre exist interv xa n delta xa contain power case extern path length f a n delta proof prove lemma g case prove similar way suppos interv xa n delta xa contain power then lemma sinc uniqu xa n delta tree least a extern node first level therefor hypothesi part a lemma hold and thu n delta atre exist implic prove similar way comput extern path length n delta atre use lemma configur n delta atre thu extern path length complet determin configur correspond x tree express function l which turn depend valu x thu comput extern path length n delta atre tediou comput show exactli f a n delta next studi behavior extern path length n delta atre fix n delta see extern path length n delta atre biton function a is nonincreas certain valu ffdelta nondecreas ffdelta integ part uniqu solut equat easili seen ffdelta equal either blg deltac gamma blg deltac gamma lemma let n g n delta gamma tree exist f a n delta proof differ f a gamma delta equal hypothesi n delta gamma tree exist therefor lemma interv contain power delta power dlg from definit xa gamma therefor lemma prove let us consid case xa power case as interv xa gamma contain power therefor now ffdelta delta hand ffdelta delta path length binari tree lemma let n g n delta gamma tree exist n delta atre n delta gamma tree exist f a n delta proof proof lemma similar one previou lemma omit refer reader complet proof lemma let n delta n ffdelta n delta fftree exist n delta ff gamma tree n delta ff exist proof n delta fftree exist then lemma interv contain power previou power interv interv contain power thu n delta ff gamma tree exist sinc xff gamma first inequ follow definit xa n delta second equival inequ hold thu prove n delta ff gamma tree exist exist n delta ff tree establish similar way summar lemmata say n delta fftree exist is interv xff n delta xff contain power n delta fftree exist then lemma n delta ff gamma tree n delta ff exist minimum path length obtain either one thu prove follow bound n delta n contain power de santi persiano ff integ part uniqu solut equat x dlg xa n delta gamma dlg xandelta a acknowledg second author would like thank prof harri lewi suggest also thank mario mavronicola care read manuscript r intern path length redblack tree stac tight upper lower bound path length binari tree code inform theori path length binari tree art comput program upper bound total path length binari tree zur theori der elementaren mittel tr