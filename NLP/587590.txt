t affin invari converg analysi inexact augment lagrangiansqp method a affin invari converg analysi inexact augment lagrangiansqp method present theori use construct accuraci match iter error truncat error aris inexact linear system solver theoret investig illustr numer optim control problem burger equat b introduct paper concern optim problem follow type minim jx subject sucient smooth function x real hilbert space type problem occur exampl optim control system describ partial dierenti equat solv p use augment sequenti quadrat program techniqu develop method dierenti equat treat equal constraint enforc lagrangian term togeth penalti function present algorithm secondord converg rate depend upon secondord sucient optim condit comparison sqp method augment lagrangiansqp method advantag global behavior certain exampl found less sensit respect start valu region secondord converg rate reach earlier see eg shall point penalti term augment lagrangian function need implement rather realiz firstord lagrangian updat augment lagrangiansqp method appli problem p essenti newton type method appli kuhntuck equat augment optim problem newton method behavior dierent linear transform studi sever author see instanc paper combin line work present ane invari set analysi implement augment lagrangiansqp method hilbert space ane invari converg theori inexact augment lagrangiansqp method present theoret result use construct accuraci match iter error truncat error aris inexact linear system solver paper organ follow augment lagrangiansqp method introduc necessari prerequisit given ane invari introduc karlfranzensuniversitt graz institut fr mathematik heinrichstra a graz austria konradzusezentrum fr informationstechnik berlin zib takustra d berlin germani weiserzibd work author support deutsch forschungsgemeinschaft dfg sonderforschungsbereich s volkwein m weiser ane invari converg result augment lagrangiansqp method present two invari norm optim control problem analyz inexact lagrangiansqp method studi last section report numer experi done optim control problem burger equat onedimension model nonlinear convectiondius phenomena augment lagrangiansqp method let us consid follow constrain optim control problem minim jx subject real hilbert space throughout distinguish function dual space riesz represent hilbert space hilbert space x endow hilbert space product topolog and breviti set let us present exampl p illustr theoret investig use numer experi carri detail refer reader exampl let denot interv set given defin space w hilbert space endow common inner product control state w given weak solut unsteadi burger equat robin type boundari condit ie satisfi y x t yt y x t ft denot dualiti pair h dual suppos f l recal w continu embed space continu function l denot c l see eg p therefor a make sens everi control u v associ cost track type jy u z l q fix let introduc bound oper whose action defin ey u v l t h ey u given g h map neumann solut oper associ optim control problem written form p c augment lagrang function associ p defin follow assumpt rather standard sqp method hilbert space suppos hold throughout paper assumpt let x x refer point a j e twice continu frechetdierenti map j e lipschitzcontinu neighborhood x b linear e oper e x surject c exist lagrang multipli satisfi firstord necessari optim condit frechetderiv respect variabl x denot prime d exist constant ker e ker e denot kernel null space e remark context exampl write x prove assumpt hold provid y z l q sucient small next proposit follow directli assumpt proof refer instanc proposit assumpt hold x local solut p furthermor exist neighborhood uniqu solut neighborhood map x l c x bound quadrat func tion fact refer augment l c formul next proposit proof refer reader s volkwein m weiser proposit exist neighborhood u x constant c map x l c x coerciv whole space x x u remark due assumpt proposit convex neighborhood x a jx ex twice frechetdierenti second frechetderi vativ lipschitzcontinu ux c l x coerciv kernel e x d point z uniqu solut u exist c x c c shorten notat let us introduc oper x u firstord necessari optim condit express find x numer solv os newton method frechetderiv oper f c u given denot adjoint oper e x remark assumpt hold exist constant c satisfi see eg p bz denot banach space bound linear oper z formul augment lagrangiansqp method algorithm a choos c solv x linear system d set back b remark sinc x hilbert space equival obtain solv linear system set equat correspond newton step appli os form iter requir implement e c algorithm see case exampl requir least one addit solv poisson equat ane invari let arbitrari isomorph transform x variabl by thu instead p studi whole class equival transform minim problem by subject e transform solut set g c y by firstord necessari optim condit form appli algorithm os get equival sequenc transform iter theorem suppos assumpt hold let start iter algorithm appli optim condit os os respect sequenc iter welldefin equival sens proof first note frechetderiv oper g c given by prove use induct argument assumpt ident hold suppos satisfi k impli use step b algorithm follow conclud y util step d algorithm get desir result due previou theorem augment lagrangiansqp method invari arbitrari transform b state space x nice properti should cours inherit converg theori termin criteria develop invari theori exampl usual local newtonmysovskii converg theori cf p ane invari lead unsatisfactori descript domain local converg consid optim problem subject uniqu solut x associ lagrang multipli note jacobian f depend here context remark choos neighborhood s volkwein m weiser x d c a x x fig illustr exampl a contour line cost function constraint area occupi subplot b neighborhood ux gray kantorovich ball theoret assur converg white origin problem formul c ux kantorovich ball better formul d ux kantorovich ball better formul plot coordin origin formul defin newtonmysovskii theori essenti guarante converg start point kantorovich region here denot spectral norm symmetr matric euclidean norm choic u result section kantorovich region plot figur b dierent choic coordin howev yield significantli dierent result transform problem written subject neighborhood u better constant result again section kantorovich region shown figur c transform back space figur d reveal much larger domain theoret assur converg better formul problem is howev evid contrast converg theori invari linear transform automat includ best formul remark invari newton method limit transform type fact newton method invari arbitrari transform domain imag space ie behav exactli af c f c special gradient structur optim context meaning transform coupl due chain rule meaning transform result transform underli optim problem ie transform domain space imag space constraint type x gener transform possibl defin norm invari way sinc domain imag space constraint transform x reason dierent type transform studi dierent problem see eg ane invari converg theori formul converg theori termin criteria term appropri norm use norm invari transform definit let z u norm z z r z u call ane invari os f c zz z z u z z call z zu continu famili invari norm os everi r z z z u z z u use ane invari norm abl present ane invari converg theorem algorithm theorem assum assumpt hold constant continu famili ane invari norm z zu oper f c satisfi z s z u z z coz z z u co denot convex hull a k n let h suppos h level set lz close then iter stay u residu converg zero rate k s volkwein m weiser addit f c z k z k f c z k z k proof induct assum lz k close h k k due remark neighborhood u assum convex z f c z k z conclud ds ds appli h z k ds hold z k z k exist z k ie contradict henc z k z k thu h k h close everi cauchi sequenc lz k converg limit point lz k is continu norm also contain lz k henc lz k close final use result obtain remark choos simplic sharp here definit level set lz sharpen somewhat care estim term theorem guarante lim k h ensur z k z z k requir canon norm z z bound appropri ane invari norm z corollari if addit assumpt theorem exist constant c z z u iter converg solut z proof assumpt theorem thu z k kn cauchi sequenc lz u sinc lz close claim follow remark d actual implement algorithm need converg monitor indic whether assumpt theorem may violat termin criterion decid whether desir accuraci achiev new iter z k accept whenev f c z k z k f c z k z k otherwis assumpt theorem violat iter consid nonconverg use norm z k old new iter permit ecient implement sinc mani case norm f c z k z k defin term z deriv need evalu new iter factor f c z k avail via direct solver reus neglig cost even converg test fail iter solver use z k gener provid good start point comput z k addit cost introduc converg monitor minor sqp iter termin solut z k soon user specifi toler tol again use norm z k allow ecient implement invari norm optim problem remain done construct continu famili invari norm section introduc two dierent norm first invari norm first norm take advantag paramet c augment lagrangian mention remark exist c l c z coerciv x z u c c henc oper belong bz c c let us introduc oper z u c sinc l c z selfadjoint z u c z selfadjoint well due oper c z coerciv z u c c thu z u norm z c c proposit let c c then everi z u map s volkwein m weiser defin ane invari norm proof let z u arbitrari sinc s defin norm z c c f c z continu invert remark follow z norm z prove invari properti let l c denot augment lagrangian associ transform problem set r conclud u use obtain give claim order show continu requir theorem need follow lemma lemma suppos c c exist constant z z u z z z z u proof let z z u infer assumpt c z continu invert util lipschitz assump tion second addit term righthand side estim note impli insert claim follow proposit let hypothes lemma satisfi z zu continu famili invari norm f c z z z z u introduc proof follow estim addit term righthand side separ use lemma find appli obtain henc use s volkwein m weiser follow z zu c e continu famili invari norm final z z infer second invari norm introduc invari norm provid augment paramet algorithm satisfi c c mani applic constant c explicitli known thu l c x need bound c c c x given might singular overcom diculti defin second invari norm base split x least coerciv l x ker e x util even though thu defin norm use larger valu c may improv global converg properti see section begin with let us introduc bound linear oper c lemma everi x u c oper c x isomorph proof let r x arbitrari equat c x equival due remark oper f c x continu invert x u c thu uniqu determin claim follow defin bound linear oper r c x u c note r c x coerciv selfadjoint next introduc invari norm z z u r r z shorten notat write r c z c z first addit term proposit everi z u map given ane invari norm os equival usual norm z proof let z u arbitrari sinc r c z coerciv c z continu invert follow z defin norm inde equival usual norm z prove invari properti x by u util invari properti follow follow proposit guarante z zu continu famili invari norm os proposit suppos exist constant z z u z z z z u proof previou proposit use follow lemma lemma assumpt proposit hold z x follow ker e proof let use obtain c oper r c z continu invert furthermor r c z selfadjoint thu appli second addit term righthand side estim insert bound claim follow lemma let assumpt theorem satisfi z r x proof arbitrari r x set use estim z z s volkwein m weiser claim follow proof proposit let z z util lemma find z z therefor z henc z zu continu famili invari norm remark note lipschitz constant second norm involv c e henc independ choic c contrast choos c small may lead larg lipschitz constant first norm thu aect algorithm exampl let us return exampl use second norm theoret assur ane invari domain converg shown figur compar figur b d shape size clearli similar noninvari domain converg better formul and definit chang coordin chang x fig illustr exampl neighborhood ux gray ane invari domain theoret assur converg white comput ecienc ane invari two norm develop previou section come free evalu norm involv evalu standard norm nevertheless comput overhead first norm defin almost neglig sinc gener implement one addit matrix vector multipl requir howev sucient larg paramet c hand second norm defin work arbitrari c requir one addit system solv jacobian dierent right hand side case factor matrix avail comput overhead neglig compar cpu time exact newton method if howev system solv iter addit system solv may incur substanti cost case first norm prefer connect optim problem solv optim problem type p feasibl optim relev quan titi well reflect propos norm z let z x use taylor theorem see p continu l obtain first norm z second norm base partit f c x correspondingli split newton correct optim direct tangenti constraint manifold feasibl direct f c x z recal thu proxim solut ane invari norm measur quantiti interest solv optim problem addit error lagrang multipli optim direct lagrang multipli compon respect inexact augment lagrangiansqp method take discret error truncat error result iter solut linear system account consid inexact newton method inner residu remain z inexact newton method studi non ane invari set dembo eisenstat steihaug bank rose s volkwein m weiser slightli stronger assumpt suitabl control inner residu similar converg theori establish note exact ane invari preserv case inner iter ane invari too theorem assum assumpt hold constant continu famili ane invari norm z zu oper f c satisfi z s z u z z z defin level set suppos z u lz close inner residu r k result inexact solut newton correct bound iter stay u residu converg zero k rate f c z k z k f c z k z k proof analog proof theorem one obtain ds use find z k ds z k z k thu set f c z k z k z k use follow f c z k z k z k u coz k z k f c z k z k contradict thu z k u furthermor insert therefor lz k lz k close next corollari follow analog corollari corollari if addit assumpt theorem exist constant c cf c z z z z u iter converg solut z os actual implement inexact newton method follow theorem need satisfi accuraci requir thu need error estim inner iter comput k also easili comput estim lipschitz constant case suitabl theoret valu deriv set readili obtain z k henc lower bound z k unfortun norm involv solut newton type system therefor cannot comput exactli assum rel accuraci evalu norm respect defin actual comput estim s volkwein m weiser would like select k accuraci match condit unfortun due local sampl global lipschitz constant inexact comput norm estim k possibl small translat possibl larg toler inexact newton correct order compens that introduc safeti factor requir approxim accuraci match condit hold obviou choic would proposit infer order magnitud thu take estim current ignor c e use first norm again converg monitor use detect nonconverg inexact set howev converg monitor may also fail due k chosen larg therefor whenev violat reduct k promis eg newton correct recomput reduc k remark inner iter use approxim solv newton equat provid orthogon relat z k z k scalar product z k induc ane invari norm estim tighten substitut k furthermor norm z k exact newton correct comput avail permit construct algorithm robust even larg inaccuraci k applic conjug gradient method confin null space linear constraint augment lagrangiansqp method focu futur research numer experi section devot present numer test exampl illustr theoret investig previou section solv p appli socal optimizethendiscret approach comput approxim solut discret algorithm ie discret associ system context exampl x y reduc size system take advantag relationship sqp step u v control sqp step lagrang multipli fact infer algorithm insert obtain system unknown y note second frechetderiv lagrangian given solut y u v comput follow first solv y x y x in z q in obtain u v detail refer reader time integr use backward euler scheme spatial variabl approxim piecewis linear finit element program written matlab version execut pentium iii mhz person comput run neumann control first exampl choos grid given solv appli newton method time step algorithm need one second cpu time valu cost function turn optim control problem choos desir state zt view choic z nonlinear convect term yy x b interpret problem determin u way counteract uncontrol dynam smooth discontinu transport left increas discret lead indefinit system start valu algorithm take s volkwein m weiser taxi xaxi optim optim control u t v t taxi fig run residuum yt zt l optim control tabl run i decay fc z k z k first norm i first solv lufactor matlab routin lu theori appli accord stop sqp iter case f c z z larg factor righthand side might big avoid situat algorithm termin and addit hold augment lagrangiansqp method stop four iter cpu time dierent valu c found tabl let us mention algorithm need second diverg algorithm prove set admiss start valu reduc whenev c enlarg valu cost function figur residuum yt zt l solut optim state plot furthermor optim control present decay f c z k z k first invari norm given dierent valu c shown tabl recal invari norm defin c c unfortun constant c unknown proceed follow choos fix valu c comput tabl run i valu k dierent c tabl run i decay fc z k z k second norm level sqp iter whenev k greater zero coerciv direct sqp step otherwis c need increas tabl present valu k observ numer k posit increas c increas next test second norm introduc again augment method stop four iter need second cpu time thu invari norm lead similar perform algorithm decay f c z k z k found tabl ii solv inexact gener minimum residu gmre method matlab routin gmre precondition gmre method took incomplet lufactor matrix util matlab function luincd here matrix p discret heat oper y xx homogen robin boundari condit y x precondition use newton step chose introduc estim constant denot k k respect thu k calcul k k determin k follow first norm f c z k z k z k alreadi determin comput previou newton correct thu case second norm f c z k z k z k calcul given toler k test take k k start valu choos test four strategi choic turn obtain best perform respect cpu time henc follow s volkwein m weiser tabl run ii decay fc z k z k first norm tabl run ii valu k test exampl take decay f z k z k present tabl algorithm stop seven iter let us mention c estim k coerciv constant posit particular augment lagrangiansqp method best perform tabl valu estim k present tabl cpu time first norm present turn perform inexact method chang significantli dierent valu k sinc solv addit linear system level sqp iter order comput second norm first norm lead better perform inexact method respect cpu time compar part i cpu time reduc one take first norm case second norm reduct final test inexact method use decreas k choos turn strategi speed inexact method norm expect theoret complex model develop run robin control choos desir state taken zt i first solv lufactor take start valu stop criteria run augment lagrangiansqp method stop four iter need second cpu time discret optim solut plot figur tabl follow satisfi exact tabl run ii cpu time second first norm first norm second norm exact tabl run ii cpu time second norm numer let us mention posit c need cpu time refer tabl ii solv inexact gmre method precondition take run choos k decay f z k z k present tabl part i find k test run need cpu time shown tabl see inexact augment lagrangiansqp method gmre much faster exact one use lufactor first norm cpu time reduc second norm k moreov exampl best choic c smaller valu k method speed significantli run test inexact method use decreas k choos run strategi speed inexact method significantli norm reduct compar cpu time fix k compar tabl tabl run i decay fc z k z k dierent c s volkwein m weiser taxi optim state tx optim control u t v t taxi fig run optim state control tabl run ii decay fc z k z k exact tabl run ii cpu time second first norm first norm second norm exact tabl run ii cpu time second norm r global approxim newton method subspac cascad multigrid method mortar element mathemat analysi numer method scienc technolog newton method nonlinear problem local inexact newton multilevel fem nonlinear ellipt problem finit element method navierstok equat inexact gauss newton method paramet depend nonlinear problem augment lagrangiansqpmethod hilbert space applic control coecient problem optim vector space method first secondord necessari sucient optim condit infinitedimension program problem iter solut nonlinear equat sever variabl nonlinear function analysi applic tr ctr anton schiela martin weiser superlinear converg control reduc interior point method pde constrain optim comput optim applic v n p april s volkwein lagrangesqp techniqu control constrain optim boundari control burger equat comput optim applic v n p decemb