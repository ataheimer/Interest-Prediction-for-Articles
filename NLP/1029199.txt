t locat divers anonym network a anonym network long reli divers node locat protect attackstyp adversari observ larger fraction network launch effect attack investig divers two deploy anonym network mixmast tor respect adversari control singl internet administr domain specif implement variant recent propos techniqu passiv estim set administr domain also known autonom system ase two arbitrari endhost without access either end path use techniqu analyz aslevel path like use anonym network find sever case network multipl node administr domain further mani path node node popular endpoint travers domain b introduct anonym network aim provid commun privaci individu group internet network still vulner power eavesdropp varieti organ rang corrupt law enforc curiou isp passiv observ larg piec internet highlat mix network mixmast adversari observ larg volum network traffic notic time certain recipi like receiv messag particular sender transmit messag lowlat network like onion rout directli vulner eav permiss make digit hard copi part f work person classroom use grant without fee provid c opi made distribut profit commerci advantag co pie bear notic full citat first page copi otherwi e republish post server redistribut list requir prior specif permiss andor fee octob washington dc usa dropper end connect quickli link sender recipi packet count time attack anonym design use three strategi mitig attack batch pool network collect group input messag reorder exit hinder adversari learn messag batch origin given sender pad sender provid decoy traffic well normal traffic complic adversari attempt correl sender receiv dispers reduc chanc adversari see endpoint given commun may entir block attack lowlat network slow intersect attack highlat network dispers achiev increas number node network adversari given strength see less network arrang overlay topolog messag enter exit place network compar cascad topolog locat diversitycoordin network behavior transact spread multipl jurisdict paper investig variant locat divers take advantag fact internet divid thousand independ oper network call autonom system ase consid underli topolog internet rout assess vulner exist mix network certain class adversari specif locat independ metric reflect probabl path entri point mix network path exit point travers as consid topolog node select algorithm two exist mix networkstor mixmast and evalu independ metric network paper present sever interest result first find tor mixmast multipl node autonom system differ ip address space user network take care avoid select two node as light thi argu node select algorithm look ip prefix use tarzan morphmix like less effect achiev locat independ next measur locat independ path insid mix network find short path given exist mix network topolog mixmast tor node select algorithm frequent creat path observ singl as longer mix path greatli reduc likelihood singl observ signific fraction link path final use model typic sender receiv anonym network measur likelihood singl observ path initi entri node path exit node respond find entri exit path result random node selectioneven initi never choos node entri exitar like observ singl time depend locat initi respond singl observ path alway backbon isp conclud slightli differ node select algorithm allow user minim likelihood entri path exit path travers as background first describ differ type mix network present brief explan type attack type mix network must protect against then provid background internet rout topolog anonym network chaum propos hide correspond sender recipi wrap messag layer publickey cryp tographi relay path compos mix mix turn decrypt delay reorder messag relay onward subsequ anonym system diverg two direct system like babel mixmast mixminion defend power adversari cost requir high variabl latenc system onion rout successor tor freedom network support lowlat transact web brows necessarili weaker threat model onion rout freedom differ singlehop proxi like anonym fixedpath topolog like web mix aim achiev much divers node placement path select possibl anonym network tri protect wide varieti passiv activ attack attack gener fall two categori attack insid network endpoint attack attack insid network partit anonym set passiv observ activ traffic manipul otherwis narrow set suspect given transact endpoint attack treat network black box consid entri node exit node transact attack includ simpl time count attack lowlat system longterm intersect disclosur attack highlat system mixmast tor deploy network dozen node around world appendix b list node network describ threat model section path select algorithm section previou work recogn import locat ind pendenc tim may eric hugh wrote idea locat independ earli post cypherpunk list mixmast oper attempt track isp control node gain inform intuit independ network previou anonym network tarzan morphmix attempt provid collus resist compar ip peer our result show techniqu less effect claim paper evalu topolog real anonym network context properti internet rout aslevel design way quantifi result internet rout topolog determin network packet travers node mix network must first understand packet peer peer custom provid c export c filter other figur common relationship export restrict rout two arbitrari host internet sec tion first present brief overview interdomain rout ie rout isp internet describ avail data internet topolog assumpt regard well data reflect path packet actual travel border gateway protocol internet compos independ oper network autonom system ase exchang reachabl inform use border gateway protocol bgp could internet servic provid isp corpor net work univers network router rout traffic global destin use inform propag rout protocol find rout destin ip address router perform longest prefix match ip address find specif ip prefix rout tabl contain ip address exampl look ip address router might use rout prefix router forward packet destin next hop specifi rout prefix router select rout smallest prefix contain ip address exampl router rout tabl prefix for say router would prefer rout former internet rout tabl prefix associ rout origin rout advertis rout neighbor ase via bgp attach number path rout router neighbor learn rout router propag router as router will turn exchang rout ase router typic readvertis rout neighbor ase prepend number path process fashion bgp allow learn aslevel path rout destin learn via bgp ase blindli propag rout neighbor rather pair ase commerci relationship may prefer send traffic via one anoth econom reason ase form bilater arrang broadli categor either customerprovid relationship custom pay provid rout traffic it peer relationship two ase exchang traffic network and network custom neither pay privileg bgp rout base polici shortest path ex ampl figur typic prefer rout traffic destin via one custom who pay connect via one provid whom must pay send traffic to ward one peer relationship also determin rout one advertis anotheran typic advertis rout learn one peer provid network next hop metric locprf path figur exampl bgp rout tabl entri taken ciscolik router peer provid would constitut implicit agreement forward traffic two provid two peer etc figur would advertis rout learn custom neighbor would readvertis rout learn peer peer and vice versa provid would also advertis rout learn provid custom peer figur show simplifi bgp rout tabl entri router learn two rout destin prefix rout variou attribut includ next hop ip address where rout packet use path variou attribut affect rout select prefer rout de tinat path path begin first line indic router select rout best rout destin use bgp decis process router singl best rout destin time rout tabl entri allow us reason certain packet destin destin ip address travers network correspond number level mit packet tend follow sequenc ase sinc level traffic flow opposit direct router advertis rout aslevel internet topolog path endhost internet travers sequenc ase or jurisdict estim sequenc ase given path cross must first represent internet topolog aslevel ie ase connect to well busi relationship determin complet view aslevel graph notori difficult bilater polici hide edg graph perspect exampl figur rout tabl captur peer contain rout peer link sinc center readvertis rout learn one peer anoth mani publicli avail place provid access rout tabl data preval oregon routeview project maintain rout server peer ase ase send rout tabl routeview server learn ass best rout destin prefix ass rout tabl slightli differ mean aslevel topolog construct routeview rout server miss intera edg due bilater poli cie graph repres enough purpos futur could improv analysi incorpor newer techniqu captur aslevel topolog know aslevel topolog enough determin aslevel path two arbitrari mix node though determin thi need make assumpt aslevel path packet actual travers describ section rare except rule exampl discrep result router advertis bgp rout via one deflect data packet router within select differ nexthop as note rout protocol misconfigur addit recent work observ path rout tabl may alway match sequenc network packet forward through typic differ minor occur infrequ threat model alic want commun bob without reveal lo cation intend improv alic anonym adversari monitor singl for exampl curiou isp corrupt law enforc offic abus subpoena power assum abil observ multipl ase significantli difficult observ singl as isp control multipl ase law enforc less will face increas account risk associ obtain multipl unapprov subpoena investig further must consid attack effect differ class anonym network divid attack intranetwork attack endpoint attack describ section endpoint attack lowlat network straight forward adversari observ alic bob quickli learn commun previou analysi onion rout shown adversari observ c n node network break cn transact requir path alic anonym network path anonym network bob travers separ ase prevent observ transact long ase collud intranetwork attack lowlat network also use ful particular path tor no longer deploy freedom protocol gener hopsshort enough maintain us abil short two node certain link alic bob decid collud adversari observ two link path break assumpt adversari common design reconsid path length success endpoint attack highlat system like mixmast take lot time effort one lowlat system like tor howev observ even mixmast node may abl link alic recipi work also relev protect highlat system singlea adversari further intranetwork observ particularli period low traffic combin activ attack messag flood shrink set messag mix alic messag model techniqu describ model mix network internet rout draw conclus anonym network vulner eavesdrop adversari detail section first describ model node select mix network then present techniqu estim aslevel path two arbitrari host internet node select mix network establish path anonym network client must somehow discov set current node mixmast client examin output pinger softwar measur node reliabl publish key address node tor client download similar network snapshot special node call directori server pinger directori server note whether node exit nodemean oper will allow traffic exit network node some oper choos instead middleman node avoid need deal abus complaint abstract alic get list assum set n possibl choic e n exit node also assum node network list work typic node list temporarili offlin build path length alic first select exit node random e select node n remail network case select node node appear twice row onion rout case select node node appear twice anywher path aslevel mix network path estim activ measur tool tracerout could use discov aslevel path exampl mix network oper could execut tracerout pair mix node determin iplevel path and henc aslevel path them first note measur would robust singl compromis mix importantli howev alic must also determin aslevel path mix entri select well aslevel path mix exit select destin send pack et discov aslevel path good candid mix node alic must run tracerout node mix net work may engend suspicion further abl activ determin aslevel path chosen exit node destin rout tabl node may unavail difficult obtain covertli tracerout candid exit node destin also like engend suspicion thi approach work anyway node compromis final without access host destin node alic unabl run tracerout destin node chosen exit node ie path traffic destin alic travers case alic discov aslevel path destin chosen exit node use passiv infer techniqu examin rout tabl alic access uptod rout tabl everi network contain mix node could construct reason estim aslevel path fairli easili discov aslevel path node could look is rout tabl determin path associ rout longest prefix match address unfortun alic cannot ask rout tabl mix node construct mix tunnel first act request rout tabl particular network might attract attent eavesdropp particularli ask larg number rout tabl second ask network contain mix node current rout tabl like quit slow sinc full rout tabl approxim megabyt addit alli rout continu chang part tabl like outofd even request it third method introduc anoth vulner attack adversari compromis domain contain mix node could send back inaccur version rout tabl shortcom alic must passiv determin aslevel path or reason approxim it without visibl rout tabl hop intend mix path fortun examin path bgp rout tabl give reason estim ase connect ase provid reason inform path arbitrari internet host might take reach given destin summar aslevel path estim techniqu base techniqu recent propos mao et al although admittedli imposs determin ass rout polici absolut certainti mao work suggest infer aslevel path base common polici accur path one bgp rout tabl construct aslevel graph repres internet topolog rout bgp rout tabl path attribut provid list adjac exampl rout figur know directli con nect given complet list adjac bgp rout tabl reason approxim aslevel topolog internet cours polici appli base commerci relationship eg may filter rout learn one peer advertis rout anoth peer provid certain edg graph global visibl result approxim aslevel graph may omit certain edg typic miss edg smaller ase thu algorithm may realiz particular edg exist two ase and result infer wrong aslevel path destin determin origin destin ase path question determin aslevel path two host must first determin ase host locat reason easi gener suffici look bgp rout tabl find final path particular destin exampl figur last path prefix therefor gener safe assum prefix contain within locat ase often alloc address space custom address space techniqu appli specif prefix rout tabl determin relationship pair ase notori difficult problem ase typic guard natur relationship neighbor ase fortun use heurist previou work tend work reason well basic idea exploit valleyfre properti internet path assign pairwis relationship ase is path travers sequenc customerprovid edg zero one peer edg sequenc provid custom edg therefor pair path assign either customerprovid provid custom relationship everi pair highest degre path assign customerprovid re lationship everi pair assign provid custom relationship if two separ path two ase custom other algorithm design peer complet detail infer algorithm provid previou work estim aslevel path two ase find shortest path compli common polici practic bgp router select singl best rout de tinat pair host typic travers singl uniqu path direct see section discuss except step assum ase implement polici prefer shortest path consist best common practic prefer custom rout peer rout peer rout provid rout mao et al algorithm suggest assumpt reason aslevel path estim techniqu improv techniqu estim actual aslevel forward path matur determin ase mix network travers becom easier improv allow alic make inform decis mix node choos achiev locat independ it also improv accuraci type analysi present paper given model anonym network select node estim aslevel path two arbitrari host internet alic determin complet set ase typic mix network path travers use passiv techniqu explor question detail section section summar data use analysi aslevel path mix network base analysi locat mix node deploy system today describ data use gener aslevel network topolog mix network sender receiv evalu node select mixmast tor model use oper mix node respect network tabl appendix provid list mix node two network sinc also interest aslevel path alic mix entri point mix exit point bob must also estim ase alic bob may typic locat unfortun usag data mix network readili avail possibl drive simul list common locat sender receiv nevertheless perform reason approxim assum alic locat home network eg cabl modem network dsl network etc bob content host locat data host isp gener set ase sender might locat creat list dsl cabl modem provid www dslreportscom would like sender map provid respect number gener list typic receiv sampl site comscor media metrix top us internet properti decemb well site think might popular anonym network list sender receiv use experi appendix a paper use topolog exist mix network get plausibl set node model tor node repres newborn network particip develop earli adopt wherea mixmast network repres wider particip set deploy mani year compar node set perform initi typic dsl cabl modem user us respond popular websit usin effect evalu locat independ newborn tor network independ node set resembl tor network tor matur internet topolog gener estim internet aslevel topolog use rout tabl dump routeviewsoregon ixnet rout server januari pm gmt perform analysi section use passiv techniqu could run tracerout mixmast node want directli compar tor mixmast network part futur work plan use tracerout measur pairwis path tor network compar accuraci aslevel estim alic would make use techniqu ground truth tabl extern bgp ebgp feed ase some ase multipl ebgp feed rout server use tabl gener view aslevel topolog includ intera relationship comput pairwis aslevel shortest path describ section map ip address ase locat result first discuss fundament robust properti exist mix network addit maxim locat independ entri exit point mix network tri minim case one observ multipl link along mix network path analysi independ model mix network user ie sender receiv sinc examin properti mix node themselv next comput probabl aslevel path sender entri node path exit node receiv travers ie probabl singl observ endpoint mix network path given tor mixmast topolog reason assumpt locat sender receiv independ mix node path section explor quantifi locat independ mixmast tor topolog examin case tor mixmast node locat as also examin aslevel path properti pair exist mix node quantifi extent aslevel path two mix node travers common ase examin likelihood mixlevel path travers common ase forward ie sender recipi revers ie recipi repli sender direct node properti tabl appendix b show mixmast tor network multipl node as tor three mix node speakeasi dsl mixmast two node ase telecom italia hurrican elec tric sbc speakeasi dsl hetzner onlin lack locat independ node placement surpris particular reflect fact network node oper volunt mani commonli oper mix node internet connect home eg dsl provid etc nevertheless fact network multipl duplic ase suggest user mix network exercis caution select mix node particu larli entri exit node previou work and convent wisdom suggest select node disjoint subset ip address space achiev independ node placement clear survey mixmast tor type prefixbas mechan are gener ineffect give user fals sens secur exampl tarzan morphmix suggest subdivid node space prefix subsequ prefix select node distinct subset ip prefix space reduc likelihood two mix node jurisdict singl unfortun techniqu necessarili increas likelihood locat independ five pair mixmast node locat as three pair those ase distinct prefix also distinct prefix similarli one tor network node distinct tor mixmast asdisjoint mix node pair mix node pair common level commun llc level commun llc abovenet commun inc abovenet commun inc verio inc cogent commun global cross uunet technolog inc ashland fiber network unit layer inc unit layer inc indiana univers california state univers harvard univers verio inc cai internet internap network servic tabl character locat independ mixmast tor prefix achiev locat independ mix network must explicitli consid actual host simpli ip address final note mani tor network exit node current locat unit state practic network could achiev greater locat independ increas exit node particip outsid us path properti tabl show extent locat independ mixmast tor tor node locat distinct ase total asdisjoint mix node pair similarli mixmast node locat distinct ase asdisjoint node pair strike statist appear nearli tor asdisjoint path also appear mixmast asdisjoint path node pair reason preval explain two factor locat node mix network fundament properti aslevel topolog ie mani path ultim travers tier isp mix topolog examin seem particularli like travers first mani tor mixmast node locat edg network mean that node path node cross much time phenomenon especi true node locat edg network singl prefer upstream isp exampl node mit use inbound outbound path except path internet destin second mani path internet particularli two edg network travers least one larg tier isp ie isp oper backbon buy upstream servic anoth isp surprisingli tabl show mani ase larg number mix node pair tier isp eg uunet qwest global cross att aol verio abovenet preval certain isp mix node pair suggest length mix network path increas likelihood abl observ path one locat also increas still likelihood abl observ signific fraction link mix network path decreas length path increas test hypothesi gener random mix path mix net work use remail onion rout node select algorithm as describ section vari length two hop eight hop measur probabl path cross multipl link length type path ran trial figur show probabl singl abl observ link along mix network path mix network path differ length figur show probabl singl abl observ one link along path certain length figur show properti revers path mix network path length one two less two link and thu never observ twice contain second node threehop path alway observ link path incid link path reason ase second third hop fourhop path alway abl observ one link path figur show result tor mixmast network topolog two differ node select scheme allow mix node use twice along mix path long mix node use two consecut hop with replac remail network allow mix node use without replac onion rout ing figur show two interest result first mix path shorter four hop singl observ link mix network path second tor node select algorithm ie onion rout scheme provid signific protect observ multipl link tor mixmast network topolog exampl fourhop path construct tor node without node replac observ singl link probabl wherea fourhop path construct node replac observ probabl result make sens random node select replac like result hop use twice along singl mix path explicitli prevent figur also seem indic revers path mix network ie path web server cabl modemtyp user slightli vulner observ entri exit vice versa independ entri exit path evalu locat independ entri exit path typic mix network use list common sender receiv locat appendix model typic path sender receiv mixmast tor topolog thi gener random entri exit pair network and senderreceiv pair observ number time path sender entri node travers least one path perform analysi forward revers path mix network tabl show probabl sender receiv event see pair sender receiv least subset entri exit path travers upon entri probabl one see link number mix hop tor node replac tor node without replac mixmast node replac mixmast node without replac figur fraction path singl observ link mix network path probabl one see one link number mix hop tor node replac tor node without replac mixmast node replac mixmast node without replac figur fraction path singl observ one link mix network path probabl one see link number mix hop tor node replac tor node without replac mixmast node replac mixmast node without replac figur fraction path singl observ link revers mix network path probabl one see one link number mix hop tor node replac tor node without replac mixmast node replac mixmast node without replac figur fraction path singl observ one link revers mix network path note slightli differ yaxi scale exit upon investig learn travers entri exit often alway tier isp result suggest sender mix network exercis care select entri exit node avoid choos entri exit path travers as also suggest certainli possibl intellig sender select entri exit node entri exit path travers entri exit eg speakeasi googl tor entryexit node pair result entri exit path cross entri exit howev careless sender pay attent aslevel topolog may well observ singl entri exit exampl alic use aol as isp attempt connect cnncom as singl ie observ entri exit path absolut certainti aol time warner own turner broadcast as includ cnn locat independ pair sender receiv highli asymmetr exampl tor network comcast as indymedia as entryexit node pair result path travers entri exit indymedia comcast hand random entri exit node select suscept observ path case result suggest that certain case user may wish establish differ mixlevel path forward revers traffic minim possibl singl observ entri exit traffic find entir un expect given asymmetr path properti internet interestingli tabl also show locat independ high sender receiv locat tier isp eg part sprint might path sender entri point alreadi locat tier isp thu cross tier isp en rout entri point design recommend light analysi shown certain ase consider eavesdrop capabl mix network propos two recommend regard mix network design first mix network select path underli aslevel topolog mind second mix network strive deploy node locat rich connect ase consider aslevel path result suggest design user mix network take account underli aslevel path link mix network mix network path made safe receiv sender tabl locat independ typic send receiv ase forward and revers path tor network topolog entri show senderreceiv pair probabl singl observ path sender entri node path exit node receiv name list appendix a receiv sender tabl locat independ typic send receiv ase forward path mixmast anonym network topolog number parenthes show locat independ properti revers path ie traffic receiv sender sender increas locat independ path use explicitli choos entri exit node avoid travers upon entri exit mix network howev approach clearli better small adversari own one as must also consid effect larg adversari own mani ase narrow set possibl mix alic might use give inform larg adversari exampl adversari observ transact exit mix network sprint node deduc alic enter mix network sprint node must consid effect suggest algorithm level adversari leav investig futur work improv node placement mix network expand would node certain ase help achiev divers better other result suggest node edg network eg cabl modem dsl provid universi tie etc like travers inbound outbound path node farflung node locat provid geograph divers node asia like actual reduc locat independ node typic divers aslevel connect rather best place new node like ase high degreethat is connect larg number ase iron ase highest degre tend tier isp themselv thu place one node tier isp build mix path node may best strategi increas locat independ explor question excel direct futur work issu sever factor complic analysi leav futur work first compani like akamai provid web host around globe serv content locat close given user therefor present challeng analysi exit node choos nearbi akamai server alic longer use scheme section estim aslevel path exit node destin also akamai becom power global adversari respect certain popular websit second research remain determin sensit independ metric addit remov node topolog third choic popular locat initi respond insid unit state determin whether analysi chang user foreign countri final alic use approach must period fetch rout tabl estim internet topolog requir lot comput bandwidth must devis way condens inform directori server could provid period sign snapshot conclus propos mix network consid underli aslevel path achiev better locat independ paper present sever interest import result previou system propos select node disjoint ip address prefix select node differ juri diction techniqu suffici achiev locat independ certain tier isp preval mani mix network path node replac use path select probabl singl observ link fourhop path mix node replac use probabl tor mixmast topolog given random entri exit node select even initi choos distinct entri exit node singl often abl observ entri exit path mix network time path asymmetri internet entryexit node pair good locat independ forward path mix network may alway good locat independ revers direct howev initi choos entri exit node locat independ mind prevent attack figur show intranetwork divers tor topolog nearli equival mixmast topolog least observ attack singl as newborn network node almost entir us robust matur network like mixmast r econom anonym remail geograph map project anonym freedom system secur issu analysi traffic analysi attack tradeoff anonym provid system web mix system anonym unobserv internet access dummi traffic long term intersect attack disadvantag free mix rout overcom them freedom system architectur toward captur repres aslevel internet topolog untrac electron mail comscor media metrix announc top u pipenet statist disclosur attack traffic confirm open environ traffic analysi continuoustim mix mixminion design type iii anonym remail protocol tor secondgener onion router infer autonom system relationship internet correct ibgp configur time attack lowlat mixbas system infer aslevel path routescop toward accur aslevel tracerout tool practic traffic analysi extend resist statist disclosur mixmast protocol version univers oregon echolot pinger anonym remail traffic analysi protocol anonym connect onion rout border gateway protocol bgp practic anonym mass morphmix trickl flood activ attack sever mix type passiv attack analysi connectionbas anonym system toward analysi onion rout secur tr untrac electron mail return address digit pseudonym traffic analysi disadvantag free mix rout overcom toward analysi onion rout secur web mix infer autonom system relationship internet tarzan correct ibgp configur traffic analysi attack tradeoff anonym provid system trickl flood mix email babel mixminion toward accur aslevel tracerout tool toward captur repres aslevel internet topolog ctr heiko tillwick martin olivi toward framework connect anonym proceed annual research confer south african institut comput scientist inform technologist research develop countri p septemb white river south africa micah sherr boon thau loo matt blaze toward applicationawar anonym rout proceed nd usenix workshop hot topic secur p august boston