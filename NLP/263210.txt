t perturb analys qr factor a paper give perturb analys q_ r qr factor aq_r q_tq_i given real mtime n matrix a rank n gener perturb a suffici small norm analys accur reflect sensit problem previou result condit number alter column pivot use apq_r condit number r bound fix n standard column pivot strategi use strategi also tend improv condit q_ comput q_ r probabl greatest accuraci use standard column pivot strategyfirstord perturb analys given q_ r seen analysi r may approach two waysa detail matrixvector equat analysi provid tight bound correspond condit number unfortun costli comput intuit simpler matrix equat analysi provid result usual weaker easier interpret allow effici comput satisfactori estim actual condit number approach power gener tool appear applic perturb analysi matrix factor b introduct qr factor import tool matrix comput see exampl given theta n real matrix full column rank exist uniqu theta n real matrix q orthonorm column uniqu nonsingular upper triangular n theta n real matrix r posit diagon entri matrix q refer orthogon factor r triangular factor suppos tg uniqu qr factor differenti rt respect set given g linear equat upper triangular matrix r determin sensit rt core perturb analysi qr factor effect involv use determin bound r essenti two main way approach problem discuss these togeth recent histori xiaowen chang first realiz publish result sensit factor lu choleski qr extrem school comput scienc mcgill univers montreal quebec canada ha a changcsmcgillca chriscsmcgillca research first two author support nserc canada grant ogp depart comput scienc institut advanc comput studi univers maryland colleg park md usa stewartcsumdedu g w stewart research support part us nation scienc foundat grant ccr g w stewart weak mani matric origin gener approach obtain provabl tight result sharp condit number problem call matrix vector equat approach qr factor involv express matrixvector equat form wr zr matric involv element r vecdelta transform argument vector element notat uvecdelta denot variant vecdelta defin section chang also realiz condit mani problem significantli improv pivot provid first firmli base theoret explan so g w stewart stimul chang work understand deepli present simpl explan go on chang work use approach perturb analys factor call matrix equat approach keep equat like matrixmatrix form stewart also see use eleg construct partli illustr up low notat section make matrix equat approach far usabl intuit tool combin deep insight scale produc new matrix equat analys appealingli clear provid excel insight sensit problem new matrix equat analys gener provid tight result like matrixvector equat analys do usual simpl provid practic estim true condit number obtain latter third author chri paig insist write brief histori delin except contribut chang stewart requir combin two analys provid full understand case examin interplay two approach first reveal hope convey even clearli qr factor perturb analysi qr factor consid sever author first normbas result r present stewart modifi improv sun use differ approach sun stewart gave first order normwis perturb analys r first order componentwis perturb analysi r given zha strict componentwis analysi r given sun paper also gave analys q recent sun gave strict perturb bound q alon purpos paper establish new first order perturb bound gener sharper equival result r factor straightforward sharp result q factor section defin notat give result use throughout paper section survey import key result sensit r q section give refin perturb analysi show simpl way standard column pivot strategi benefici certain aspect sensit q section analyz perturb r first straightforward matrix equat approach detail tighter matrixvector equat approach give numer result suggest practic condit estim section summar comment find section perturb analys qr factor notat basic simplifi present n theta n matrix x defin upper lower triangular matric upx gener x symmetr x f gamma illustr basic use up show given n theta n nonsingular upper triangular r given n theta n symmetr equat form cf alway uniqu upper triangular solut u sinc ur gamma upper triangular see immedi ur gamma therefor u uniqu defin describ use later perturb bound tighter bound separ perturb along column space along orthogon complement thu introduc follow notat real theta n a let p orthogon projector onto ra p orthogon projector onto ra real theta n deltaa defin ffl also defin qr factor use follow standard result lemma real theta n rank n real orthogon projector onto ra xiaowen chang chri paig g w stewart proof let qr factor necessarili full column rank kq a smallest singular valu a inequ corollari nonzero deltaa satisfi ffl g defin tg full column rank therefor uniqu qr factor jtj ffl previou normbas result section summar strongest normbas result previou author first give deriv essenti sun stewart first order normwis perturb result r sinc techniqu result use later theorem let r mthetan full column rank qr factor real theta n matrix uniqu qr factor proof let g j deltaaffl if theorem trivial corollari atg uniqu qr factor jtj ffl notic easi verifi q t rt twice continu differenti ffl algorithm qr factor thu see linear equat uniqu defin element term element q g upper triangular rr gamma see perturb analys qr factor sinc kq taylor expans rt which combin give proof show key point deriv first order perturb bound r use give good bound sensit k obtain bound directli matrix equat analysi show recent perturb result q given sun obtain present set sinc analysi easili extend obtain refin result simpl way note hypothes follow theorem theorem use result latter theorem theorem let r mthetan full column rank qr factor real theta n matrix hold deltaa uniqu qr factor proof let g j deltaaffl if theorem trivial corollari atg uniqu qr factor at jtj ffl differenti follow q q xiaowen chang chri paig g w stewart use theorem see thi kgk f taylor expans kdeltaq refin analysi q note sinc q orthonorm matric deltaq small deltaq follow analysi assum n result sun give good possibl overal bound chang deltaq q look deltaq distribut orthogon complement follow idea theorem abl obtain result tight but unlik relat tight result easi follow make clear exactli illcondit lie squar orthogon key bound first term right separ second note g chosen give equal given a henc true condit number part deltaq rq part deltaq rq see skew symmetr clearli zero diagon let r j j denot lead block r respect g j matrix first j column g perturb analys qr factor j j element upper triangular form r ks ks f r ngamma equal obtain take kr gammat follow bound tight true condit number part deltaq rq problem mainli interest chang q lie rq result show bound smaller previous thought particular one small singular valu use standard column pivot strategi comput qr factor r ngamma quit wellcondit compar r kr gamma perturb analys r section saw key deriv first order perturb bound r qr factor full column rank equat gener form find bound x term given r f matrix equat upper triangular r nonsingular sun stewart origin analyz use matrix equat approach give result theorem analyz two new way first stewart refin matrix equat approach give clear improv theorem second chang matrixvector equat approach give improv still provabl tight bound lead true condit number r a r qr factor a approach provid effici condit estim see matrixvector equat approach nice result special case permut matrix give standard column pivot deriv matrix equat version these tighter complic matrixvector equat analysi case pivot given result quot here refin matrix equat analysi r proof theorem use produc matrix equat deriv bound directli thi look approach close first use gener form keep think clear see xiaowen chang chri paig g w stewart let n set n theta n real posit definit diagon matric r note matrix b upbd henc defin b r r gammat f d r obviou notat upper triangular matrix bound thi use follow result lemma n theta n b n ijn proof clearli cauchyschwarz theorem bound solut x sinc true n know upper triangular solut x defin give encourag result perturb analys qr factor compar see qr factor henc chang never wors bound theorem use standard column pivot strategi permut matrix analysi lead nice result element r r nn diagon r follow theorem sinc k thu use standard pivot strategi see sensit r bound n remark clearli me a potenti candid condit number r qr factor me a depend sole r true condit number nonsingular upper triangular r find f give equal true everi column f lie space right singular vector correspond maximum singular valu r gammat restrict gener strong made equal well see lead howev class r possibl r diagon take first restrict f disappear let j g w stewart see that least diagon r bound tight restrict case a true condit number refin matrix equat analysi show extent solut x sensit r qr factor depend row scale r term r gammat f d saw multipli occur j i result obtain bound rather equal minimum element come maximum diagon thu obtain full cancel gamma first term right hand side partial cancel second give insight r qr factor less sensit earlier condit estim indic illcondit r mostli due bad scale row correct choic r give near one time larg r d much smaller pivot alway ensur exist fact give howev use pivot remark suggest rel small earlier element diagon r could correspond poor condit factor return me a r d seek practic estim true condit number deriv next section matrixvector equat analysi r obtain provabl sharp less intuit result view matrix equat larg matrixvector equat matrix c nthetan denot c i j vector first element c j thi defin u denot upper c c delta c n vector form stack column upper triangular part c one long vector analyz consid gener form repeat clariti upper triangular r nonsingular saw via uniqu upper triangular solut x upper lower triangular part contain ident inform write upper triangular part matrixvector rather matrixmatrix format first j element jth column given r f jtf jtdelta f jt perturb analys qr factor rewrit thi see solv x j r r t r j gammat r r jt r jt which divid last row give theta nn r zr r nn r sinc r nonsingular wr also r zr vecf rememb x upper triangular see r zr vecf k nonsingular upper triangular r equal obtain choos vecf lie space span right singular vector correspond g w stewart largest singular valu w gamma r zr follow tight deriv matrix equat approach remark usual first second inequ strict exam ple let solv optim problem remark first inequ becom equal r diagon second also becom equal r n theta n ident matrix upper bound tight structur wr zr reveal column wr one column zr w gamma r zr nn squar ident submatrix give remark lower bound approxim tight n seen take take see remark result analysi section q lead new first order normwis perturb theorem theorem let qr factor r mthetan full column rank let deltaa real theta n matrix hold uniqu qr factor wr zr me a perturb analys qr factor proof corollari a deltaa uniqu qr factor g j deltaaffl r zr vecq take norm give combin thu taylor seri rt follow remain result restat remark know first order perturb bound least sharp suggest may consider sharper fact sharper arbitrari factor consid exampl remark take see first order perturb bound sever overestim effect perturb a remark take close upper bound show rel small earli diagon element r caus poor condit suggest use pivot signific chanc condit problem approach upper bound least randomli chosen matric use standard pivot see follow tighter result shown th theorem let r mthetan full column rank qr factor standard column pivot strategi use xiaowen chang chri paig g w stewart parametr famili matric a r zr theorem show standard column pivot strategi use r ap bound fix n matter larg is mani numer experi strategi suggest r ap usual close lower bound one give extrem exampl section not use pivot simpl result r a is far see unreason expens comput approxim r a directli usual approach fortun me a appar excel approxim r a me a quit easi estim need choos suitabl r d consid next section numer experi condit estim section present new first order perturb bound r factor qr factor use two differ approach defin r zr k true condit number r factor suggest r a could estim practic r d new first order result sharper previou result r least sharp q give numer test illustr thi possibl estim r a would like choos r d good approxim show good estim true condit number r a procedur obtain on condit estim r qr factor ie estim r a choos d use standard condit estim see exampl estim d gamma r take r d appropri estim well known result van der slui d gamma r nearli minim row gamma r equilibr could lead larg three obviou possibl d first one choos equilibr r precis specif take n second one choos equilibr r far possibl keep specif take n third one choos comput show third choic sometim caus unnecessarili larg estim give result choic specifi diagon matrix obtain first method second method respect follow give three set exampl first set matric n theta n pascal matric with element result shown tabl without pivot give tabl pivot give r note tabl far wors true condit number r a much greater lower bound tabl pivot seen give signific improv r a bring close lower bound cours still also observ tabl r r good estim r a latter littl better former tabl in fact also good estim r ap perturb analys qr factor tabl result pascal matric without pivot e e e e e e e e e e e e e e e e e e e e e e e e e tabl result pascal matric pivot r e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e second set matric theta j obtain random theta matrix produc matlab function randn jth column multipli gamma give j result shown tabl without pivot result pivot similar given here a close upper bound significantli smaller result expect sinc matrix r illcondit due fact r jj small row r alreadi essenti equilibr expect r a much g w stewart better a also first seven case smallest singular valu lead part r ngamma close r q a could much better a even though r still illcondit due fact r small equilibr becom wellcondit row scale notic time close r d r therefor much better a case smallest singular valu r significantli smaller r ngamma thu q a condit number chang q lie rang q spectacularli better a contriv exampl serv emphas benefit pivot condit q r tabl pivot e e e e e e e e e e e e e e e e e e e e third set matric n theta n upper triangular matric introduc kahan cours here condit number depend r onli interest in result shown tabl found list result correspond tabl result kahan matric exampl see r r gave excel estim r a r margin prefer kahan matric correspond correctli pivot a see extrem case larg enough n r a larg even pivot bad result get perturb analys qr factor pivot it get bit wors r sinc kahan matric parameter famili mention theorem nevertheless r still estim r a excel summari conclus first order perturb analys present show sensit condit q r qr factor full column rank a provid true condit number with respect measur use suffici small deltaa well effici way approxim these key normbas condit number deriv are part deltaq ra see part deltaq ra see r zr k r see theorem ffl estim r a me a j inf ddn r d r d j condit number obey r see numer exampl analysi case not given here suggest r d chosen equilibr subject give excel approxim r a gener case special case orthogon column r diagon remark show take gener use standard column pivot strategi qr factor izat saw result analys see r certain sens q less sensit thought previou analys true condit number depend column pivot a show standard pivot strategi often result much less sensit r sometim lead much smaller possibl chang q rang q given size perturb a matrix equat analysi section also provid nice analysi interest possibl gener matrix equat follow approach stewart th see also th would straightforward detail lengthi extend first order result provid strict perturb bound done could also provid new componentwis bound chose either here order keep materi basic idea brief approach possibl condit number result bound asymptot sharp less need strict bound new componentwis bound r given g w stewart acknowledg would like thank jiguang sun suggest encourag provid us draft version work r phd thesi perturb analysi r qr factor new perturb analys choleski fac toriz matrix comput survey condit number estim triangular matric accuraci stabil numer algorithm perturb bound subspac associ certain eigenvalu problem perturb bound qr factor matrix perturb lu perturb lu choleski factor matrix perturb theori perturb bound choleski qr factor componentwis perturb bound matrix decomposit perturb bound qr factor condit number equilibr matric componentwis perturb analysi qr decomposit tr ctr youn chahlaoui kyle a gallivan paul van dooren increment method comput domin singular space comput inform retriev societi industri appli mathemat philadelphia pa