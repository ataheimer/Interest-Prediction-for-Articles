t twice differenti spectral function a function f space n n real symmetr matric call spectral depend eigenvalu argument spectral function symmetr function eigenvalu show spectral function twice continu differenti matrix correspond symmetr function twice continu differenti vector eigenvalu give concis usabl formula hessian b introduct paper interest function f symmetr matrix argument invari orthogon similar transform orthogon u symmetr depart combinator optim univers waterloo waterloo ontario nl g canada email aslewismathuwaterlooca research support nserc depart combinator optim univers waterloo waterloo ontario nl g canada email hssendovbarrowuwaterlooca research support nserc everi function decompos map give eigenvalu matrix f symmetr function see next section detail call function f spectral function or function eigenvalu depend spectrum oper a classic interest function aros import role quantum mechan nowaday insepar part optim matrix analysi modern optim key exampl semidenit program one encount problem involv spectral function like log deta largest eigenvalu a constraint must posit denit mani exampl properti spectral function f actual equival correspond properti underli symmetr function f among rstorder dierenti convex gener rstorder dierenti analyt variou secondord properti also worth mention chevalley restrict theorem context identi spectral function polynomi symmetr polynomi eigen valu secondord properti matrix function great interest optim applic newton method interior point method secondord nonsmooth optim condit requir know secondord behaviour function involv mathemat model standard refer behaviour eigenvalu matrix subject perturb particular direct secondord properti eigenvalu function particular direct deriv problem interest us paper spectral function twice dierenti as function matrix itself rather particular direct hessian continu analyt discuss thu result lie sens result smooth properti special spectral function such largest eigenvalu certain manifold help perturb theori newtontyp method see exampl show spectral function twice continu dierenti matrix correspond symmetr function twice con tinuous dierenti vector eigenvalu thu particular spectral function c restrict subspac diagon matric c exampl schatten pnorm symmetr matrix pth root function where eigenvalu matrix see latter function c p although analyt unless p even integ part gener result also give concis easytous formula hessian result analyt function rather implicit paper selfcontain result deriv essenti scratch make use complexvari techniqu ex ampl parallel paper give analog character spectral function quadrat expans point but may twice dierenti notat preliminari result follow n denot euclidean space n n symmetr matric inner product ha vector eigenvalu order nonincreas order n denot set nn orthogon matric vector x r n diag x denot diagon matrix vector x main diagon x denot vector entri x order nonincreas order x x n let r n denot set vector x r n x x x n let also dene diag m denot sequenc symmetr matric converg m denot sequenc orthogon matric describ set r n function r n symmetr invari coordin permut denot function dene open symmetr set properti permut matrix p x domainf denot gradient f rf f hessian r f f vector understood column vector unless state otherwis whenev denot vector r n make convent thu r number distinct eigenvalu dene correspond partit call set block denot standard basi r n e vector entri equal also dene correspond matric arbitrari matrix a denot ith row a row vector ij denot i jth entri final say vector block rene vector b impli need follow result r symmetr function twice dierenti point r n let p permut matrix particular represent r e r r e r rr r rr e uv matric dimens ji u j ji v j entri equal ij real symmetr matrix b b b n vector block rene j u ident matrix dimens proof appli chain rule twice equal order get part i ii deduc block structur hessian consid block structur permut matric p permut row column hessian way dene p must stay unchang use notat lemma dene matrix note make convent ith diagon block represent dimens set otherwis valu b k uniqu determin dierenc diagon odiagon element block note also matrix b vector b depend point function f lemma r n sequenc symmetr matric mm diag mm proof combin lemma theorem follow main technic tool lemma let fmmg sequenc symmetr matric converg mm kmm k converg let r n um u n sequenc orthogon matric diag diag mm follow properti hold i orthogon matrix u form l orthogon matrix dimens ji l j ji l j l ii l lim pi l u ip iii j belong block lim u ij iv l l diag x l mx l l v l p l lim u ip vi indic j lim pi l u ip vii indic j l diag x l mx l l viii three indic i j p distinct block lim u ip ix two indic i j l lim pi l u ip ks pi u ip proof i take limit equat left diag describ represent matrix u follow ii let us denot use lemma equat obtain diag diag hm u equival form diag um divid side equat kmm k rearrang diag um diag u diag hm u diag u diag um diag hm notic right hand side equat converg nite limit increas inniti call matrix limit right hand side rst equat l clearli limit second equat u lu go prove part ii iii togeth induct divid orthogon matrix um block structur u begin consid rst row block um let index rst block limit i ith entri matrix left hand side equat lim u ip ks pi u ip recal v orthogon matrix notic idiag x sum equat get lim u ip ks u ip notic here coecient front k l numer sum zero is u ip r u ip us choos number add everi coordin vector thu shift it coordin shift vector rst block strictli bigger zero rest strictli less zero comment abov last limit remain true shift way rewrit last limit shift vector summand posit immedi see must lim u ip lim u ip rst limit written lim u ip summand posit conclud lim u ip second limit impli immedi lim u ip thu prove part ii part iii case speci abov good place say word idea proof said divid matrix um block compli block structur vector exactli part i matrix u prove part ii iii element rst row block divis go prove thing rst column block order x index consid i ith entri matrix left hand side equat take limit lim u pi ks pi u pi use also blockdiagon structur matrix u proceed order conclud lim u pi lim u pi readi second step induct let index limit i ith entri matrix left hand side equat lim u ip u ip r ks pi u ip analog sum limit get lim u ip u ip r ks u ip know lim u ip choos number exchang shift version conclud lim u ip lim u ip repeat step second column block matrix um induct exhaust block complet proof part ii iii iv proof part one need consid i ith entri right hand side equat diagon left hand side converg zero by ii iii take limit prove statement part v part follow immedi part iii vi take limit equat give lim sl ks pi u ip pi l u ip l ij i jth entri limit right hand side equat note coecient ks sum zero sl pi u ip pi l u ip um orthogon matrix part v sl pi u ip pi l u ip requir moreov l vii statement part detail way write fact prove previou part l viii part follow immedi part iii in fact express part viii ident one part v reiter dierent index condit later conveni ix take limit i jth entri matric side equat lim tl u ip pi l u ip ks pi u ip part viii lth sth summand converg zero hand mm diag hm u ij lim diag hm u u j row dierent block diag hm kmm k converg diagon matrix tool prove main result paper twice dierenti spectral function section prove symmetr function f twice dierenti point a correspond spectral function f twice dierenti matrix a recal hadamard product two matric size matrix elementwis product let symmetr function f r n r twice dierenti point r n where befor dene vector lemma specic index i say l l f rg dene ii ji l pq p q l lemma guarante second case denit depend choic p q also dene matrix a ij notic similar denit classic divid dierenc construct lowner theori see chap v exampl simplic iti argument understood context write b ij follow lemma theorem lemma let n suppos a belong domain dierenti point a f dierenti point a case orthogon matrix u satisfi recal standard notion twice dierenti consid function f n r gradient point when exist linear function euclidean space n thu identi element n denot rf a thu rf map n n map dierenti say f twice dierenti a case interpret hessian r f a symmetr bilinear function n n r valu particular point denot r f ah particular xed h function r f ah linear function n consid element n breviti denot r f ah hessian continu say f twice continu dierenti a case follow ident hold t next theorem preliminari version main result theorem symmetr function f r n r twice dierenti point r n f twice dierenti point diag case hessian given henc proof easi see f must twice dierenti point whenev f twice dierenti diag restrict f subspac diagon matric get function f interest case direct let f twice dierenti point r n suppos contrari either f twice dierenti point diag equat fail dene linear oper lemma tell us f least dierenti around diag so linear oper sequenc symmetr matric fmm g m converg loss gener may assum sequenc fmmg m mm kmm k converg matrix subsequ fmm g m sure properti let fum g m sequenc orthogon matric diag diag mm without loss gener may assum um u n otherwis take subsequ fmmg m fumg m inequ show everi correspond pair or precis least one pair indic i j ij least one pair indic call i j innit mani number i j correspond pair necessari take subsequ fmmg m fumg m may assum without loss gener pair indic i j last inequ hold dene symbol hm equat notic use lemma lemma fact rf dierenti get consid three case everi case go show left hand side inequ actual converg zero contradict assumpt case i use equat left hand side inequ less equal diag rf diag r fhm go show summand approach zero goe inniti assum l l f rg use fact vector block rene vector rf lemma part i rst term written askmmk f l pi l u ip ssl ks pi u ip appli lemma part ii iii last express concentr second term abov use notat equat that is r bdiag b term less equal diag diag bh diag bdiag mm approach inniti u dene vector h be hm take limit express turn into diag bdiag m go investig term sum separ show actual equal zero rst use block structur matrix b see lemma block structur vector h obtain r qs tr x use fact l v l orthogon get l diag bh l l diag bhx l l r ls tr x l r ls tr x bdiag m show rst term zero second term use block structur vector b write diag next last equal use part iv lemma l diag diag bh l l diag diag bhx l l l diag b k l l mx l l diag bdiag m see second term also zero case ii j l l f rg use equat left hand side inequ becom diag rf use fact block rene vector rf write rst summand askmm k sl ks pi u ip l pi l u ip use part v vi lemma conclud express converg zero left substitut r diag b get diag diag bh recal notat lemma use denot entri matrix b limit rst summand written lim r sl tr x l mx l pi u ip u jp clearli pi u ip u rg left follow limit lim diag diag bh use lemma part vii observ right hand side zero case iii l j l s use equat left hand side inequ becom up o diag rf diag r fhm l ks ks start second term abov limit lim case u nonzero coordin entri u j zero left lim diag rf l ks ks expand rst term limit diag rf l pi l u ip ks pi u ip tl u ip use lemma part viii see third summand converg zero goe inniti part ix lemma tell us lim pi l u ip ks pi u ip order abbrevi formula introduc follow notat l pi l u ip substitut everyth get follow equival limit lim l ks l ks ks l ks simplifi get lim ks l ks ks notic r l um orthogon matrix numer sum product ith jth row next lemma part viii say lim tl lim complet proof nalli readi give prove full version main result theorem let nn symmetr matrix symmetr function twice dierenti point a spectral function f twice dierenti matrix a moreov case hessian spectral function matrix w orthogon matrix w diag a dene equat henc diag hi proof let w orthogon matrix diagon order fashion let mm sequenc symmetr matric converg zero let um sequenc orthogon matric diag a w use lemma get also goe inniti w orthogon matrix kwxw matrix x easi check result theorem continu hessian suppos symmetr function f r n r twice dierenti neighbourhood point a hessian continu point a theorem show f must twice dierenti neighbourhood point a section go show r f also continu point a dene basi fh ij g space symmetr matric entri matrix h ij zero except i jth j ith one one i ith posit suce prove hessian continu appli matrix basi begin lemma lemma let r n let symmetr function f r n r twice continu dieren tiabl point let f g m sequenc vector r n converg lim proof everi permut matrix pm p see begin section mean bar vector nite mani permut matric name n form n subsequ f g two vector particular subsequ order descend order permut matrix prove lemma everi subsequ done without loss gener may assum p everi m xed permut matrix p clearli larg enough m consequ matrix p blockdiagon permut matric main diagon dimens match block structur consid block structur vector f g nite mani dierent block structur divid sequenc subsequ vector particular subsequ block structur prove lemma subsequ done without loss gener may assum vector f g block structur everi m next use formula hessian theorem lemma togeth theorem give us equat show without loss gener suce prove lemma case vector f g order descend order is vector block rene vector case consid four case case i lim diag r r f continu case ii j belong block i j block well lim r f continu case iii j belong dierent block block lim prove lim ii see denit b begin section everi dene vector _ _ conclud sequenc f _ converg f g so appli mean valu theorem twice vector _ vector _ notic vector obtain swap ith jth coordin use rst part lemma see f final take limit use continu hessian f point case iv j belong dierent block dierent block lim rf continu denomin never zero readi prove main result section theorem let nn symmetr matrix symmetr function continu dierenti point a spectral function f twice continu dierenti matrix a proof know f twice dierenti f twice dierenti a left prove continu hessian suppos f twice continu dierenti a f twice continu dierenti a is hessian continu a take sequenc famg m symmetr matric converg m let fum g m sequenc orthogon matric without loss gener may assum um u u orthogon otherwis take subsequ famg fumg use formula hessian given theorem lemma easili see lim everi symmetr h contradict direct follow chain rule observ complet proof exampl conjectur exampl suppos requir second direct deriv function f point direct b is want nd second deriv function w orthogon matrix wdiag aw let dierenti twice use lemma theorem diag rfa diag principl function f analyt second direct deriv also comput use implicit formula work show answer agre nal illustr consid classic exampl power seri expans simpl eigenvalu case consid function f given kth largest entri x matrix function result show follow formula familiar perturb theori quantum mechan agre result p conclud follow natur conjectur conjectur spectral function f ktime dierenti matrix correspond symmetr function f ktime dierenti point a moreov f c k f c k r matrix analysi deriv deriv chain rule sensit analysi eigenvalu symmetr matrix matrix analysi topic matrix analysi short introduct perturb theori linear op erat fundament principl quantum mechan convex analysi hermitian matric deriv spectral function nonsmooth analysi eigenvalu eigenvalu optim quadrat expans spectral func tion minim maximum eigenvalu symmetr matrix second deriv optim eigenvalu symmetr matric toward secondord method structur nonsmooth optim wet variat analysi quantum mechan first second order analyi nonlinear semid eigenvalu optim valeur propr de matric sym analyt function involv eigenvalu tr ctr xin chen houduo qi liqun qi koklay teo smooth convex approxim maximum eigenvalu function journal global optim v n p novemb lin xiao stephen boyd seungjean kim distribut averag consensu leastmeansquar deviat journal parallel distribut comput v n p januari