t longtim energi conserv numer method oscillatori differenti equat a consid secondord differenti system highfrequ oscil gener linear part present frequenc expans solut discuss two invari system determin coeffici frequenc expans invari relat total energi oscillatori harmon energi origin systemfor numer solut studi class symmetr method discret linear part without error interest case product step size highest frequenc larg sens backward error analysi repres numer solut frequenc expans coeffici solut modifi system allow us prove nearconserv total oscillatori energi long time interv b introduct longtim nearconserv total energi adiabat invari numer solut hamiltonian differenti equat import wide rang physic applic molecular dynam nonlinear wave propag backward error analysi bg hal rei shown symplect numer integr approxim conserv total energi adiabat invari time exponenti long step size precis time length expch highest frequenc system result meaning h often practic assumpt exampl spatial discret wave equat h cfl number chosen small actual comput recent gss hol new symplect symmetr timestep method studi admit secondord error bound finit time interv independ frequenc domin linear part system particular longtimestep method case comput interest situat reminisc stiff versu nonstiff differenti equat stiff integr appropri analyz consid limit behavior h stiff case much insight gain studi behavior numer method wellchosen rather simpl linear nonlinear stiff model problem first step toward understand numer energi behavior hamiltonian system product step size highest frequenc small quantiti consid articl nonlinear highli oscillatori model problem x dept de mathematiqu universit de genev ch genev switzerland mathematisch institut universitt tubingen auf der morgenstel d tubingen germani email lubichnaunituebingend with block arbitrari dimens nonlinear lipschitz constant bound independ situat aris celebr fermipastaulam model present numer experi clearli model problem take strong restrict high frequenc confin linear part problem linear part singl high frequenc diagon form ofomega essenti sinc numer method invari diagon matrix studi longtim energi behavior class symmetr numer method use step size h product h bound away zero arbitrarili larg method integr linear part exactli reduc stormerverlet method class includ method gss hol classic symmetr method stormerverlet method trapezoid rule numerov method consid articl howev use result present paper energi behavior h rang linear stabil analyz hal approach nearconserv energi base frequenc expans solut xt asymptot seri coeffici function yt z k t togeth deriv bound independ turn system determin coeffici function two formal exact invari one close total energi accord partit omegagamma invari close repres oscillatori energi system numer solut deriv similar frequenc expans valid grid point nonreson assumpt h equat determin coeffici function similar structur continu problem allow us obtain two almostinvari close h rigor estim nearconserv total oscillatori energi time interv size cn h gamman restrict n come nonreson condit analysi use symmetri method requir symplect sect describ numer method present numer experi fermipastaulam problem experi illustr longtim conserv total oscillatori energi nonreson situat later complet explain theori also show energi behavior method near reson behavior depend strongli properti filter function determin numer method identifi condit yield satisfactori energi conserv near reson correct energi exchang highli oscillatori compon sect give complet analysi twodimension linear case whole rang nonreson nearreson exactli reson case give alreadi much insight condit determin energi conserv gener situat frequenc expans analyt solut introduc sect numer solut sect numer invari deriv sect main result numer longtim conserv energi formul prove sect numer method numer experi section present numer method illustr main result paper fermipastaulam problem discret consid differenti equat symmetr posit semidefinit not necessarili diagon real matrix assum initi valu x x given variationof constant formula exact solut satisfi tomega gammaomega sin tomega co tomega somega ds observ tomega welldefin also singularomegagamman therefor natur consid fix step size h explicit discret homega xn gammaomega sin real function oe depend smoothli method integr problem without error method consist order fixedomega h secondord converg follow classic result articl mainli interest situat homega take larg valu longtim integr symmetr andor symplect method expect favor properti exchang n seen method symmetr gx where sinc sin shown direct verif symplect discret if addit also hold condit requir analysi paper sinc nonlinear gx depend x elimin xn help case symmetr discret thu get twostep recurr start valu x obtain recogn wellknown stormer method stiff harmon soft nonlinear fig altern soft stiff spring method type propos studi sever author gautschi gau suggest take choic integr exactli even const deuflhard deu discret integr trapezoid rule thu arriv recent garciaarchilla sanzserna skeel gss introduc function oe argument g consid case method symplect hochbruck lubich hol consid oe paper gss hol deriv error bound finit time interv independ smooth solut articl consid gener function oe zero except possibl integr multipl sinc interest energi conserv numer solut need also approxim deriv use twoterm recurr relat obtain relat or case symmetr method also formula possibl h nonzero integr multipl obtain subtract twice formula symmetr method obtain formula exchang n subtract result formula obtain twostep recurr gammaomega sin formula give symmetr twostep method even sati fie method exact const choic consid hol experi fermipastaulam problem consid chain spring soft nonlinear spring altern stiff harmon spring see ggmv fig variabl x displac endpoint spring movement describ hamiltonian system use symplect chang variabl u get new hamiltonian system a h a h a h c h a h c h fig energi exchang stiff spring exactli form numer experi consid case shown fig initi valu take zero remain initi valu appli method follow data a c given studi total energi oscillatori energi along numer solut interv chosen initi valu fig plot three differ step size three method numer valu h gamma see exchang energi take place go first stiff spring energi second stiff spring later third one smallest step size also plot gray numer valu perturb initi valu obtain ad gamma u illustr solut sensit perturb e hairer ch lubich case see h well preserv whole interv even step size numer solut complet wrong experi shown preserv hold much longer interv we test explan phenomenon main object paper numer experi nearreson situat product step size frequenc h close multipl differ method show wide differ behavior energi conserv choic oe satisfactori numer behavior also nearreson situat obtain numer method satisfi follow addit condit condit yield longtim energi conserv valu h except h interv width oh near integr multipl total energi appear conserv uniformli arbitrari valu h necess condit seen analysi linear case given sect h close m posit integ m condit requir doubl zero m similarli h close odd multipl condit requir simpl zero choic hol condit obvious satisfi valu h violat near odd multipl condit trivial satisfi h condit fail near even multipl choic satisfi three condit h condit satisfi method previous propos literatur tabl method use numer experi sect sinc k p let us illustr effect condit numer solut h close multipl consid fermipastaulam problem sect initi valu appli six differ method characterist given tabl sign p indic correspond condit oe satisfi condit satisfi valu c scale d fig energi conserv differ method fig energi conserv differ method fig energi conserv differ method h give valu close violat method b c d one condit fulfil fig show error hamiltonian interv use step size maxim error size given singular fig error total oscillatori energi function h fpu problem method a d show clear drift constant valu hamiltonian method b e f three condit satisfi close conserv hamiltonian well pictur correspond three method chang scale small oscil becom visibl fig show experi time chosen delta situat get qualit behavior plot oscillatori energi instead hamiltonian result experi confirm condit cannot omit interest longtim energi estim hold uniformli h fig numer result nonreson case includ method give satisfactori result accur result obtain method c upper pictur fig plot maxim error hamiltonian function h take step size pictur right correspond method e tabl pictur left obtain method f satisfi uniform converg error observ case lower pictur fig show analogu deviat oscillatori energi close integr multipl deviat larg method phenomenon observ alreadi linear problem see fig complet analysi given sect energi exchang energi exchang stiff compon take place time interv length o fig reproduc qualit correctli larg h case numer frequenc expans sect show condit hh hh ii ii fig experi fig method method right pictur need approxim energi exchang stiff compon h bound away zero compar equat z compon sever condit exclud method consid far except abovement method hand seen method rather poor energi conserv properti therefor extend class method homegagamma consist function k oe k must satisfi condit need condit replac exampl method equival onestep form homega xn gammaomega sin show correct energi exchang larg h method b fig fig compar energi conserv method method step size fig total oscillatori energi well conserv long time except h interv length oh around integr multipl eas present follow analysi done method class argument extend obviou way class longtim energi conserv linear problem start analysi case twodimension symmetr matrix satisfi linear give alreadi lot insight illustr import condit situat differenti equat becom x total energi h given invari system follow assum h delta bound uniformli requir x analyt solut exact solut given o gamma eigenvalu o gamma given initi valu x consequ impli quantiti remain o gamma close constant valu delta time t numer solut search function b v xn xnh satisfi numer scheme impli eigenvalu v correspond eigenvector section use short notat oeh sinc offdiagon element small eigenvalu close ff respect correspond eigenvector fl gammafl oe gener solut thu written complex coeffici comput initi valu b obtain insert studi longtim nearconserv h delta delta distinguish two case case i wellsepar eigenvalu assum one condit satisfi cover nearli choic h valu interv length oh exclud theorem consid numer method appli one restrict step size condit numer method energi h along numer solut satisfi n constant symbol odelta independ h n proof characterist polynomi matrix zero comput explicitli condit togeth impli eigenvalu henc suffici small h real interv gamma angl defin therefor also real satisfi next estim coeffici a a b b sinc v real coeffici a b complex conjug a b situat assumpt consequ condit b use b conveni work b xh gamma co co estim sinc h follow get second relat consequ fact which follow statement immedi consequ modulu c i independ t nearconserv hamiltonian seen similarli one condit satisfi get floe sin impli jbx const t togeth prove statement total energi case ii nearli collaps eigenvalu consid complementari case h two eigenvalu close theorem consid numer method appli condit numer method viz n uniformli h c constant symbol odelta independ h n proof condit numer method satisfi theorem applic therefor remain consid situat h restrict condit impli suffici small h assum oe satisfi choic guarante eigenvalu real oe oh special choic jflj p o coeffici satisfi o fig error total oscillatori energi function h linear problem hold recal consequ estim oe fact jflj oe relat thu yield togeth impli prove tdepend term small need relat oe use also obtain sin complet proof theorem proof show gener situat theorem first term righthand express becom neglig longtim conserv conclud cosh e hairer ch lubich oe fl oe fl oe floe oe initi condit b none term neglect differ integr multipl express cannot remain close constant valu result intuit clear situat two frequenc indistinguish close numer method upper pictur fig show maxim error hamiltonian hxn depend h problem initi valu three curv correspond step size pictur left obtain method satisfi uniform converg error nice observ pictur right correspond method e tabl lower pictur fig plot maxim deviat oscillatori energi ixn function h confirm analysi abov show h satisfi oscillatori energi cannot well conserv frequenc expans analyt solut main tool analysi nonlinear problem decomposit solut xt smooth part highli oscillatori term smoothli vari amplitud decomposit valid finit time interv show exist two almostinvari coeffici decomposit relat total energi oscillatori energi system repeat use almost invari allow us prove longtim nearconserv oscillatori energi frequenc expans assum nonlinear g analyt open set d consid solut satisfi k compact subset d assum initi valu limit harmon energi k e independ theorem assumpt solut xt eq arbitrari n expans form e ikt z k t rn t remaind term deriv bound real function complex function z bound togeth deriv z uniqu term size o gamman gamma constant symbol onot independ e n order deriv proof determin smooth function put e ikt z k t insert function expand nonlinear around yt compar coeffici e ikt notat g m yz follow system differenti equat z k z k sum rang multiindic integ ff j satisfi given sum larg domin term differenti equat given leftmost express howev sinc central term involv higher deriv confront singular perturb problem interest smooth function satisfi system defect size o gamman spirit euler deriv eulermaclaurin summat formula see eg haw remov disturb higher deriv use iter differenti equat lead system z k formal seri power gamma sinc get formal algebra relat elimin variabl function f final obtain algebra relat z k z k system real secondord differenti equat complex firstord differenti equat z point forget deriv take motiv ansatz truncat o gamman term insert ansatz first second deriv compar like power recurr relat function f k jl show function togeth deriv bound compact set determin initi valu function e xt satisfi e x special structur ansatz give system which implicit function theorem yield local uniqu initi valu assumpt impli z follow bounded f l z look closer structur function g k jl seen contain least k time factor z impli state bound function still estim remaind rn xt consid solut initi valu construct function satisfi system defect o gamman give defect size o gamman function e xt insert henc finit time obtain slightli sharper bound appli proof n replac n hamiltonian frequenc expans consid situat hamiltonian system x hamiltonian ux assum analyt let v k function satisfi here sum multiindic integ ff given sum write denot follow vector y v satisfi system which neglect o gamman term hamiltonian theorem assumpt constant symbol odelta independ depend e n proof multipli respect give dt integr use v bound theorem hand use follow insert yield statement anoth almostinvari besid hamiltonian hy v coeffici frequenc expans anoth almostinvari depend oscil part given almostinvari turn close energi harmon oscil theorem assumpt constant symbol odelta independ depend e n proof vector hold uy differenti ident respect yield z gammak proof theorem similar theorem multipli relat gammaikv gammak instead sum yield use gammai deriv iv dt v gammak sum term k gammak cancel henc statement follow use bound theorem hand use argument proof theorem prove second statement theorem corollari xt k constant symbol odelta independ depend e n proof fix let v j denot vector frequenc expans term correspond start valu xjt xjt vn t vn t vn note iv j uniqu statement theorem v j bound theorem argument appli ivn t vn t vn yield result remark alreadi known articl bgg oscillatori energi xt nearli preserv long time proof bgg complet differ use coordin transform hamiltonian perturb theori show nearli preserv time interv grow exponenti care trace ndepend constant o gamman term possibl obtain nearconserv exponenti long time interv also within present framework frequenc expans frequenc expans numer solut section show numer solut nonlinear problem frequenc expans similar analyt solut follow idea backward analysi motiv result sect look function e ikt z k t with smooth yt z k t depend h that small defect assum throughout section numer solut phix n remain compact subset region gx analyt ie function calculu comput function yt z k t follow function calculu conveni let f entir complex function bound jfij c e fljij then converg everi function x analyt disk radiu r flh around t note hd k two entir function whenev side exist particular avoid overload notat hat use letter z k analyt solut hope caus confus therefor introduc oper homega sin which h approxim h d next studi applic oper function form e it zt leibniz rule calculu hd k e it zt short calcul also yield fhde it modifi equat coeffici function frequenc expans oper lhd condit becom insert ansatz expand righthand side taylor seri around phiyt compar coeffici e ikt yield function yt z k t here multiindex proof theorem ff abbrevi mtupel phiz ff get smooth function yt z k t solv small defect look domin term taylor expans lhd lhd ikh abbrevi kh ihd situat complic frequenc expans analyt solut sever coeffici may vanish due numer reson confin discuss nonreson case assum h gamma lie subregion small paramet exist posit constant c longtim energi conserv condit exclud h o close integr multipl given h condit impos restrict n follow n fix integ hold theorem limitedenergi condit nonreson condit condit condit numer method numer solut form uniformli function satisfi defect oh n first compon ohh n second compon togeth deriv function bound constant symbol onot independ h depend e n proof assumpt first nonvanish coeffici domin one deriv defin relat z k analyt solut theorem insert elimin recurs higher deriv motiv follow ansatz comput function z k z k z k function depend smoothli variabl bound paramet h insert ansatz deriv compar like power h yield recurr relat function jl function g k jl for k contain least k time factor oehz f l contain least factor sinc seri need converg truncat next determin initi valu xh coincid start valu x x numer scheme x comput x x via formula use nonreson e hairer ch lubich assumpt condit b formula first compon x b impli second compon x x b x delta divis h sinc h yield four equat constitut nonlinear system four quantiti z implicit function theorem use limitedenergi assumpt get local uniqu solut suffici small h condit satisfi initi valu z satisfi z follow impli z estim directli obtain cons quentli valu b xnh insert numer scheme yield defect size oh n standard converg estim show bound time interv size ot h n first compon size oht h n second compon complet proof theorem frequenc expans deriv approxim condit h k integ k deriv approxim xn given defin b x t continu analogu use condit theorem impli bound time interv next write function b x t e ikt z k t insert relat gammai equival compar coeffici e ikt obtain sinc ihd particular get z z co h sin h theorem assumpt theorem numer solut xn given satisfi uniformli function togeth deriv bound z constant symbol onot independ h depend e n proof estim follow theorem z use formula get sharper result energi along numer solut hamiltonian case gammaru y total energi h oscillatori energi relat frequenc expans coeffici follow lemma coeffici frequenc expans xn xn satisfi respect proof definit ibx b e it z e it z statement follow fact jv formula prove way almostinvari numer frequenc expans section show that hamiltonian case coeffici frequenc expans numer solut invari obtain sect denot z k coeffici frequenc expans similar consid function sum taken multiindic nonvanish integr compon follow theorem coeffici v k satisfi r factor oeh defect due presenc factor oehz relat defin zcompon similar relat allow us obtain invari analogu h sect first invari sect multipli respect thu obtain dt sinc know bound z k deriv theorem switch quantiti z k get equival relat dt shall show lefthand side total deriv express depend y z k deriv inde term l written dt similarli get z gammak z z dt z z z z dt z z z z dt z z im z z dt z z z henc exist function b depend valu function first n deriv read dt yield immedi first statement follow result theorem assumpt theorem coeffici function proof formula b h obtain formula lhd togeth estim theorem remark symplect discret second invari proof theorem function consequ follow gammai written z variabl becom gammai sect lefthand express written total deriv function b zt depend valu function z first n deriv dt theorem assumpt theorem coeffici function h theorem proof estim theorem obtain condit yield state formula b longtim energi conserv numer discret abl prove main result paper show total energi h oscillatori energi nearli conserv time interv length cn h gamman n nonreson condit satisfi conveni reader restat assumpt ffl limitedenergi condit e hairer ch lubich ffl bounded condit numer solut sequenc phix n stay compact subset domain analyt g ffl condit h ffl condit numer method ffl nonreson condit n theorem condit numer solut obtain method satisfi nh constant symbol odelta independ n h satisfi condit depend n proof a consid linear combin b follow theorem theorem moreov theorem theorem togeth lemma b xt defin frequenc expans coeffici yt defin relat hold finit time frequenc expans defin b appli relat repeatedli interv length h frequenc expans correspond differ start valu long satisfi limitedenergi condit possibl larger constant e theorem give us frequenc expans coeffici yn t zn t correspond start valu uniqu up oh n coeffici frequenc expans follow diagram commut term size oh n numer method up oh n construct coeffici function via show also higher deriv y n zn h y n zn differ oh n thu use relat repeatedli obtain moreov follow coeffici function correspond start valu xn construct b x theorem obtain give desir bound deviat total energi along numer solut argument appli ixn acknowledg grate sebastian reich draw attent fermipastaulam problem r realiz holonom constraint freez high frequenc degre freedom light classic perturb theori hamiltonian interpol near ident symplect map applic symplect integr algorithm studi extrapol method base multistep scheme without parasit solut problem energi equipartit larg system fermipastaulam type analyt numer estim numer integr ordinari differenti equat base trigonometr polynomi lifespan backward error analysi numer integr energi conserv stormertyp numer integr analysi histori gautschityp method oscillatori secondord differenti equat dynam system tr ctr m van dael g vanden bergh geometr numer integr mean exponentiallyfit method appli numer mathemat v n p april ernst hairer import aspect geometr numer integr journal scientif comput v n p octob j m franco new method oscillatori system base arkn method appli numer mathemat v n p august paul j atzberg peter r kramer charl s peskin stochast immers boundari method fluidstructur dynam microscop length scale journal comput physic v n p june