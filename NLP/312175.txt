t fast estim diamet shortest path without matrix multipl a recent past consider progress devis algorithm allpair shortest path apsp problem run time significantli smaller obviou time bound on unfortun new algorithm base fast matrix multipl algorithm notori impract work motiv goal devis pure combinatori algorithm match improv run time result come close achiev goal present algorithm small addit error length path obtain algorithm easi implement desir properti combinatori natur hidden constant run time bound fairli smallour main result algorithm solv apsp problem unweight undirect graph addit error time onsqrtlog n algorithm return actual path distanc addit give effici algorithm run time footnotes on sqrtk log n case requir determin shortest path k specifi pair vertic rather pair vertic start point result om sqrtn log n algorithm distinguish graph diamet later extend obtain ratio approxim diamet time om sqrtn log n n unlik case apsp result approxim diamet comput extend case direct graph arbitrari posit real weight edg b introduct consid problem comput allpair shortest path apsp unweight undirect graph g n vertic edg recent work alon galil margalit agm alon galil margalit naor agmn seidel sei led dramat progress devis fast algorithm problem algorithm base formul problem term matric small integ entri use fast matrix multipl achiev time bound denot expon run time matrix multipl algorithm use current best matrix multipl algorithm due coppersmith winograd cw contrast naiv algorithm apsp perform breadthfirst search vertex requir time thetanm given fundament natur problem import consid desir implement algorithm practic unfortun fast matrix multipl algorithm far practic suffer larg hidden constant run time bound consequ adopt view treat result primarili indic exist effici algorithm consid question devis pure combinatori algorithm apsp run time on gammaffl admittedli vagu term combinatori algorithm intend contrast algebra flavor algorithm base fast matrix multipl understand distinc depart comput scienc stanford univers email donaldcsstanfordedu support nsf graduat fellowship nsf grant ccr depart comput scienc stanford univers email chekuricsstanfordedu support otl grant nsf grant ccr z depart comput scienc stanford univers email rajeevcsstanfordedu support alfr p sloan research fellowship ibm faculti develop award otl grant nsf young investig award ccr match fund ibm schlumberg founda tion shell foundat xerox corpor notat ofn denot ofn polylogn tion believ instruct tri interpret algebra algorithm pure graphtheoret term even use simpler matrix multipl algorithm strassen str current best known combinatori algorithm due feder motwani fm run time on yield margin improv naiv algorithm take step direct realiz goal outlin present algorithm solv apsp problem addit error time on log n algorithm return actual path distanc note run time better practic matrix multipl algorithm strassen str use algorithm describ earlier further explain below also give slightli effici algorithm for spars graph approxim diamet algorithm easi implement desir properti combinatori natur hidden constant run time bound fairli small result present case unweight undirect graph gener case undirect graph small integ edg weight detail provid final version paper crucial step develop result shift focu problem comput diamet graph maximum pair vertic shortest path distanc ver tice diamet determin comput allpair shortest path apsp distanc graph appear known way solv diamet problem fact fan chung chu earlier pose question whether on gammaffl algorithm find diamet without resort fast matrix multipl situat regard combinatori algorithm diamet margin better case apsp basch khanna motwani bkm present combinatori algorithm verifi whether graph diamet time slight adapt algorithm yield boolean matrix multipl algorithm run time bound therebi allow us verifi diamet graph d constant d time consid problem devis fast algorithm approxim diamet easi estim diamet within ratio om time perform breadthfirst search bf vertex v let depth bf tree obtain clearli diamet g lie d better approxim algorithm known problem fact even known distinguish graph diamet first result om log n algorithm distinguish graph diamet later extend obtain ratio approxim diamet time om work suggest sever interest direct futur work elementari be combinatori algorithm run time on gammaffl distinguish graph diamet belief problem effici comput diamet solv given decis algorithm work provid evid support belief fact view bottleneck obtain faster combinatori apsp algorithm precis problem distinguish graph diamet also rais question whether strong equival diamet apsp problem eg complex within polylogarithm factor final cours remov addit error result remain major open problem rest paper organ follow begin present definit use observ section section describ algorithm distinguish graph diamet extens obtain ratio approxim diamet then section appli idea develop estim diamet obtain promis algorithm addit approxim apsp final section present empir studi perform algorithm allpair shortest path preliminari basic algorithm present notat result concern domin set graph underli algorithm definit respect fix undirect graph gv e n vertic edg definit distanc du v two vertic u v length shortest path them definit diamet graph g defin max uvg du v denot diamet graph g delta definit kneighborhood n k v vertex v set vertic v distanc k v ie degre vertex v denot final use notat n denot set vertic distanc v import keep mind set n v contain neighbor v also includ v itself definit vertex v v denot bv depth bf tree g root vertex v throughout paper work paramet chosen later serv threshold classifi vertic low degre high degre threshold implicit follow definit definit defin lv sg hv sg follow gener standard notion domin set definit given set v set b v domin set vertex is vertex n b one neighbor b follow theorem underli algorithm theorem exist domin set hv size os gamma n log n domin set found om remark easi see choos set theta gamma n log n vertic uniformli random give desir domin set hv high probabl theorem effect derandom result random algorithm proof suppos begin with hv then interest standard domin set graph g problem comput minimum domin set g reformul set cover problem follow everi vertex v creat set give instanc set cover problem g goal find minimumcardin collect set whose union v given set cover solut c s set vertic correspond subset c form domin set g size c vertex v occur one set sw c thu either fast estim diamet shortest path domin set neighbor therein similarli domin set g correspond set cover cardin greedi set cover algorithm repeatedli choos set cover uncov element known provid set cover size within factor log n optim fraction solut joh lov sinc everi vertex degre least therefor correspond set v cardin least s assign weight s everi set give fraction set cover total weight fraction size equal gamma n thu optim fraction set cover size on greedi set cover algorithm must deliv solut size os gamma n log n give domin set g size implement greedi set cover algorithm keep set bucket sort number uncov vertic algorithm shown run time om consid case hv construct graph g ad set dummi vertic g everi vertex new graph degre higher preced argument construct domin set g size os gamma ns log n os none new vertic x connect vertic hv restrict domin set v give domin set hv size os gamma n log n final run time increas addit new vertic edg sinc total number edg ad ns on get desir time bound rest paper denot domin set hv construct per theorem estim diamet section develop algorithm find estim e delta e delta first present algorithm distinguish graph diamet shown algorithm gener promis approxim algorithm distinguish diamet basic idea behind algorithm root follow lemma whose proof straightforward lemma suppos g pair vertic b then bf tree root vertex v n a n b depth least algorithm call algorithm vs comput bf tree small set vertic guarante contain vertex one bf tree certifi diamet algorithm vs lv a choos v lv b comput bf tree vertic n v els a comput domin set hv b comput bf tree vertic endif bf tree depth return return assum and algorithm set lv dv provid part input otherwis comput omn time theorem algorithm vs distinguish graph diamet run time om proof clear algorithm output graph diamet sinc graph bf tree depth exceed assum g diamet fix pair vertic show algorithm bf vertex v n a n b sinc lemma depth bf tree root v least algorithm output consid two case aris algorithm case lv either b belong n v noth prove bv noth prove therefor case remain b n v see figur sinc da b path b go vertex n v impli further sinc comput bf tree vertex n v guarante bf neighbor b complet proof size n v s therefor time comput bf tree bound om case lv sinc domin set v follow immedi n a n b establish proof correct theorem aingworth chekuri motwani v less node figur case algorithm vs log n impli bound om log n cost comput bf tree case choos log n obtain follow corollari corollari graph diamet distinguish om log n time approxim diamet basic idea use algorithm vs gener estim diamet gener fix two vertic b delta delta diamet graph suppos find vertex v n delta a n delta b clear bv delta use bv estim befor find small set vertic guarante vertex n delta a n delta b then comput bf tree vertic use maximum depth tree estim e reason choos fraction becom appar analysi algorithm fol low simplifi notat assum delta integ gener though analysi need modifi use bdeltac also assum delta easi see case delta easi handl separ key tool rest algorithm notion partialbf defin term paramet k kpartialbf tree obtain perform usual bf process point exactli k vertic not includ root visit lemma kpartialbf tree comput time ok proof number edg examin vertex visit bound k sinc kpartialbf process termin k distinct vertic examin impli total number edg examin ok domin run time note kpartialbf tree contain k vertic closest root set uniqu defin due tie typic k clear context mention explicitli definit let pbf k v set vertic visit kpartialbf v denot pbv depth tree construct fashion approxim algorithm diamet follow algorithm approxdiamet comput spartialbf tree vertex v let w vertex maximum depth comput bf tree vertex comput new graph b g g ad edg form u v u pbf v comput domin set b g comput bf tree vertex return estim e equal maximum depth bf tree step follow lemma constitut analysi algorithm lemma domin set found step size os gamma n log n proof b g vertex v v adjac vertic pbf v respect graph g everi vertex v degre vertex b g least s theorem follow find domin set size os lemma jn delta vj vertex proof consid particular vertex v v v d noth prove otherwis sinc domin set b g vertex u u v edg b g u v g done sinc u n v ae n delta v possibl u neighbor v g must case u pbf v condit jn delta vj impli pbf v ae n delta v turn impli u n delta v henc fast estim diamet shortest path reader notic similar preced lemma case theorem lemma follow gener set cover idea use proof theorem hold even replac delta fraction delta crucial lemma given below lemma let set vertic v vertex w found step belong s addit bw delta everi vertex v pbf w n delta v proof verifi vertex u s convers vertex v v n s delta conclud nonempti vertex largest depth belong s also vertex u s must n delta u ae pbf u bw delta everi vertex within distanc delta w fact n delta w ae pbf w follow proof lemma make clear reason estim within diamet essenti need ensur deltak neighborhood w intersect deltak neighborhood everi vertex happen bw suffici small small enough want bw good estim balanc condit give us ratio theorem algorithm approxdiamet give estim e delta om ms ns choos log n give run time om proof analysi partit two case let b two vertic delta case for vertic v jn delta vj s either b d done otherwis proof lemma set vertex b sinc step comput bf tree vertex d one v bv desir estim case there exist vertex v v let w vertex step bw delta bw estim done otherwis lemma pbf w vertex v n delta a n delta b sinc step comput bf tree vertex pbf w one v bv desir estim run time easi analyz partial bf step take os thu total time spent step on step implement on time step comput bf tree vertic requir total om time time requir step domin time requir comput partial bf tree step theorem impli step requir on note graph b g could mani edg m lemma step take om time final cost step domin cost comput variou bf tree step run time domin cost step ad bound give desir result addit factor approxim possibl determin diamet allpair shortest path distanc within addit error basic idea domin set sinc contain neighbor everi vertex graph must contain vertex within distanc shortest path sinc find small domin set vertic hv treat lv vertic differ low degre allow us manag partialbf combin inform glean domin set algorithm approxapsp comment defin glv subgraph g induc lv initi entri distanc matrix b infin comput domin set hv size comput bf tree vertex v d updat b shortest path length v obtain comput bf tree glv vertex shortest path length v obtain u return b apsp matrix largest entri diamet figur illustr idea behind algorithm aingworth chekuri motwani actual shortest path path comput step hi lo bf node lo step bf node step graph hi lo label figur illustr algorithm approxapsp theorem algorithm approxapsp vertic distanc return b satisfi further algorithm modifi produc path length b rather mere return approxim distanc algorithm run time on choos log n give run time on log n proof first show algorithm easili modifi return actual path rather distanc achiev thi step associ updat entri matrix path bf tree use updat step mere concaten two path step sum whose length determin minimum valu d vertex u clear shortest path distanc vertex v v return cannot smaller correct valu sinc correspond actual path see differ need consid three case case u d case bf tree v comput step clearli distanc return correct case definit d must case u neighbor w d clearli distanc u w vertex cannot differ distanc w alway correct per case assign step guarante case u lv fix shortest path u v suppos path u v entir contain lv then du v set correctli step otherwis path must contain vertex w hv w contain d correct distanc comput per case final w hv nd contain neighbor x clearli step one possibl consid involv path u x path x v sinc distanc involv x correctli comput step mean b final analyz run time algo rithm step requir on time theorem impli perform step state time bound step requir ms gamma n log n comput bf tree step may comput mani omegagamma n bf tree glv on edg requir on s time final step take vertex pair compar vertic d impli desir time bound although error algorithm improv special case distinguish diamet base follow two observ fact u hv distanc delta vertex v b proof consid w vertex domin u algorithm set b algorithm would impli b exact vertic d possibl fact whenev algorithm report verifi time on per vertex thu perform verif vertic report distanc improv algorithm approxapsp alway perform well diamet approxim algorithm previou section first fact also appear use bring diamet error unfortun vertic lv cannot handl easili larger diamet experiment result evalu use algorithm ran two famili graph compar result care code algorithm base breadthfirst search algorithm approxapsp tweak follow heurist improv step avoid mani needless iter node neighbor d copi distanc neighbor sinc differ algorithm call fast approxapsp occasion higher fraction incorrect entri seem fastest way solv allpair shortest path problem fast estim diamet shortest path approxapsp fast approxapsp approxapsp fast approxapsp speedup speedup accuraci accuraci gb median gb averag gb standard deviat rg median rg averag rg standard deviat tabl summari experiment result first famili graph random graph g nm model bol graph chosen uniformli random n vertic edg experi chose random graph n rang mn rang graph fast approxapsp run time faster bf implement half distanc one second famili graph come stanford graphbas knu test connect undirect graph appendix c knuth knu ignor edg weight heterogen famili graph includ graph repres highway connect american citi athlet schedul letter english word expand graph well combinatori graph thu result quit indic practic perform although bfsbase algorithm run fastest certain subfamili graphbas fast approxapsp outperform algorithm overal result summar tabl tabl gb rg refer graphbas random graph re spectiv speedup number indic invers ratio execut time algorithm care code bf algorithm accuraci refer ratio total number exact entri distanc matrix total number entri matrix famili accuraci approxapsp could improv subtract step seem necessari given bf approach perform fast approxapsp fast approx apsp perform faster roughli accuraci number indic gener graph addit factor error accept fast approxapsp algorithm choic specif famili graph paramet adjust even better perform acknowledg grate noga alon comment suggest nati linial help discuss thank also michael goldwass david karger sanjeev khanna eric torng comment r expon pair shortest path problem boolean matrix multipl shortest path diamet verif boolean matrix multipl random graph diamet graph old problem new result matrix multipl via arithmet progress cliqu partit approxim algorithm combinatori problem ratio optim integr allpairsshortestpath problem gaussian elimin optim tr ctr david eppstein joseph wang fast approxim central proceed twelfth annual acmsiam symposium discret algorithm p januari washington dc unit state mattia andersson joachim gudmundsson christo levcopoulo approxim distanc oracl graph dens cluster comput geometri theori applic v n p august tom feder rajeev motwani liadan ocallaghan chri olston rina panigrahi comput shortest path uncertainti journal algorithm v n p januari alan p spragu o queri time algorithm pair shortest distanc permut graph discret appli mathemat v n p februari mikkel thorup uri zwick approxim distanc oracl proceed thirtythird annual acm symposium theori comput p juli hersonisso greec joachim gudmundsson christo levcopoulo giri narasimhan michiel smid approxim distanc oracl geometr graph proceed thirteenth annual acmsiam symposium discret algorithm p januari san francisco california michael elkin jian zhang effici algorithm construct spanner distribut stream model proceed twentythird annual acm symposium principl distribut comput juli st john newfoundland canada mikkel thorup uri zwick approxim distanc oracl journal acm jacm v n p januari joan feigenbaum sampath kannan andrew mcgregor siddharth suri jian zhang graph distanc stream model valu space proceed sixteenth annual acmsiam symposium discret algorithm januari vancouv british columbia feodor f dragan estim pair shortest path restrict graph famili unifi approach journal algorithm v n p septemb surend baswana telikep kavitha kurt mehlhorn seth petti new construct spanner pure addit spanner proceed sixteenth annual acmsiam symposium discret algorithm januari vancouv british columbia mikkel thorup uri zwick spanner emul sublinear distanc error proceed seventeenth annual acmsiam symposium discret algorithm p januari miami florida surend baswana sandeep sen approxim distanc oracl unweight graph expect on time acm transact algorithm talg v n p octob timothi m chan allpair shortest path unweight undirect graph omn time proceed seventeenth annual acmsiam symposium discret algorithm p januari miami florida rezaul alam chowdhuri vijaya ramachandran externalmemori exact approxim allpair shortestpath undirect graph proceed sixteenth annual acmsiam symposium discret algorithm januari vancouv british columbia surend baswana sandeep sen simpl linear time random algorithm comput spars spanner weight graph random structur algorithm v n p juli pair shortest path use bridg set rectangular matrix multipl journal acm jacm v n p may