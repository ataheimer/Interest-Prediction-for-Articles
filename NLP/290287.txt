t reject techniqu sampl logconcav multivari distribut a differ univers method also call automat blackbox method suggest sampl form univari logconcav distribut descriptioon suitabl univers gener multivari distribut arbitrari dimens publish now new algorithm base method transform densiti reject construct hat function reject algorithm multivari densiti transform proper transform concav function in case logconcav densiti logx possibl construct domin function take minimum server tangent hyperplan transform back t origin scale domain differ piec hat function polyhedra multivari case although method shown work slow complic higher dimens articl split rn simpl cone hat function construct piecewis cone tangent hyperplan result function longer continu reject constant bound setup gener remain quit fast higher dimens exampl articl describ detail main idea use construct algorithm tdrmv gener random tupl multivari logconcav distribut comput densiti although develop algorithm real black box method adjust larg class logconcav densiti b introduct univari case larg literatur gener method standard distribut see eg dev dag last year paper appear univers or blackbox method see dev chapter vii gw ahr hora hd es algorithm gener random variat larg famili long inform typ ical mode densiti specif distribut avail gener variat bivari multivari distribut paper rare well known discuss gener multinorm wishart distribut see eg dev dag sever approach problem gener multivari random tupl exist disadvantag ffl multivari extens ratio uniform method sv wg method reformul reject small famili tablemountain shape multivari distribut point view includ two paper use clarifi question accept probabl becom poor high correla tion disadvantag method alreadi mention wg practic problem obtain necessari multivari rectangl enclos region accept ratio uniform method discuss sv wg seem difficult distribut ffl condit distribut method requir knowledg abil sampl margin condit distribut see dev chapter xi ffl decomposit reject method major function also call suggest multivari reject method product margin densiti in dag clear obtain necessari reject constant ff ffl develop new class multivari distribut easi gener necessari and possibl specifi margin distribut degre depend measur correl coeffici see monograph joh idea seem attract simul practition interest multivari distribut help variat distribut given densiti gener recent devroy dev develop algorithm orthounimod densiti paper leav gener logconvav distribut open problem ffl sweepplan method logconcav and tconcav distribut describ recent horb bivari case lh multivari case algorithm use idea transform densiti reject present first form dev chapter vii differ setup gw knowledg two algorithm univers algorithm literatur multivari distribut given densiti in dev chapter xi even stress gener inequ multivari densiti avail fact make design blackbox algorithm similar develop dev univari case imposs although algorithm lh work slow sinc domain densiti f decompos polyhedra due construct hat function take pointwis minimum tangent hyperplan paper use transform densiti reject sweepplan techniqu deriv much effici algorithm main idea decompos domain densiti cone first comput tangent hyperplan cone result hat function continu reject constant bound below setup well sampl hat function much faster origin algorithm section explain method give necessari mathemat formu lae section provid detail algorithm section discuss improv extend main idea algorithm eg tconcav distribu tion bound domain section report comput experi new algorithm method transform densiti reject densiti given multivari distribut differenti densiti function simplifi develop method assum x extend algorithm requir drop transform design univers algorithm util reject method necessari find automat way construct hat function given densiti transform densiti reject introduc differ name gw gener hora base idea densiti f transform monoton eg way see hora concav we say f concav differenti x impli gamma exist t volum hat finit hat easi construct hat hx fx minimum n tangent sinc fx concav clearli transform hx back origin scale get major function hat f ie fx hx figur illustr situat univari case mean normal distribut transform logx left hand side show transform figur hat function univari normal densiti densiti three tangent right hand side show densiti function result hat the dash line simpl lower bound densiti call squeez random variat gener use reduc number evalu f especi number touch point larg evalu f slow acceler gain squeez enorm reject basic form multivari reject method given algorithm reject algorithm reject setup construct hatfunct hx gener random tupl proport hx uniform random number u uhx fx return x els go main idea paper extend transform densiti reject describ hora multivari case construct hat function tangent let p point r n multivari case tangent transform densiti fx p hyperplan given hdelta deltai denot scalar product polyhedra lh hat function hx construct pointwis minimum tangent domain particular tangent x determin hat function simpl convex polyhedra p may bound for detail convex polyhedra see gru zie sweepplan techniqu gener random tupl polyhedron densiti proport avoid lot indic write p x p without index risk confus sweepplan algorithm let r kr r choos g denot norm given x let denot hyperplan perpendicular g x fy intersect polytop p depend x onli thu write f x risk confus qx convex simpl polyhedra move sweepplan f x domain p vari x figur illustr situat easili seen gamma x constant qx everi x let hat function p given find margin densiti function hat z figur sweepplan f x integr done f x ax denot n gamma dimension volum qx exist qx bound comput ax let v j denot vertic p v assum polyhedron p simpl let v j n n nonzero vector direct edg p origin v j ie k everi modifi method law find coeffici given notic b x equat hold p simpl detail see lh gener h g easi gener logconcav concav see x densiti fx h g logconcav pre c concav lh respect gener random tupl sampl hat distribut first need volum hat polyhedra p domain d choos one polytop randomli densiti proport volum mean proper univari random number sampl margin distribut hj g get intersect qx p last sampl uniform distribut qx shown see lh algorithm work polyhedra p simpl see abov exist uniqu maximum x p then ff gamma fi x decreas thu volum hat finit unbound polyhedra nonconst everi edg p otherwis hg v j edg thu adapt reject sampl hard find optim point construct tangent x thu point must chosen adapt reject sampl see gw adapt situat work follow way start vertic regular simplex add new construct point whenev point reject maximum number n tangent reach point contact thu chosen stochast algorithm clear multivari densiti distribut next point new tangent proport hx gamma fx henc tend toward infin accept probabl hat construct way converg probabl difficult show expect volum hat on gamman problem use method run sever problem comput polyhedra everi time add point must done margin distribut exist initi usual bound polyhedra p volum hat infinit q x bound ff gamma fi x decreas moreov polyhedra p typic mani vertic therefor algorithm slow hard implement follow effect gamma comput polyhedra setup expens gamma margin densiti expens comput sinc differ everi polyhedron p and everi densiti function f use slow black box method eg gw hora sampl margin distribut even case logconcav densiti gamma qx simplex thu use slow recurs sweep plane algorithm describ lh sampl uniform distribut simpl polytop simpl cone better idea choos polyhedra first simpl possibl ie choos cone we describ x get cone simpl cone c with vertex origin unbound subset span n linearli independ vector opposit procedur describ choos proper point p cone c construct tangent whole cone hat h given tangent method remain same obvious hat function continu becaus first defin decomposit domain comput hat function differ part cannot made continu take pointwis minimum tangent sinc otherwis cannot comput margin densiti h g equat moreov choos one touch point part disadvantag neglig compar enorm speedup setup gener random tupl respect hat function margin densiti intersect qx sweep plane f x cone c bound f x cut set ft x ie hg t henc find volum ax intersect qx ae x again notic ax exist condit violat wherea right hand side defin margin densiti exist ie hold given volum volum hat function cone c given z h g z x notic g thu a ff fi depend choic p choos arbitrari p may result larg volum hat thu poor reject constant intersect sweepplan notic intersect qx alway n gamma simplex condit hold thu use algorithm dev sampl uniform distribut qx vertic qx r n given uniformli random variat u sort variat u un get random point qx see dev theorem xi v choic p one main difficulti new approach choic touch point p opposit first approach polyhedron build around touch point find point hold moreov volum hat function cone small possibl search touch point whole cone c domain the touch point need c techniqu multidimension minim practic firstli evalu volum hc given point p expens gradient respect p given secondli domain hc given set point hold instead suggest choos point center c proper touch point hat let barycent span vector let as ff fi denot correspond paramet t choos minim function z domain da function given point kr ax exist ie condit easili seen da open subset minim j use standard method eg brent algorithm see eg fmm main problem find da although fx concav assumpt possibl particular cone c da strict subset even empti set moreov might connect gener follow hold let a b compon da f c ie gradient f continu lim sa roughli spoken j ushap function a b essenti part minim initi bracket minimum ie find three point a b js necessari sinc function term j also defin da eg use brent algorithm without initi bracket may and occasion doe result eg neg s bracket done search da use properti move toward b respect find it obviou find local minimum j procedur distribut test one local minimum therefor global one special case hg ti depend eg multivari normal distribut da either empti set possibl make similar consider like hora theorem one dimension case adapt multivari case would state optim touch point p fp everi cone c condit violat notic da even may empti set ie condit fail concav fx know construct point p furthermor hg pi bound everi compact subset domain densiti f therefor alway exist partit simpl cone proper touch point satisfi ie domain da empti cone c even triangul new approach need partit r n simpl cone get partit triangul unit sphere ngamma cone c gener simplex delta ae ngamma triangl tetrahedron deltag simplic uniqu determin vector vertic they convex hull vertic ngamma matter cone close set intersect cone might empti measur zero comput need volum simplic avoid da empti set cone skinni furthermor get good hat function simplic volum if possibl regular ie distanc center vertic equal or similar thu triangul follow properti recurs construct easi comput simplic c edg simplex equal length although possibl get triangul n suggest algorithm fulfil c c nearli satisfi c initi cone get initi simplic convex hull ngamma vector en e denot ith unit vector r n ie vector ith compon other g easili seen result partit r n arrang hyperplan henc n initi cone barycentr subdivis edg get smaller cone triangul simplic standard triangul simplic use exampl fixedpoint comput see eg tod tod appropri purpos number simplic increas fast triangul step in opposit fix point calcul keep simplic paramet memori comput instead use barycentr subdivis edg let vertic simplex delta use follow algorithm find longest edg let ie barycent edg project sphere get two smaller simplic replac vertex new first simplex vertex j new second one make k triangul step initi cone nk simplic triangul flexibl whenev cone c empti or algorithm find split c tri find proper touch point new cone done found proper construct point cone partit see end x practic procedur stop mani cone necessari the comput run memori notic good idea use barycentr subdivis whole simplex instead divid longest edg triangul exhibit ineffici behavior creat long skinni simplic see remark tod oldest edg find longest edg simplex expens altern approach use oldest edg simplex idea follow enumer n vertic initi cone whenev new vertex creat barycentr subdivis get next number edg index tupl i j number incid vertic j choos edg lowest index respect lexicograph order the oldest edg pair lowest indic vertic simplex easili seen oldest edg one of longest edg first step unluckili hold simplic follow triangul step but least shortest one comput experi sever normal distribut dimens show idea speed triangul enorm littl effect reject constant setup basic version setup algorithm follow creat initi cone triangul find touch point p possibl and necessari triangul everi cone without proper touch point goto cone without proper touch point exist otherwis stop problem although procedur work test distribut adapt might necessari particular densiti function f search algorithm proper touch point x im prove eg da either empti set f normal distribut criterion mani triangul step necessari useful optim reject constant thu test differ number trianglat step made densiti f see also x possibl triangul cone bad touch point besid case proper touch point found touch point may lead enourm volum hat function case also exclud correspond cone triangul simpl solut problem upper bound hmax volum hc provid cone hc hmax triangul further bound found empir test given densiti f anoth way triangul initi cone first let hmax multipl eg th percentil hc creat cone problem might occur mode boundari support then set seen concav exampl situat fx normal densiti ball b vanish outsid b case exist cone c f t g intersect suppf algorithm troubl c simpli remov cone otherwis expens search proper touch point necessari restrict observ besid fact automat adapt possibl drawback algorithm usag blackbox algorithm nevertheless algorithm suitabl larg class logconcav densiti possibl includ paramet code adjust algorithm given densiti easili cours test might necessari besid algorithm produc wrong random point simpli work good touch point found cone c logconcav densiti transform concav say f logconcav thu find margin densiti function gamma distribut shape paramet n fi volum hat logconcav densiti cone c given z x minim function best use logarithm normal distribut densiti proport center cone c thu simpli find sinc as depend find constant even normal distribut arbitrari covari matrix function becom much complic algorithm algorithm tdrmv consist two main part construct hat function hx gener random tupl x densiti proport hat function first one done subroutin setup second one routin sampl algorithm random tupl given logconcav densiti input densiti f call construct hatfunct hx repeat x call sampl gener random tupl x densiti prop hx gener uniform random number u u delta hx fx return x store hx need list cone c cone need sever data store object cone notic variabl p g ff fi hc depend choic touch point p thu s paramet necessari setup object cone paramet variabl definit span vector center cone construct point locat p setup sweep plane g see margin densiti ff fi see coeffici see determin vector volum hat hc h cum c see remark make descript algorithm readabl standard techniqu given detail routin setup consist three part h setup initi cone h triangul initi cone h calcul paramet h simpl see x h done subroutin split main problem h find paramet ie proper construct point done subroutin find minim expens notic given comput paramet depend evalu function sinc suitabl use deriv function good choic find minimum use brent algorithm eg fmm reduc cost find proper s minim everi cone instead use follow procedur make triangul step describ x comput everi cone c continu triangul cone split barycentr subdivis correspond simplex new cone inherit old simplex comput experi variou normal distribut show cost setup reduc enorm without rais reject constant much use procedur might happen give proper touch point or hc big see end x finish triangul step thu check everi cone continu triangul cone necessari sampl subroutin sampl consist four part s select cone c s find random variat proport margin densiti h g s gener uniform random tupl u standard simplex ie comput tupl intersect qx sweep plane cone c s s done subroutin simplex possibl variant subset r n domain experi shown basic algorithm work even densiti support sinc hat hx support reject constant might becom big subroutin construct hat function input level triangul find s level minim triangul tupl append new cone list cone en span vector repeat cone c list cone call split c updat list cone level triangul find reach cone c list cone call find c repeat cone c list cone call split c updat list cone minimum level triangul reach repeat cone c list cone unknown violat call split c list cone call find new cone updat list cone cone found cone c list cone comput paramet c total volum hat cone c list cone use osearch algorithm return list cone h tot subroutin cone updat list cone input cone c list cone find lowest indic i j vector c find highest index vector of triangul append new cone c list copi vector c c replac m c replac j m c replac det c c return list cone subroutin find proper touch point input cone c bracket minimum search da return fail success search use properti return fail success find use brent algorithm use return fail success subroutin gener random tupl densiti proport hat input h tot list cone gener uniformli h tot distribut random variat u find c h cum pred c c pred predecessor c list cone gener gamman fi distribut random variat g uniformli distribut point qg return tupl x call simplex c g return x subroutin gener uniform distribut tupl simplex input cone c x locat sweep plane uniformli distribut random variat u simplex gener iid uniform random variat u un u u uniformli distribut point x qx x return x pyramid given domain proper subset r n that is give constraint suppf accept probabl increas restrict domain h accordingli domain d the domain set point densiti f defin obvious suppf d notic provid domain algorithm support f known thu replac some cone pyramid notic base pyramid must perpendicular direct g henc first choos construct point p comput height pyramid union pyramid and remain cone must cover d whenev get random point domain reject it clear continu triangul decreas volum enclos set polytop deal case arbitrari polytop given set linear inequ height pyramid height maximum hg xi c d restrict polytop linear program problem use span vector basi r n solv mean simplex algorithm k pivot step for simpl polytop k number constraint d margin densiti volum hat margin distribut truncat gamma distribut domain u u height pyramid c instead find pyramid z ux gamman gamman fiu gamman r x gammat dt proport incomplet gamma function comput mean formula gr comput height us rather expens recommend use instead exact function find touch point pyramid c comput experi standard normal distribut shown effect reject constant rather small less densiti differenti construct hat function need tangent plane everi x d differenti densiti realli requir thu suffici subroutin return normal vector tangent hyperplan which howev densiti f differenti function might nasti behavior howev notic f must continu interior suppf sinc log ffi f concav indic function indic function convex set choos arbitrari point convex set mode as origin construct set t center cone c see x notic margin densiti reduc h g none paramet ff fi depend choic touch point p cours provid compact domain densiti use indic function gener uniformli distribut random variat arbitrari convex set mode origin obviou method work mode arbitrari point r mode unknown use common numer method find maximum f sinc fx concav see eg rao notic exact locat mode realli requir algorithm even work center construct cone close mode get hat wors reject constant add mode construct point sinc one construct point cone reject constant bound below thu step triangul sens get better hat function use mode f addit construct point hat function minimum fm origin hat cone split two part hyperplan f b differ margin densiti b given fm margin densiti given notic use direct g sweep plane part comput volum hat part given x construct point per cone way improv hat function use one or two construct point method disadvantag recommend use it overlap region figur two construct point cone cone divid sever piec pyramid see figur lower upper base piec must perpendicular correspond direct g vector g determin gradient transform densiti construct point piec thu g may differ henc piec must overlap increas reject constant moreov quit clear find piec univari case appropri method exist eg dh multivari case suitabl also adapt reject sampl introduc gw use horb lh realli good choic reason quit simpl cone fix construct point alway settl center cone thu use adapt reject sampl select new construct point due distribut given margin densiti margin densiti zero exist construct point squeez make simpl kind squeez let x comput minima transform densiti qx i sinc f concav minima vertic simplic squeez x x denot minimum fx qx setup squeez rather expens use mani random point distribut must gener concav densiti famili c transform fulfil condit tt introduc hora let c set c x easili verifi condit t ie volum hat bound hold gamma ensur neg transform hat alway choos mode construct point see x hora shown densiti f c concav c concav c c case logx alreadi describ x case c margin densiti function given c x b b given fi knowledg special gener distribut known the part x b look like betaprim distribut see jkb ff fi assumpt fi x gamman henc easili seen margin densiti c concav therefor use univers gener hora comput experi cimplement test version algorithm written c avail via anonym ftp ley handl follow densiti ffl f logconcav constant support ffl domain either r n arbitrari rectangl a ffl mode arbitrari suppf must interior point suppf too close boundari suppf use two list store span vector cone with pointer list vector setup store edg i comput new vertic done temporarili hash tabl first index use hash index setup step modifi case rectangular domain mode near boundari use nearest point boundari if possibl vertex center construct cone point boundari easili elimin initi cone intersect d point vertex rectangl remain one initi cone find mode f use pattern search method hook jeev hj rao implement kau bp sinc could deal unbound bound support f without give explicit con straint find minimum use brent algorithm describ fmm implement contain paramet adjust routin particular densiti f find cone c subroutin sampl use oalgorithm search tabl binari search slower gener gamma distribut random number g use algorithm ad case unbound domain rectangl use transform densiti reject hora gener truncat gamma distribut necessari gener optim hat function truncat gamma distribut shape paramet n domain umax umax maxim valu height delta fi cone optim touch point gamma distribut comput mean algorithm dh code written test variou variant algorithm optim speed thu data shown tabl give idea perform algorithm test algorithm variou multivari logconcav distribut dimens test done pc p processor run linux gnu c compil basic version unbound domain mode origin random point densiti proport hat function time gener random point hat shown almost linear dimens n tabl show averag time gener singl point comparison give time gener n normal distribut point use boxmul method bm which give standard multinorm distribut point densiti proport comput hat function use initi cone standard multinorm densiti hat function multinorm tabl averag time gener one random point in s random point given densiti real time need gener random point given logconcav densiti depend reject constant cost comput densiti tabl show accept probabl time need gener standard multinorm distribut point notic data includ time set hat function setup find call triangul done time need comput hat function depend linearli number number cone time s accept tabl accept probabl averag time gener standard multinorm distribut point cone thu find expens part setup tabl show situat multinorm distribut densiti proport demonstr effect continu barycentr subdivis oldest edg see x number cone accept probabl cost gener random point proport hat function ie without reject proport given densiti furthermor show total time in ms setup ie comput paramet hat function in ms time cone in s the increas larg n time need gener point hat due effect memori access time subdivis cone accept hat s densiti s setupcon s tabl time comput hat function multinorm distribut run find everi cone triangul use method describ x reduc cost construct hat function tabl give idea reduct multinorm distribut proport show time construct hat function subject number cone find call due tabl accept probabl bad run find initi cone true gener might becom extrem poor level set densiti skinni tabl demonstr effect densiti proport last tabl demonstr increas time construct hat function increas dimens n mainli due increas find subdivis cone accept setup ms setupcon total s tabl time comput hat function multinorm distribut inherit construct point find subdivis accept tabl accept probabl multinorm distribut inherit construct point number cone notic start n cone furthermor make consecut subdivis shorten everi edg simplex defin initi cone thu number cone increas exponenti accept setupcon s tabl time comput hat function multinorm distribut subdivis initi cone covari matrix multinorm distribut diagon matrix ratio highest lowest eigenvalu larg cannot use initi cone make sever subdivis cone consider necessari number cone explod increas n thu case method cannot use larg n suppos shorten everi edg simplex cone need test ran test densiti proport expgamma valid implement densiti compar observ rate accept expect accept probabl comparison algorithm lh code algorithm lh much longer and thu contain bug setup much slower need s gener mulitnorm distribut random point dimens versu s tabl tdrmv rectangular domain normal densiti restrict arbitrari rectangl similar perform correspond unrestrict densiti except accept probabl wors sinc domain hat h superset domain densiti f qualiti qualiti nonuniform random number gener use transform techniqu open problem even univari case see eg hor first approach depend underli uniform random number gener situat seriou multivari case notic new algorithm requir n uniform random number everi random point cannot give answer problem here clear eg randu formerli part ibm scientif subroutin packag famou devast defect three dimens consecut point fifteen parallel plane see eg lw may result gener poor qualiti exampl test algorithm dimens proport domain r n rectangl also use densiti proport f u x u orthonorm transform b vector test distribut nondiagon correl matrix arbitrari mode algorithm work well densiti f f f rectangl enclos support f although densiti c find routin work problem aris level set densiti corner ie g unstabl vari touch littl bit some that contain corner huge volumehc triangul necessari dimens high n mani cone might necessari optim algorithm find mode fail use start point outsid support f code paramet adjust algorithm given densiti exampl requir test get optim number cone optim level subdivis call find resum present algorithm suitabl method sampl logconcav and concav distribut algorithm work well test logconcav densiti dimens low n correl high restrict densiti compact polytop possibl setup time small small dimens increas exponenti n speed gener random point quit fast even n due larg amount cone high dimens program requir lot comput memori typic mb although develop algorithm real black box method easili adjust larg class logconcav densiti exampl algorithm work multivari normal distribut multivari student distribut with transform arbitrari mean vector varianc matrix condit arbitrari compact polytop howev higher dimens ratio highest lowest eigenvalu covari matrix too big acknowledg author wish note appreci help render jorg lennei given lot hint implement algorithm author also thank gerhard derfling wolfgang hormann help convers interest work r gener gamma variat modifi reject techniqu box m remark algorithm principl random variat gener random variat gener multivari densiti optim select hat function reject algorithm random variabl gener use concav properti transform densiti comput method mathemat comput tabl integr convex poytop adapt reject sampl gibb sam pling univers gener correl induct direct search qualiti nonuniform random number reject techniqu sampl univers gener bivari logconcav distri bution continu univari distribut multivari statist simul polytop volum sweep plane algorithm gener random tupl invers linear congruenti pseudorandom number gener empir test theori applic comput gener random vector transform uniformli distribut vector comput fix point applic improv converg fixedpoint algorithm effici gener random variat via ratioofuniform method lectur polytop tr multivari statist simul comput gener random vector transform uniformli distribut vector reject techniqu sampl italictitalicconcav distribut invers linear congruenti pseudorandom number gener empir test random variat gener multivari unimod densiti sweepplan algorithm gener random tupl simpl polytop direct search solut numer statist problem gener gamma variat modifi reject techniqu remark algorithm e direct search algorithm direct search comput method mathemat comput ctr g leobach f pillichshamm method approxim invers hyperbol cdf comput v n p decemb wolfgang hrmann algorithm automat gener bivari logconcav distribut acm transact mathemat softwar tom v n p march w hrmann j leydold randomnumb randomvari gener automat random variat gener simul input proceed nd confer winter simul decemb orlando florida sey taghi akhavan niaki babak abbasi norta neural network base method gener random vector arbitrari margin distribut correl matrix proceed th iast intern confer model simul p may montreal canada sampl ratioofuniform method acm transact mathemat softwar tom v n p march