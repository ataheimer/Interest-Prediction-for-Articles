t fast multigrid solut advect problem close characterist a numer solut advectiondiffus problem inviscid limit close characterist studi prelud effici high reynoldsnumb flow solver demonstr heurist analysi numer calcul use upstream discret downstream relax order multigrid cycl appropri residu weight lead effici solut process upstream finitediffer approxim advect oper deriv whose truncat term approxim physic laplacian viscos thu avoid spuriou solut homogen problem artifici diffus domin physic viscos a brandt i yavneh j comput phi pp b introduct effici multigrid algorithm numer solut partial differenti problem normal requir good ellipt measur scale problem impli nonsmooth solut compon resolv local process problem small ellipt measur mark either indefinit anisotropi latter case technionisrael institut technolog haifa israel univers twent ensched netherland z weizmann institut scienc rehovot israel exist socal characterist direct strong depend nonsmooth compon solut advect along char acterist henc cannot resolv local typic exampl steadi flow high reynold number small viscos appli problem small ellipt usual multigrid algorithm often exhibit sever degrad perform compar seen ellipt problem inde multigrid code use today solv steadi flow high reynold number although yield great improv previou singlegrid solver fall far short attain socal textbook multigrid effici gener even smooth flow regain effici multigrid algorithm requir modif take account anisotrop properti oper exampl shown use upstream discret downstream relaxationord yield fulli effici multigrid solver flow whose characterist streamlin start part boundari end anoth without recircul enter flow obtain effici multigrid solver flow close characterist howev differ modif propos defectcorrect cycl residu overweight main drawback latter approach are a like gener effici order accuraci higher one b requir w cycl may substanti expens simpl v cycl parallel comput c suggest differ treatment differ type flow viz recircul versu enter flow upshot present work obtain unifi approach type flow employ upstream discret downstream relax order recircul flow well section formul simpl model problem advectiondiffus present first differenti approxim discret form section present twolevel cycl use approxim section heurist analysi priori predict perform algorithm section new firstord upstream discret advect oper present whose first truncat term approxim isotrop diffus scheme shown elimin spuriou solut homogen ie unforc smallviscos advectiondiffus equat report section present numer calcul test accuraci discret effici multigrid algorithm compar predict section section summar main conclus research plan scalar advectiondiffus equat studi scalar advectiondiffus equat close characterist prelud studi flow problem equat serv well preliminari problem sinc advect part ie momentum equat respons degrad perform observ solut incompressibleflow equat usual multigrid algorithm also shown enter flow solutionprocess advect part system effect decoupl ellipt part due continu equat henc effici solut advect problem necessari stage develop fulli effici flowequ solver suggest result advectionproblem solver inde use design soughtaft flowsolv advectiondiffus equat two dimens ffl posit constant a b f g given function x y equat discret uniform grid meshsiz h whose gridlin lie parallel x coordin characterist direct advect oper given local oe local angl nonalign x coordin characterist direct focu attent particular case characterist defin b form close loop as vortic one may coincid omega as intern flow suppos discret stabl finitediffer discret firstord accuraci main aspect problem analyz substitut discret oper first differenti approxim also advectiondiffus equat posit vanishingli small ffl need consid advect oper ator sinc tini diffus domin artifici diffus repres truncat term except stagnat point let l h denot firstord accur discret approxim advect opera tor then taylor seri expans gener u h denot discret function h meshsiz uniform grid here function x y specif detail determin b discret fda approxim l h differenti oper remain oh term neglect henc appli suffici smooth u h sinc neglect term higher deriv assum simplic discuss equat normal introduc conform local coordin system j denot local streamwis coordin parallel characterist direct j denot crossstream coordin perpendicular characterist thu fda l h local coordin system therefor where assum consist stabl discret requir artifici viscos oper repres first truncat term ellipt impli oh part oper posit type special circumst consist align characterist grid h vanish properti margin violat case physic diffus term becom import matter small ffl may be analysi appli accordingli assum h larg compar h usual case twolevel errorreduct analysi analyz error reduct attain twolevel cycl use upstream discret downstream relaxationord twolevel cycl propos twolevel cycl given discret problem l h u defin follow ffl start approxim u h perform small integ relax sweep ffl calcul residu r u h current approxim solut transfer twicecoars grid h multipli globallyuniform weight w ffl solv coarsegrid problem l h v correct here r h restrict r h coars grid ffl interpol add correct v h finegrid approxim ffl perform small integ finegrid relax sweep studi asymptot perform twolevel cycl number prerelax sweep need distinguish number postrelax sweep recal associ asymptot perform spectral radiu ae iter matrix aeab aeba pair squar matric a b dimens denot total number sweep analyz twolevel cycl shall make mani simplifi assump tion degre assumpt justifi need judg degre numer result match predict analys model problem analysi analyz twolevel converg discret approxim limit vanish ffl problem close characterist consid follow model problem grid h l h is abov discret advect oper domain solut boundari condit requir period order simul close characterist choos simplic discuss boundari condit crossstream direct german present context simplic let main point approach use discret pure upstream relax equat downstream order start order mean relax variabl relax unknown particip equat correspond variabl except perforc thu full relax sweep result elimin residu except narrow band of oh width stretch which coincid due period neglect width band find residu function r h remain least one full relax sweep carri out model r h finegrid error v h satisfi residu equat wherev residu vanish revert fda obtain defin add simplifi assumpt independ j henc may expand fourier seri j error compon expij frequenc equat yield d oh term first neglect homogen equat sinc multipli deriv therefor small compar dv h d solut interv therefor given z t h ds h amplitud v h shall determin shortli superscript denot infinitesim posit neg incr ment particular averag valu h entir domain assumpt j gammaindepend and recal domain length direct one import note dh approxim factor singl relax sweep amplifi reduc error compon oscil frequenc j direct due fact that given upstream differenc downstream relax order yield numer integr dh factor integr domain reduc error equat impli relax reduc error compon larg effici compon smooth along j need correct coars grid fda longer use instead jump v h proport fourier coeffici r h j correspond frequenc denot jump ffi h period impli h now follow twolevel algorithm attempt approxim weight residu equat coars grid h assum discret stencil use coars grid fine note import assumpt entir method hing also assum restrict oper jump condit approxim correctli coars grid practic hold provid proper averag use fullweight residu transfer analog respect obtain z t hs ds h w constant weight chosen sinc stencil l h l h same also assum also sinc assum restrict oper transfer jump condit correctli ffi h equat yield h h neglect effect intergrid transfer alias assum remain error ad coarsegrid correct henc finegrid error amplifi factor v h addit relax sweep perform fine grid amplifi error dh note abov twolevel erroramplif factor tl given absolut valu product term note howev determin valu coarsegrid correct term depend one begin relax fine grid immedi follow coarsegrid correct sinc finegrid valu end one sweep determin sole valu relax begin due upstream differenc downstream relax order fine grid relax begin is shortli point residu nonzero h h howev finegrid relax begin small overlap region relax h optim residu weight order obtain hindepend analysi assum take valu interv optim valu w minim supremum tl fix w supremum evid obtain either d thu obtain dm function w calcul w opt the valu w yield fastest converg either case yield larger tediou calcul need carri numer w opt tend case rather quickli expect sinc valu ratio green function coars fine grid compon smooth crosscharacterist direct compon reduc relax obtain equat deriv respect zero get relev root twolevel erroramplif factor obtain substitut suffici small gamma may neglect term obtain fact give excel approxim maxim tl er less curiou coincid asymptot twolevel erroramplif factor larg e gamma obtain poisson equat rectangl use gauss seidel relax redblack order thu analysi lead us expect effici compar obtain poisson problem exampl appli algorithm advectiondiffus problem close characterist use origin ux advect term use discret use finest grid standard upstream su defin use valu stagnat point ad viscos elsewher maintain upstream discret sinc physic viscos domin artifici viscos elsewher anyway differ small altern could use much smaller ffl everywher level grid w w mgdv tabl number cycl necessari reduc l residu norm factor exampl problem taken mgdv automat method de zeeuw use there initi guess u inomega zero cycl l norm residu reduc gamma time initi valu perform test level coarsest grid alway theta includ boundari point as use v cycl throughout usual fullweight residu transfer bilinear in terpol see section detail implement relax tabl compar result w report mgdv automat method de zeeuw avail six level use socal sawtooth cycl one illu incomplet line lu relax sweep per level must stress effici robust method convincingli demonstr result achiev ten problem includ nonrecircul advect diffus far better these evid present method perform well effici compar ellipt equat simpl test problem clearli downstream relax order suffici recircul problem nor illu mgdv present method residu overweight show clear deterior grid refin proper overweight converg rate remain excel even fine grid reiter residu overweight approach may appli mgdv sinc differ stencil use differ grid requir differ overweight sever band residu may alway easi obtain singl band residu per vortex happen relax carri piecewisedownstream order would case domaindecomposit set exampl analysi extend case sever band nonzero residu remain relax found one requir two coarsegrid correct optim weight approxim seem impli w cycl requir situat also one must use upstream intergrid transfer avoid averag interfac subdomain may actual caus diverg discret flow streamlin start end boundari constitut close curv requir special consider discret case even small viscos play import role determin main flow throughout domain solut limit vanish viscos depend strongli coeffici tend zero effect advect term determin behavior solut along streamlin wherea viscou term determin crossstream form sinc boundari often streamlin itself propag inform boundari domain govern viscou term matter small may be effect discuss detail shown advectiondiffus problem incompress navier stoke equat solut scheme numer viscos anisotrop have differ viscos coeffici crossstream streamwis direct standard upstreamdiffer scheme may spuriou gener case shown even isotrop viscos suffici converg solut one must actual specifi uniform viscos know retain pure upstream structur but see remark section howev homogen advectiondiffus problem sever indic though proof isotropi suffic shown also also shown in numer exampl suffic incompress navier stoke equat consist fact vortic navier stoke equat satisfi homogen advectiondiffus equat obtain discret scheme exhibit appropri physic like behavior vanish viscos must thu either add suffici explicit isotrop viscos domin artifici viscos discret advect oper els deriv discret advect oper satisfi condit isotropi lowestord truncat term sinc want scheme remain pure upstream follow latter approach consid standard upstream scheme assum simplic discuss b taylor expans henc order obtain isotrop artifici viscos may either add approxim ha gamma bu xx els subtract approxim ha gamma bu yy order retain upstream scheme defin addit viscos point i gamma gener b obtain first case isotropicviscos upstream scheme ivu defin ja ij j jb ij j otherwis second case obtain scheme ivu defin ja ij j jb ij j otherwis i j defin similarli first truncat term scheme ivu thu gamma minja ij j jb ij jdeltau ivu gamma maxja ij j jb ij jdeltau scheme isotrop artifici viscos ivu smaller fact vanish upon align characterist direct grid discret stabl downstreamord gaussseidel relax ation former nonnegativeweight averag standard firstord secondord upstream scheme stabl relax latter produc mmatrix expect stabil problem mani numer calcul numer experi first test numer discret deriv section model problem standard upstream scheme shown yield spuriou solut then asymptot error reduct twolevel multilevel cycl investig sever problem accuraci test accuraci differ discret test model problem b given these coeffici exampl below pictur characterist appear figur a domain solut unit squar center origin squar diagon whose side form degre angl axe remov center outer boundari prescrib inner boundari solv problem three upstream schemessu ivu ivu also nonupstream isotropicviscos scheme use denot iso viscos ad solut compar obtain standard secondord upstream scheme physic viscos coeffici latter solut obtain theta grid grid su ivu ivu iso theta tabl l differ norm solut obtain sever scheme differ resolut highaccuraci solut obtain grid theta see text detail three isotropicviscos scheme seen yield converg solut standard upstream su scheme tabl present l norm differ test solut variou resolut secondord accur solut restrict correspond grid inject sinc solut smooth physic viscos domin secondord truncat term high resolut latter solut assum accur evid three scheme isotrop artifici viscos produc converg solut su scheme not despit fact averag viscos smaller ivu iso ivu least artifici viscos four scheme test produc smallest error effici test remaind numer calcul aim test perform algorithm variou configur compar analyt predict section test su scheme as wide use firstord scheme ivu scheme which accur ivu also employ fourpoint stencil test use firstord upstream residu restrict bilinear interpol correct restrict perform follow even j fine grid defin i j restrict correspond coarsegrid righthand side coarsegrid point i j averag finegrid residu point i j i j i j i j restrict give slightli better result standard full weight multivortex problem sinc residu less like transfer one vortex anoth finest grid test six level employ except twolevel test includ physic viscos except stagnat point requir wellposed calcul converg factor follow boundari condit righthand side chosen zero the choic immateri linear problem allow us normal solut constant factor everi cycl order avoid roundoff error initi solut field pseudo random cycl perform calcul converg factor geometr averag errorconverg per cycl last cycl averag use case converg histori smooth valu correspond particular cycl may carri much mean howev note case converg factor vicin optim w sensit exact choic w exampl first test effici problem use test discret without inner island so pure recircul everywher characterist problem form singl clockwiserot vortex plot figur a relax sweep implement sweep four time domain sweep relax roughli one quarter variabl follow first sweep variabl locat ax y bx y nonneg relax design first quadrant second sweep variabl correspond locat ax y nonneg bx y nonposit relax second quadrant third sweep variabl locat ax y bx y nonposit relax third quadrant fourth sweep variabl correspond locat ax y nonposit bx y nonneg relax fourth quadrant fi nalli stagnat point in case one relax last entir process compris singl clockwis sweep cours quartersweep perform downstream order ie x increas first quarter increas decreas second etc effici store order relax entir sweep setupsweep which cost littl full clockwis sweep cost nearli ordinari lexicograph gaussseidel sweep note specifi nonneg nonposit descrip tion is ensur boundari quadrant includ quadrant import test clockwis sweep inde elimin residu except along narrow band extend center vortex boundari vortex rotat counterclockwis sever band would remain henc exampl below clockwis counterclockwis vortic exist as would gener case perform analog counterclockwis sweep follow clockwis one quadrant counterclockwis sweep start bear perform experi use exactli revers order allow us save work perform counterclockwis sweep three quadrant sinc fourth quadrant ax y nonposit bx y nonneg relax clockwis sweep thu begin third quadrant a b nonposit second final first quadrant note way differ usual symmetr gaussseidel sweep perform downstream order within quadrant quadrant scan symmetr problem especi also sensit quadrant one choos start relax sweep is somewhat differ converg rate optim overweight obtain one perform clockwis sweep abov one relax say second quadrant first third fourth final first henc test shift relax startingpoint one quadrant everi cycl obtain result repres averag typic case first perform twolevel test order compar numer result analysi use theoret optim w calcul relev valu exampl sinc onelin overlap quadrant result given tabl evid analysi captur main featur problem well despit numer simplif seen especi su result calcul also carri v v v cycl optim valu determin experiment numer result summar tabl find experiment vcycl result also match twolevel predict fairli well tabl comparison erroramplif factor obtain analyt predict twolevel numer calcul exampl w opt optim valu w obtain vicin optim residualweight factor optim w s somewhat higher predict although show expect depend number relax sweep perform problem report below optim valu vari alway fairli close overal perform optim w use satisfactori note abov perform sensit moder chang w see also below exampl exampl featur flow four vortic rather one here b given characterist plot figur b domain exampl except exampl unit squar center origin numer result use v v cycl appear tabl respect converg perform remain excel even though nonvanish residu remain relax part borderlin vortic where flow lead away borderlin recal howev full relax sweep consist one clockwis sweep follow three quarter counterclockwis sweep see descript implement abov order allow opposit sign vortic cycl w su ivu v v v tabl erroramplif factor obtain numer calcul exampl optim valu w obtain experiment see text exampl order test effect gridalign borderlin vortic solv problem borderlin align grid problem b given respect repres superposit two oppositesign vortic characterist depict figur c numer perform shown tabl see loss effici perform still satisfactori far better usual exhibit problem exampl test mix problem flow enter leav boundari also exist larg recircul zone obtain redo exampl extend domain exampl su ivu tabl erroramplif factor obtain v cycl w opt latter found experiment exampl su ivu tabl obtain v cycl w opt latter found experiment mesh still uniform finest grid characterist shown figur d numer perform given tabl exampl virtual sensit order relax sweep perform that is clockwis first counterclockwis vice versa summari often one may wish search optim residu weight factor everi problem instead one simpli use nomin valu realist exampl one save time spent relax use optim valu rather usual much less would also case exampl employ symmetr relax even nomin valu converg rate compar ellipt problem conclus research experiment approach hope eventu lead fulli effici solver gener highreynold flow introduc analyz test advectiondiffus problem inviscid limit numer test mostli match predict well indic main caus slow converg usual multigrid algorithm recircul flow inde understood way elimin found multigrid vcycl use downstream relax upstream di cretiz shown yield effici solver test problem sever simpl situat close characterist mix en teringrecircul problem test perform classic standard firstord upstream discret scheme also novel firstord upstream discret shown preclud spuriou solut report present approach cheaper implement develop straightforwardli appli mix enteringrecircul flow import potenti success highord discret approach yield inadequ compromis howev result obtain still preliminari effect intergrid transfer small band residu consequ term error reduct effici investig wide varieti case along studi deal or avoid situat remain sever band nonvanish residu per vortex then research direct toward higherord discret case too effectivelyupstream discret need develop whose truncat error repres isotrop artifici diffus one approach use predictorcorrector type discret employ upstream scheme local driver possibl higherord not necessarili upstream scheme local corrector final present approach test advect problem experi incompress navier stoke equat flow close streamlin need perform employ distribut gaussseidel relax shown doubt rais question anticip techniqu investig carri three dimens although implement consider complic support fact simpl experi perform overweight method three dimens exhibit expect perform obviou drawback entir approach inher sequen tial effici parallel implement hard envisag parallel might achiev perform downstream line gauss seidel relax also conceiv domain decomposit approach leav sever line residu per vortex anoth drawback present approach directli applic flow signific addit viscos sinc entail use discret pure upstream method deal flow well present investig acknowledg work support royal netherland academi art scienc feinberg graduat school unit statesisrael binat scienc foundat grant no unit state air forc grant fj carl f gauss minerva center scientif comput r multigrid solver nonellipt singular perturb steadi state problem multigrid guid applic fluid dynam ic inadequaci firstord upwind differ scheme recircul flow multigrid solut highreynold incompress enter flow acceler multigrid converg high reynold recircul flow effici solut finit differ finit element equat algebra multigrid fundament algo rithm correct first differenti approxim differ scheme multigrid techniqu incompress flow tr