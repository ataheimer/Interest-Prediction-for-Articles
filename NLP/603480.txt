t formal model express fragment xslt a extens extens style sheet languag xsl variabl pass data valu templat rule gener power xml queri languag extens style sheet languag transform xslt inform introduct xstl given base formal model fragment xslt defin formal model spirit tree transduc semant defin rewrit relat shown express power fragment alreadi beyond xml queri languag final import properti termin closur composit consid b introduct xsl current wc propos xml extens stylesheet lan guag origin primari role allow user write transform xml html thu describ present xml document nowaday mani peopl use xsl basic tool xml xml transform render xsl xml queri languag note databas commun though transform xsl express rather limit instanc xsl join skolemfunct and henc cannot sophist group output data word xsl lack basic properti queri languag have relat com plete howev languag still develop featur chang time recent variou extens ad languag appar one addit variabl paramet pass templat rule show addit togeth use mode which actual state use nite state machin alreadi dene earlier version xsl render xsl power queri languag inde xsl becom relat complet explicit group with without skolem function simul regular path express simul current xml queri languag work author support ec tmr network getgrat research assist fund scientic research flander work partli perform visit univers california san diego contact author submiss actual togeth addit new featur xsl split two part xsl transform xslt xpath latter contain descript xsl associ pattern languag former dene real transform languag emphas focus transform part new featur refer xsl xslt rest paper main sourc denit xslt specic bit dicult read especi one want impress languag work capabl of remedi thi dene abstract formal model xslt incorpor featur necessari simul say xmlql purpos model twofold i clean formal semant provid necessari mathemat model studi properti xslt ii formal model abstract away actual syntax xslt emphas featur way interest reader get feel languag capabl of next use model gain insight xslt first obtain xslt comput unari monad secondord mso structur properti brief mso rstorder logic fo extend set quantic express versatil logic tree instanc captur mani robust formal like regular tree languag queri automata nite valu attribut grammar moreov mso take inher order children vertic account desir properti xml pattern languag structur pattern mean mso without join is cannot check whether valu two attribut see section detail fact neven schwentick show that alreadi wrt structur pattern mso express fo extend variou kind regular path express thu current xml queri languag base fo extend regular path express alreadi indic xslt cannot simul by say xmlql next show xslt simul exist xml queri languag studi decid type check milo suciu vianu dene k pebbl treetransduc formal captur express exist queri languag includ xmlql xql lorel struql unql previou version xsl model take valu equat account need join instanc easili modi so obtain xslt simul model therebi establish xslt express abov concret simul refer interest reader show xmlql queri express actual xslt want emphas provid model xslt instanc exclud forloop variabl instanti data valu not result tree fragment idea want use variabl lookahead fetch data valu occur far current node result languag is henc ture complet and hope ecient evalu studi properti formal model howev beyond scope present paper import fact dene languag express than say xmlql oppos previou version xsl rest paper structur follow section introduc import featur xslt mean two exampl section dene formal model final section obtain express result xslt exampl basic xslt program collect templat rule rule consist match pattern mode which indic nite state comput in templat see exampl program figur comput document start root start mode proce roughli follow comput arriv node say u certain mode say q program tri nd templat rule mode q whose match pattern match u nd templat rule program execut correspond templat latter usual instruct xslt produc xml output variou posit xml output select list node process we refer pattern select node process select pattern select node process independ befor final document construct subprocess insert posit subprocess gener illustr new featur xslt use dtd figur describ organ sequenc group togeth list top manag group id consist manag list group consist list employe simplic identifi employe id xslt program figur comput pair employe top manag dierent bill direct indirect manag e pair encod simpli pair element attribut topmgrid employeeid face it program make join list top manag group manag is one occur top manag list one occur manag group howev rather direct procedur way brief xslt program start appli rst templat rule root mode start rule select top manag in mode selecttopmgr particular pattern organizationtopmgremploye match current node previou work dene formal model version xsl incorpor data valu actual mode option conveni assum everi templat one start mode usual exampl match pattern refer label current node fact show section pattern suce organ element organ group topmgr element topmgr employe element group mgr group employe element mgr employe attlist group id id requir fig dtd describ organ label organ select employe children topmgr children the mean child of select employe in mode selecttopmgr second templat rule appli store employe id say e variabl varid veri use latter whether e dierent bill so select descend group manag id e in mode display particular select pattern second templat rule say select employe descend group child group whose manag id one store variabl varid the symbol mean descend of express bracket lter group element latter select xslt program pass id e along paramet next employe select latter select program output element pair attribut valu e e attribut topmgrid employeeid respect program best way xslt comput desir queri nice illustr three import featur xslt mode variabl pass data valu let us discuss brie y i mode enabl xslt act dierent upon arriv element type instanc describ abov program arriv employe element action depend actual mode select display element select in ii variabl use two purpos appar one illustr queri allow perform join data valu less appar applic use lookahead figur give fragment xslt program evalu binari tree repres boolean circuit truth valu essenti use variabl allow bottomup comput restrict binari tree expositori purpos fact shown xslt evalu bottomup tree automaton unrank tree brief arriv orlabel node program return correct truth valu base upon truth valu rst second subtre iii pass data valu templat rule crucial perform join item join far apart moreov xsltemplat matchorgan modestart xslapplytempl selectorganizationtopmgremploye modeselecttopmgr xsltemplat xsltemplat matchemploye modeselecttopmgr xslvariabl namevarid xslvalueof selectid xslvariabl xslif testvarid bill xslapplytempl modedisplay selectgroupmgremployeeidvaridgroupemploye xslwithparam namevarid selectvarid xslapplytempl xslif xsltemplat xsltemplat matchemploye modedisplay xslparam namevarid xslattribut nametopmgrid xslvalueof selectvarid xslattribut xslattribut nameemployeeid xslvalueof selectid xslattribut xsltemplat fig xslt program comput queri section group idhr employe idbil group idhrprod employe idedna group idhrprodempl employe idkat employe idronald group idhrqa employe idjohn group idhrqaempl employe idjan employe idjak employe idbil employe idjohn fig xml document conform dtd figur pair topmgridjohn employeeidjan pair topmgridjohn employeeidjak fig output xslt program figur document figur node id present xml document use mechan place pebbl input document enabl us complic group oper exactli three featur render xslt quit power transform languag xsltemplat matchor xslvariabl namearg xslapplytempl select xslvariabl xslvariabl namearg xslapplytempl select xslvariabl xslchoos xslwhen xslvalueof selectfals xslwhen xslotherwis xslvalueof selecttru xslotherwis xslchoos xsltemplat fig fragment xslt program evalu treestructur boolean circuit take care ornod next section give abstract formal syntax xslt first all restrict match pattern test label current node as alreadi case figur restrict theorem show test mani properti current node bodi templat rule further divid templat rule two part variabl denit part construct part variabl assign data valu particular variabl dene valu attribut current node xslt applytempl statement return exactli one data valu refer special templat select templat rule construct part templat rule actual output dene rel condit valu variabl paramet attribut valu current node possibl whether current node root leaf rst last child parent not xsl capabl gener see section formal model xslt tree forest start necessari denit regard tree forest nite alphabet the symbol correspond element name xml document tree repres use tree adequ abstract actual xml document extend attribut take valu innit domain g set forest denot f induct dene follow everi forest f f f forest f f f fn forest tree forest form f denot set tree note priori bound number children node forest follow whenev say tree forest alway mean tree forest reason consid forest even use xsl tree tree transform onli sometim need specifi templat rule construct forest everi forest f f set node f denot nodesf subset n induct dene follow g thu tree node repres root ui repres ith child u further forest node iu repres node u ith tree forest next add xml attribut dene attribut end rest paper x nite set attribut a attribut forest domain pair f f a function assign valu node f set attribut forest domain s denot f usual take d howev creat output templat rule use attribut forest dfx variabl refer dene variabl dene part templat cours real xml document usual element type set attribut obvious conveni necessari restrict analog way one dene set attribut tree denot set b f denot set attribut forest f b symbol b may appear leav f formal model abstract away particular select pattern languag recal xslt use pattern languag describ xpath see formal semant pattern rather involv illustr second templat rule figur pattern depend valu variabl varid addit pattern also move instruct like select parent left sibl right sibl rst child actual proof theorem indic local select enough simul exist xml queri languag follow assum innit set variabl x dene pattern variabl x x function denot set pattern x idea follow let p pattern tree variabl assign for variabl p pt u set select node pattern appli node u syntax denit xslt program tupl alphabet input symbol alphabet output symbol c nite set construct select mode start c start mode r nite set construct select templat rule to dene below mention end section distinguish two type templat rule construct select one former use creat output so result appli forest latter use fetch data val ue so one return exactli one domain element mode determin natur templat construct select denit construct applytemplatesexpress r atexpress short form qp z q c p pattern z possibl empti sequenc variabl x domain element d select at express dene construct one restrict p select singl node is everi tree t assign variabl node u t pt u singleton set denot set construct select atexpress c at instanc applytempl express second templat figur construct one correspond model express p pattern groupmgremployeeidvaridgroupemploye note applic pattern eventu lead gener element express construct sens eventu produc output denit attribut express express form a attribut atom test one follow i express attribut express variabl domain or ii express form root leaf rstchild lastchild final test boolean combin atom test comput express a evalu valu attribut current node further root leaf rstchild lastchild evalu true whenev current node root leaf rst last child parent select templat rule dene next recal output one domain element denit let q c q select templat rule templat q x return xs ys variabl the former paramet latter local r attribut express further r everi variabl occur among c test contain variabl x fx everi z domain element variabl x select atexpress restrict variabl occur belong x denit let q c q construct templat rule form select rule z forest f dx recal forest attribut take valu x leav may label construct atexpress restrict variabl occur atexpress occur leaf z x keep model total determinist requir exist exactli one q templat rule mode further ensur xslt program gener tree tree translat requir z start construct templat rule tree rather forest exampl illustr translat program figur syntax pattern p refer pattern rst second templat rule respect second templat rule displayp varid tree consist one node label displayp varid further denot empti tree last rule pairtopmgrvarid employeeidmyid denot tree consist one node topmgrid employeeid myid readabl omit test if true then mode construct templat organizationstart return templat employeeselecttopmgr return varid bill displayp templat employeedisplayvarid return semant dene semant need follow let w consist sequenc variabl x domain element function d denot sequenc domain element obtain w replac occurr variabl x w x x nd denot function map x next dene semant xslt program p tree t thereto need follow concept local congur element nodest intuit u q mean program select node u mode q valu paramet eas present dene result p denot p direct procedur way latter advantag usual denit term rather complic formal correct rewrit relat tran parent drawback deal border case xslt program get innit cycl howev clear p un dene whenev one gener subprocess comput forev defer formal semant term rewrit relat full version paper distinguish two case these let label u suppos q select mode p d let q templat rule form speci denit r q p attribut express intuit templat evalu follow first valu variabl dene valu attribut valu current node dene invok atrul comput desir data valu output determin z c rst test evalu true suppos variabl assign domain valu e atexpress e map x j j node select p is p t attribut express e u next suppos c rst condit evalu true interpret j e j x j j a u root leaf rstchild lastchild true u root leaf rst last child parent respect ensur translat total requir least one c exist then z determin output valu follow way z constant variabl attribut express p equal correspond valu z select atexpress q p w wxn d yne v node select p is pt xn d fvg suppos q construct mode p let q templat rule form speci denit suppos variabl get assign valu e rst condit evalu true z determin output valu follow way recal z forest f dx at c is forest attribut take valu x leav may label construct atexpress now p forest obtain z replac everi occurr j x j valu attribut data valu e j j respect everi occurr q p w atexpress leav z forest wxn d wxn d d denot document order recal p wxn d yne return attribut forest initi local congur dene start denit result xslt program p tree t denot p t dene p start remark conclud section remark first note xslt make explicit distinct construct select templat rule obvious one could also add otherwis construct rather condit even variabl denit part construct part templat rule howev feel make explicit program becom structur hand incorpor everyth xslt oer instanc refrain includ forloop nevertheless show next section captur power fragment capabl simul exist xml queri languag even more express next show xslt capabl comput express structur pattern thereto rst say view attribut tree logic structur in sens mathemat logic binari relat symbol e unari relat symbol o domain t view structur equal set node t ie nodest e edg relat equal set pair v v i everi v v nodest relat speci order children node equal set pair v nodest set node label logic mso mso vocabulari with mso dene usual way see eg extend atom formula form d attribut d denot latter atom formula semant dene follow d is attribut u valu d note allow atom formula form allow join clearli mso dene xpath match pattern they even fo denabl next theorem say xslt capabl express unari mso pattern particular mean one need match pattern templat is xslt actual allow specifi rule like xsltemplat matchp modeq p pattern rather label mean rule appli node satisfi p next theorem impli one test p bodi templat rule and henc need match pattern theorem let x mso formula exist xslt program p mode q p u q proof due space limit give brief hint proof refer interest reader start terminolog subtre root v denot v envelop v denot v tree obtain delet subtre root v keep v note v v v common let quantierdepth k denot unari mso formula x quantierdepth k hold x interpret v well known k t v nite v for xed k further whether depend k would case atom formula form comput unrank tree automata work t v v v respect here t v v tree v v distinguish node henc remain show xslt program comput bottomup unrank tree automata brief done use variabl lookahead like xslt program figur studi decid type check milo suciu vianu dene kpebbl treetransduc formal captur express exist xml queri languag transduc transform binari tree binari tree next describ determinist transduc equal test data valu kpebbl determinist treetransduc use k pebbl mark certain node tree transit determin uniqu way current node symbol current state or mode pre enceabs variou pebbl current node equal test attribut valu node pebbl locat on pebbl order number k machin place pebbl root move around remov actual use pebbl restrict stack disciplin ensur model becom power is accept nontreeregular languag move transit output tran sition move transit follow kind movetopar movetorst child movetolastchild movetolefts movetorights remainand changest placenewpebbl pickcurrentpebbl two kind output transit binari output output symbol possibl attribut dene attribut valu pebbl node spawn two comput branch comput independ other left right subtre branch inherit posit pebbl input commun other is branch move pebbl independ other nullari output node output leaf output tree possibl attribut comput halt clear that apart pebbl describ model extrem close xslt xslt equip mode state local movement simpl output transit assumpt node uniqu id xslt also simul pebbl inde use k variabl x x k time instanc x contain id node ith pebbl locat discuss immedi lead next theorem impli xslt simul current queri languag like instanc xmlql refer interest prove properti xml transform restrict binari tree usual sucient unrank one encod rank one cours case one tri dene formal model xslt work directli unrank tree actual assumpt necessari xslt equip function generateid gener uniqu id current node furthermor id depend current node is invok node sever time return valu need store node id comput demand reader show xmlql queri express actual xslt theorem xslt simul kpebbl determinist treetransduc equal test data valu point nondeterminist treetransduc simul give nondeterminist semant xslt obviou way although discuss kpebbl transduc seem extrem close formal model xslt clear whether former simul latter inde theorem show xslt check mso properti root tree know whether determinist kpebbl transduc thi fact problem close relat seemingli dicult open problem formal languag theori treewalk automata with without pebbl dene mso denabl tree languag hand theorem hold nondeterminist kpebbl transduc furthermor clear whether determinist transform express simul xslt regardless abov known queri languag base rstorder logic extend regular path express like xmlql weaker mso henc theorem theorem weaker xslt acknowledg last author thank bertram ludasch victor vianu encourag help discuss r data web lorel queri languag semistructur data exampl translat xmlql xslt queri languag optim techniqu unstructur data xml path languag xpath extens stylesheet languag xsl xsl transform version world wide web consortium queri xml data finit model theori trip tree catch boat strudel experi websit manag system structur document transform base xsl type check xml transform design analysi queri languag structur document extens attribut grammar structur document queri express e queri automata power treewalkingautomata design xql semistructur data xml formal semant pattern xslt tr queri languag optim techniqu unstructur data languag automata logic express structur document queri languag base attribut grammar catch boat strudel queri automata macro tree transduc attribut grammar mso defin tree translat data web typecheck xml transform express effici pattern languag treestructur data extend abstract quilt structur document transform base xsl extens attribut grammar structur document queri ctr frank neven automata theori xml research acm sigmod record v n septemb michael benedikt wenfei fan gabriel kuper structur properti xpath fragment theoret comput scienc v n p may joost engelfriet hendrik jan hoogeboom bart samwel xml transform treewalk transduc invis pebbl proceed twentysixth acm sigmodsigactsigart symposium principl databas system june beij china andrea maletti heiko vogler incompar result class polynomi tree seri transform journal automata languag combinator v n p januari maarten marx maarten de rijk semant character navig xpath acm sigmod record v n june marten frank neven frontier tractabl typecheck simpl xml transform proceed twentythird acm sigmodsigactsigart symposium principl databas system june pari franc marten frank neven complex typecheck topdown xml transform theoret comput scienc v n p may frank neven thoma schwentick power treewalk automata inform comput v n p may frank neven power walk queri treestructur data proceed twentyfirst acm sigmodsigactsigart symposium principl databas system june madison wisconsin makoto onizuka fong yee chan ryusuk michigami takashi honishi increment mainten materi xpathxslt view proceed th intern confer world wide web may chiba japan marten frank neven frontier tractabl typecheck simpl xml transform journal comput system scienc v n p may frank neven thoma schwentick victor vianu finit state machin string infinit alphabet acm transact comput logic tocl v n p juli jan hidder philipp michiel jan paredaen roel vercammen lixqueri formal foundat xqueri research acm sigmod record v n p decemb thoma schwentick automata xmla survey journal comput system scienc v n p may