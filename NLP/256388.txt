t timeoptim domainspecif queri enhanc mesh a abstractqueri process crucial compon variou applic domain includ inform retriev databas design manag pattern recognit robot vlsi mani applic involv data store matrix satisfi number properti one properti occur time specifi row column matrix independ sort customari refer matrix sort instanc batch search rank problem bsr short involv sort matrix item total order univers along collect q queri q arbitrari mix follow queri type search queri qj one interest item closest qj rank queri qj one interest number item strictli smaller qj bsr problem ask solv queri q work consid bsr problem follow context matrix pretil one item per processor onto enhanc mesh size sqrt ntime sqrt n queri store one per processor first m over sqrt n column platform main contribut twofold first show algorithm solv bsr problem must take least omega rm maxlognsqrt m time worst case second show time lower bound tight mesh size sqrt ntime sqrt n enhanc multipl broadcast exhibit algorithm solv bsr problem theta rm maxlognsqrt m time platform b introduct due simpl intuit topolog mesh establish one massiv parallel architectur suitabl solv problem imag process robot vi sion comput graphic path plan vlsi design among mani other time mesh notori ineffici come handl nonspati organ data address problem meshconnect comput enhanc variou type bu system recent power eleg architectur refer mesh multipl broadcast obtain endow row column mesh dedic high speed bu mesh multipl broadcast proven feasibl implement vlsi adopt among other dap famili comput theoret interest well commerci avail mesh multipl broadcast attract great deal well deserv attent applic rang imag process comput graphic robot comput geometri pattern recognit sort search fundament problem found effici solut work support nasa grant na nsf grant ccr ccr onr grant n preliminari version work appear proc intern confer applicationspecif array processor stra bourg franc juli correspond prof s olariu email architectur variant queri process crucial transact variou applic domain includ inform retriev databas design manag vlsi mani applic involv data store matrix satisfi number properti one properti occur time applic specifi row column matrix independ sort customari refer matrix sort matrix said fulli sort entri sort rowmajor resp columnmajor order figur display sort matrix figur b featur fulli sort version matrix figur a b fig illustr sort fulli sort matric sort matric provid natur gener number reallif situat consid vector j cartesian sum x denot n theta matrix entri clear x y sort ma store succinctli o n space sinc entri ij comput need constant time task search rank select sort matric receiv consider attent main goal paper look problem batch search rank bsr short sort matric throughout work gener instanc bsr problem involv sort matrix size n theta store one item per processor mesh multipl broadcast size n collect q m queri store first column platform queri two type queri q j first type one interest item closest q j queri q j second type one interest number item strictli smaller q j two queri type refer search queri rank queri respect set q queri arbitrari mix two queri type goal determin solut everi queri q import note search queri occur frequent imag process pattern recognit comput learn artifici intellig one interest find item databas best match sens queri hand hand rank queri central relat databas design histogram pattern analysi here given collect item databas along queri one interest comput number item databas lesser valu queri addit rank queri find applic imag process ing robot pattern recognit note variant rank queri also receiv attent literatur specif rang queri involv determin number item given databas fall certain rang easi see rang queri answer state rank queri point reader may wonder queri lie leftmost l column mesh shall discuss section ii assum mesh multipl broadcast commun outsid world via io port place along leftmost column platform consist view enhanc mesh serv fast coprocessor presentday comput scenario host comput pass queri mesh batch n so presenc input queri leftmost l column use main contribut twofold first show algorithm solv bsr problem must take least omegagammaast flog n time worst case lower bound hold crewpram mesh multipl broadcast second show bsr problem solv timeoptim mesh multipl broadcast size n theta n exhibit algorithm whose run time match lower bound put contribut perspect note recent bhagavathi et al show task solv search rank queri fulli sort matrix perform theta p m time mesh multipl broadcast size p n theta p n actual context fulli sort matric differ two queri type vanish solv essenti way context sort matric search queri rank queri much differ requir differ resolut strategi surpris therefor algorithm bsr problem much complic sophist algorithm order obtain timeoptim algorithm bsr problem develop novel interest clone strategi queri scenario follow partit platform number submesh clone given queri them done that obtain local solut queri submesh fi nalli sinc number clone queri larg larger avail bandwidth allow handl devis strategi wherebi retriev inform gather clone onli interest featur strategi alway exist rel small subset clone that retriev allow resolut queri consequ algorithm devis paper complet differ show whole potenti mesh multipl broadcast paper organ follow section ii introduc model comput section iii present lower bound argument section iv discuss timeoptim algorithm bsr problem final section v offer conclud remark pose open problem ii comput model mesh multipl broadcast size theta n refer mesh confus possibl consist mn ident simd processor posit rectangular array overlaid highspe bu system everi row mesh processor connect horizont bu similarli everi column processor connect vertic bu illustr figur assum processor first column serv io port illustr way platform commun outsid world fig mesh multipl broadcast size theta processor p i j locat row column j northwest corner mesh processor p i j local link neighbor provid exist processor assum know coordin within mesh constant number regist size olog mn unit time processor perform arithmet boolean oper commun one neighbor use local link broadcast valu bu read valu specifi bu oper involv handl olog mn bit inform due physic constraint one processor allow broadcast given bu one time contrast processor bu simultan read valu broadcast accord research assum constant broadcast delay although inexact recent experi dap ppa yuppi multiprocessor array system seem indic reason work hypothesi iii lower bound purpos section establish nontrivi lower bound bsr problem mesh multipl broadcast purpos consid platform size n theta store sort matrix size discuss m n queri store first column mesh clearli processor store one item one queri lower bound argument reli part follow fundament result cook et al proposit time lower bound comput logic n bit crewpram omegagamma n matter mani processor memori cell avail also reli follow result lin et al proposit comput take otn comput step nprocessor mesh multipl broadcast perform otn comput step nprocessor crewpram import note proposit guarante tm n execut time algorithm solv given problem nprocessor mesh multipl broadcast exist crewpram algorithm solv problem tp use n processor on extra memori word too fast algorithm mesh multipl broadcast impli too fast algorithm crewpram observ exploit transfer known comput lower bound crewpram mesh multipl broadcast fig illustr lower bound solv singl queri shall prove even solv singl queri search rank type take n time result prove crewpram port mesh multipl broadcast proposit begin reduc problem problem solv search queri q purpos let arbitrari input or construct sort matrix a illustr figur place n set ae assum simplic n integ construct guarante matrix sort regardless valu b assign queri q valu easi confirm answer problem solut queri see thi note sequenc b contain return solut queri fail thi return virtu proposit algorithm correctli answer search queri sort matrix must nomegagamma n time crewpram regardless number processor memori cell avail continu reduc problem problem solv rank queri q purpos let arbitrari input or construct sort matrix a illustr figur let queri q valu clear answer problem number element smaller q exactli n p nto see thi observ construct everi element matrix upper left triangl strictli smaller queri element may strictli smaller queri lie diagon seen figur reader difficulti verifi total number element strictli smaller q element diagon proposit guarante algorithm correctli answer rank queri sort matrix must takeomegagamma n time crewpram virtu proposit follow result lemma algorithm correctli solv one search rank queri sort matrix n element must take least omegagammaast n time mesh multipl broadcast size demonstr everi algorithm solv bsr problem fulli sort matrix must take omegagamma m time worst case thi cours impli lower bound sort matric purpos assum fulli sort matrix a store rowmajor order mesh multipl broadcast size n theta n refer element a row major order note that context fulli sort matric search rank queri solv essenti way specif let q arbitrari queri let subscript q i clearli q rank type solut denot number item strictli smaller q hand q search type item closest q either i observ allow us handl purpos lower bound type queri rank queri turn impli use follow result prove bhavagathi et al proposit algorithm correctli solv m queri fulli sort matrix n element must take m time mesh multipl broadcast size n theta n lemma combin provid main result section state next theorem algorithm correctli solv instanc bsr problem involv sort matrix item store one per processor collect m store one per processor first column mesh multipl broadcast size n theta must take least omegagammaast flog n mg time iv timeoptim bsr algorithm gener instanc bsr problem involv sort matrix size n theta n collect queri queri q j follow type search type determin item closest rank type determin rank q j a ie number item strictli smaller q j avoid handl doubl subscript item enumer rowmajor order sort matrix store one item per processor mesh r multipl broadcast size n theta n set q store first column r one queri per processor illustr figur shall view mesh r consist submesh size theta m r ij involv processor p r c m illustr figur occasion shall find conveni view mesh r consist submesh size theta n consist submesh r i submesh refer slice r depict figur fig illustr input bsr problem outlin algorithm bsr problem proce follow three stage stage set q queri replic submesh r ij creat local instanc bsr problem stage determin submesh r ij paral lel solut local instanc bsr problem stage solut local instanc bsr problem obtain stage combin r r slice slice fig illustr partit submesh r ij solut origin bsr problem remaind section devot detail descript stage stage purpos stage replic set q queri submesh r ij one queri per processor plan move queri column r column everi r ij specif queri move column r ij give detail data movement illustr reader refer figur ad begin everi processor p n broadcast queri hold horizont diagon processor shown figur ab turn processor p r r broadcast queri receiv vertic everi processor shown figur bc fig illustr data movement stage note befor result data movement queri origin store column k r replic diagon processor submesh everi slice on slice process parallel specif queri store diagon processor r i replic use row buse slice th column r ij slice next queri store diagon processor r i replic use row buse slice th column r ij for illustr refer figur d easi see task replic queri origin store one column r take o time therefor long n queri initi store leftmost column r replic time o m case queri replic way similar one de scribe complex data movement is again o m thi goal stage achiev queri replic submesh r ij thu prove follow result lemma set q queri initi store first column r replic one queri per processor submesh r ij o m time stage import note that end stage replic set q queri submesh r ij have fact partit origin instanc bsr problem sever instanc local r ij local instanc involv subset store processor r ij entir set q queri main goal stage solv local instanc bsr submesh r ij avoid broadcast conflict stage bu system ignor everi submesh r ij act unenhanc mesh begin sort item queri r ij rowmajor order use optim sort algorithm mesh note sort process tie broken favor queri word queri item equal sort version queri preced item let c result sort sequenc store two item per processor submesh r ij follow two result justifi approach solv local instanc bsr problem lemma let q k queri rank type assum c word q k occur posit sort sequenc c ij number item r ij strictli smaller q k equal number item preced q k c ij proof follow directli sorted c ij along assum tiebreak disciplin lemma motiv follow strategi solv rank type queri r ij assign everi c weight defin follow ae item queri next comput prefix sum sequenc use weight assign result virtu lemma valu e correspond c exactli number item r ij strictli smaller q k therefor rank queri solv time sort prefix sum comput o p m task handl search queri requir differ approach motiv strategi consid sort sequenc c refer figur item queri l l l fig illustr sort sequenc c ij queri occur c ij form contigu subsequ everi sequenc p let l p r p stand respect leftmost rightmost queri p illustr figur cours sequenc p consist one queri l m motiv terminolog becom clear observ lemma search queri sequenc p solut either c ffgamma c fi proof let q k arbitrari search queri sequenc p sorted c ij along tiebreak disciplin guarante item r ij closer q k one item c ffgamma c fi turn lemma suggest follow approach solv search queri r ij first assign everi c weight w defin follow ae c c item queri next comput prefix maxima sequenc use weight assign result easi confirm everi search queri c correspond valu e exactli ident item c ffgamma previou terminolog gamma item exist next assign everi c weight w ae c c item queri comput prefix minima sequenc use weight assign let result easi confirm everi search queri c correspond valu e exactli ident item c fi previou terminolog item exist therefor end two comput everi search queri q k becom awar c ffgamma c fi virtu lemma suffici purpos determin solut everi search queri q k r ij summar find state follow result lemma task solv local instanc bsr problem submesh r ij perform parallel o m time stage end stage processor gener submesh r ij store along queri q k local solut case q k search queri oei j denot item closest q k case q k rank queri oei j denot number item strictli smaller q k goal stage combin local solut solut q k origin instanc bsr problem fig illustr proof lemma prepar thi first task stage arrang everi submesh r ij order pair rowmajor order sort subscript k recal use optim sort algorithm mesh task perform o m time note that sort tupl q occupi rel posit submesh r ij on process reli heavili technic properti sort matric discuss next refer figur submesh r ij said critic respect queri q k q k larger entri v northwest corner r ij greater entri b v southeast corner r ij word follow result key deriv timeoptim algorithm bsr problem lemma submesh r ij critic respect queri q k one submesh r igammaj r ij may critic respect q k proof refer again figur let u v aw stand item store northwest corner respect similarli let b b w stand item store southeast corner r igammaj r ij r ij respect assum further r ij critic respect queri q k now r igammaj critic respect q k and sinc matrix sort combin guarante so r ij cannot critic respect q k similarli r ij critic respect q k and sinc matrix sort combin guarante confirm virtu r igammaj cannot critic respect q k complet proof lemma r fig illustr concept activ copi queri q k consid gener slice refer shall call copi queri q k submesh r ij activ one condit aa satisfi refer reader figur illustr r ij critic respect queri q k a slice contain critic submesh respect queri q k and larger item r ij smaller equal item r ij larger item slice case copi q k r i activ smaller equal item slice case copi q k r i activ leftmost submesh slice contain activ copi queri q k refer lead respect point reader may wonder inform comput clear determin submesh r ij critic respect given queri inform need valu northwest southeast corner submesh o m time valu circul within submesh everi processor becom awar them next everi processor r ij need inform valu item northwest southeast corner neighbor submesh slice again inform obtain o m time obviou way inform avail critic submesh activ copi queri found constant time fig illustr assign buse strategi combin solut queri everi r ij global solut involv consider amount data movement restrict run time theta m plan use buse support data movement lemma motiv us assign buse activ copi queri accord follow rule illustr figur r copi q k belong lead submesh slice assign horizont bu row r remain activ copi q k assign vertic bu column follow result show rule r r lead conflictfre broadcast lemma everi activ copi q k broadcast simultan assign bu broadcast conflict aris proof first claim broadcast conflict occur horizont buse see thi note horizont bu assign copi q k either exist one activ copi q k slice in case copi q k lead submesh activ rule aa copi q k attempt use bu els copi come critic submesh rule r activ copi slice use vertic buse and again conflict aris next show conflict aris vertic buse suppos contrari let largest subscript broadcast conflict occur copi q k slice broadcast vertic assign bu without loss gener assum q k belong r ij conclus lemma along maxim impli copi q k submesh r igammaj also use vertic bu impli neither r igammaj r ij lead submesh with respect q k slice igamma respect howev r igammaj r ij r ij must critic respect q k contradict lemma import note total number activ copi queri q k follow immedi lemma sinc assign buse activ copi q k lead two copi use bu sinc copi q k assign horizont buse copi q k assign vertic buse conclus follow next one may wonder activ copi queri q k carri enough inform yield correct overal solut q k answer natur question provid follow result lemma let q k search queri let item closest q k exist activ copi q k submesh r ij either oei j proof assumpt must solut oep q q k submesh r pq fact sinc item matrix necessarili distinct possibl solut q k number submesh assum without loss gener case submesh slice specif let r ij leftmost submesh oei j k copi q k r ij activ noth prove shall therefor assum copi q k r ij inact propos show least one copi q k r ij gamma r ij activ sinc copi q k r ij inact guarante r ij cannot critic respect q k therefor v b v denot respect item northwest southeast corner r ij notic oei j along impli must either v b v symmetri allow us assum without loss gener v turn impli notic along fact copi q k r ij inact guarante virtu a j and thu r ij must exist let u b u be respect item northwest southeast corner r ij gamma r ij leftmost submesh sinc matrix sort must moreov cannot q k b u otherwis a combin would guarante copi q k r ij must activ therefor must case howev equat combin impli copi q k r ij gamma must activ desir complet proof lemma lemma suggest obviou way updat solut activ copi search queri q k spell detail follow ffl activ copi q k belong critic submesh r ij r ij gamma critic copi q k r ij updat solut oei j combin ffl activ copi q k belong critic submesh r ij r ij critic copi q k r ij updat solut oei j combin ffl copi q k activ rule a updat solut oei j combin lemma let q k rank queri activ copi q k gener slice carri enough inform comput number item strictli smaller q k proof first copi q k slice activ sum local solut oei j exactli number item strictli smaller q k assum therefor copi q k slice activ consid activ copi q k lead submesh respect q k ffl copi activ rule a solut must correct number item strictli smaller q k ffl copi activ rule a solut updat read mn correct number item strictli smaller q k ffl copi activ rule a a solut updat read oei correct number item strictli smaller q k submesh r i import note solut activ copi q k chang updat thu requir updat collect activ copi q k slice carri enough inform correctli comput number item smaller q k conclus follow r r fig illustr target data movement stage next task stage move activ copi queri diagon submesh r ii illustr figur task perform two broadcast round follow first round proceed row row submesh r ij specif activ copi queri first row r ij s assign vertic buse broadcast local solut bu correspond processor diagon submesh r jj follow thi queri second row broadcast vertic on lemma broadcast conflict aris sinc everi r ij row first round take o p m time second broadcast round involv broadcast along horizont buse time column everi r ij handl one one sinc column submesh second round take o m time note how ever illustr figur possibl two activ copi queri q k sent locat diagon submesh r jj one copi via horizont bu one via vertic bu lemma number copi restrict two fur thermor one arriv one broadcast round on vertic buse second arriv horizont buse processor receiv proceed combin respect solut summar state follow result fig illustr combin solut lemma solut activ copi queri q broadcast diagon submesh r ii one per processor o m time complet algorithm variou copi queri q move diagon submesh collect combin idea move activ copi queri diagon submesh r ii one sever adjac row origin mesh specif case p copi first move first row mesh copi second group move second row mesh on hand case copi q move first row mesh per row data movement case similar discuss next prepar data movement need introduc terminolog consid gener copi queri q k associ q k quantiti rq k cq k refer rvalu cvalu q k here rq k ident row mesh copi navig cq k rel posit queri among copi move row rq k further note processor store q k comput rq k cq k o time recal begin stage everi submesh r ij queri sort rowmajor order thu solut store diagon submesh r ii rel order further use vertic buse copi queri first row everi submesh r ii move row mesh correspond rvalu specif gener copi queri q k store processor p i broadcast vertic processor p rq k j crucial note queri also sort rowmajor order rvalu broadcast conflict aris proceed sequenti p row r ii s process describ thu o p m time copi broadcast row mesh correspond rvalu import observ processor receiv one copi queri data movement on process take place row mesh depend whether hold first assum true shall detail process take place first row mesh action perform parallel row copi q broadcast processor p order cvalu upon receiv next copi q p combin correspond solut obviou way sinc at most copi q solut queri q obtain o time copi remain queri q move row process similarli therefor overal time need solv queri case hold bound o m case hold recal copi given queri spread row mesh again discuss process queri q other han dled parallel perfectli similar way copi q move row copi row proceed sequenti order c valu copi q first row broadcast leftmost processor row processor respons combin solut describ abov lemma end inform need solv queri store processor first column mesh specif processor solut correspond queri q next group processor contain partial solut correspond queri on refer figur illustr final consid diagon submesh size theta illustr figur final step stage dedic diagon submesh solv queri q one broadcast partial result store processor first column mesh move along horizont buse first column depict figur combin partial solut queri q fig partial solut contain processor first column fig illustr submesh amount semigroup comput local use result olariu et al comput perform olog final solut queri comput routin matter move back first column mesh consequ case hold overal run time algorithm bound o log sinc run time algorithm case hold satisfi o log summar state follow result theorem arbitrari instanc bsr problem involv sort matrix size n theta n set queri solv omaxflog n mg time mesh multipl broadcast size thermor timeoptim architectur v conclud remark open problem matrix said sort row column independ sort instanc batch search rank problem bsr short involv sort matrix item total order univers along collect q queri q arbitrari mix follow queri type search queri q j one interest item closest q j rank queri q j one interest number item strictli smaller q j bsr problem ask solv queri q work consid bsr problem matrix pretil one item per processor onto mesh multipl broadcast size n theta n queri store one per processor first column platform main contribut twofold ffl first prove algorithm correctli solv bsr problem must take least omegagammaea flog n time worst case ffl second show time lower bound tight mesh multipl broadcast size n theta n develop novel interest clone strategi queri partit platform number interest featur clone strategi support sorted matrix alway small set clone that retriev allow obtain overal solut queri visibl clone strategi perfectli gener interest direct research see dataset strategi work yet anoth direct see practic applic benefit strategi acknowledg author wish express appreci three anonym refere except thorough review job r optim bound find maximum array processor k global buse comput vision squar mesh alway optim design massiv parallel processor squar mesh optim convex hull computa tion unifi look semigroup comput mesh multipl broad cast fast select algorithm mesh multipl broadcast squar mesh optim convex hull compu tation design effici parallel algorithm mesh connect comput multipl broadcast effici median find applic twovari linear program meshconnect comput multipl broadcast upper lower time bound parallel random access machin without simultan write complex search x parallel algorithm search x pattern classif scene analysi parallel search sort multiset gener select rank sort matric commun acm array processor multipl broadcast imag comput mesh multipl broadcast sort x ieee transact comput parallel process letter effici vlsi architectur digit geometri ieee transact parallel distribut system channel rout vlsi biton sort meshconnect parallel comput data broadcast simd comput optim convex hull algorithm enhanc mesh amt dap imag databas system survey tr ctr susumu matsuma nobuki tokura effici selfsimul algorithm reconfigur mesh proceed twelfth annual acm symposium parallel algorithm architectur p juli bar harbor main unit state dharmavani bhagavathi himabindu gurla stephan olariu larri wilson jame l schwing jingyuan zhang time vlsioptim sort enhanc mesh ieee transact parallel distribut system v n p octob r lin s olariu j l schwing bf wang mesh hybrid buse effici parallel architectur digit geometri ieee transact parallel distribut system v n p march