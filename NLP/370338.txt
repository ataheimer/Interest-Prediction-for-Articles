t partial evalu view a mani databas applic environ mediat heterogen databas sourc data wareh decis support lead complex queri queri often nest defin previous defin view may involv union good reason one might want remov piec subqueri subview queri subview queri may effect cach previou queri may materi viewssemi may known evalu empti reason integr constraintssemi may match protect queri secur cannot evalu usersin paper present new evalu strategi respect queri defin view call tupletag allow effici remov subview queri approach rewrit queri subview remov effect gone evalu rewritten queri tupl tag evalu rewrit origin queri necessaryw describ formal discount queri a queri subview mark consid remov present tupl tag algorithm evalu discount queri provid analysi algorithm perform present experiment result result strongli support tupletag algorithm effici mean effect remov subview view queri evalu viabl optim strategi certain applic experi also suggest rewrit techniqu may perform wors evalu origin queri much wors tupl tag approach b introduct motiv object mani current databas applic environ mediat heterogen databas sourc data wareh decis support incur complex queri queri often nest defin previous defin view may involv union special type queri call fusion queri selfjoin view defin union discuss necess mediat view metaschema defin combin data dispar sourc environ view definit mainten paramount import mani reason one might want remov piec subqueri given queri let us call subqueri unfold queri unfold via view definit specif subqueri reason includ follow unfold queri may effect cach previou queri may materi view themselv unfold may known evalu empti reason integr constraint unfold may match protect queri secur cannot evalu user unfold may subsum previous ask queri interest unfold share two queri except differ oper remov queri oper carri out e figur andor tree represent origin queri mean remov unfold queri modifi queri subsumeand thu evalu never evaluateth remov unfold subsum everyth els origin queri case one might want separ certain unfold evalu much less expens network distribut environ evalu local then remaind queri evalu independ find remain answer remaind queri less expens evalu origin optim case unfold free evalu sinc known advanc must evalu empti case unfold protect mean rest queri cannot safe evalu case user ask seri queri may interest stream answer return previous seen answer longer interest case except queri might optim techniqu consid follow exampl exampl let six relat defin databas db departmentsdid address insti tutesdid address facultyeid did rank staffeid did posit health inseid premium provid life inseid premium provid also three view defin term relat creat view creat view creat view academ unit employe benefit select did address select eid select eid premium provid depart faculti life in union union union select did address select eid select eid premium provid institut staff health in defin follow queri q q select eeid academ unit a employe e benefit b adidedid eeidbeid bproviderblu cross queri q repres pars tree relat algebra represent andor tree shown figur we ignor breviti explicit represent project select oper evalu queryin order oper specifi relat algebra representationi equival materi node queri tree type evalu and represent refer bottomup assum follow queri f ask result store cach select eeid depart d faculti f life in l ddidfdid feidleid lproviderblu cross figur andor tree represent modifi queri equival assum formula repres materi view match protect queri whose answer display f protect queri join express comput evalu thu elimin queri otherwis f cach queri materi view may still benefici remov queri call result discount queri one way achiev rewrit q union join base tabl remov join repres f which explicitli present final evalu remain join express may ineffici howev number join express remain evalu may exponenti size collect view definit furthermor shown evalu plan which often call topdown may requir evalu join mani time incur expens given tupl may comput mani time whenev project part base tabl overlap significantli topdown evalu q figur union eight follow join express depart faculti life in depart faculti health in depart staff life in depart staff health in institut faculti life in institut faculti health in institut staff life in institut staff health in seemingli effici evalu plan discount queri devis rewrit queri number oper union join minim see figur side effect approach redund join evalu well redund answer comput reduc howev redund entir elimin exampl join institut faculti comput twice implicitli left subtre explicitli right subtre one verifi rewrit queri tree remov join depart faculti in yet guarante time redund comput join thu optim queri sometim cost evalu origin queri experiment result show see section is inde case exampl paper present new strategi partial evalu queri defin view call tupletag offer mani advantag explicit queri rewrit ffl tupletag easili implement logic level accomplish rewrit sql express queri ffl techniqu modular implement independ optim stage in particular tradit relat databas queri optim work conjunct stage ffl tupletag algebra rewrit queri preserv queri tree is thu scale complex queri ffl tupletag interleav queri evalu thu reliabl heurist devis employ decid stepwis whether given optim step appli paper organ follow section present formal framework discount queri that section skip first read section present tupletag techniqu evalu discount queri perform analysi techniqu experiment result tpcd benchmark databas db present section section conclud issu futur work relat work substanti bodi research rewrit base queri optim howev techniqu discuss literatur consid rewrit queri logic equival form differ goal one consid here interest gener effici evalu queri view unfold remov thu result queri equival origin queri problem address also differ problem answer queri use materi view latter problem goal replac subqueri queri view or queri gener queri equival contain origin queri goal again remov precis avoid evalu part queri optim secur reason work close relat work author consid queri involv nest union oper propos techniqu rewrit queri known join evalu part queri empti techniqu appli howev simpl class queri complex issu address anoth research area relat problem multipl queri optim goal optim evalu set queri rather singl queri sinc queri set arbitrari may relat structur way allow use techniqu propos here develop techniqu multipl queri optim focus toward find reus common subexpress across collect queri heuristicsbas problem queri tree rewrit purpos optim also consid context deduct databas recurs problem detect elimin redund subgoal occurr proof tree gener program presenc function depend discuss residu method extend recurs queri investig comput complex queri rewrit show optim rewrit queri nphard also identifi special class queri unfold rewrit result simpler queri thu alway provid optim discount queri section formal defin notion unfold discount queri precis use notat datalog write queri set atom interpret conjunct atom instanc fa e bg repres queri exampl atom may intension is written view predic defin base tabl predic and perhap view definit given queri set q u call u step unfold queri set q respect databas db iff given q q rule ha b defin view a q j a for gener unifi present proposit exampl simplic sake extend obviou way queri variabl made explicit e l h figur andor tree exampl two unfold mark denot u q call u simpli unfold q written u q iff finit collect queri set u unfold u call extension iff everi q u atom q refer base tabl call unfold intension otherwis in word atom refer view exampl view exampl repres simplifi datalog where letter repres atom as d e f b l i e s b h sinc b queri q unfold l use singl rule hb li fa e lg one step unfold q sinc atom unfold f q d f l extension extension unfold q easi see unfold andor tree inscrib queri andor tree atom unfold mark queri tree shown figur unfold and say bg queri consid equival union extension unfold defin unfold q set extension unfold q defin concept discount queri repres queri unfold remov or discount definit given queri set q unfold u q express qnfu discount queri defin mean be unfold unfold u call u unfoldingstodiscount tupl answer set unfold tuplestodiscount exampl consid queri q exampl sinc fd f lg fd f hg fd s lg fd s hg fi f lg fi f hg fi s lg fi s hg fd f lg fd f hg fd s lg fd s hg fi f lg fi f hg fi s lg fi s hg similarli unfold g fi s bg figur fd f hg fd f lg fd s lg fd s hg fi f lg fi f hg lastli fd f hg fd s lg fd s hg fi f lg fi f hg discuss formal semant discount queri tupletag evalu strategi overview strategi bottomup materi strategi queri tree union join oper modifi account discount unfold strategi ensur two thing ffl tupl result unfoldingtodiscount contribut answer set discount queri ffl join repres unfoldingtodiscount never fulli evalu tupl result unfoldingtodiscount remov either actual queri evalu ensur second properti thu gain optim need somehow avoid evalu unfoldingstodiscount is prevent tupl materi queri evalu propos method tupletag keep extra inform temporari tabl creat materi queri tree essenc tabl extra column unfoldingto discount domain tag column boolean valu tag column given tupl true tupl deriv correspond unfoldingtodiscount fals otherwis union join oper which creat new temporari tabl tag column valu must maintain properli exampl consid queri q exampl queri f repres unfoldingtodiscount join depart faculti life in tabl new column cf ad valu initi true similarli tabl institut staff health in union tabl column ad valu initi fals keep deriv inform tupl evalu easili ensur first properti abov evalu queri select tupl fals valu tag column and also project away tag column shall abl use tag columnsand ultim satisfi second propertyto determin join oper tupl join becaus result tupl would from unfoldingtodiscount comput save primarili depend size true section tabl present evalu strategi two version simpler version ensur first properti is final answer set contain tupl aris sole unfoldingstodiscount strategi use case unfold remov secur reason littl howev optim queri evalu gross save equal differ cost write back result origin queri versu cost write back result discount queri which sometim new tag column needbi basi u u add column cu instanti valu cu true u cu belong tb add column cu instanti valu cu tb fals union two tabl union tln trn creat tn algorithm modifi union oper significantli smaller save substanti queri result sent network second version remov tuplestodiscount queri evalu soon possibl strategi reduc cost queri evalu version algorithm requir modifi union join oper defin next modifi union oper assum queri tree contain union join node that is oper implicit furthermor without loss gener assum tree binari refer one child branch nonleaf node n binari queri tree ln for left child rn for right child assum leaf n queri tree correspond tabl databas is answer set n deriv tabl perhap temporari databas via select project call n s tabl with select project implicit tn handl discount queri modifi tradit algorithm bottomup queri evalu involv replac union join oper special version handl exploit tag column unfoldingstodiscount discuss abov given discount queri qnfu introduc new column cu tag column correspond unfoldingsto discount as describ exampl assum wellform queri tree tabl union union step union compat addit tag column could violat two tabl union may unioncompat tag column thu need modifi union step first make tabl unioncompat ad tag column need algorithm show thi way need modifi union step note algorithm effici implement sql ad tag column initi valu befor execut union oper show section add littl overhead cost queri execut modifi join oper must assign correct valu tag column join tabl tupl result join one tupl deriv given unfoldingtodiscount u henc valu cu true second tupl henc valu cu fals result tupl answer set u cu result tupl valu fals tupl join deriv u result tupl column cu set true thu tag conjunct combin let n join node queri tree children ln rn let u unfoldingsto discount tag column cu tabl tln trn modifi join oper execut node n modifi ad follow assign statement unfoldingtodiscount u exampl consid final join queri exampl three join tabl academ unit employe benefit contain extra column cf store valu unfold todiscount f column introduc execut union oper as describ algorithm queri modifi join oper follow select eeid acf ecf bcf cf academ unit a employe e benefit b adidedid eeidbeid bproviderblu cross modifi union join oper influenc except ad extra column final answer set queri purpos keep trace inform unfoldingstodiscount via tag column last step tupletag algorithm first version consist use inform select tupl known deriv unfold unfoldingtodiscount ensur thi suffici select tupl valu fals tag column show tupletag algorithm that is modifi union join oper correct prove need show tupl tupl valu true tag column given unfoldingtodiscount final answer set queri tupl answer set unfold theorem let qnfu discount queri let denot answer set tabl repres result evalu qnfu use tupletag algorithm then tupl proof assum without loss gener unfoldingstodiscount extension an intension unfold alway repres union extension unfold let unfold u join consid tupl mark true column unfold u is cu true assum cannot initi valu set modifi union oper cu true r thu least one fals valu cu chang fals and remain such sometim evalu join contradict assumpt henc statement as per sql standard perform requisit logic and tag column introduc tag column back new tabl f benefit academ unit employe institut figur final join queri exampl assum initi true r sinc modifi join oper assign conjunct valu cu join tabl cu remain true durat evalu process note modifi union oper never chang valu tag column henc cu optim state section remov tuplestodiscount final queri answer set accord optim describ not gener improv effici queri evalu complex queri howev remov execut queri evalu is final answer set produc word push select fals tag column queri tree constitut tupletag algorithm second version consid follow exampl exampl let queri exampl unfoldingtodiscount mark figur thu tupl join intitut staff benefit remov queri answer set let us assum final join queri academ unit employe benefit execut specifi queri tree that is left right consid result evalu academ unit employe tupl result join valu true column c g see figur now tupl tabl benefit valu true column becaus tabl part unfoldingtodiscount g thu tupl mark true result join academ unit employe remain true join benefit henc remov final queri answer set so elimin soon academ unit employe evalu note provid optim size one tabl input final join decreas gross save achiev optim estim cost join result institut staff benefit mark dot line figur introduc notion close unfoldingtodiscount node queri tree definit unfoldingtodiscount u close node n respect binari queri tree qt tupl mark true tn contribut tupl u final tupletag queri plan would even need add tag column cg benefit reason thu node repres join academ unit employe close node unfoldingto discount g exampl cours root queri tree close node unfoldingstodiscount next prove theorem specifi method identifi close node queri tree theorem unfold u close node n respect binari queri tree qt everi node u cannot reach root qt join node onli subtre root n proof consid node u lie n none node contain column u sinc none tabl use union becaus join node node queri tree root column never creat tupl tabl henc tupl tabl repres node n could contribut chang valu column cu join evalu tabl repres node u thu tupl valu true unfold close n remov immedi or while tabl tn materi sinc may sever close node given unfold use identifi first one in sequenc oper specifi queri tree order elimin tuplestodiscount soon possibl again condit properti simpl n close node u u close node subtre root n n first close node u tupletag algorithm util as describ exampl exist close node elimin unfoldingstodiscount also provid optim experiment result confirm inde case perform analysi experi purpos experi threefold evalu overhead in queri evalu time introduc tupletag algorithm modif union join oper compar perform tupletag versu queri rewrit techniqu elimin unfold todiscount evalu optim queri execut tupletag use tpcd benchmark databas size mb experi for detail benchmark see instal db windowsnt order abl defin view union modifi slightli tpcd schema thu three tabl supplier partsupp lineitem base tabl tpcd schema partit horizont half new base tabl repres subtabl supplier supplier forth creat then view supplier v partsuppv lineitemv defin union supplier supplier partsupp partsupp lineitem lineitem respect thu view exactli content origin tabl tpcd benchmark databas test sever version follow three queri select supplierv s partsuppv p supplierv s partsuppv p ssuppkeypsuppkey ssuppkeypsuppkey select figur queri tree q mark unfoldingstodiscount supplierv s partsuppv p ssuppkeypsuppkey ppartkeylpartkey defin one unfoldingtodiscount ffl u join supplier partsupp defin follow three unfoldingstodiscount mark queri tree figur u join supplier lineitem partsupp u join supplier lineitem partsuppv u join supplier lineitem partsupp follow discount queri test g note q q exactli structur as respect q qnffg exampl similarli structur qnfgg exampl sinc db support boolean data type use integ tag use multipl instead logic manipul exampl queri q evalu tupletag strategi follow form select supplierv s partsuppv p lineitemv l ssuppkeypsuppkey ppartkeylpartkey psuppkeylsuppkey stag ptag tag tag stand tag u u respect valu set definit view supplierv partsuppv lineitemv tabl present result test measur evalu cost sever queri use tupl tag explicit rewrit evalu discount queri thu suffix tag rew top mean discount queri evalu use respect tupletag explicit rewrit queri tree minim number oper as describ exampl topdown approach that is evalu join base tabl particular queri tree rew structur queri tree figur similarli q rew follow form allattribut supplier express relat algebra breviti queri total execut time s number retriev row tag tag tag rew tag rew tag tabl experiment result one easili verifi compact represent q g recal q nfu g top evalu union extension unfoldingsthat is union join base tablesand similarli top discuss purpos test q q nfu g measur overhead ad manipul tag queri design way optim queri execut time possibl achiev use tag done make root close node u q nfu g so join tabl ident size q minim size answer set thu make sure benefit write less data back disk inde queri execut time second larger q second good news differ neglig case q g size answer becom substanti tupletag begin optim queri q project attribut two join tabl reduc size answer set q provid optim queri execut time q vs second q purpos queri compar tupletag two techniqu remov unfold queri topdown queri evalu explicit rewrit queri tree minim algebra form tupletag outperform two techniqu respect margin fact topdown approach explicit queri rewrit approach add substanti overhead cost evalu discount queri see tabl conjectur section due introduct redund join evalu techniqu hand evalu tupletag strategi provid modest optim q see figur still achiev reduct size answer set reduct size join tabl last queri q nfu g provid crucial test techniqu temporari tabl creat join supplierv lineitemv close node unfold u mean tupl mark true tabl elimin next join with partsuppv execut thu reduc queri evalu strategi tupletag topdown explicit rewrit tabl evalu time in second discount queri differ evalu strategi cost last join inde reduct execut cost q nfu g origin queri q heurist state section one advantag tupletag explicit queri tree rewrit reliabl heurist devis decid stepwis whether given optim step appli decis depend reduct size tabl repres close node unfold or set unfold queri tree exampl queri q half tupl supplierv half tupl lineitemv mark true henc proport tupl mark true join supplierv lineitemv assum uniform distribut valu estim tupl elimin cost join partsuppv roughli estim reduc well show formal reduct estim gener thu provid main compon heurist use tupletag algorithm proport tuplestodiscount versu tupl p tabl repres close node n depend three factor proport tupl tag true unfoldingtodiscount close n number unfoldingstodiscount close n size join how mani tabl particip state depend formal follow we assum uniform distribut tuplesto discount among tupl tabl theorem let tabl creat join tabl t n differ tag column proport tupl tabl j valu true column proport tupl tag column valu true is proof induct n one unfoldingtodiscount tupl discount creat join tabl particip join tupl valu true column cu probabl pi valu formula assum formula hold n unfoldingstodiscount show hold tupl discount consid one follow case a would discount n unfoldingstodiscount consid b discount answer set n st unfoldingtodiscount probabl given induct hypothesi as q qnfug qnfug figur comparison execut time s origin queri queri evalu tupletag probabl b condit probabl tupl discount n unfoldingstodiscount consid discount st unfoldingto discount consid probabl express as pi n thu probabl tupl discount n unfoldingstodiscount consid equal sum probabilitu case b special case proport tupl mark true tabl tag column ident equal valu p t that is reduc to show applic result predict size tabl close node experi exampl queri g root queri tree close node proport tupl mark true u u three tabl supplierv partsupp v lineitemv thu queri q nfu g formula form sinc size answer origin queri q row reduc would produc tabl size close actual size row observ g similarli queri q form predict size final queri answer set thu close actual size g valu formula p function n plot figur way way join sever valu pt surprisingli number discount tupl grow number unfoldingsto discount well proport tuplestodiscount tabl particip join also howev strong invers relationship number join involv multiway join number discount tupl even tabl particip join tuplestodiscount differ unfold remov number discount tupl small way join conclus paper introduc new framework queri repres collect select unfold queri discount queri repres queri unfold remov pt pt pt pt pt a way join pt pt pt pt b way join figur proport discount tupl result join respect number unfold todiscount select unfold may remov secur reason answer readili avail through cach materi view present effici evalu strategi discount queri call tupletag show experi discount queri be gener evalu effici queri itself experi also suggest rewrit techniqu seem intuit approach remov unfold queri may perform wors evalu origin queri much wors tupl tag approach thu discount framework tupletag algorithm offer viabl approach optim queri employ view numer issu explor respect optim queri view type optim orthogon optim techniqu directli use conjunct exist optim would benefici identifi type interact tradit queri optim could increas overal optim current tupletag done prior stage optim appli result queri also need understand better variou cost tradeoff tupletag best balanc them r optim queri materi view implement two semant queri optim techniqu db univers databas rule languag intern algebra rule base optim data cach replac rule specif framework queri optim framework intension queri optim answer queri semant cach view disassembl queri optim bottomup evalu structur queri optim uniform framework semant queri optim deduct databas push semant insid recurs gener framework semant optim recurs queri comput queri deriv relat queri reformul deduct databas answer queri use view foundat logic program understand new sql complet guid extensiblerul base queri rewrit optim starburst queri fold multiplequeri optim problem constraint process multilevel secur distribut databas manag system transact process perform council principl databas knowledgebas system fusion queri internet databas tr rulebas view queri optim foundat logic program nd extend ed principl databas knowledgebas system vol logicbas approach semant queri optim structur queri optimizationmyampersandmdasha uniform framework semant queri optim deduct databas extensiblerul base queri rewrit optim starburst understand new sql answer queri use view extend abstract rule languag intern algebra rulebas optim multiplequeri optim problem constraint process multilevel secur distribut databas manag system fusion queri internet databas queri reformul deduct databas prair push semant insid recurs optim queri materi view queri fold view disassembl implement two semant queri optim techniqu db univers databas semant data cach replac queri optim bottomup evalu answer queri semant cach ctr park godfrey jarek gryz view disassembl rewrit extract portion view journal comput system scienc v n p septemb