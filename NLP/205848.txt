t analysi costat discret paramet estim linear evolut equat a wide use approach paramet identif output leastsquar formul numer method solv result minim problem almost invari requir comput gradient output leastsquar function identif problem involv timedepend distribut paramet system or approxim thereof numer evalu gradient extrem time consum costat method greatli reduc cost comput gradient howev question rais concern accuraci converg costat approxim even numer method use known converg rapidli forward problem paper shown use timemarch scheme yield highord accuraci forward problem necessarili lead highord accur costat approxim fact case approxim converg all howev certain circumst rapidli converg gradient approxim result rapid weakstartyp converg costat approxim issu treat theoret numer b introduct paper analyz tempor discret costat method comput gradient output leastsquar approach paramet esti mation analysi appli initi valu problem form aq bound linear oper hilbert space h inner product h denot hdelta deltai h dot u indic differenti respect t refer u state variabl state equat assum q lie set qad admiss paramet contain norm linear paramet space q throughout paper assum map q aq gateaux differenti oper norm applic interest finit dimension ie dimh approxim timedepend pde import exampl diffus equat t depart mathemat scienc montana state univers bozeman mt research support part nsf grant dm center interfaci microbi process engin montana state univers nsfsponsor engin research center center industri associ center appli mathemat scienc univers southern california lo angel ca address juli depart mathemat texa univers colleg station research support part air forc offic scientif research grant afosr afosr nsf grant dm dm situat dimh arbitrarili larg gener assum solut u lie state space hilbert space inner product bank kunish assum exist observ space z hilbert space inner product hh delta delta ii z observ oper given observ z u one wish estim paramet q output leastsquar approach paramet estim q qad select minim function uq solut scalar ff posit regular paramet n q regular function whose purpos stabil minim usual n q norm seminorm q comput method minim ff q typic requir gradient gradient ap proxim exampl assum discret paramet form one often see exampl section v approxim compon gradient use finit differ eg small scalar note limit th compon rt ff q direct ie gateaux deriv ff q direct dimh n q larg gradient approxim base directli extrem expens requir evalu function ff henc n q solut evolut equat attract altern costat approach section v describ continu form section sharp contrast n q state equat solut need finit differ method costat method requir solut two evolut equat state equat costat adjoint equat follow n q hinner product unfortun comput experi adjoint approxim paramet estim certain evolut equat puzzlingli disappoint exampl author conclud approach unsatisfactori extrem difficult obtain accur search direct gradient comput manner also author suggest costat method certain class damp elast system explain may facilit effici use gradientbas method conjug gradient bfg also report use numer experi howev none specif exampl upon report use method subsequ privat commun two author reveal encount unexpect difficulti costat approach later comment thi bank state experienc much difficulti costat base gradient method abandon similar difficulti encount optim control set dealt comput method control system govern delay differenti equat author observ certain spline approxim solut oper ricatti equat fail converg strongli subsequ work care shown underli difficulti lack strong converg adjoint approxim paper focu tempor discret costat system leastsquar paramet estim sinc costat method comput rt ff q requir solut two evolut equat plu n q inner product two import compon numer scheme approxim gradient a scheme approxim solut evolut equat which assum timemarch scheme b numer quadratur scheme are say th order accur one would reason hope attain th order converg gradient approxim howev observ oper c involv pointwis evalu time certain subtleti aris one may observ unexpectedli poor converg gradient approxi mation perhap strike exampl present involv fourthord rungekutta rk timemarch scheme show rk use conjunct simpon rule which fourthord numer quadratur gradient approxim fail altogeth converg show fact rksimpson approxim converg secondord accuraci time true gradient posit perhap equal surprisingli prove rk togeth secondord accur trapezoid quadratur rule yield fourthord converg underli reason strang phenomena c involv pointwis evalu time costat equat evolut equat diracdelta function forc term reason costat approxim solut converg strongli howev case exhibit highord converg weak topolog dual space c consider similar spirit work report introduct paper author state we feel mani distribut paramet control system might lead numer difficulti use optim scheme we hope reader motiv think similar problem complex distribut paramet system paper address optim control problem nonetheless relev us extent output leastsquar paramet estim mathemat similar optim control bank suggest nonconverg costat approxim also occur paramet estim lack converg spatial discret exampl system one must discret respect compon x well respect t result need costat approxim essenti converg dual semigroup consider suggest direct futur work pursu here section discuss costat method continu problem apart tempor approxim section introduc fairli wide class timemarch scheme correspond costat approxim scheme analyz approxim detail make certain assumpt properti timemarch scheme observ oper variou oper discret section contain numer exampl illustr result analysi section sever altern approach avoid difficulti mention present conclus work discuss section continu costat approach state introduct typic implement output leastsquar approach paramet estim requir gradient function ff q given effort obtain gradient lie comput gradient least squar function solv state equat sinc gradient q obtain comput direct deriv focu throughout comput direct deriv q direct p given residu defin henc solut given term solut oper sq z te aq term sq thu take adjoint c sq one obtain solut costat equat oper q given s e gammaa qs differenti equat satisfi sinc equat final condit instead initi condit use note equival y j time revers oper h defin costat approach comput rt q consist follow four step continu costat method i solv state equat state variabl ii comput residu iii solv costat equat costat variabl y iv comput direct deriv direct p cf equat note approach requir solut two evolut equat state equat costat equat oppos n q evolut equat moreov linear q as case approxim exampl implement step iv straightforward final note complet comput rt ff q necessari comput gradient rn q regular function usual trivial analysi discret approxim discret approxim usual solv numer one use sort finitediffer timemarch scheme tm section pose analyz rather natur algorithm comput costat approxim base given tm continu costat method describ abov given n let denot specifi mesh f defin h k k later use discuss asymptot rate converg defin also let u k approxim state variabl u n k obtain use particular tm mesh denot fft n k g f n may express approxim approxim use minim scheme ff q paramet estim problem correspond continu leastsquar function defin z n z n c n discret z z c discuss detail below minim scheme requir direct deriv ie gradient seemingli natur approach section v call discret costat approxim base obviou discret continu costat method suggest itself discret costat approxim i comput ii comput residu r iii comput n here j n approxim j cf given c n approxim adjoint c iv approxim direct deriv direct p here hh delta delta ii h n discret continu inner product converg g depend factor converg time march scheme tm forward problem converg approxim c n observ oper c converg discret inner product hh delta delta ii h n continu inner product hh delta delta ii h hh delta delta ii z respect carri converg analysi first care state discret version problem h f k k h n inner product fw n k given sequenc weight purpos weight facilit definit hh delta delta ii h n way wellapproxim hh delta delta ii h accordingli assum essenti without loss gener exist independ n form basi follow lemma lemma sequenc ff n g h n properti constant kn kf n kf n kh also denot hh delta delta ii e n inner product which loos speak use standard euclidean inner product time compon specif inner product use adjoint comput two inner product relat w n diagon oper h n defin assum time march scheme tm form n q defin recurs bound oper b k q express term compon see section specif exampl make follow assumpt tm a tm stabl ie exist term product order left right decreas indic a constant a f c f h ft ds ojhj a state equat forc function f lie c f h follow theorem readili establish theorem aa hold use aa one obtain one use a induct show kn theorem follow lemma rate converg gradient address converg state direct deriv approxim result obtain subsect later use prove converg discret costat approxim assum exist oper also note c make follow assumpt relationship inner product approxim a consid converg direct deriv a hold rate converg e directli determin rate converg solut forward problem e assur a rate converg e determin fast take direct deriv compon form recurs hand ft n take direct deriv give compar one show desir converg provid direct deriv oper preserv converg rate smooth t precis assum r h ds ojhj obtain follow analogu theorem theorem assumpt aa aa hold proof notat conveni suppress depend q first show k kh bound independ k n appli recurs assumpt a j assumpt aa theorem z h je ft integr term inequ bound independ j consequ assumpt a subtract ft n ds bounded k s result theorem assumpt term right side equat ojhj except first term thu equat form argument use proof theorem appli one obtain follow result theorem assumpt aa aa proof refer equat schwartz inequ definit r r n z n first term within parenthes ojhj theorem second a kffi p u n kh n bound theorem consequ je similarli equat theorem assumpt a final a je continuoustim versu discretetim observ follow subsect analys converg costat approxim subsect make preliminari consider toward end lead specif two distinct class observ oper c breviti notat set one obtain consequ theorem bounded ffi p a fact oper ffi p p n commut sequenc fki n kh ng bound schwartz inequ impli ng bound je henc rate converg costat approxim direct deriv depend rate see oper represent z te aq similarli oper obtain replac q format n r n cf oper c approxim adjoint c z select adjoint oper differ choic might made basi discuss section below sinc costat vector given term evolut equat c r sourc term and similar statement true approxim find conveni specifi c further facilit analysi converg je j commonli happen applic c inherit type tensorproduct structur state space particular assum exist bound spatial observ oper z hilbert space relat z descib below distinguish two case practic import observ continu time first case observ oper c con tinuou time defin term space z bound oper act case defin addit defin q n inner product approxim manner analog note case valid assumpt a determin quadratur weight w n k also determin accuraci hh delta delta ii h n approxim assumpt a trivial satisfi case sinc c n p definit adjoint residu r r n appear given observ discret time second case assum observ oper c consist spatial observ taken discret point time accordingli assum discret observ space z form z simplic assum that given set tempor observ point f g timemarch grid n alway chosen f g ae n alway inject map ng f c f case sinc observ space alreadi discret defin ident z case assumpt a alway true sinc z also a alway true sinc continuoustim observ case c n p c thi true sinc assum f g ae n definit adjoint find c z h given ffidelta denot dirac delta function discret analogu ffi k denot kroneck delta function integ pair rate converg costat approxim discuss previou subsect immedi follow suffic consid converg term je j zero address simpl case continu time observ first case th order converg e result observ data z smooth enough theorem aa aa hold data z lie c f z proof note j c c preserv smooth respect t smooth z smooth u which follow a jc r c f h appli theorem jc r place forc function f place a note last term ojhj also a a ks n k bound independ n suffic show follow theorem bounded c c result theorem assumpt quadratur weight chosen correctli cf obtain costat converg corollari hypothes theorem hold g g c f h proof theorem impli sequenc fki n kh ng bound discuss immedi follow suffic show first term ojhj theorem sinc oe suffici smooth second term ojhj next address case discret time observ case c r given linear combin dirac delta function sinc forc term costat equat question fast if all g rather delic particular smooth c r play crucial role proof theorem present case c r smooth all exist distribut thu proof theorem and henc corollari valid case hand converg stronger actual need essenti statement strong pointwis converg h see sort weak converg would suffici rewrit e note oe c f h need establish th order weak converg n dual space c f h seemingli natur situat weak converg appli number subtleti aris explor matter discuss shortli is howev one class problem fulli analyz here cover varieti secondord method uniform mesh n theorem assum a assumpt aa hold b aa c observ point lie interior f d partit n uniform sens h e quadratur weight w k equat given w weight correspond trapezoid rule numer quadratur f oper b k term n defin cf k oper b g oper r n may written note last compon r role tm purpos defin way becom clear below h oper b r r ration function aq proof corollari suffic show lead us studi see shall take adjoint inner product right side equat main effort proof lie subsequ simplif particular goal show proceed detail first note sinc p n oe condit e obtain refer note j n j n equal ident obtain j j r n denot adjoint respect e n inner product defin use fact j n selfadjoint respect hh delta delta ii e n next assert r n oper n r n follow block toeplitz matrix represent r block oper h oper n r n ident block toeplitz form except b r r replac hadjoint consider block matrix represent action j n e n adjoint one verifi hold thu simplifi thu question aris much n r n r n n differ sinc b r r ration function aq commut other comput base directli reveal that arbitrari s r r r result may also obtain directli matrix represent thu commut equat hold g h n case present interest name role g play p n oe p n oe thu observ point less f yet occur mesh point see discuss lead thu c n r n last term equat drop out also sinc s n r n p n oe obtain condit e combin yield theorem reason similar proof theorem sinc oe smooth also ks consequ right side may replac hh z within secondord use thi definit e fact hh find result follow assumpt a result similar theorem obtain certain fourthord method includ ing rungekutta uniform mesh provid forc function f zero provid appropri quadratur weight chosen surprisingli weight correspond second order quadratur rather fourth order theorem assum forc term f satisfi a theorem hypothesi a b aa c theorem hypothesi c d theorem hypothesi d theorem hypothesi e f theorem hypothesi f g oper r n may written theorem hypothesi h then proof given g h n r n g defin k r n g unspecifi defin f r n note f becaus a satisfi r n necessarili f r n c therefor may replac r n f r n sinc block matrix represent f r n toeplitz follow reason similar lead proof theorem obtain r proof theorem consid extent f r n n fail commut goal show r may invok reason similar follow f r fact lengthi straightforward comput also definit n r n f r n a find k n z oet n ds substitut yield gammah z oet n ds oh integr term equat approxim within fourthord accuraci replac oet secondord taylor polynomi t argument use show fourthord converg simpson ruleh z oet n z t n ds oh now t evalu n use assumpt a make substitutionh z oet n hypothesi u mean thush z oet n h also oet n oet n replac t n t n respect within thirdord accuraci yield g fact which true a thu arriv shown r use thi reason similar obtain also natur ask happen use fourthord tm fourthord quadratur scheme simpson rule show gradient approxim thu comput fail converg although direct space q converg particular rksimpson costat approxim converg quadrat time true gradient corollari assum hypothes theorem hold except e assum e quadratur weight aris simpson rule i limit n taken repeat doubl n precis integ n n equal n l posit integ l then argument similar use obtain find r r n defin rap weight matrix correspond trapezoid rule shall show kv gamma vkh impli r show induct kv gamma vkh note first v assum k v note here fw n k g simpson weight diagon entri w n simp thu definit w n simp smooth oe fact follow second parenthes term equal h hoet n a use observ definit w n divid thu find induct hypothesi v may replac v kgamma v kgamma right side equat result express then definit formula thu sinc also true obtain v hold may use reason lead obtain next turn attent c n r n g refer see g depend linearli fw k g show simpson weight replac trapezoid weight result call g inde follow easili hypothesi i guarante i even simpson weight w k satisfi w m h simpli time i th trapezoid weight thu right side equal within oh time right side thu result theorem appli obtain desir result numer exampl illustr result previou section focu splinebas galerkin approxim with fix dimension diffus equat one space dimens direct deriv correspond leastsquar function accordingli fix n take basi function fb g n usual piecewis linear hat function uniform mesh nodal point x given n seek approxim u solut diffus equat linear combin basi function ie fix denot coeffici vector fu tg simpli ut ndimension linear system form obtain u standard galerkin method requir ux z z gammaqx x dx dx implement integr left side equat encod exactli one right side approxim use trapezoid rule report result six numer experi these thu h subspac l consist continu function equal zero endpoint piecewis linear interior node x one experi exampl continu time observ rest base discret time observ case spatial observ oper c same defin pointwis evalu function h point function qx perturb px repres linear spline describ abov perturb p element h specif zero endpoint vari x thu qdepend linear evolut equat given data z gener carri approxim outlin abov approxim linear spline interpol sourc term fx t chosen solut ux t ux direct deriv approxim investig base qx j three experi base nonuniform mesh n explain mesh gener suffici explain vector fh k g gener highlight depend n denot vector h n individu hvalu h n k gener nonuniform h n begin given n creat uniform mesh set h n n given mesh ratio r satisfi mesh refin scheme gener h n h n n choic refin mesh uniform clearli true choic r examin converg properti costat approxim use four differ timemarch scheme state equat method are cn trapezoid cranknicholson method rke explicit secondord rungekutta method rki implicit secondord rungekutta method rk explicit fourthord rungekutta method order express rk method form compat hypothesi g theorem first obtain fourthord accur approxim f k evalu t n k cubic polynomi interpol uniform mesh yield carri rather extens numer investig use matlab softwar packag sun sparcstat decstat case compar costat approxim g centereddiffer approxim comput evalu express limit sign replac n ffl valu ffl call ep matlab machinedepend constant defin smallest integerpow sparcstat number repres sixteen decim place choic ffl finit differ comput reflect desir strike balanc discret error roundoff error heurist page expect ffi p n fd thu comput agre correct valu roughli half sixteen decim place result theorem true gradient discret function full accuraci ffi p q under assumpt a a cours sinc within eight digit so triangl inequ impli rate converg g correctli indic rate converg g long rel differ two quantiti larger six experi then tabul rel error im four method jhj vari result estim actual rate converg base assumpt e case observ continu time mesh nonuniform refin trapezoid quadratur rule use h n inner product three secondord method simpson rule use rk method e e e e e e e e e e case experi motiv theorem take observ discret time uniform mesh quadratur weight aris trapezoid rule result present follow tabl e e e e e three rungekutta method appear converg secondord rate predict theorem cranknicholson costat approxim agre forwarddiffer approxim within nine decim place roughli expect accuraci ffi p n fd fact uniform mesh g comput cranknicholson method exactli equal neglect roundoff error outlin proof assert recurs formula take form then use lead refer see last equat recurs reason similar led right side equat rewritten g numer nonzero extent explain cranknicholson column tabl abov case exampl case nonuniform mesh gener case theoret basi expect converg inde tabl suggest converg obtain e e e e e e e e e e case conjectur case even though mesh n may nonuniform highord converg still achiev provid mesh local uniform sens given n h k s near given observ point constant precis posit integ oe real h n i exampl repeat experi report case took step ensur refin mesh local uniform e e e e e e e e e e tabl suggest highord converg sometim obtain local uniform mesh howev pursu idea further case next present exampl illustr theorem forc term f state equat chang rk method use togeth quadratur weight matrix w rap aris trapezoid quadratur rule weight appear theorem hypothesi d mesh refin uniform e e case final illustr corollari repeat experi shown case use simpson rule instead trapezoid rule compar g e e altern approach throughout preced section discuss use discret costat approxim attempt illustr delicaci procedur pointwis in time observ involv least three possibl approach also merit consider pointwis observ involv briefli discuss strategi pursu section take discret adjoint system is first deriv costat method continu problem discret result equat integr altern would use adjoint discret system approach straightforward appli boundari valu problem certain complic may aris implement evolut equat particularli time march scheme use tempor discret particular definit discret leastsquar function express compon ffi p u n definit n q see fl n q p given thu advantag approach yield exact valu direct deriv n henc numer attempt minimizet n fix n would ideal howev involv use fl n q p given may requir signific amount addit mathemat effort code complex comput execut time disadvantag may negat whole part certain special case express simplifi simplif occur cranknicholson method uniform time mesh describ case section howev pursu approach here anoth altern section v retain strategi discret continu adjoint system transform costat equat increas smooth sourc term done introduct two new variabl given z tjc rs ds idea sinc piecewis constant as oppos jc r linear combin dirac delta function easier obtain accur numer solut first approxim given here briefli explor idea numer repeat relev numer exampl case case section case four tmss use approxim instead y set run observ linear converg direct deriv eg approxim case obvious uniform time mesh as case repres loss accuraci nonuniform mesh case definit improv one altern consid modifi step iii discret costat approxim along follow line instead attempt integr whole interv f one shot tm one treat subinterv rate use fact j n c zero interior subinterv jump discontinu correspondingli quadratur must modifi although implement complic analysi along line proof corollari appli consequ suffici smooth statevari forc function f full accuraci tm quadratur yield full accuraci costat approxim summari conclus costat method offer potenti dramat time save comput gradient paramet estim problem timedepend system indic care must taken use approach shown analyt numer use converg timemarch quadratur scheme seemingli reason combin yield surprisingli poor result difficulti lie fact forc term costat equat may nonsmooth assumpt tm quadratur scheme converg violat descript discret costat approxim begin section assum tm use step iii black box without regard smooth or lack thereof j n c costat implement analyz involv discret con tinuou costat equat use standard time march scheme due simplic approach desir result gradient approxim order accuraci particular time march scheme present condit guarante thi condit straightforward instanc sever popular second order time march scheme yield second order gradient approxim provid uniform time mesh use combin second order accur trapazoid quadratur condit less obviou cf theorem also demonstr certain reason implement yield gradient approxim fail converg all eg fourth order time march uniform time mesh combin fourth order trapa zoidal quadratur final sever altern though less simpl costat implement present r comput issu paramet estim feedback control problem partial differenti equat method identif materi paramet distribut model flexibl structur estim techniqu distribut paramet system numer scheme estim function paramet distribut model mix mechan lake sea sediment core a splinebas techniqu comput riccati oper feedback control regul problem delay equat on nonconverg adjoint semigroup control system delay de la nonlinearit dune equat paraboliqu quasi linear numer method unconstrain optim nonlinear equat differ method initi valu problem tr