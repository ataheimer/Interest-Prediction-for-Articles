t spars serial test uniform random number gener a differ version serial test test uniform independ vector success valu produc pseudorandom number gener studi test partit tdimension unit hypercub k cubic cell equal volum gener n point vector hypercub count mani point fall cell comput test statist defin sum valu univari function f appli k individu counter overlap nonoverlap vector consid differ famili gener linear congruenti tausworth nonlinear invers etc differ way choos function choos k compar formula obtain estim sampl size requir reject null hypothesi independ uniform random variabl function period length gener class altern correspond linear gener effici test turn k gg n in contrast usual done recommend simul book use overlap vector b introduct aim paper examin certain type serial test test uniform independ output sequenc generalpurpos uniform random number gener rng found softwar librari rng suppos produc imit mutual independ random variabl uniformli distribut interv iid u short test rng whose output sequenc u amount test null hypothesi iid u approxim multidimension uniform good rng usual design theoret multiset vector rst success output valu possibl initi seed cover tdimension unit hypercub evenli least chosen somewher so initi seed chosen randomli view sens sampl space point chosen random approxim uniform distribut background construct rng see exampl larg t structur typic hard analyz theoret moreov even small t one would often gener sever success tdimension vector form u statist test come play depend structur vector hard analyz theoret excess regular impli statist test fail sampl p lecuy r simard depart dinformatiqu et de recherch operationnel universit de montreal cp succ centrevil montreal hc j canada e mail lecuyeriroumontrealca simardriroumontrealca s wegenkittl institut mathemat univers salzburg hellbrunnerstrass a salzburg austria email sterandommatsbgacat work support nation scienc engin research council canada grant odgp smf fcarquebec grant er austrian scienc fund fwf project no pmat perform rst author visit salzburg univers north carolina state univers thank peter hellekalek jame r wilson size approach period length gener close period length one get troubl begin sever goodnessoft test h propos studi past see eg refer therein statist test never certifi good rng dierent type test detect dierent type decienc diversi avail batteri test better simpl wide use test rng serial test oper follow partit interv equal segment determin partit cubic cell equal size gener nt random number u construct point v let x j number point fall cell j multinomi distribut paramet k usual version test describ exampl among place base pearson chisquar statist averag number point per cell distribut x h approxim chisquar distribut k degre freedom say paper consid test statist gener form f nk realvalu function may depend n k interest instanc power diverg statist realvalu paramet by understand limit could also consid seem unnecessari context paper note power diverg statist studi refer given there gener class diverg famili f nk x form f nk consid f nk where denot indic function correspond number cell least b point number empti cell number collis respect interest dens case also spars case small sometim much smaller also consid circular overlap version statist u replac v slightli modi setup constant n replac poisson random variabl mean n then x vector iid poisson random variabl mean instead multinomi vector distribut becom easier analyz iid properti larg k n howev dierenc two setup practic neglig experi rstorder test observ valu say y reject h pvalu much close either function f usual chosen p close mean point tend concentr certain cell avoid other wherea p close mean distribut cell excess uniform p view measur uniform approxim random variabl h distribut approxim continu secondord or twolevel test would obtain n independ copi say theoret distribut h compar empir distribut uniform twolevel procedur wide appli test rng see main support argument test rng sequenc global level also local level ie could bad behavior short subsequ cancel out larger subsequ permit one appli certain test larger total sampl size for exampl memori size comput limit valu n andor k serial test total sampl size exceed n take n extens empir investig indic xed total sampl size nn test rng test typic ecient correspond test n mean typic rng type structur found one reason long subsequ usual found practic subsequ length word rng start given seed fail spectacularli certain test usual fail test admiss seed common way appli serial test rng select specic gener arbitrarili chosen test paramet run test check h reject not aim paper examin systemat way interact serial test certain famili rng famili take rng period length near e chosen basi usual theoret criteria integ e rang so examin dierent way choos k construct point v pvalu test evolv function sampl size n typic behavior take reason valu while say n threshold n converg exponenti fast n main interest examin relationship n e adjust crude regress model form log e two constant small nois result give idea size or period length rng requir within given famili safe respect serial test sampl size practic feasibl current comput turn popular famili rng linear congruenti multipl recurs shiftregist sensit test choos k proport e yield mean n time squar root rng period length result depend cours choic f chosen exampl linear congruenti gener lcg select basi spectral test serial test sensit k e case k most ecient test spars larg valu k yield sensit test usual one for k e so excess regular lcg realli show level partit k e partit eventu becom ne cell contain either point test lose sensit xed n nonoverlap test typic slightli ecient overlap one reli larger amount independ inform howev dierenc typic almost neglig see section nonoverlap test requir time random number x total number u s use nonoverlap test base n point wherea overlap one base nt point exampl overlap test typic ecient also costli comput distribut gener complic compar two test xed comput budget overlap one advantag larg time gener random number import fraction total cpu time appli test section collect result asymptot distribut dens case k xed n spars case spars case nk section overlap setup section brie discuss ecienc statist certain class altern systemat experi test certain famili rng report section section appli test short list rng propos literatur avail softwar librari wide use gener fail miser howev sever recent propos rng robust enough pass test least practic feasibl sampl size power diverg test statist nonoverlap vector brie discuss choic f nk correspond previous introduc test provid formula exact mean varianc limit theorem dens spars case choic f nk choic f nk given tabl case measur cluster tend increas point less evenli distribut cell wellknown pearson loglikelihood statist special case power diverg respect h relat g via relat statist n b w b c count number cell contain exactli b point for b number cell contain least b point for b number collis ie number time point fall cell alreadi point respect relat n mean varianc look distribut give express comput exact mean varianc h number point xed n denot one obtain algebra manipul x tabl choic f nk correspond statist diverg loglikelihood neg entropi number cell exactli b point number cell least b point number empti cell number collis x x x minn x fx fy although contain lot summand formula practic spars case sinc s dene tabl n k larg small term small x sum nonneglig term converg exponenti fast function x y x rst two moment easi comput truncat sum small number term exampl rel error eh less sum stop sum stop similar behavior observ statist express still valid dens case larger term need consid approxim mean varianc error term on provid chapter page poisson setup n mean poisson random variabl x j iid poisson express becom limit theorem limit distribut chisquar dens case normal spars case twomomentcorrect version pierr lecuy richard simard stefan wegenkittl result state next proposit mean c n proposit exactli mean varianc asymptot distribut eg normal case read cressi recommend type standard tend closer asymptot distribut standard asymptot mean varianc twomoment correct becom increasingli import get away around mean varianc comput explain previou subsect anoth possibl would correct distribut itself eg use edgeworthtyp expans page give extrem complic express due part discret natur multinomi distribut gain small proposit follow hold h i dens case k xed n multinomi setup converg distribut chisquar distribut k degre freedom poisson setup c ii spars case multinomi poisson setup standard normal distribut proof multinomi setup part i found page wherea part ii follow theorem note x j s distribut proof simplifi poisson setup due independ p nk iid asymptot n dens case sum squar x asymptot k turn count random variabl n b w b c approxim chisquar dens case fact xed k clear xed b impli w b k random variabl degener poisson setup x poisson p b b n b bnk p b binomi paramet k p b k larg p b small n b thu approxim poisson exact mean b next result cover case well proposit poisson multinomi setup h suppos k n let posit constant one also c ii proof i sinc one poisson case en b en b rel contribut w b sum w a sum correl poisson random variabl neglig compar n b n b w b asymptot distribut thi follow lemma likewis condit c asymptot distribut n e multinomi setup shown see section n b w b b asymptot poissonkp b poisson setup argument w appli c use lemma prove i poisson setup saw alreadi n asymptot multinomi case result follow theorem d prove ii part iii obtain appli theorem exact distribut c n h multinomi setup given stirl number second kind see page algorithm also given comput nonneglig probabl time on log n implement test base c use poisson approxim normal approxim n exact distribut otherwis overlap vector overlap case let x o tj number overlap vector j now formula mean varianc limit theorem proposit longer stand analysi dicult disjoint case gener p x o depend p x o depend pair i nontrivi way theoret result avail overlap multinomi setup pearson statist dens case let let x equival x overlap vector dimens consid statist good shown ex exactli see eq top page page setup usual nk so call overlap serial test mtupl test literatur use previous test rng eg next proposit gener result good power diverg statist dens case gener given theorem proposit let power diverg statist tdimension overlap vector dene multinomi setup k xed n proof result wellknown moreov taylor seri expans t power x o easili show probabl theorem a therefor t asymptot distribut t complet proof spars case k simul experi support conjectur overlap emptycellscount test discuss heurist way paper call overlap pair spars occup opso suggest specic paramet without provid underli the ori marsaglia zaman specul n approxim normal distribut mean ke varianc ke e make sens larg close zero studi empir approxim found reason accur approxim approxim could certainli improv rene varianc formula proposit i ii hold overlap case well simul experi indic poisson approxim c accur say alreadi quit good n larg test statist expect lfsr lcg mrg gener list construct point set entir period superuniformli distribut thu may afraid k larg enough cell if ani contain point c n n b w b b smaller expect extrem case assum distribut c h approxim poisson mean n k left pvalu collis test xed number cell pvalu approach exponenti fast squar sampl size n exampl k k respect assum k near rng period length ie mean test start fail abruptli sampl size exce approxim time squar root period length shall see precis happen certain popular class gener use statist b instead c situat sampl size requir obtain pvalu less xed small constant setup c n equival w choos ecient test suppos opposit mani collis one simpl model situat altern iid uniformli distribut box k k box alway empti h w b approxim poisson mean larg small instead therefor given x power test level x depend b b increas xed x decreas decreas well nk maxim power unless nk larg fact test signic power exce unit otherwis larg probabl one w reject mean approxim ok b b reason larg then best choic k small maxim approxim take altern h discuss gener follow suppos probabl larger k k k cell smaller probabl h call hole resp peak split altern k k near resp near near made extens numer experi regard power test altern found follow hole altern detect nk reason larg dens case spars case one expect sever empti cell anyway best test statist detect base number empti cell n small possibl eg peak altern power increas concav function rate increas typic becom small larger or higher peak narrow test statist tabl usual competit say altern except w b come close b nk howev hard choos right b k gener unknown split altern probabl k k lowprob cell equal easi detect collis test use c w recommend power essenti c w ew neglig valu impli almost onetoon correspond c w howev small n suce detect situat ew small distribut concentr small number valu neither normal chisquar good approxim distribut cours power test would improv highprob cell aggreg smaller number cell similarli lowprob cell thi one need know cell priori observ extend and agre with made previous sever author see refer therein alreadi note power decreas hole altern increas peak altern impli particular g h better wors test statist x detect hole a peak case split altern cell probabl slightli perturb x optim term pitman asymptot ecienc optim term bahadur ecienc see detail empir evalu rng famili select famili rng report systemat experi assess eectiv serial test detect regular specic famili small rng rng famili consid name lfsr goodlcg badlcg mrg combl invexpl within famili construct list specic rng instanc period length near e integ valu e rang rng small consid seriou gener purpos softwar studi give good indic behavior larger instanc famili step n gener output number un lfsr combin linear feedback shift regist lfsr or tausworth gener three compon form mean bitwis exclusiveor constant paramet select k j reason close other sequenc fung period length k k k maxim equidistribut see denit detail gener goodlcg linear congruenti gener lcg form prime near e select period length lcg excel behavior respect spectral test ie excel lattic structur least dimens badlcg structur except chosen mediocr lattic structur dimens detail valu found mrg multipl recurs gener order form period length excel lattic structur goodlcg combl combin two lcg propos combin gener period length m m excel lattic structur see detail lattic structur invexpl denot famili explicit invers nonlinear gener period length m dene prime an mod logpvalu given test statist take valu y let logpvalu test exampl mean right pvalu given class rng given t way choos k appli test dierent valu e sampl size e constant chosen test start fail approxim valu or most e specic dene resp smallest valu absolut logpvalu satis jj resp jj major valu e threshold arbitrari test result exampl summari tabl give log pvalu collis test appli goodlcg badlcg respect dimens log pvalu outsid set f g correspond pvalu less display symbol mean respect column shown mostli blank left tabl lled arrow right tabl small pvalu appear strike regular e tabl also true valu e shown tabl one tabl tabl goodlcg fail structur regular the left pvalu small collis wherea badlcg opposit behavior the right pvalu small mani collis behavior correspond split altern describ section tabl give valu select rng famili collis test dimens famili except invexpl fail sampl size proport squar root period length left right pvalu less time badlcg dimens rst fail chosen particularli mediocr dimens test detect it apart badlcg gener alway fail test due excess regular goodlcg lfsr exampl never cell point it lfsr distinguish two case one chosen alway odd one alway smallest power latter case number collis alway sinc cell contain singl point entir period gener consequ maxim equidistribut properti gener left pvalu behav describ begin section invexpl resist test period length exhaust gener point set randomlook instead evenli distribut howev much slower linear one appli power diverg test case pvalu close collis test fact cell count observ frequent onetoon correspond valu c therefor statist similar pvalu ew observ valu w small the spars situat overlap version test valu exactli given tabl mean tabl logpvalu goodlcg period length e collis test base c cell sampl size tabl entri give valu symbol mean respect here overlap test ecient nonoverlap one call rng time less appli test smaller larger number cell found increas move away e typic exampl goodlcg four choic k given abov respect wherea classic way appli serial test rng test use larg averag number point per cell dens case appli test base x goodlcg k n found empir mean requir sampl size increas o instead o befor ie dens setup chisquar approxim much less ecient spars setup observ valu valu t similar behavior rng famili result describ xed vari e x ie take rst two bit number vari dimens tabl give result collis test setup note chang goodlcg badlcg test less sensit larg valu t also experi twolevel test test sampl size n replic time independ collis test use test statist c total number collis n replic approxim poisson mean nn e nk k h power diverg test use test statist sum valu n c approxim n n nk h respect observ follow power tabl logpvalu collis test setup tabl badlcg gener here tabl collis test rng famili dimens k e recal resp smallest integ jj resp jj major valu e test sampl e rng famili lfsr power test n n typic roughli test level one sampl size n n singlelevel test thu need smaller total sampl size twolevel test achiev power hand twolevel test justi sampl size n limit memori size comput hand for n k counter x j implement via hash pierr lecuy richard simard stefan wegenkittl tabl collis test divis dimens dimens gener combl techniqu requir memori proport n instead k anoth way twolevel test comput pvalu n replic compar distribut uniform via say kolmogorovsmirnov andersondarl goodnessoft test experi extens well found advantag term ecienc rng famili tri reallif lcg result preced section one easili predict conserv sampl size specic rng given famili start fail verifi commonli use rng list tabl of cours list far exhaust tabl list select gener lcg lcg lcg lcg lcg lcg lcg lcg lcg lcg lcg lcg lcg lcg lcg lcg lcg lcg rlux ranlux wey nest weyl see wey shu nest weyl see clcg combin lcg cmrg combin mrg fig cmrg combin mrg fig gener lcg lcg wellknown lcg base recurr x step i lcg lcg recommend fishman fortran implement lcg given fishman lcg recommend among other use simscript ii insight simul languag lcg numer softwar system includ ibm macintosh oper system arena slam ii simul languag note arena rng replac cmrg wrote paper matlab imsl librari which also provid lcg tabl logpvalu collis test cell sampl size m gener tabl logpvalu twolevel collis test base c cell sampl size replic replic gener lcg numer recip etc suggest sever book paper eg lcg use vaxvm oper system convex comput lcg lcg rand rand function standard librari c program languag lcg taken lcg use cray system librari lcg lcg period length lcg lcg lcg period length m lcg lcg period length rlux ranlux gener implement jame luxuri level luxuri level ranlux equival subtractwithborrow gener modulu propos use exampl mathematica accord document wey gener base nest weyl sequenc dene see wey implement shu nest weyl sequenc propos dene clcg cmrg cmrg combin lcg combin mrg given figur combin mrg given figur tabl give logpvalu collis test two dimens lcg lcg k m expect suspect valu start appear sampl size n lcg denit reject n m lcg mani collis wherea other few extrapol lcg lcg expect start fail n around bit memori size current comput allow wrote paper howev appli twolevel collis test here total number collis c approxim poisson mean logpvalu tabl total sampl size lcg lcg fail decis collis also tri collis test overlap result similar test rng the last tabl sever valu rang rlux pass test fail spectacularli dimens logpvalu collis test collis ecjh twolevel test total number collis c much result surpris gener point v dimens lie famili equidist hyperplan apart see note ranlux larger valu l pass test least wey pass test dimens fail spectacularli point concentr small number box exampl sampl size small wey clcg cmrg cmrg pass test tri conclus compar sever variant serial test detect regular rng found spars test perform better usual dens one context choic function f nk seem matter much particular collis count pearson loglikelihood ratio statist power diverg famili perform approxim spars case overlap test requir sampl size n nonoverlap one reject gener ecient term quantiti random number need gener purpos paper recommend specic rng that refer reader exampl howev test result certainli elimin mani contend lcg lfsr fail simpl serial test soon sampl size exce time squar root period length regardless choic paramet thu period length less so case lcg still encount mani popular softwar product easi crack test small gener longer use among gener list tabl last four pass test describ paper sampl size tri other certainli discard r oxford scienc publica tion guid simul invers congruenti pseudorandom number tutori serial test sampl number test random guid chisquar test pseudorandom number gener massiv parallel moleculardynam simul asymptot normal ecienc certain goodnessof test ranlux fortran implement highqual pseudorandom number gener luscher art comput program simul model analysi random number gener base combin four lcg select criteria test objectori randomnumb packag mani long stream substream structur properti two class combin random number gener invers linear congruenti pseudorandom number gener empir test current view random number gener new class random number gener asymptot diverg estim discret distri bution good one hard standard c librari portabl random number gener thought pseudorandom number gener test uniform distribut addwithcarri subtractwithborrow random number gener tr ctr makoto matsumoto takuji nishimura sumdiscrep test pseudorandom number gener mathemat comput simul v n p march peter hellekalek stefan wegenkittl empir evid concern ae acm transact model comput simul tomac v n p octob pierr lecuy jacinth grangerpich combin gener compon differ famili mathemat comput simul v n p march pierr lecuy softwar uniform random number gener distinguish good bad proceed nd confer winter simul decemb arlington virginia