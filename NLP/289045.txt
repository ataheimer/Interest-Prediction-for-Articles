t nest fgmre method parallel calcul nuclear reactor transient a semiit method base nest applic flexibl gener minimum residualfgmr develop solv linear system result applic discret twophas hydrodynam equat nuclear reactor transient problem complex threedimension reactor problem decompos simpler manag problem recombin sequenti gmre algorithm mathemat method consist use inner level gmre solv precondition equat outer level gmre applic perform practic threedimension model oper pressur water reactor pwr serial parallel applic perform reactor model two differ detail core represent appropri tight converg enforc gmre level result semiit solver agreement exist direct solut method larger model test serial perform gmre factor better direct solver parallel speedup use processor intel paragon thu larger problem order magnitud reduct execut time achiev indic use semiit solver parallel comput consider reduc comput load practic pwr transient calcul b introduct analysi nuclear reactor transient behavior alway one difficult comput problem nuclear engin comput load calcul detail threedimension solut field equat prohibit variat power flow temperatur distribut treat approxim reactor calcul result consider conservat reactor oper research estim use exist method comput load calcul threedimension distribut would exceed teraflop per time step last sever year comput speed memori increas dramat motiv rethink limit exist reactor transient analysi code research begun adapt threedimension hydrodynam neutron kinet code advanc comput architectur begun investig advanc numer method take full advantag potenti high perform comput overal goal work report reduc comput burden threedimension reactor core model therebi enabl high fidel reactor system model specif object investig krylov subspac method parallel solut linear system result reactor hydrodynam equat follow section provid brief descript hydrodynam model reactor problem use work here nest gmre method precondition develop work describ section serial parallel applic present section respect work support electr power research institut school nuclear eng purdu univers w lafayett hydrodynam model reactor problem nuclear reactor analysi problem involv solut coupl neutron kinet heat conduct hydrodynam equat these twophas flow hydrodynam gener comput demand focu work here hydrodynam method use consist reactor system code retran wide use nuclear industri analysi reactor transient behavior method base semiimplicit solut mass momentum equat phase energi equat fluid mixtur solut scheme use finit differ represent fluidflow balanc equat convect quantiti sourc term linear ie expand use first order taylor seri result coupl finit differ equat implicitli includ system coupl equat method consid semiimplicit sinc linear equat use rather origin nonlinear partial differenti equat standard newtonraphson techniqu use solv nonlinear equat hydrodynam model applic spatial finit differenc set govern partial differenti equat perform use concept volum connect junction result system ordinari differenti differ equat may express dy dt column vector nodal variabl f column vector function number dependentsolut variabl solut vector consist n j junction mass flow rate w slip veloc v sl volum total mass m total energi u vapor mass m g inventori vector fy linear first order time differ approxim use result follow linear system ident matrix j matrix jacobian deltay deltat valu time level n n respect semiimplicit natur formul linear system aris linear discret tightli coupl also high degre stabil formul impos less stringent limit size time step indic equat larger time step reduc diagon domin result illcondit linear system sever author note illcondit linear system welldefin structur difficult solv effici mani case special handl requir obtain accept solut present linear solver retran direct method base gaussian elimin thetan execut time complex n number unknown model domin onedimension flow direct solut complement type matrix reduct techniqu effici howev case high fidel model reactor three dimension core rep resent direct method becom ineffici demonstr use model standard loop presur water reactor aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa aaa system model model see model side view top view channel upper plenum pass fig nodal pwr model pressur water reactor problem reactor system model use work consist loop pressur water reactor model detail three dimension represent reactor core schemat shown figur loop system contain steam gener heat transfer pressur primari loop secondari loop contain steam turbin core model consist sever volum stack one upon along channel assum layout c c channel axial volum number volum ac number cross flow junction number vertic junction c a first problem use work core model channel axial level per channel shown figur construct two version core model one cross flow horizont flow volum without cross flow cross flow import reactor transient break steam line one loop result horizont mix hot cold water core model cross flow consist volum junction result linear system size core model cross flow contain volum junction form nearli system model without cross flow contain number volum junction result linear system size coeffici matrix problem cross flow shown schemat figur structur shown figur correspond sequenti order junction volum variabl conveni reductionelimin method current use code reorder suitabl precondit discuss follow section column row fig pwr model d core sparsiti pattern coeffici matrix initi test problem simpl core reactiv event model simul insert withdraw control rod second rod insert core rate dollar reactiv per second second immedi withdrawn rate comput perform problem singl processor intel paragon summar tabl model without cross flow direct linear system solut perform solv modul indic tabl tabl computatin summari pwr exampl problem direct linear solver modul wo cross flow w cross flow cpu time percent cpu time percent total immedi appar tabl use cross flow core increas comput time order magnitud primarili problem without cross flow result linear system contain predominantli tridiagon submatric lend effici reductionelimin method larg increas execut time discourag model cross flow and gener high fidel reactor simul although reduct oper count requir direct solut primari motiv work here reason consid iter linear solut method first actual problem solv retran nonlinear direct solut result linear equat wast float point oper sinc usual accuraci consider less machin precis adequ secondli unlik direct method semiit solut method acceler inform previou time step initi guess precondition final direct method lend easili parallel comput distribut memori mimd multicomput wherea mani new semiit linear solver effici parallel semiit linear solver d hydrodynam last sever year consider research perform nonstationari class techniqu collect known krylov subspac method includ classic conjug gradient cg method shown effici symmetr posit definit system equat method call krylov method base build solut vector krylov sub space span fr residu initi solut coeffici matrix coeffici solut vector case cg method base minim energi norm error gen eral linear system encount hydrodynam problem symmetr posit definit therefor solv use cg method numer krylov method solv nonsymmetr problem propos year sever consid work includ gener minim residualgmr method biconjug gradient bicg method conjug gradient squar cg method biconjug gradient stabil bicg method particular interest work gmre method solv minim problem iter therefor guarante monoton decreas residu well known converg rate krylov method depend spectral properti coeffici matrix proper precondit consider improv rate converg precondit involv addit cost initi per iter tradeoff cost implement precondition gain converg speed sinc mani tradit precondition larg sequenti compon tradeoff serial perform precondition parallel effici sever altern precondition examin work here applic krylov method reactor problem previou work applic semiit solver reactor core hydrodynam calcul focus primarili solut linear pressur equat result singl phase onedimension flow problem krylov method found perform well result tridiagon system equat particular turner achiev excel converg conjug gradient squar method ilu precondition work provid use insight linear system result twophas threedimension flow problem significantli differ perform variou krylov method differ figur show behavior absolut residu l norm applic pwr problem variou krylov method precondition perform bicgstab bicg cg irregular cg shown residu increas sever order magnitud first iter continu increas gmre method demonstr accept behavior monoton decreasingli residu expect basi minim principl linear system time step examin behavior similar shown figur observ although float point oper count per iter higher gmre particularli larger number iter attract applic inher robust precondit techniqu examin could improv converg behavior gmre domain decomposit precondit knowledg physic characterist system invalu choos good precondition evid figur core excor system interact upper lower plenum suggest natur way decompos problem domain system reorder solut variabl belong core place contigu structur result matrix given ac u block l u repres interact core excor vari abl core excor interact upper lower plenum matric non zero element sever option exist use equat precondition one possibl precondition neglect l u block entir result block jacobi precondition given ac gmre iter residu fig figur perform krylov solver pwr d core problem block ae repres interact variabl excor region block ac repres interact variabl core region precondition jacobi two block may solv individu attract parallel comput note earlier size core block consider larger excor block later section method discuss solv core problem block jacobi domain decomposit precondition appli d pwr exampl problem first use direct solut precondition equat tabl contain result linear system first two time step transient describ section first case correspond problem result shown figur addit number iter two measur effect precondition shown tabl first condit origin precondit matrix shown second third column fourth column shown anoth measur effect precondit suggest dutto use ratio frobeniu norm remaind matrix defin frobeniu norm origin matrix frobeniu norm defin diagon shown tabl measur indic jacobi precondition effect toler gamma rel residu converg achiev less tabl result applic domain decomposit pwr problem precondition kakf iter gauss seidel modifi gauss seidel block jacobi precondition impact submatric l u complet neglect solv precondition equat anoth possibl employ gaussseidel like techniqu precondition equat solv sequenti z c z c z c z e respect two approach examin solv equat precondition one approach first equat solv neglect coupl ie z c symmetri sequenc solut matter precondition form ac result appli techniqu shown gaussseidel precondition tabl indic minor chang measur effect precondit howev converg achiev fewer iter second approach estim excor solut z e form use decoupl excor equat ae use solv sequenti core excor equat given equat precondition approach express as approach shown tabl modifi gausssiedel precondition and indic littl differ observ effect precondi tion block jacobi method natur parallel use work even though gausssiedel method show slightli better numer perform result shown precondition equat solv directli use gaussian elimin excor problem predominantli onedimension flow direct solut use reductionelimin prove effici con vers threedimension core model lend direct solut follow section examin use second level gmre solv core problem precondit core problem origin matrix order shown figur conduc precondit core problem ac z sever altern order examin junction physic volum reorder solut vector bear resembl physic layout would help decreas profil matrix goal increas densiti matrix region around diagon ie reduc bandwidth use portion matrix precondit purpos eg block jacobi etc structur exist core exploit defin supernod consist volum junction physic domain discret sever supernod introduc homogen structur matrix supernod could consid fractal repres smallest unit structur present system shown figur supernod core problem consist volum junction one junction vertic junction upstream volum two crossflow junction lead volum differ direct note use supernod lead problem extra junction exterior channel junction dummi junction repres matrix appear solut henc size system increas condit number remain same volum vertic junction crossflow junction crossflow junction fig structur supernod sever order supernod consid eg channelwis plane wise cuthillmcke etc order planewis found best purpos precondit plane repres two dimension grid supernod plane form one dimension structur link two neighbor result block tridiagon matrix shown figur equat case outer level precondition sever option exist use equat precondition inner level gmre column row fig structur coeffici matrix plane wise order block diagon precondition neglect planar coupl consid first tabl show result solv second level gmre first outer iter four differ block size examin converg criterion gamma two case shown c c taken differ time step tabl result applic jacobi precondit inner level precondition block size condit krkf kakf iter condit krkf kakf iter result outer iter slightli differ sinc sourc henc initi residu second level gmre differ howev result case consist gener trend shown tabl expect larger block size reduc number iter howev cost solv block directli would increas n offset reduct iter also smaller block advantag scalabl parallel comput domain decomposit scheme incorpor interact diagon block also examin approxim solut z c comput solv block jacobi system neglect coupl adjac plane z prime notat use distinguish z c r c vector occur outer iter equat inner gmre precondition equat solv precondition md is indic tabl improv precondit reduc number iter solv precondition becom expens number iter block size reduc half twice number float point oper requir form md tabl result applic domain decomposit precondit inner level kakf iter block size precondition block jacobi investig core problem primarili illcondit natur coeffici matrix popular scheme ssor ilu ineffect exampl incomplet lu factor scheme test linear system aris d core prob lem band construct frobeniu norm ilu precondition compar norm exact invers shown frobeniu norm approxim precondit system gamma three order magnitud larger frobeniu norm gamma a suggest ilu precondition would effect nest gmre method describ previou section implement nest gmre algorithm consist use inner level gmre solv precondition equat outer level gmre strategi suggest van der vorst demonstr success sever model problem precondition inner level gmre could solv use third level gmre applic direct solver prove effici schemat nest gmre algorithm shown figur physic interpret algorithm view overal problem decompos three simpler manag problem recombin sequenti gmre algorithm highest level take advantag natur loos coupl core excor compon solv separ linear system core excor region solut recombin use highest outer level gmre second inner level gmre use solv d core flow problem focu coupl vertic flow channel core final third lowest level gmre direct solver use restor coupl node plane core problem system problem gmre i gmre ii gmre iii direct e z c z fig nest gmre algorithm retran linear system solut flexibl gener minimum residu fgmre solut precondit equat gmre method anoth gmre algorithm pose potenti problem due finit precis inner level solut precondit gmre algorithm solut first built precondit subspac transform solut space matrix set orthonorm vector case iter solut precondition transform approxim extent determin converg criterion case illcondit matric approxim could especi troublesom tight converg requir minim error propag problem inexact transform allevi work use slight variant gmre algorithm extra set vector store use updat solut modif gmre algorithm suggest saad call flexibl gener minimum residualfgmr algorithm allow complet variat precondition one iter next store result precondit basi vector use krylov subspac instead use equat final transform solut subspac perform use matrix fgmre algorithm given appendix implement nest gmre method serial applic static problem nest gmre algorithm first appli linear system aris first time step rod withdrawalinsert transient parametr perform converg criterion number iter level maximum iter limit set inner gmre sinc case rate converg slow sometim term critic slow down variat outer highest level residu iter shown figur differ maximum number inner iter miter result indic rate decreas residu substanti greater miter howev shown figur result subsequ timestep indic differ rate decreas residu miter gradual diminish residu achiev inner second level gmre timestep correspond figur shown figur maximum iter limit residu increas first iter one possibl explan desir search direct outer level gmre becom harder resolv lead degrad perform inner level howev diminish qualiti precondit inner level gmre appear deleteri effect converg outer iter base converg result analysi time step strategi formul implement nest gmre transient analysi code retran follow section discuss result appli gmre transient problem outer iter number outer residu fig reduct outer residu first time step outer iter number outer residu fig reduct outer residu subsequ time step outer iter number inner residu fig perform inner gmre subsequ time step transient problem timedepend iter solut hydrodynam equat error incomplet converg one time step propag coeffici matrix subsequ timestep preliminari assess effect converg criteria qualiti solut perform use null transient steadyst condit continu sever second disturb system sever outer level converg criteria investig accept perform achiev toler e rel residu higher toler minor deviat observ eg less rel error perform paramet core power level provid initi guidanc set toler iter limit transient problem pwr rod withdrawalinsert transient describ section analyz use retran nest fgmre model cross flow core studi use iter solver transient time second requir step perform iter algorithm analyz first vari number outer iter use direct solver inner eg problem vari number outer inner gmre iter result shown tabl cpu second per time step maximum rel residu error outer iter shown fourth column tabl purpos comparison retran solut tabl use direct solut linear system repeat case a tabl first two case a a inner two gmre level see figur replac direct solver gmre use outer highest level iter object isol impact number outer iter tabl serial perform retran gmre channel axial case iter number cpu secstim step case outer inner max krk a direct direct gammagamma a direct a a qualiti solut seen tabl maximum residu error decreas number outer iter increas howev case a a signific error observ import physic paramet number outer iter reduc four minor deviat began occur solut second transient note execut time case a a gener compar direct solver gmre algorithm employ outer inner iter keep direct solut innermost third level order gain insight relat converg inner outer gmre algorithm number outer inner iter vari shown tabl case a a a a accuraci solut examin import physic paramet solut normal core power pressur pressur volum figur plot versu time figur direct solut a gmre solut a a minor deviat observ solut iter execut time greater direct a gmre outer direct inner a solut howev discuss next section algorithm inner level gmre attract larger problem parallel comput parallel applic one attract featur precondit krylov method potenti parallel comput emphasi work use distribut memori parallel architectur applic perform intel paragon section describ map nest gmre onto paragon execut time reduct achiev pwr sampl problem natur map processor pwr model one processor excor one plane core model matric stripe row wise impli l ae equat store processor assign excor ideal ac u partit among processor repartit data found expens henc copi ac u maintain pe oper distribut among processor one primari concern distribut data comput parallel process commun overhead incur transfer data pro cessor time necessari perform transfer consist two part time necessari initi transfer refer latenc time necessari actual transfer data depend amount data core power retran solut inner outer psia retran solut inner outer fig result retran gmre pwr transient gmre inner sec machin bandwidth follow section discuss parallel inner outer level nest algorithm special emphasi given commun issu parallel outer iter one domin oper outer iter matrix vector product iter product form matrix eq residu vector oper broken four part first part involv product ae v e involv commun sinc data resid processor next two part involv u v c l v e involv transfer part vector processor assign excor processor assign bottommost topmost plane core respect fourth part matrix vector product involv ac v c requir commun processor two processor gener matrix vector product requir commun select processor specif pattern vector inner product hand requir global commun mean everi processor requir inform processor necessari sum product element first vector correspond element second vector element vector first multipli processor form partial sum element resid domain sum product requir individu product number transfer requir consider reduc employ well known method treesum commun cost vari dlog n e as oppos n case commun gramschimdt orthogon process use gmre involv sever inner product iter howev result inner product depend other therefor partial sum inner product perform one time reduc number transfer requir least squar solut gmre involv reduc linear system involv suffici oper merit parallel commun relat least squar problem avoid entir perform least squar solut simultan processor also estim residu gmre consequ least squar solut termin criterion could evalu without need addit commun parallel inner iter sever oper requir parallel inner iter similar outer iter matrix ac stripe row wise row correspond plane store correspond processor plane link immedi neighbor matrix vector product requir two set data transfer vector inner product least squar solut treat manner outer level sinc precondition second level block jacobi precondition equat could implement without data transfer irrespect whether solv use direct solver iter solver result pwr model channel axial core parallel version retran execut paragon processor section present result rod withdraw case pwr model channel axial volum core transient analyz second nest fgmre solut perform use toler gamma iter limit inner outer iter tabl serial perform second level channel axial time step outer inner serial execut time precond total tabl parallel perform second level channel axial time step outer inner parallel execut time precond comm total speedup tabl show result serial parallel implement respect inner second level gmre fourth column tabl head pre cond indic time requir precondit second level gmre iii direct solv figur perform applic use direct solver mean lu factor first timestep involv addit initi cost consist comparison parallel serial version retran possibl differ code structur initi high speedup first iter second timestep due lu factor perform concurr parallel implement note bulk time spent third level sinc part code natur paralleliz one would expect high effici howev sinc problem size rel small communicationoverhead implement remaind gmre significantli reduc effici would case larger problem seen next section tabl show result serial parallel implement outer level gmre bulk time spent precondit similar execut time obtain timestep speedup slightli greater two obtain outer iter execut time first four time step summar tabl again speedup order two achiev serial perform outer level channel axial timestep outer serial execut time core excor total tabl parallel perform outer level channel axial timestep outer parallel execut time core excor comm total speedup result pwr model channel axial core order examin scalabl result pwr model use instead channel core linear system nearli three time size aris form channel axial case anticip shown tabl time requir solv linear system use direct solver order magnitud larger channel axial case compar case a tabl problem first execut use retran nest fgmre solver singl processor paragon problem larg execut ordinari node mb ram special fat node paragon use addit memori mb support larger applic shown tabl result singl processor encourag sinc factor improv achiev gmre compar direct solver problem execut use parallel version nest gmre solver domain decomposit method exactli channel axial case processor assign core excor expect parallel effici much better speedup factor respect serial version gmre tabl show comparison result first two time step indic tabl parallel execut nest gmre provid order magnitud reduct execut time compar serial execut direct solver furthermor sinc memori requir per node less mb parallel version could execut use standard size node paragon thu parallel key execut time reduct also allevi memori constraint larger problem summari conclus nest fgmre method develop solv linear system result threedimension hydrodynam equat applic perform practic pressur water reactor problem threedimension core model serial parallel applic perform overal perform nest fgmre channel axial timestep number execut time speedup outer serial parallel tabl execut time channel axial case case timestep execut time per iter outer total per inner timestep core excor precond direct solver channel channel version reactor core appropri tight converg enforc gmre level semiit solver perform satisfactorili durat typic transient problem serial execut time channel model compar direct solver parallel speedup intel paragon factor use processor channel model serial perform nest gmre factor better direct solver parallel speedup vicin use processor thu channel problem order magnitud reduct execut time achiev result indic use semiit solver parallel comput consider reduc comput load practic pwr transient calcul furthermor result indic distribut memori parallel comput help allevi constraint size problem exe cute final method develop scalabl suggest within reach model pwr core flow channel explicitli repres acknowledg author appreci work mr jeni wu gener transient result report paper r march algorithm ellipt boundari valu problem reduc effect global commun gmresm cg parallel distribut memori comput direct method spars matric effect order precondit gmre algorithm numer method engin scientist supercomput appli nuclear reactor assess advanc numer method twophas fluid flow flexibl innerout precondit gmre algorithm gmre gener minim residu algorithm solv nonsymmetr linear system comparison precondit nonsymmetr krylov method largescal mimd machin perform conjug gradientlik algorithm transient twophas subchannel analysi gmresr famili nest gmre method comput challeng develop effici parallel algorithm datadepend comput thermalhydraul supercomput applic tr