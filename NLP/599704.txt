t variabl resolut discret optim control a problem state abstract central import optim control reinforc learn markov decis process paper studi case variabl resolut state abstract continu time space determinist dynam control problem nearoptim polici requir begin defin class variabl resolut polici valu function represent base kuhn triangul embed kdtrie consid topdown approach choos cell split order gener improv polici core paper introduct evalu wide varieti possibl split criteria begin local approach base valu function polici properti use featur individu cell make split choic later introduc two new nonloc measur influenc varianc deriv split criteria allow one cell effici take account impact cell decid whether split influenc efficientlycalcul measur extent chang state effect valu function state varianc efficientlycalcul measur riski state markov chain low varianc state one would surpris if one execut longterm reward attain state differ substanti expect valu given valu functionth paper proce graphic demonstr variou approach split familiar nonlinear nonminimum phase two dimension problem car hill evalu perform varieti split criteria mani benchmark problem pay care attent numberofcel versu closenesstooptim tradeoff curv b introduct paper nonuniform discret state space find optim control continu time space markov process uniform discret gener base finit element finit differ techniqu kushner dupui provid us import converg result see analyt approach barl souganidi crandal ishii li on crandal lion muno probabilist result kushner dupui dupui jame suffer impract comput requir size discret step small especi state space high dimension hand approxim method bertseka tsitsikli baird sutton handl high emi muno andrew moor dimension gener guarante converg optim solut boyan moor baird muno local converg result gordon baird paper tri keep converg properti discret method introduc approxim factor iter design variabl resolut paper consid gener toward specif approach initi coars grid success refin area state space use split process desir approxim of valu function optim control reach first implement two split criteria base valu function see section defin criterion inconsist valu function polici see section order defin effect split state other state defin section notion influenc estim expect gain approxim valu function split state defin section varianc markov chain combin two notion deduc given discret state whose split mostli influenc part state space chang optim control lead increas resolut import area illustr differ split criteria car hill problem section show result control problem includ well known dimens cartpol acrobot problem paper make assumpt model dynam reinforc function moreov assum dynam determinist descript optim control problem consid discount determinist control problem includ wellknown reinforc learn benchmark car hill moor cartpol barto sutton anderson acrobot sutton let xt x state system state space x compact subset ir evolut state depend control ut u with control space u finit set discret action differenti equat call state dynam dx dt initi state x control function ut equat lead uniqu trajectori xt let exit time state space with convent xt alway stay x then defin gain j discount cumul reinforc rx u current reinforc rx boundari reinforc fl discount factor conveni reason follow assum fl howev result appli undiscount case assum control ut trajectori loop ie variabl resolut discret optim control object control problem find initi condit x control u t optim function j use method dynam program dp introduc valu function vf maximum j function initi state x follow dp principl prove fleme soner v satisfi firstord nonlinear differenti equat call hamiltonjacobibellman theorem v differenti x x let dv x gradient v x follow hjb equat hold x uu dp comput vf order defin optim control feedback control polici u optim control u t time depend current state xt u xt inde valu function deduc follow optim feedback control polici discret process order discret continu control problem describ previou sec tion use process base finit element method kushner dupui use class function known barycentr interpol muno moor built triangul statespac function piecewis linear insid simplex might discontinu boundari two simplex represent chosen fast comput properti descript class function statespac discret variabl resolut grid use structur tree root tree cover whole state space suppos hyper rectangl two branch divid state space two smaller rectangl mean hyperplan perpendicular chosen split dimens way node except leaf one split direct d rectangl cover middl two node half area see figur kind structur known kd trie knuth special kind kdtree friedman bentley finkel split occur center everi cell everi leaf consid coxeterfreudenthalkuhn triangul or simpli kuhn triangul moor dimens figur b rectangl compos triangl dimens see figur compos pyramid dimens d d simplex interpol function consid defin valu corner rectangl use kuhn triangul linearli interpol insid rectangl thu function piecewis linear continu insid rectangl may discontinu boundari two rectangl emi muno andrew moor b correspond tree a exampl discret figur a exampl discret state space rectangl corner the dot b correspond tree structur area cover node indic gray level implement kuhn triangul everi leaf remark go approxim valu function v piecewis linear function easi comput gradient dv almost point state space thu make possibl use feedback rule deduc correspond optim control x x figur kuhn triangul d rectangl point x simplex comput issu although number simplex insid rectangl factori dimens d comput time interpol valu point insid rectangl order d ln d correspond sort rel coordin point insid rectangl assum want comput index d vertic simplex contain point defin rel coordin respect rectangl whose corner f dg index corner variabl resolut discret optim control use binari decomposit dimens d illustr figur comput index achiev sort coordin highest smallest exist indic permut f gamma g x j d vertic simplex contain point exampl coordin illustr point x figur vertic everi simplex vertex well ad correspond barycentr coordin point insid simplex previou exampl barycentr coordin approach use kuhn triangul interpol valu function introduc reinforc learn literatur davi build discret mdp given discret build correspond markov decis process mdp follow way state space mdp set xi corner tree control space finit set u everi corner xi control u u approxim part correspond trajectori xt with euler rungekuta method integr state dynam initi state constant control u time u enter insid new rectangl point j u see figur time also comput integr current reinforc r u defin reinforc function mdp comput vertic simplex contain j u correspond barycentr coordin j u d j u probabl transit mdp state control u state defin barycentr coordin see figur j u thu dp equat correspond mdp j uv integr initi state control u trajectori exit state space time u u lead termin state ie satisfi p reinforc r u resolut discret mdp use classic method solv discret mdp ie valu iter polici iter modifi polici iter puterman bertseka emi muno andrew moor x x figur accord current variabl re olut grid build discret mdp everi corner state mdp everi control u integr correspond trajectori enter new rectangl j u interpol valu j u linear combin valu vertic simplex here furthermor linear combin posit coeffici sum one thu interpol mathemat equival probabilist jump vertex probabl transit mdp state control u state f g i barycentr coordin j u barto bradtk singh priorit sweep moor atk son exampl car hill control problem descript dynam problem see moor atkeson problem dimens experi chose reinforc function follow current reinforc rx u zero everywher termin reinforc rx gamma car exit left side state space vari linearli gamma depend veloc car exit right side state space best reinforc occur car reach right boundari null veloc figur control u possibl valu maxim posit neg thrust figur repres interpol valu function mdp obtain regular discret state observ follow distinct featur valu function ffl discontinu vf along frontier see figur result fact given initi point situat frontier optim trajectori stay insid state space and eventu lead posit reward valu function point posit wherea initi point frontier control lead car exit left boundari becaus initi veloc neg thu correspond valu function neg see optim trajectori figur observ chang optim control around frontier ffl discontinu gradient vf along upper part frontier result chang optim control exampl point frontier reach directli top hill wherea point frontier go one loop gain enough veloc reach top see figur moreov observ around lower part variabl resolut discret optim control goal thrust gravit resist reinforc r null veloc r max veloc figur car hill control problem frontier frontier upper part frontier lower part goal posit veloc figur optim polici indic differ gray level sever optim trajectori drawn differ initi start point frontier see figur visibl discontinu vf despit fact chang optim control ffl discontinu gradient vf along frontier chang optim control below frontier car acceler order reach reward fast possibl wherea abov deceler reach top hill lowest veloc receiv highest reward figur valu function caronthehil problem obtain regular grid state frontier illustr discontinu vf frontier the dash line stand chang optim control emi muno andrew moor deduc observ good approxim valu function necessarili mean good approxim optim control sinc ffl approxim valu function suffici predict chang optim control around lower part frontier ffl good approxim valu function necessari around frontier sinc chang optim control variabl resolut approach idea start initi coars discret build correspond mdp solv order coars approxim valu function then local refin discret split cell accord process score cell direct accord promis split accord measur call splitcriterioni pick top f where f paramet highest score cell split along direct given argmax splitcriterioni use dynam reward model creat new larger discret mdp see split process figur note cell split whose success state involv split cell need state transit recomput go step estim approxim valu function optim control precis enough thu central purpos paper studi sever split criteria figur sever discret result success split oper remark paper consid gener toward special process sens discret alway refin could also consid gener process where exampl tree code discret could prune order avoid non relev partit small subset follow present sever local split criteria illustr result discret previou car hill control problem variabl resolut discret optim control criteria base valu function first criterion averag cornervalu differ everi rectangl comput averag absolut differ valu corner edg direct us denot avei criterion direct i exampl consid squar describ figur splitcriterion figur repres discret obtain iter procedur start initi grid use cornervalu differ criterion split rate rectangl iter figur discret state space car hill problem use cornervalu differ criterion figur discret state space car hill problem use valu nonlinear criterion second criterion valu nonlinear everi rectangl comput varianc absolut increas valu corner edg direct criterion similar previou one except comput varianc instead averag figur show correspond discret use valu nonlinear criterion split rate iter comment result ffl observ case split occur around frontier upper part frontier previous defin fact first criterion lead reduc variat valu split wherev valu function constant figur ab show dimens cut discontinu emi muno andrew moor correspond discret approxim obtain use corner valu differ split criterion ffl valu nonlinear criterion lead reduc chang variat valu thu split wherev valu function linear criterion also concentr irregular two import differ compar cornervalu differ criterion valu nonlinear criterion split parsimoni corner valu differ see exampl differ split area frontier discret result split discontinu corner valu differ valu nonlinear criteria differ see figur valu nonlinear criterion split approxim function here kind sigmoid function whose slope depend densiti resolut least linear figur cd explain parallel tail observ around frontier mainli right part frontier figur ffl refin process split around bottom part frontier although chang optim control becaus vf almost constant area moreov huge amount memori spent approxim discontinu frontier although optim control constant area a averag split criterion coars resolut b averag split criterion dens resolut c varianc split criterion coars resolut d varianc split criterion dens resolut figur discret around discontinu result cornervalu differ ab valu nonlinear cd split criterion coars ac dens bd resolut thu wonder realli use split much around frontier know result improv polici next section introduc new criterion take account polici variabl resolut discret optim control criterion base polici figur show optim polici sever optim trajectori differ start point would like defin refin process could refin around area chang optim control around frontier upper lower part around frontier follow propos criterion base inconsist control deriv valu function polici polici disagr criterion solv mdp comput valu function dp equat deduc follow polici state xi compar optim control law deriv gradient polici disagr criterion compar control deriv local gradient v control deriv polici mdp remark instead comput gradient dv d simplex rectangl comput approxim gradient dv corner base finit differ quotient exampl figur approxim gradient corner thu everi corner comput approxim gradient correspond optim control compar optim polici given figur show discret obtain split rectangl two measur optim control diverg criterion interest sinc split place chang optim control thu refin resolut import part state space approxim optim control howev expect use criterion valu function well approxim thu process may converg suboptim perform inde observ figur bottom part frontier lightli situat higher optim posit illustr figur result underestim valu function area lack precis around discontinu frontier section observ perform discret result split criterion rel weak howev split criterion benefici combin previou one base approxim vf combin sever criteria combin polici disagr criterion cornervalu differ valu nonlinear criterion order take advantag method good approxim valu function whole state space increas resolut around area chang optim control combin emi muno andrew moor figur discret state space use polici disagr criterion use initi grid theta split rate figur discret state space car hill problem use combin valu nonlinear polici disagr criterion previou criteria sever way exampl weight sum respect criteria logic oper split andor combin criteria satisfi order criteria first split one criterion use one etc figur show discret obtain altern iter use valu nonlinear criterion to obtain good approxim valu function polici disagr criterion to increas accuraci around area chang optim control comparison perform order compar respect perform discret ran set here optim trajectori use feedback control law start initi state regularli situat state space perform discret sum cumul reinforc the gain defin equat obtain trajectori set start posit figur show respect perform sever split criteria function number state dimension control problem variabl resolut approach perform much better except polici disagr criterion alon uniform grid howev see later higher dimension problem ressourc alloc approxim discontinu vf area use improv optim control might prohibit high better far consid local split criteria sens decid variabl resolut discret optim control figur perform uniform versu variabl resolut grid sever split criterion cornervalu differ valu nonlinear split process perform better uniform grid polici disagr split good small number state improv after thu lead suboptim perform polici disagr combin valu nonlinear give best perform whether split rectangl accord inform valu function polici rel rectangl itself howev effect split local influenc whole state space thu tri see possibl find better refin process could split area use improv perform section follow present two notion use defin global split criterion influenc measur extend local chang state effect global vf varianc measur accur current approxim vf is notion influenc let us consid markov chain result choic control optim polici u mdp conveni reason let us denot intuit idea intuit idea influenc i j state anoth state give measur extend vf state contribut vf state ie chang vf result modif vf vf solut bellman equat depend structur markov chain reinforc valu thu cannot modifi valu state without violat bellman equat howev notic valu function state affect linearli reinforc obtain state thu comput contribut state state estim chang vf result modif reinforc r emi muno andrew moor definit influenc let us defin discount cumul kgammachain probabl p k j repres sum discount transit probabl sequenc k state definit let xi defin influenc state state quantiti i sigma subset xi defin influenc state subset sigma quantiti i call influenc state respect subset sigma set state nonzero influenc resp sigma note definit influenc nonneg properti influenc first notic time influenc well defin bound i inde definit discount chainedprob moreov relat definit intuit idea previous state follow properti hold ffl influenc i j partial deriv v r ffl state proof bellman equat appli bellman equat v definit p rewrit appli bellman equat v final deduc thu contribut r v v variabl resolut discret optim control properti easili deduc definit influenc chain probabl properti sinc comput influenc equat bellman equat sinc sum probabl may greater cannot deduc success iter n converg influenc use classic contract properti maxnorm puterman howev follow properti thu denot ixij vector whose compon i j introduc norm jjixijjj deduc contract properti norm insur converg iter n j uniqu solut the fix point i j illustr car hill problem subsetomegagamma comput influenc exam ple figur show influenc point figur influenc point the cross darker gray level import influenc notic influenc state follow direct optim trajectori start state see figur kind diffus process emi muno andrew moor let us defin subset sigma state polici disagr in sens section figur a show sigma regular grid theta influenc sigma comput plot figur b darkest zone figur b place whose split affect valu function place illustr figur a chang optim control a state polici disagr b influenc state figur set state polici disagr a influenc b would like defin area whose refin could lead highest quantit chang valu function close relat qualiti approxim valu function given discret inde better approxim lower chang valu function may result split follow section introduc varianc markov chain order estim qualiti approxim vf current discret thu defin area whose split may lead highest chang vf varianc markov chain use notat previou section bellman equat state gammar discount averag next valu weight probabl transit p j interest comput varianc next valu order get estim rang valu averag v first idea comput onestepahead varianc e v theta howev valu v also averag success valu v j would like varianc also take account secondstepahead averag well follow one next section defin valu function averag reinforc present definit varianc markov chain variabl resolut discret optim control valu function averag reinforc let us denot k sequenc first one let k set possibl sequenc k let ps k product probabl transit success state sequenc cumul time th first state sequenc with definit s k follow properti sk sk ps k prove valu function satisfi follow equat similar bellman equat kstepsahead k sk sk ps k let us denot infinit sequenc state start set possibl sequenc defin ps defin previous still properti valu function satisfi definit varianc markov chain intuit varianc state measur dissimilar cumul futur reward obtain along possibl trajectori start are precis defin varianc quantiti averag equat definit let xi defin varianc oe markov chain let us prove varianc satisfi bellman equat select case summat theta p rand deduc theta theta success appli select state sequenc theta theta p theta emi muno andrew moor e satisfi thu varianc oe sum immedi contribut e take account variat valu immedi successor discount averag varianc oe successor bellman equat solv valu iter remark give geometr interpret term e relat gradient valu function iter point barycentr coordin j inde definit discret mdp section v j piecewis linear approxim function v thu jfl dv j express matrix qj defin element thu e close two specif case either gradient iter point j low ie valu almost constant j close one vertex then barycentr coordin close j for close thu qj low case e low impli iter lead degrad qualiti approxim valu function the varianc increas exampl varianc car hill figur show standard deviat oe caronthehil problem uniform grid of figur standard deviat oe car hill standard deviat high around inde discontinu imposs ap proximateperfectli discret tech niqu whatev resolut is observ fact figur maxim error approxim equal half step discontinu how ever higher resolut is lower integr error compar figur ac versu bd notic posit standard deviat around frontier upper part valu function averag differ valu discount termin reinforc refin resolut area standard deviat low chanc produc import chang valu function thu appear area split might affect approxim valu function rectangl highest surfac whose corner highest standard deviat variabl resolut discret optim control global split criterion go combin notion influenc varianc order defin new nonloc split criterion seen ffl state highest standard deviat oe state lowest qualiti approxim vf thu state could improv approxim accuraci split figur a ffl state highest influenc set sigma state polici disagr figur b state whose valu function affect area chang optim control thu order improv precis approxim relev area state space split state highest standard deviat influenc area chang optim control accord stdev inf criterion see figur figur show discret obtain use split criterion a standard deviat b influenc x standard deviat figur a standard deviat oe car hill equival figur b stdev inf criterion product oe influenc ijsigma figur b figur discret result stdev inf split criterion observ upper part frontier well refin refin occur split accord valu function such cornervalu differ valu nonlinear criterion split necessari good approxim valu function around bottom part and even upper part frontier chang optim control fact stdev inf criterion split area vf discontinu unless refin necessari get better approxim optim control import sinc see simul follow higher dimens cost get accur approxim vf high emi muno andrew moor remark perform criterion car hill problem similar combin valu nonlinear polici disagr criterion plot perform figur clariti reason repres major improv howev differ perform local criteria stdev inf criterion much signific case difficult problem the acrobot cartpol illustr follow illustr control problem cartpol problem dynam dimension physic system illustr figur a describ barto et al experi chose follow paramet follow state space defin posit gamma angl veloc restrict control consist appli strength sigma newton goal defin area limit notabl narrow goal tri hit see project state space goal plan y figur notic task minimum time manoev small goal region arbitrari start state much harder mere balanc pole without fall barto et al current reinforc r zero everywher termin reinforc r gamma system exit state space jyj jj system reach goal _ _ _ _ posit y goal b project state space a cartpol figur a descript cartpol b project discret onto plane y obtain stdev inf criterion trajectori sever initi point figur show perform obtain sever split criteria previous defin dimension control problem observ follow point variabl resolut discret optim control ffl local criteria perform better uniform grid problem vf discontinu sever part state space area high jj late rebal pole similar frontier car hill problem valuebas criteria spend mani resourc approxim useless area ffl stdev inf criterion perform well observ trajectori see figur b nearli optim the angl jj maxim order reach goal fast possibl close limit valu possibl recov balanc figur perform cartpol figur perform acrobot acrobot acrobot dimension control problem consist twolink arm one singl actuat elbow actuat exert torqu link see figur a dynam similar gymnast high bar link analog gymnast hand arm torso link repres leg joint link gymnast waist sutton here goal control balanc acrobot unstabl invert vertic posit minimum time boon goal defin narrow rang angl around vertic posit b system receiv reinforc r anywher els reinforc zero two first dimens state space structur toru becaus modulo angl implement structur vertic first dimens angl point entri valu function interpol kdtrie figur show perform obtain sever split criteria previous defin respect perform differ criteria similar cart pole problem local criteria better uniform grid stdev inf criterion perform much better figur b show project discret obtain stdev inf criterion one trajectori onto dplane r emi muno andrew moor goal goal a acrobot b project state space figur a descript acrobot physic system b project discret onto plane obtain stdev inf criterion one trajectori interpret result notic two previou prob lem local split criteria fail improv perform uniform grid spend mani resourc local consider either approxim valu function optim polici exampl cartpol problem valu nonlinear criterion concentr approxim vf mostli part state space alreadi chanc rebal pole area around vertic posit low import area refin time howev continu simul state local criteria start perform better uniform grid area get eventu refin stdev inf criterion take account global consider split perform well problem describ abov conclus futur work paper propos variabl resolut discret approach solv continu time space control problem describ sever local split criteria base vf polici approxim observ approach work well problem like car hill howev complex problem local method fail perform better uniform grid local valuebas split effici modelbas rel qlearn base tree split criteria use exampl chapman kaelbl si mon van brussel de schutter verhaert mccallum combin new nonloc measur abl get truli effec tive nearoptim perform control problem treebas statespac partit moor moor atkeson produc differ criteria of empir perform produc far parsimoni tree attempt made minim cost mere find valid path variabl resolut discret optim control order design global criterion introduc notion influenc estim impact state other varianc markov chain measur qualiti current approxim combin notion defin interest split criterion give good perform in comparison uniform grid problem studi anoth extens measur could learn interact environ order design effici explor polici reinforc learn notion varianc could use interv estima tion heurist kaelbl permit optimisminthefaceofuncertainti explor backpropag explor bonus meuleau bourgin explor continu statespac inde observ learn varianc state high good explor strategi could inspect state high expect influenc futur seem import develop follow point ffl gener process order also specif toward gener group area for exampl prune tree overrefin ffl suppos want solv problem specif areaomega initi start state restrict refin process area use trajectori notion influenc introduc paper use purpos comput stdev inf criterion respect set state polici disagr influenc area initi statesomegagamma instead sigma improv drastic perform observ start specif area ffl would like deal stochast case assum model nois chang process build mdp kushner dupui muno bourgin ffl releas assumpt model build approxim dynam reinforc deal explor problem r residu algorithm gradient descent gener reinforc learn converg approxim scheme fulli nonlinear second order equat neuronlik adapt element learn difficult control problem learn act use realtim dynam program ming dynam program learn delay reinforc complex domain user guid viscos solut second order partial differenti equat viscos solut hamiltonjacobi equat multidimension triangul interpol reinforc learn rate converg approxim scheme optim control siam journal control optim control markov process viscos solut algorithm find best match logarithm expect time stabl function approxim dynam program learn embed system sort search machin learn explor multist environ local measur backpropag uncertainti variabl resolut dynam program effici learn action map multivari realvalu statespac priorit sweep reinforc learn less data less real time partigam algorithm variabl resolut reinforc learn multidimension state space simplic mesh gener applic studi reinforc learn continu case mean viscos solut reinforc learn continu stochast control problem neural inform process system barycentr interpol continu space time reinforc learn markov decis process gener reinforc learn tr ctr david wingat kevin d seppi pvi partit priorit parallel valu iter proceed twentyfirst intern confer machin learn p juli banff alberta canada chee wee phua robert fitch track valu function dynam improv reinforc learn piecewis linear function approxim proceed th intern confer machin learn p june corvali oregon philipp w keller shie mannor doina precup automat basi function construct approxim dynam program reinforc learn proceed rd intern confer machin learn p june pittsburgh pennsylvania sbastien jodogn justu h piater interact learn map visual percept action proceed nd intern confer machin learn p august bonn germani feng richard dearden nicola meuleau richard washington dynam program structur continu markov decis problem proceed th confer uncertainti artifici intellig p juli banff canada duncan pott claud sammut increment learn linear model tree machin learn v n p novemb florian bauer lar grne willi semmler adapt spline interpol hamiltonjacobibellman equat appli numer mathemat v n p septemb theodor j perkin andrew g barto lyapunov design safe reinforc learn journal machin learn research lar grne willi semmler asset price dynam program comput econom v n p may