t perfect simul correl poisson random variabl condit posit a paper present perfect simul method obtain perfect sampl collect correl poisson random variabl condit posit show use method produc perfect sampl boolean model condit cover set point ws kendal e thnne pattern recognit special case treat complic way method appli sever simpl exampl exact calcul made check correct program use khgrtest smallscal experi carri explor behaviour condit boolean model b introduct markov chain mont carlo mcmc provid opportun carri simulationbas statist infer allow one sampl approxim target distribut realis equilibrium markov chain approxim natur mcmc aris output subject initi bia recent work perfect simul show favour circumst mcmc simul algorithm modifi replac approxim exact simul procedur particular coupl past cftp method due propp wilson develop intens sinc discoveri exampl domin cftp variant cftp develop permit perfect simul gener class point process see also domin cftp import go beyond point process sinc allow applic cftp wide class nonuniformli ergod markov chain need monoton kendal thonn use domin cftp carri perfect simul stochast ge ometri show get perfect sampl boolean model condit cover finit set point purpos paper explain get perfect sampl collect correl poisson random variabl condit posit briefli correl poisson random variabl aris sum basic set independ poisson random variabl follow kendal thonn motiv applic obtain perfect sampl boolean model condit cover set point howev construct involv condit boolean model view aris correl condit poisson random variabl lead simpler simul algorithm gener random variabl setup draw attent away geometri which distract complex well interest stochast geomet wish investig condit boolean model result report add sequenc casestudi aim develop cftp use challengeproblem stochast geometri particular challeng perfect simul condit boolean model result formul rather gener context cftp describ extend statespac cftp below construct paper follow x introduc notion correl poisson random variabl describ mcmc method obtain approxim sampl condit correl poisson distribut specifi algorithm scheme obtain perfect sampl context extend statespac cftp common practic cftp algorithm base construct interleav sequenc upper lowersandwich process bound intermedi markov process actual requir equilibrium distri bution fundament properti cftp algorithm establish theorem x name algorithm termin finit time output desir distribut x describ relationship condit boolean model collect correl poisson random variabl condit posit thu show use algorithm conduct cftp condit boolean model sever exampl describ x exampl deriv explicit condit distribut function correl poisson random variabl enabl us carri test order check correct cftp algo rithm relationship intens germ process radiu typic grain number condit point coalesc time investig x final comment conclus present x correl poisson random variabl condit posit begin section introduc concept collect correl poisson random variabl describ mcmc method obtain approxim sampl collect individu random variabl condit posit final describ cftp modif allow us obtain perfect sampl desir distribut fix given index set assign rate nonempti subset s consid collect independ poisson random variabl fya sg index subset ya mean defin collect correl poisson random variabl also defin set abbrevi describ x collect aris natur context boolean model stochast geometri index set replac finit set condit point yb count number grain cover exactli subset b condit point other x fx g count number grain cover condit point x context motiv problem oil industri lantuejoul investig simul boolean model condit cover condit point question convert perfect simul discuss lead directli question conduct perfect simul correl poisson random variabl condit posit mcmc collect correl poisson random variabl condit posit carri mcmc fx replac random variabl immigr death process nonempti subset defin immigrationdeath process ya immigr rate unit death rate requir ya indepen dent detail balanc ya poisson equilibrium mean defin xa nonempti subset abbrevi equilibrium distribut fx collect correl poisson random variabl mcmc procedur straightforward simul ya process long time construct x use equat cours use sledgehamm crack nut reason sampl directli ya equilibria howev mcmc approach easili modifi allow condit consid alon process xa immigrationdeath process immigr rate unit death rate moreov xa e xb mean immigr xa time immigr xb time death xb time death xa time possibl establish convers follow given collect immigrationdeath process fxa sg satisfi relat coadapt sens ratecomput base condit common past independ immigrationdeath process ya immigr rate unit death rate construct equat appli use mobiu formula chapter page deduc aba consid modifi mcmc procedur produc correl poisson random variabl condit posit sinc underli markov chain revers done forbid transit lead one x becom zero way maintain coupl requir cftp method need prescrib replac death time potenti death time thu prevent becom actual accordingli introduc independ unitr poisson process za one nonempti subset s defin immigrationdeath process e ya base immigr death structur ya forbid death would lead one target random variabl becom zero name death time ya death time ya accept e ya set e furthermor use next incid za new potenti death time e ya call perpetu e time t interv t t perpetu interv perpetu time e ya summar e experi death t exist e perpetu take place particular perpetu increas e ya compar origin ya sinc use independ unit rate poisson process za t provid perpetu time e ya inherit unit death rate ya subject censorship transit would lead x defin e aba e e detail balanc show equilibrium distribut e collect correl poisson random variabl condit posit pseudocod mcmcccp display tabl give explicit descript deriv simul e x time interv a b realiz time interv initi e repeat e aia e ya index next incid next incid immigr e next incid death e e els label next zaincid death incid return algorithm mcmcccp perform mcmc obtain approxim sampl condit correl poisson random variabl use uncondit immigrationdeath process fya g associ perpetu poisson process fza g tabl mcmcccp algorithm extend statespac cftp gener context domin cftp present gener context paper requir modest extens extend statespac cftp describ gener context describ use get perfect sampl correl poisson random variabl condit posit aim obtain perfect sampl equilibrium distribut discret continu time markov chain take valu state space x difficulti markov chain r may uniformli ergod even relev partial order exist wish assum either monoton exist maxim minim element main idea overcom problem is insert origin unord statespac x subset bigger order space e x upperlowersandwich process live e x eventu absorb x evolut stochast process e r chosen visit x follow stochast dynam r specif identifi sequenc major process e r ident distribut shift time live superset e x x satisfi follow condit e x possess partial order relat e x b b so x base partial order space e e r n eventu absorb subspac x fix u n e r n evolv accord stochast dynam r hit x n e r m t e follow cftp result theorem suppos markov chain r take valu state space x r n live partial order superset e x x satisfi condit suppos rt converg weakli uniqu equilibrium distribut r n almost sure e equilibrium distribut proof follow equat condit almost sure equat condit n e r n e consequ condit e r n r t n accordingli e e r n exist almost sure condit fact e r n ident distribut time shift e r n equilibrium distribut rn lim r n r start time common hit distribut e r n x converg weakli therefor e r t distribut requir follow subsect describ construct e r n order tripl process next section show condit hold use e r n get perfect sampl desir distribut cftp correl poisson random variabl condit posit need introduc notat order explain howw use extend statespac cftp produc perfect sampl correl poisson random variabl condit posit x follow ntupl nonneg integersg e ntupl nonneg integ v min v max ntupl length k index nonempti subset s inequ v min v max interpret elementwis fact v v min v max contain entri embed x e x given partial order e x given exactli interpret equal inequ elementwis order e correspond exactli inclus order order interv use setvalu cftp and implicitli domin cftp earlier formul appar partial order embed x e preced theorem describ use uncondit immigrationdeath process y nonempti s assum statist equilibrium perpetu incid process za nonempti s construct realiz e r n time interv n note use timerevers ya extend trajectori far back past may requir fix valu time sampl uncondit poisson equilibrium process extens za even easier e r n ya uncondit immigrationdeath process assign subset a v nmin v nmax process defin togeth recurs follow way initi time n set nonempti s updat process occur death time correspond process perpetu time correspond z process conveni notat defin e e suppos ya experi death time respect may set equal danger caus zero opposit process e respect e mindeath e ya death would zero upper process e set lower compon maxdeath e ya death would zero lower process e set upper compon hand suppos za experi perpetu incid time t set v nmin respect v nmax equal danger caus zero opposit process e respect e minperpetu e danger zero upper process e set lower compon maxperpetu need consid follow two case case e set upper compon v nmax case e a set upper compon v nmax remain establish condit requir theorem shall next section first give brief descript cftp algo rithm begin test whether e r n lie x say whether nonempti s vector common valu x nmin return sampl correspond vector correl poisson random variabl condit posit exist v nmin v nmax must choos new start time n repeat simul replac n as suggest case sensibl choic doubl n note must insist extend backward way reus previou realiz note abov revers aris detail balanc technic assist here proceed extend backward time minim maxim process coalesc return common valu coalesc process time tabl give pseudocod summar result algorithm cftpccp properti cftp algorithm prove cftp algorithm cftpccp inde provid us perfect sampl desir distribut must establish sequenc lemma relat condit extend z n e r n e return els cftpccp algorithm perform extend statespac cftp obtain exact sampl condit correl poisson random variabl tabl cftpccp algorithm first must make sure condit appli say process e r n genuin stay statespac e x defin t v nmax t nonempti n particular statespac e r n taken e x first note construct equat must hold time n suppos equat hold to possibl includ time t therefor e s suffic consid either ya experi death time za deliv perpetu incid case death relationship crossov mindeath maxdeath assur us v nmin set v nmax is equat must also hold time t case perpetu incid entir similar perpetu happen upper lower process v nmax set v nmin is equat must also hold time t perpetu happen upper process alreadi v nmin hold matter valu t result follow induct set asid condit moment turn condit persist t time interv coupl process evolv copi e proof simpli matter observ v nmin v nmax coincid time e longer distinct min max condit mindeath maxdeath death min perpetu maxperpetu perpetu abov note case perpetu upper process happen more birth decis alreadi ident consequ time onward death perpetu decis v nmin v nmax must continu coincid furthermor effect death perpetu decis v nmin v nmax agre prescript evolut e descript mcmcccp algorithm tabl consid condit follow establish follow fun nell result lemma n nonempti t v nmin t v nmax t v mmax proof initi valu v mmin m v mmax m respect minim maxim funnel certainli hold time m consid therefor incid time m suppos funnel relationship hold time carri relationship e incid immigr v mmin v mmax v nmin v nmax affect relationship persist incid death examin mindeath show v mmin set v nmin set sinc e similar argument use maxdeath appli show v nmax set v mmax set incid perpetu upper lower process similar argument concern minperpetu maxperpetu show v nmin set v mmin set v mmax set v nmax set consid case incid perpetu upper process case follow lemma t v nmin t v nmax need prove t v mmax e accord maxperpetu t set v mmax hold e set v mmax e a two case consid case sinc v mmin actual know e henc also e a follow maxperpetu minperpetu condit case either v nmax e follow maxperpetu v nmax automat sinc perpetu time death time case hold mean funnel relationship persist time maintain time result follow induct along sequenc incid final turn condit consequ follow lemma lemma suffici larg n process v nmin v nmax coalesc time interv n proof lemma follow time upper process v nmax vanish construct follow coalesc occur time fix experi immigr time interv t increas event base independ event form ya immigr t fkg inequ theorem appli consequ hand p d i follow altern line reason construct estim base ya experienc immigr thu dispens fkg inequ suppos time event occur let famili subset ya experi least one immigr t occur union must cover s moreov clearli k member k perpetu valu among v t max s coalesc v t min v t max occur if yield perpetu val ue poisson process za experi incid time interv t t also ya hit zero time interv sinc v t max zero simpl stochast comparison use strong markov properti represent immigrationdeath process term poisson input exponenti death time show happen condit probabl condi tion let c event occur togeth event whose probabl given equat abov howev c actual independ event past time t may therefor appli second borelcantelli lemma show that almost sure infinit mani c r occur for follow coalesc almost sure happenth follow result immedi consequ lemma theorem exist uniqu limit equilibrium process e x x theorem algorithm describ x almost sure termin finit time moreov output algorithm distribut correspond array correl poisson random variabl condit posit work show cftp algorithm inde produc perfect sampl correspond collect correl poisson random variabl condit posit applic simul condit boolean model section show cftp algorithm use obtain perfect sampl condit boolean model relationship condit boolean model correl poisson random variabl condit posit recal section introduc distribut correl poisson random variabl show could obtain equilibrium distribut process x aia ya t independ immigrationdeath process ya t consid boolean model equilibrium distribut spatial immigrationdeath process appropri assign condit point rate process xb t interpret time evolv number germgrain pair whose grain cover condit point b process ya t describ number germgrain pair whose grain cover condit point a condit point a exampl count number germgrain pair whose grain cover condit point x divid process xb t count number germgrain pair whose grain cover x x fx x g t count number germ grain pair whose grain cover x x convert boolean model poisson process space mark use grain space germ lead grain cover x divid two disjoint subregion fxg t count number germ fall one subregion fx x g t count other thu number germgrain pair subregion associ immigr death process ya t independ immigrationdeath process condit appli mean forbid certain transit note process ya t might zero immigr rate condit boolean model correspond set condit point simultan cover singl germgrain pair case grain disk constant radiu least two point separ distanc greater r r radiu typic grain seen use perfect sampl condit correl poisson random variabl produc perfect sampl condit boolean model perfect simul condit boolean model sake simplic consid case disk constant radiu though method extend cover case typic grain random bound diamet perfect simul follow one establish simul sort incid time ya t za t essenc one simul stream candid incid time timevari intens incid time choos whether ztype type incid use appropri probabl timevari rate underli stream candid incid taken ya n total number process za assign type made deliv correspond rate ztype incid one assign type indic variou za process incid belong uniformli random type death incid one assign type indic variou ya process incid belong randomli weight size correspond ya type birth inci dent one choos locat uniformli random bound window w assign incid ya locat fall region x g ga g typic grain sinc correspond disk cover exactli condit point constitut index set a birth incid discard locat fall region perfect simul conduct accord algorithm cftpccp given tabl conclus algorithm perfectli sampl condit boolean model built use locat surviv birth incid supplement sampl uncondit boolean model region construct cover condit point thi done easili thin uncondit boolean model full region w follow consid plot condit boolean model obtain perfect simul method clearli given configur condit point radiu typic grain result affect valu intens give plot simul use vari pattern condit point random pattern obliqu lattic squar lattic medium high intens underli poisson germ process low intens less germ per unit area closelyspac condit point such grain cover one condit point algorithm fail coalesc within memori constraint comput sun ultra mbyte ram maximum minimum process take long time come agreement sinc initi perpetu maximum grain disappear minimum grain cover condit point itself rare event moreov perpetu minimum grain tend disappear quickli back zero sinc condit point typic cover sever perpetu maximum grain plot base intens germ per unit area gener featur display case mani extra grain induc requir cover condit point high intens result figur differ less uncondit case sinc much window cover anyway still excess grain cover condit point case comput number grain cover condit point excess number expect compar simul uncondit boolean model excess much larger case random pattern condit point reason sinc randomli scatter pattern affect much greater area window excess appear depend strongli underli germ intens come surpris excess gener algorithm mere sum perpetu grain notat section sinc va scope variat total excess limit note figur condit point mark perfect sampl condit boolean model place randomli window w width unit intens underli germ process radiu typic grain simul yield grain cover least one condit point uncondit model would yield poisson number grain mean number would expect cover least one point excess number grain condit boolean model cover condit point figur condit boolean model random pattern place randomli window w width unit intens underli germ process radiu typic grain simul yield grain cover least one condit point uncondit model would yield poisson number grain mean number would expect cover least one point excess number grain condit boolean model cover condit point figur condit boolean model random pattern point place lattic base parallelogram horizont side length height angl window w width unit intens underli germ process radiu typic grain simul yield grain cover least one condit point uncondit model would yield poisson number grain mean number would expect cover least one point excess number grain condit boolean model cover condit point figur condit boolean model parallelogram grid point place lattic base parallelogram horizont side length height angl window w width unit intens underli germ process radiu typic grain simul yield grain cover least one condit point uncondit model would yield poisson number grain mean number would expect cover least one point excess number grain condit boolean model cover condit point figur condit boolean model parallelogram grid point place squar lattic side length window w width unit intens underli germ process radiu typic grain simul yield grain cover least one condit point uncondit model would yield poisson number grain mean number would expect cover least one point excess number grain condit boolean model cover condit point figur condit boolean model squar grid perfect sampl condit boolean model point place squar lattic side length window w width unit intens underli germ process radiu typic grain simul yield grain cover least one condit point uncondit model would yield poisson number grain mean number would expect cover least one point excess number grain condit boolean model cover condit point figur condit boolean model squar grid check correct implement simul method alway check care protect mistak code well confirm theori section summar sever simpl exampl provid check correct method program implement c simul time interv initi case though cours algorithm extend back time requir window w unit squar g set disk radiu r intens germ process check correct case collect sampl carri test use appropri group follow report summar result full detail implement result deriv exact equilibrium distribut function exampl found associ research report avail preprint httpwwwwarwickacukstatsdeptstaffwskppthtml singl condit point result valu two separ condit point result valu two close condit point result valu three close condit point fold symmetri g place three point configur fold symmetri result valu none valu signific investig algorithm perform section carri experi explor way runtim perfect simul algorithm depend variou paramet follow analysi section uncondit process ya spatial immigrationdeath process constant immigr rate unit death rate ea ea given equat recal k number condit point r radiu typic grain section investig depend c r k note throughout section use actual coalesc time c time produc doubl perform algorithm cftpccp experi depend coalesc time grain radiu hold fix intens germ process number condit point investig relat coalesc time c radiu r typic grain place set condit point vertic squar sidelength unitwidth window w obtain independ sampl size equal space valu r rang figur plot logsampl mean coalesc time versu r the dot line includ two theoret deriv asymptot the curv solid line small ra diu horizont solid line larg radiu discontinu sampl curv signal effect possibl singl grain cover sever condit point theoret asymptot deriv follow first consid case grain small one grain cover one condit point r relev ya k process fig singleton independ other coalesc occur exactli fig experienc death time perpetu v max fig individu fig first event occur approxim first instanc poisson process rate r independ thin delet probabl use approxim thin process also poisson process rate r therefor altern extrem larg r r condit point like cover one disk uncondit boolean model coverag probabl one condit point time zero coverag event posit correl accordingli coalesc time c approxim maximum first perpetu time n ya process depend grain radiu r deduc follow theoret asymptot mean coalesc time small r larg r radiu logmean coalesc time figur graph logsampl mean c versu grain radiu r fix condit point valu reason big jump follow possibl one grain cover one condit point jump show cost pay consequ interact e process experi depend coalesc time intens hold fix radiu typic grain number condit point investig relat coalesc time c intens germ process place set vertic squar sidelength unitwidth window w obtain independ sampl size equal space valu rang figur plot logsampl mean coalesc time versu dot line includ two theoret deriv asymptot solid line theoret asymptot deriv essenti experi follow first consid case larg condit point like cover singl disk uncondit boolean model so argument experi coalesc time c also approxim maximum n first perpetu time ya process henc mean approxim asymptot independ valu hand small valu coalesc time c depend valu r experi take r follow argument experi larg distribut c approxim given asymptot henc approxim theoret mean given view function intens logmean coalesc time figur graph logsampl mean c versu intens fix condit point radiu grain experi depend coalesc time number condit point hold fix intens germ process radiu r typic grain investig relat coalesc time c number condit point unitwidth window w k small like singl grain cover one condit point long r larg therefor small k distribut c also approxim equat henc mean given asymptot view function k hand k larg disk uncondit boolean model like cover least one condit point distribut c case approxim equat again n number ya process s henc mean given asymptot view function k illustr relat c k r small experi design follow take condit point vertic rectangl unitwidth window w rectangular width length obtain independ sampl size k set grain cover one condit point therefor case would expect sampl mean versu k agre approxim theoret mean curv given asymptot confirm plot sampl mean dot line two asymptot theoret mean versu number condit point k figur mean coalesc time figur graph sampl mean c versu k fix valu grain experi depend actual durat algorithm intens final investig relat actual durat wallclock time algorithm r k experi record independ actual durat time collect one sampl valu r k plot averag durat time confid limit mean versu r k respect follow figur first consid durat time experi theoret argument suggest mean durat time convex function grain radiu r tend infin r posit constant r simul support conclus also show signific featur depend occur rel small rang r figur plot logsampl mean realiz confid limit mean rang r see two peak correspond two valu correspond follow observ r increas possibl one grain cover condit point r increas becom possibl one grain cover condit point consid depend mean durat time intens experi gain similar theoret pictur except larg intens mean durat time increas minimum sinc algorithm need time deal incid ya za process increas figur plot logsampl mean realiz confid limit mean confirm argument theori sharp increas durat time intens reduc mirror ex radiu log actual duation in second algorithm figur graph logmean actual durat in second confid limit realiz algorithm versu r fix valu two peak correspond two valu r one grain cover two four condit point respect perienc largerscal simul display figur particularli failur algorithm produc coalesc low intens case thing much simpler case depend number condit point k experi experi fix case e process independ other therefor need h amount time coalesc condit point total amount time coalesc k condit point approxim kh figur plot logsampl mean realiz confid limit mean figur show actual time increas number condit point increas agreement abov conclus paper present perfect simul method correl poisson random variabl condit posit work gener context as oppos geometr context made algorithm simpler implement present moreov although method paper fall categori domin cftp defin kendal moller nevertheless modest variat it paper domin occur respect partial order defin state space lower upper sandwich process domin process extend state space form ya za s cannot give theoret bound rang paramet involv particular kind perfect simul may seen result section intens log actual duation in second algorithm figur graph logmean actual durat in second confid limit realiz algorithm versu fix valu number k log actual duation in second algorithm figur graph logmean actual durat in second confid limit realiz algorithm versu k fix valu lowintens condit boolean model present challeng particular perfect simul algorithm overcom cours contrast convent mcmc method perfect simul clearli indic fail give correct answer convent mcmc may fail without overt warn howev overst firstli price pay cftp cftp method may fail judici chosen mcmc algorithm still give good answer secondli cftp exhibit bia user liabl termin run earli overcom fill reject method gener point process context though wilson point one us problem remain timevari due simul point process part point process algorithm despit caveat perfect simul remain attract member statistician toolbox algorithm deliv promis medium high intens condit boolean model develop particular problem perfect simul condit boolean model lead consider condit constraint base connect perfect simul situat like prove difficult sinc condit appear involv arbitrarili larg number extra grain work perfect simul gibb point process taken care test simul program care particular issu perfect simul implement inevit complic straightforward mcmc algorithm rais interest issu best test correct case concentr straightforward test compat simpl theoret asymptot give detail pseudolikelihood approach deal directli coupl random process lie heart sim ulat hope return issu later work ramif beyond perfect simul gener issu program complic simul acknowledg research support epsrc grant grl eu tmr network erbfmrxct comput statist method analysi spatial data r asymptot techniqu use statist effici markovian coupl exampl counterexampl perfect implement simul condit boolean model via correl poisson random variabl interrupt algorithm exact sampl via markov chain weight boolean model perfect simul spatial point process perfect simul areainteract point process perfect implement metropolishast simul markov point process perfect simul point process use metropolishast algorithm perfect simul stochast geometri exact sampl coupl markov chain applic statist mechan perfect simul point process impati user tr ctr jame d brown gerard b m heuvelink data uncertainti engin due softwar tool assess simul uncertain environment variabl comput geoscienc v n p februari