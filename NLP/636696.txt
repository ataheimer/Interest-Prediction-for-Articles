t effici protocol authent key agreement a paper propos effici twopass protocol authent key agreement asymmetr publickey set protocol base diffiehellman key agreement modifi work arbitrari finit group and particular ellipt curv group two modif protocol also present onepass authent key agreement protocol suitabl environ one entiti onlin threepass protocol key confirm addit provid variant protocol standard ieee p ansi x ansi x iso current consider standard us govern nation institut standard technolog b introduct key establish process two or more entiti establish share secret key key subsequ use achiev cryptograph goal confidenti data integr broadli speak two kind key establish protocol key transport protocol key creat one entiti secur transmit second entiti key agreement protocol parti contribut inform jointli establish share secret key paper shall consid key agreement protocol asymmetr publickey twoentiti set let b two honest entiti ie legitim entiti execut step protocol correctli inform speak key agreement protocol said provid implicit key authent of b a entiti assur entiti asid specif identifi second entiti b possibl learn valu particular secret key note properti implicit key authent necessarili mean assur b actual possess key key agreement protocol provid implicit key authent particip entiti call authent key agreement ak protocol inform speak key agreement protocol said provid key confirm of b assur second entiti b actual possess particular secret key implicit key authent key confirm of b provid key establish protocol said provid explicit key authent of b a key agreement protocol provid explicit key authent particip entiti call authent key agreement key confirm akc protocol extens survey key establish see chapter menez van oorschot vanston extrem care must exercis separ key confirm implicit key authen ticat ak protocol offer key confirm use then point desir agre key confirm prior cryptograph use done varieti way exampl key subsequ use achiev confiden tialiti encrypt key begin care chosen known data system may provid key confirm realtim telephon convers separ key confirm implicit key authent sometim desir permit flexibl particular implement choos achiev key confirm thu move burden key confirm establish mechan applic paper propos new effici twopass ak protocol protocol base diffiehellman key agreement mani desir secur perform attribut discuss see x two modif protocol also present onepass ak protocol suitabl environ one entiti onlin threepass protocol key confirm addit provid protocol describ paper establish share secret k two entiti deriv function use deriv secret key share secret necessari k may weak bit bit inform k predict correctli nonneglig advantag one way deriv secret key k appli oneway hash function sha k except protocol x paper includ key deriv function protocol descript protocol describ paper describ set group point ellipt curv defin finit field howev easili modifi work finit group discret logarithm problem appear intract suitabl choic includ multipl group finit field subgroup z n n composit integ subgroup z p prime order q ellipt curv group advantag offer equival secur group smaller key size faster comput time remaind paper organ follow x discuss desir attribut ak akc protocol x describ ellipt curv paramet common entiti involv protocol public key method valid them x review mti protocol describ activ attack them attack influenc design new twopass ak protocol present x x present onepass variant protocol threepass variant provid explicit key authent final x make conclud remark desir attribut ak akc protocol numer diffiehellmanbas ak akc protocol propos year how ever mani subsequ found secur flaw main problem appropri threat model goal secur ak akc protocol lack formal defini tion blakewilson johnson menez adapt earlier work bellar rogaway symmetr set provid formal model distribut comput rigor definit goal secur ak akc protocol within model concret ak akc protocol propos proven secur within framework random oracl model paper follow definit goal secur ak akc protocol describ inform x classif threat secur protocol abl withstand passiv attack where adversari attempt prevent protocol achiev goal mere observ honest entiti carri protocol activ attack where adversari addit subvert commun inject delet alter replay messag addit implicit authent key confirm number desir secur attribut ak akc protocol identifi see discuss these knownkey secur run key agreement protocol two entiti b produc uniqu secret key key call session key protocol still achiev goal face adversari learn session key perfect forward secreci longterm privat key one entiti compromis secreci previou session key establish honest entiti affect keycompromis imperson suppos as longterm privat key disclos clearli adversari know valu imperson a sinc precis valu identifi a howev may desir loss enabl adversari imperson entiti a unknown keyshar entiti cannot coerc share key entiti b without as knowledg ie believ key share entiti c b b correctli believ key share a key control neither entiti abl forc session key preselect valu desir perform attribut ak akc protocol includ minim number the number messag exchang run protocol low commun overhead total number bit transmit low comput overhead attribut may desir circumst includ rolesymmetri the messag transmit entiti structur noninteract the messag transmit two entiti independ other nonreli encrypt to meet export requir hash function sinc notori hard design timestamp sinc difficult implement secur practic domain paramet key pair gener section describ ellipt curv paramet common entiti involv protocol ie domain paramet key pair entiti domain paramet domain paramet protocol describ paper consist suitabl chosen ellipt curv e defin finit field f q characterist p base point remaind subsect elabor suitabl paramet are outlin procedur verifi given set paramet meet requir order avoid pollardrho pohlighellman algorithm ellipt curv discret logarithm problem ecdlp necessari number f q ration point e denot ef q divis suffici larg prime n write commonli recommend n see fix underli field f q n select larg possibl ie one n q ef q almost prime remaind paper shall assum n n p q hass theorem henc impli n divid ef q thu ef q uniqu subgroup order n also sinc uniqu integ h name guard potenti small subgroup attack see x point p order n precaut exercis select ellipt curv avoid reduct algorithm menez okamoto vanston frey ruck curv nonsupersingular ie p divid q gener one verifi n divid q larg enough comput infeas find discret logarithm f q c suffic practic avoid attack semaev smart satoh araki f q anomal curv curv f q anomal ie ef q q prudent way guard attack similar attack special class curv may discov futur select ellipt curv e random subject condit ef q divis larg prime probabl random curv succumb specialpurpos attack neglig curv select verifi random choos coeffici defin ellipt curv equat output oneway function sha accord prespecifi procedur procedur accomplish thi similar spirit method given fip select dsa prime verifi random describ ansi x summar domain paramet compris of field size q q prime power in practic either odd prime indic fr field represent represent use element f q two field element b f q defin equat ellipt curv e f q ie case p case two field element x p p f q defin finit point prime order ef q sinc p describ two field element impli p o denot point infin order n point p cofactor domain paramet valid set domain paramet q fr a b verifi meet requir follow process call domain paramet valid verifi q prime power verifi fr valid field represent verifi a b x p p element f q ie verifi proper format element f q verifi b defin nonsingular ellipt curv f q ie case p b case verifi p satisfi defin equat e and p o verifi n p q n prime n suffici larg eg n verifi comput verifi ensur protect known attack special class ellipt curv verifi n divid q n q key pair gener given valid set domain paramet q fr a b h entiti as privat key integ select random interv n gamma as public key ellipt curv point key pair q d run key agreement protocol two entiti b produc uniqu share secret key henc protocol describ paper entiti two public key static longterm public key ephemer shortterm public key static public key bound entiti certain period time typic use certif new ephemer public key gener run protocol as static key pair denot wa wa as ephemer key pair denot remaind paper assum static public key exchang via certif cert denot as publickey certif contain string inform uniqu identifi such as name address static public key wa certifi author ca signatur inform avoid potenti unknown keyshar attack see x ca verifi possess privat key wa correspond static public key wa inform may includ data portion certif includ domain paramet known context entiti b use authent copi ca public key verifi as certif therebi obtain authent copi as static public key publickey valid use entiti purport public key q prudent verifi possess arithmet properti suppos name q finit point subgroup gener p process call publickey valid given valid set domain paramet q fr a b purport public key valid verifi that q equal o xq q element field f q ie proper format element q satisfi defin equat e embed publickey valid comput expens oper publickey valid scalar multipl step static public key valid could done ca howev sinc new ephemer key gener run protocol valid ephemer key place signific burden entiti perform valid reduc burden step omit key valid instead protocol propos x x ensur share secret k gener finit point subgroup gener p summar given valid set domain paramet embed publickey valid purport public key accomplish verifi that q equal o xq q element field f q ie proper format element f q q satisfi defin equat e mti key agreement protocol mtia mtic key agreement protocol describ special case three infinit famili key agreement protocol propos matsumoto takashima imai design provid implicit key authent provid key confirm close relat protocol kea propos goss yacobi latter oper ring integ modulo composit integ yacobi prove protocol secur certain type knownkey attack passiv adversari provid composit modulu diffiehellman problem intract howev desmedt burmest point secur heurist knownkey attack activ adversari section illustr mtia mtic famili protocol vulner sever activ attack small subgroup attack present x illustr mtic protocol as origin describ provid implicit key authent unknown attack present x illustr mtia protocol possess unknown keyshar attribut circumst activ attack ak protocol discuss diffi van oorschot wiener burmest vaudenay lim lee small subgroup attack small subgroup attack first point vanston see also van oorschot wiener anderson vaudenay lim lee attack illustr authent valid static ephemer key prudent sometim essenti measur take diffiehellman ak protocol illustr small subgroup attack mtic protocol protocol assum b priori possess authent copi other static public key mtic ak protocol gener random integ r comput point send b b gener random integ r comput point send tb a comput r b comput share secret point k small subgroup attack launch order n base point p prime say attack forc share secret one small known subset point small subgroup attack mtic protocol e intercept as messag replac e intercept bs messag tb replac mtb comput r mtb b comput k lie subgroup order group gener p henc take one possibl valu sinc valu k correctli guess e high probabl show mtic protocol provid implicit key authent effect especi drastic subsequ key confirm phase may fail detect attack e may abl correctli comput messag requir key confirm exampl e may abl comput behalf messag authent code mac k messag consist ident b ephemer point purportedli sent a point sent b small subgroup attack mtic prevent exampl mandat use base point p prime order requir b perform key valid ephemer public key receiv case static privat key w select subject condit unknown keyshar attack activ attack mtia protocol describ subsect first point menez qu vanston attack mani variant it illustr prudent requir entiti prove possess privat key correspond static public key ca ca certifi public key belong a proof possess accomplish zeroknowledg techniqu exampl see chaum everts van de graaf mtia ak protocol gener random integ r comput point send ra cert b b gener random integ r comput point send rb cert b a comput b comput share secret point k one variant unknown keyshar attack adversari e wish messag sent b identifi origin e herself accomplish thi e select integ e e get certifi public key notic e know logic privat key correspond public key assum cours discret logarithm problem ef q intract although know e unknown keyshar attack mtia protocol e intercept as messag ra cert replac ra cert e b send rb cert b e forward erb cert b a comput b comput b share secret k even though b believ share secret e note learn valu k henc attack illustr mtia protocol possess unknown keyshar attribut hypothet scenario attack may launch success follow scenario first describ diffi van oorschot wiener suppos b bank branch account holder certif issu bank headquart within certif account inform holder suppos protocol electron deposit fund exchang key bank branch via mutual authent key agreement b authent transmit entiti encrypt fund deposit account number certif suppos authent done encrypt deposit messag which might case save bandwidth attack mention success launch deposit made es account instead as account new authent key agreement protocol section twopass ak protocol describ follow notat use x x f denot bitlength n prime order base point q finit ellipt curv point q defin follow let x xcoordin q let x integ obtain binari represent x the valu x depend represent chosen element field f q q defin integ observ q mod n protocol descript describ twopass ak protocol protocol optim refin protocol first describ menez qu vanston depict figur subsequ figur w awa denot as static privat key static public key wa wa respect domain paramet static key set valid describ x b priori possess authent copi other static public certif includ flow ra figur twopass ak protocol protocol protocol gener random integ r comput point send b b gener random integ r comput point send a embed key valid rb see x valid fail termin protocol run failur otherwis comput termin protocol run failur b embed key valid ra valid fail b termin protocol run failur otherwis b comput termin protocol run failur share secret point k secur note rational although secur protocol formal proven model distribut comput heurist argument suggest protocol provid mutual implicit key authenti cation addit protocol appear secur attribut knownkey secur forward secreci keycompromis imperson key control list x anoth secur attribut protocol compromis ephemer privat key r r b reveal neither static privat key wa wb share secret k kaliski recent observ protocol possess unknown keyshar attribut demonstr follow onlin attack adversari e intercept as ephemer public key ra intend b comput certifi static public key note e know correspond privat key transmit b b respond send rb e e forward a b comput secret k howev b mistakenli believ share k e emphas lack unknown keyshar attribut contradict fundament goal mutual implicit key authent definit provis implicit key authent consid case b engag protocol honest entiti which e isnt applic use protocol concern lack unknown keyshar attribut onlin attack appropri confirm ad exampl specifi protocol protocol view direct extens ordinari unauthent diffiehellman agreement protocol quantiti b serv implicit signatur as ephemer public key ra bs ephemer public key rb respect share secret rather r r bp would case ordinari diffiehellman express ra use half bit xcoordin ra done order increas effici comput k scalar multipl rawa done half time full scalar multipl modif appear affect secur protocol definit ra impli ra ensur contribut static privat key wa cancel format multipl h ensur share secret k see equat point subgroup order n ef q check ensur k finit point protocol use agre upon kbit key subsequ use symmetrickey block cipher recommend ellipt curv chosen n k protocol desir perform attribut list x as point view domin comput step run protocol scalar multipl r ap rbwb hsa rb rbwb henc work requir entiti full scalar mul tiplic sinc r ap comput offlin a onlin work requir entiti scalar multipl addit protocol low commun overhead rolesymmetr noninteract use encrypt timestamp hash function may use key deriv function to deriv session key share secret k secur protocol appear less reliant cryptograph strength hash function ak protocol such protocol particular requir key deriv function preimag resist appear unnecessari non relianc hash function advantag histori shown secur hash function difficult design relat protocol section present two relat protocol onepass ak protocol protocol threepass akc protocol protocol onepass authent key agreement protocol purpos onepass ak protocol protocol entiti b establish share secret transmit one messag b use applic one entiti onlin secur email storeandforward protocol depict figur assum priori authent copi bs static public key domain paramet static key set valid describ x ra figur onepass ak protocol protocol protocol gener random integ r comput point send b comput termin protocol run failur b embed key valid ra see x valid fail b termin protocol run failur otherwis b comput n termin protocol run failur share secret point k heurist argument suggest protocol offer mutual implicit key authent main secur drawback protocol knownkey secur forward secreci sinc entiti b contribut random permessag compon cours case onepass key agreement protocol authent key agreement key confirm protocol describ akc variant protocol depict figur domain paramet static key set valid describ x here mac messag authent code algorithm use provid key confirm exampl provabl secur practic mac algorithm see bellar canetti krawczyk bellar guerin rogaway bellar kilian rogaway h independ key deriv function practic instanti h includ h protocol gener random integ r comput point send b b embed key valid ra see x valid fail b termin protocol run failur otherwis b gener random integ r comput point ra figur threepass akc protocol protocol b termin protocol run failur share secret k b use xcoordin z point k comput two share z z send togeth rb a embed key valid rb valid fail termin protocol run failur otherwis comput termin protocol run failur use xcoordin z point k comput two share z z comput mac verifi equal sent b comput mac send b b comput mac verifi equal sent a session key akc protocol deriv ak protocol ad key confirm latter done exactli way akc protocol deriv ak protocol protocol formal proven secur akc protocol heurist argument suggest protocol paper secur akc protocol addit desir secur attribut list x conclud remark paper present new ak akc protocol possess mani desir secur attribut extrem effici appear place less burden secur key deriv function propos neither protocol propos formal proven possess claim level secur heurist argument suggest case hope protocol appropri modif them can plausibl assumpt proven secur model distribut comput introduc acknowledg author would like thank simon blakewilson johnson comment earlier draft paper ms law dr solina would like acknowledg contribut colleagu nation secur agenc r mind ps qs key hash function messag authenti cation xor mac new method messag authent use finit pseudorandom function the secur cipher block chain random oracl practic paradigm design effici protocol entiti authent key distribut key agreement protocol secur analysi on risk open distribut key an improv protocol demonstr possess discret logarithm gener toward practic proven secur authent key distri bution new direct cryptographi authent authent key ex chang a remark concern mdivis discret logarithm divisor class group curv cryptograph method apparatu public key exchang authenti cation contribut ansi xf work group authent multiparti key agreement contribut ansi xf ieee p work group a key recoveri attack discret logbas scheme use prime order subgroup on seek smart publickey distribut sy tem reduc ellipt curv logarithm logarithm finit field some new key agreement protocol provid mutual implicit authent key agreement need authent handbook appli cryptographi secur hash standard sh digit signatur standard skipjack kea algorithm specif an improv algorithm comput logarithm gf p cryptograph signific mont carlo method index comput mod p fermat quotient polynomi time discret log algorithm anomal ellipt curv evalu discret logarithm group ptorsion point ellipt curv characterist p the discret logarithm problem ellipt curv trace one on diffiehellman key agreement short expo nent a key distribut paradox tr ctr johann groschdl alexand szeke stefan tillich energi cost cryptograph key establish wireless sensor network proceed nd acm symposium inform comput commun secur march singapor kyungah shim sung sik woo cryptanalysi tripartit multiparti authent key agreement protocol inform scienc intern journal v n p februari kyungah shim vulner gener mqv key agreement protocol without use oneway hash function comput standard interfac v n p may maurizio adriano strangio effici diffiehellmann twoparti key agreement protocol base ellipt curv proceed acm symposium appli comput march santa fe new mexico mario di raimondo rosario gennaro hugo krawczyk secur offtherecord messag proceed acm workshop privaci electron societi novemb alexandria va usa