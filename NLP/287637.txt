t comput rankrev qr factor dens matric a develop algorithm implement comput rankrev qr rrqr factor dens matric first develop effici block algorithm approxim rrqr factor employ window version commonli use golub pivot strategi aid increment condit estim second develop effici implement variant guarante reliabl rrqr algorithm triangular matric origin suggest chandrasekaran ipsen pan tang suggest algorithm improv respect condit estim termin criteria given updat combin block algorithm one triangular postprocess step arriv effici reliabl algorithm comput rrqr factor dens matrix experiment result ibm rs sgi r platform show approach perform three time faster less reliabl qr factor column pivot current implement lapack come within perform lapack block algorithm comput qr factor without column exchang thu expect routin use may circumst numer rank defici cannot rule out current ignor comput cost deal it b introduct briefli summar properti rankrev qr factor rrqr factor let theta n matrix wlog n singular valu defin numer rank r respect threshold follow oe r oe r also let qr factor form r r p permut matrix q orthonorm column r upper triangular r order r further let a denot twonorm condit number matrix a say rrqr factor follow properti satisfi whenev welldetermin gap singular valu spectrum oe r oe r henc numer rank r well defin rrqr factor reveal numer rank wellcondit lead submatrix r trail submatrix r small norm also note matrix gammai easili comput usual good approxim nullvector step subspac iter suffic comput nullvector correct work precis chan hansen rrqr factor valuabl tool numer linear algebra provid accur inform rank numer nullspac main use aris solut rankdefici leastsquar problem exampl geodesi golub et al computeraid design grandin nonlinear leastsquar problem more solut integr equat elden schreiber calcul spline grandin applic aris beamform bischof shroff spectral estim hsieh et al regular hansen hansen et al walden stewart suggest anoth altern singular valu decomposit svd complet orthogon decomposit call urv decomposit factor decompos r r u v orthogon kr k kr k order oe r particular compar rrqr factor urv decomposit employ gener orthogon matrix v instead permut matrix p urv decomposit expens comput well suit nullspac updat ing rrqr factor hand suit leastsquar set sinc one need store orthogon matrix v the orthogon matrix usual appli righthand side on fli cours rrqr factor use comput initi urv decomposit briefli review histori rrqr algorithm interlac theorem singular valu golub loan corollari oe henc satisfi condit need pursu two task task find permut p maxim oe min r task find permut p minim oe max r busing golub suggest commonli call qr factor column pivot given set alreadi select column algorithm choos next pivot column one farthest away euclidean norm subspac span column alreadi chosen golub loan p p intuit strategi address task greedi algorithm known fail socal kahan matric golub loan p exampl work well practic form basi linpack dongarra et al lapack anderson et al a anderson et al b implement recent quintanaorti sun bischof develop implement busingergolub algorithm allow half work perform bla kernel bischof also develop restrictedpivot variant busingergolub strategi enabl use bla type kernel almost work reduc commun cost distributedmemori machin one approach task base essenc follow fact prove chan hansen lemma r ir nthetan w nthetap nonsingular mean determin matrix w p linearli independ column lie approxim nullspac r ie krwk small w well condit oe min w larg guarante element bottom right p theta p block r small algorithm base comput wellcondit nullspac base includ golub klema stewart chan foster algorithm address task stewart gragg stewart algorithm address task includ chan hansen golub klema stewart fact latter achiev task task and therefor reveal rank expens comparison other bischof hansen combin restrictedpivot strategi chan algorithm chan arriv algorithm spars matric bischof hansen also develop blockvari chan algorithm bischof hansen fortran implement chan algorithm provid reichel gragg chan algorithm chan guarante is long rank matrix close n algorithm guarante produc reliabl bound reliabl may decreas rank matrix hong pan show exist permut matrix p triangular factor r partit oe min r loword polynomi n r versu exponenti factor chan algorithm chandrasekaran ipsen first develop rrqr algorithm satisfi paper also review provid common framework previous devis strategi particular introduc socal unif principl say run task algorithm row invers matrix yield task algorithm suggest hybrid algorithm altern task task step refin separ singular valu r pan tang gu eisenstat present differ class algorithm achiev address possibl nontermin algorithm floatingpoint inaccuraci goal work develop effici reliabl rrqr algorithm implement suitabl inclus numer librari lapack specif wish develop implement reliabl close perform qr factor without pivot implement would provid algorithm develop effici tool address potenti numer rank defici minim comput penalti address potenti rank defici strategi involv follow ingredi an effici blockalgorithm comput approxim rrqr factor base work bischof effici implement rrqr algorithm well suit triangular matric base work chandrasekaran ipsen pan tang algorithm seem better suit triangular matric suggest gu eisenstat expect foreach ng re minm n let pvt n respvt maxim foreach ng re j re end foreach end fig qr factor algorithm tradit column pivot in case approxim rrqr factor comput block algorithm close desir rrqr factor requir littl postpro cess the almost entir bla base preprocess algorithm perform consider faster qr factor column pivot close perform qr factor without pivot paper structur follow next section review block algorithm comput approxim rrqr factor base restrict pivot approach section describ modif chandrasekaran ipsen hybridiii algorithm pan tang algorithm section present experiment result ibm rs sgi r platform section summar result block qr factor restrict pivot section describ block qr factor algorithm employ restrict pivot strategi approxim comput rrqr factor employ idea describ bischof comput q sequenc household matric given vector x choos vector u first canon unit vector j ff see examplegolub loan p applic household matrix b hua involv matrixvector product z u rankon updat b gamma uz figur describ busingergolub household qr factor algorithm tradit column pivot busing golub comput qr decomposit theta n matrix a primit oper u y genhhx comput u hux multipl e primit oper step complet valu re length project j th column current permut ap onto orthogon complement subspac span first column ap valu re j updat easili recomput everi step although e e e e e e fig restrict pivot block algorithm roundoff error may make necessari recomput re period dongarra et al p we suppress detail line figur bulk computationalwork algorithm perform apphh ker nel reli matrixvector oper howev today cachebas architectur rang workstat supercomput matrixmatrix oper perform much better matrixmatrix oper exploit use socal block algorithm whose toplevel unit comput matrix block instead vector algorithm play central role exampl lapack implement anderson et al a anderson et al b lapack employ socal compact wy represent product household matric schreiber van loan express product seri theta household matric theta nb matrix nb theta nb upper triangular matrix stabl implement gener household vector well form appli compact wy factor provid lapack arriv block qr factor algorithm would like avoid updat part sever household transform comput strategi imposs tradit pivot sinc must updat re j choos next pivot column modifi tradit approach half work use block transform best these issu discuss detail quintanaorti et al therefor instead limit scope pivot suggest bischof thu updat remain column comput enough household transform make block updat worthwhil idea graphic depict figur given stage done column left pivot window tri select next pivot column exclus column pivot window touch part right pivot window combin household vector defin next batch pivot column compact wy factor appli block updat column right sinc lead block r suppos approxim larg singular valu a must abl guard pivot column close span column alreadi select is given upper triangular matrix r defin first column q ap new column determin new candid pivot column must determin whether condit number larger threshold defin consid rankdefici matrix approxim oe r easi comput cheapli estim oe min r i employ increment condit estim ice bischof bischof tang given good estim b oe min r defin larg norm solut x r new column increment condit estim k flop comput c oe min r oe min r sx c stabl implement ice base formul bischof tang provid lapack routin xlaic ice order magnitud cheaper condit estim see exampl higham more over consider reliabl simpli use j fl j estim oe min r i see exampl bischof also defin b oe min r restrict block pivot algorithm proce four phase phase pivot largest column first posit step motiv fact norm largest column usual good estim phase block qr factor restrict pivot given desir block size nb window size ws ws nb tri gener nb household transform appli busingergolub pivot strategi column pivot window use ice assess impact column select condit number via ice pivot column chosen pivot window would lead lead triangular factor whose condit number exce mark remain column pivot window k say reject pivot end matrix gener block transform of width nb appli remaind matrix reposit pivot window sequel use conventionthat prefix x gener refer appropri one four differ precis instanti slaic dlaic claic zlaic encompass next ws yet reject column column either accept part lead triangular factor reject stage algorithm phase stop assum includ r column lead triangular factor point comput r theta r upper triangular matrix r satisfi is r estim numer rank respect threshold point experi chose choic tri ensur suitabl pivot window loosen up bit matrix size increas pivot window larg reduc perform overhead gener block orthogon transform larger number unblock oper hand pivot window small reduc pivot flexibl thu increas likelihood restrict pivot strategi fail produc good approxim rrqr factor experi choic w small impact not overal perform neglig impact numer behavior phase tradit pivot strategi among reject column sinc phase reject remain column pivot window pivot candid reject column may pivot end reject henc continu tradit busingergolub pivot strategi remain updat estim condit number phase end column r say inclus next pivot column would push condit number beyond threshold expect mani column if ani select phase mainli intend cheap safeguard possibl failur initi restrictedpivot strategi phase block qr factor without pivot remain column column yet factor column r great probabl linearli depend previou one sinc reject phase phase henc unlik kind column exchang among remain column would chang rank estim standard bla block qr factor implement lapack routin xgeqrf fastest way complet triangular complet phase comput qr factor kthat satisfi column r r n r r result suggest qr factor good approxim rrqr factor r good estim rank howev qr factor guarante reveal numer rank correctli thu back algorithm guarante reliabl rrqr implement introduc next two section postprocess algorithm approxim rrqr factor izat chandrasekaran ipsen introduc unifi framework rrqr algorithm develop algorithm guarante satisfi thu properli reveal rank algorithm assum initi matrix triangular thu well suit postprocess step algorithm present prexed section shortli thereaft pan tang introduc anoth guarante reliabl rrqr algorithm triangular matric follow subsect describ improv implement algorithm rrqr algorithm pan tang implement variant pan tang call algorithm pseudocod algorithm shown figur assum input upper triangular matrix r pi r i denot right cyclic permut exchang column j eg denot left cyclic permut exchang column j ie j j algorithm triua denot upper triangular factor r qr factor qr a seen figur use notat shorthand retriangular r column exchang given valu k socal ffactor algorithm guarante halt produc triangular factor satisfi oe min r oe r f implement incorpor follow featur increment condit estim ice use arriv estim smallest singular valu vector thu oe line v line figur comput inexpens u line use ice significantli reduc implement cost qr factor updat line must perform iftest line thu delay possibl algorithm termin column need check new permut must occur pan tang algorithm recheck column algorithm u left singular vector correspond oe min r k k accept col r triur delta pi r comput accept col accept col els v right singular vector correspond oe find index q q r triur delta pi l u left singular vector correspond oe min rk k end i n end fig variant pantang rrqr algorithm permut alway start column k instead begin check column right one caus permut thu first concentr column work over left cyclic shift permut triangular matrix upper hessenberg form retriangular given rotat appli given rotat row r obviou fashion as done exampl re ichel gragg expens term data movement columnori natur fortran data layout thu appli given rotat aggreg fashion updat matrix strip r jb j gammab jb width b previous comput given rotat similarli right cyclic shift introduc spike column j elimin given rotat bottomup fashion aggreg given rotat first comput rotat touch spike diagon r appli one block column time experi choos width b matrix strip blocksiz nb preprocess compar straightforward implement pan tang algorithm improv averag decreas runtim factor five theta matric alliant fx retriangular frequent improv notic impact result twofold fourfold perform gain matric order ibm rs pan tang introduc ffactor prevent cycl algorithm higher f is tighter bound better approxim k k st singular valu r howev f larg introduc column exchang therefor iter and roundoff error might present converg problem use work algorithm repeat golubisffk golubisffk chaniisffk none four subalgorithm modifi column order fig variant chandrasekaranipsen hybridiii algorithm algorithm golubisffk find smallest index j k j n krk j jk r triur delta pi r end fig ffactor variant golubi algorithm rrqr algorithm chandrasekaran ipsen chandrasekaran ipsen introduc algorithm achiev bound implement variant socal hybridiii algorithm pseudocod shown figur compar origin hybridiii algorithm implement incorpor follow featur employ chanii strategi an on algorithm instead socal stewartii strategi an on algorithm need invers ipsen chandrasekaran employ experi origin hybridiii algorithm contain two subloop first one loop golubik chaniik till converg second one loop golubik chaniik present differ loop order variant one simpler seem enhanc converg matric requir consider postprocess new loop order requir less step theta matric one step call golubi chan ii chandrasekaran ipsen origin algorithm addit new order speed detect converg shown below algorithm v right singular vector correspond oe min rk k find largest index f delta jv r triur delta pi l end fig ffactor variant chanii algorithm implement pantang algorithm use ice estim singular valu vector effici aggreg given scheme retriangular employ gener ffactor techniqu guarante termin presenc round error pivot method assign everi column weight name krk golubik v chaniik v right singular vector correspond smallest singular valu ensur termin chandrasekaran ipsen suggest pivot column weight exceed current column least n ffl ffl comput precis analyz impact chang bound obtain algorithm contrast use multipl toler factor f like pan tang analysi quintanaorti quintanaorti prove algorithm achiev bound oe min r oe k a oe r bound ident except f instead f enter equat f use implement claim new loop order avoid unnecessari step algorithm termin illustr consid situat appli chandrasekaran ipsen origin order matrix almost reveal rank golubik final permut occur here rank reveal chaniik golubik anoth iter inner kloop sinc permut occur chaniik golubik inner loop golubik anoth iter main loop sinc permut occur last pass golubik chaniik termin contrast hybridiiisf algorithm termin four step golubisfk final permut golubisfk chaniisfk chaniisfk termin algorithm rrqrfk repeat call hybridiiisffk ptmfk ff rank k stop els ff fi then els ff fi then fig algorithm comput rankrev qr factor determin numer rank stewart point out chandrasekaranipsen pantang al gorithm well version algorithm reveal rank matrix per se rather given integ k comput tight estim obtain numer rank respect given threshold given initi estim rank as provid exampl algorithm describ section employ algorithm shown figur actual implement ff fi comput hybridiiisf ptm experiment result report section experiment result doubleprecis implement algorithm present preced section consid follow code dgeqpf implement qr factor column pivot current provid lapack dgeqpb implement window qr factor scheme describ section dgeqpx dgeqpb follow implement variant chan drasekaranipsen algorithm describ subsect dgeqpi dgeqpb follow implement variant pantang algorithm describ subsect dgeqrf block qr factor without pivot provid lapack implement algorithm make heavi use avail lapack infrastructur code use experi includ test time driver test matrix gener avail rrqrtargz pubprism ftpsuperorg test matric size ibm rs model sgi r case employ vendorsuppli bla essl sgimath librari respect numer reliabl employ differ matrix type test algorithm variou singular valu distribut numer rank rang full rank detail test matrix gener beyond scope paper give brief synopsi here detail reader refer code test design exercis column pivot matrix design test behavior condit estim presenc cluster smallest singular valu case employ lapack matrix gener xlatm gener random symmetr matric multipli diagon matrix prescrib singular valu random orthogon matric left right break distribut singular valu except one arithmet geometr distribut decay specifi smallest singular valu arithmet geometr fashion respect revers distribut order diagon entri revers test case though use xlatm gener matrix smallest singular valu e interspers random linear combin fullrank column pad matrix order n test case use xlatm gener matric order n smallest singular valu e believ set repres matric encount practic report section result matric size note ident qualit behavior observ smaller matrix size decid report largest matrix size possibl failur gener increas number numer step involv numer result obtain three platform agre machin precis case list tabl numer rank r respect condit threshold e largest singular valu oe max rth singular valu oe r r st singular valu oe r smallest singular valu oe min test case figur display ratio theta oe oe r br defin comput estim condit number r dgeqpb figur dgeqpx dgeqpi figur thu theta ratio ideal condit number estim condit number lead triangular factor identifi rrqr factor ratio close b good condit estim rrqr factor good job captur larg singular valu a sinc pivot strategi henc numer behavior dgeqpb potenti affect block size chosen figur contain seven panel show result obtain test matric block size rang shown top panel see except matrix type figur block size play much rule numer although close inspect reveal subtl variat figur block size dgeqpb becom standard busingergolub pivot strategi thu first panel figur corrobor experiment robust behavior algorithm also see except tabl test matrix type descript r oe max oe r oe r oe min matrix rank minmn full rank full rank e e e e small norm n full rank small norm smallest sing valu cluster e e e e break distribut e e e e revers break distribut e e e e geometr distribut e e e e revers geometr distribut e e e e arithmet distribut e e e e revers arithmet distribut e e e e break distribut e e e e revers break distribut e e e e geometr distribut e e e e revers geometr distribut e e e e arithmet distribut e e e e revers arithmet distribut e e e e test optim cond_no estim cond_no fig ratio optim estim condit number optim cond_no estim cond_no qpi fig ratio optim estim condit number dgeqpx solid line dgeqpi dash type restrict pivot strategi employ dgeqpb much impact numer behavior matrix type howev perform much wors matrix construct gener ngamma independ column gener lead n random linear combin column scale ffl ffl machin precis thu restrict pivot strategi myopic view matrix get stuck speak column postprocess approxim rrqr factor hand remedi potenti shortcom preprocess step seen figur inaccur factor matrix correct other essenc correct factor get improv slightli except small vari ation dgeqpx dgeqpi deliv ident result also comput exact condit number lead triangular submatric identifi triangular dgeqpb dgeqpx dgeqpi compar condit estim figur show ratio exact condit number estim condit number lead triangular factor observ excel agreement within order magnitud case henc spike test matric figur due error estim rather show algorithm difficulti confront dens cluster singular valu also note context notion rank numer illdefin sinc sensibl place draw line rank deriv via svd case algorithm deliv estim minim chang condit number correspond lead triangular factor summari result show dgeqpx dgeqpi reliabl algorithm reveal numer rank produc rrqr factor whose exact estim qpx qpi fig ratio exact estim condit number lead triangular factor dgeqpb dash dgeqpx dasheddot dgeqpi dot lead triangular factor accur captur desir part spectrum a thu reliabl numer sensibl rank estim thu rrqr factor take advantag effici simplic qr factor yet produc inform almost reliabl comput mean expens singular valu decomposit comput perform section report perform lapack code dgeqpf dgeqrf well new dgeqpb dgeqpx dgeqpi code code well other present section mflop rate obtain divid number oper requir unblock version dgeqrf runtim normal mflop rate readili allow time comparison report matrix size use block size nb figur show mflop perform averag versu block size ibm sgi platform dot line denot perform dgeqpf solid one dgeqrf dash one dgeqpb x symbol indic dgeqpx dgeqpi respect three machin perform two new algorithm comput rrqr robust respect variat block size two new block algorithm comput rrqr factor are except small matric sgi faster lapack dgeqpf matrix size note sgi data cach mb ibm platform data cach thu matric order fit sgi cach matric order not therefor matric size less observ limit benefit block size perform in perform in block size perform in perform in fig perform versu block size ibm rs dgeqpf delta delta delta dgeqrf block size perform in block size perform in perform in block size perform in fig perform versu block size sgi r dgeqpf delta delta delta dgeqrf dge perform in fig perform versu matrix type ibm rs better inher data local bla implement comput result also show dgeqpx dgeqpi exhibit compar perform figur offer closer look perform variou test matric chose nb repres exampl similar behavior observ case see ibm platform figur perform dgeqrf dgeqpf depend matrix type also see that except matrix type postprocess initi approxim rrqr factor take littl time dgeqpx dgeqpi perform similarli matrix type consider work requir improv initi qr factor matrix type perform dgeqpx dgeqpi differ notic ibm platform clear winner also note matrix type suitabl dgeqpb sinc independ column front thu reveal quickli rest matrix factor dgeqrf sgi platform figur offer differ pictur perform algorithm show depend matrix type dgeqpb perform wors matrix type other nonetheless except matrix dgeqpx dgeqpi requir much postprocess effort pictur matrix size similar cost dgeqpx dgeqpi decreas matrix size increas except matrix type increas expect also note figur though would look even favor algorithm omit matrix chosen median instead averag perform figur show percentag actual amount flop spent monitor e perform in fig perform versu matrix type sgi r rank dgeqpb postprocess initi qr factor differ matrix size ibm rs show matrix type sinc behavior matrix type rather differ special case roughli overal flop expend postprocess note actual perform penalti due oper is small still consider higher flop count suggest surpris given rel finegrain natur condit estim postprocess oper lastli one may wonder whether use dgeqrf comput initi qr factor would lead better result sinc dgeqrf fastest qr factor algorithm case sinc dgeqrf provid rank preorder thu perform gain dgeqrf annihil postprocess step exampl matric order ibm rs averag mflop rate exclud matrix standard deviat percentag flop spent postprocess case averag standard deviat matrix lucki sinc matrix low rank independ column front matrix thu spend postprocess obtain perform mflop overal case though consider effort expend postprocess phase lead overal disappoint perform result show preorder done dgeqpb essenti effici overal algorithm conclus paper present rankrev qr factor rrqr algorithm combin initi qr factor employ restrict pivot scheme flop pivot flop pivot fig cost pivot in flop versu matrix type algorithm dgeqpx dgeqpi ibm rs matrix size x o postprocess step base variant algorithm suggest chandrasekaran ipsen pan tang restrictedpivot strategi result initi qr factor almost entir base bla kernel yet still achiev good approxim rrqr factor time guarante reliabl initi rrqr factor improv need be improv algorithm suggest pan tang reli heavili increment condit estim block given rotat updat comput effici altern implement version algorithm chandrasekaran ipsen among improv use ffactor techniqu suggest pan tang avoid cycl presenc roundoff error numer experi eighteen differ matrix type matric rang size ibm rs sgi r platform show approach produc reliabl rank estim outperform less reliabl qr factor column pivot current common approach comput rrqr factor dens matrix acknowledg thank xiaobai sun peter tang enriqu s quintanaorti stimul discuss subject r increment condit estim parallel qr factor algorithm control local pivot siam journal scientif statist comput block algorithm comput rankrev qr factor updat signal subspac robust increment condit estim preprint mcsp linear least squar solut household transform rank reveal qr factor applic rank reveal qr factor izat rankrev qr factor applic systol array linear discret illpos problem rank null space calcul use matrix decomposit without column interchang rank degeneraci least squar problem matrix comput matrix comput nd comparison direct iter method certain larg scale geodet leastsquar problem stabl variant secant method solv nonlinear equat iter method comput multivari c piecewis polynomi interpol rank defici interpol optim design exampl technic report scatr stabl effici algorithm rankon modif symmmetr eigenproblem truncat svd solut discret illpos problem ill determin numer rank effici algorithm comput condit number tridiagon matrix rank reveal qr decomposit svd mathemat comput comparison truncat qr svd method ar spectral estim levenbergmarquardt algorithm implementationand theori bound singular valu reveal qr factor izaton guarante termin chandrasekaran fortran subroutin updat qr factor acm transact mathemat softwar storag effici wy represent product household transform rank degeneraci updat algorithm subspac track determin rank presenc error use fast signal processor solv invers kinemat problem special emphasi singular problem tr effici algorithm comput condit number tridagon matrix comparison direct iter method certian larg scale godet least squar problem aplicaiton systol array linear discret ill pose problem storageeffici wy represent product household transform block qr factor algorithm use restrict pivot truncat singular valu decomposit solut discret illpos problem illdetermin numer rank increment condit estim algorithm fortran subroutin updat qr decomposit updat algorithm subspac track parallel qr factor algorithm control local pivot structurepreserv rankrev qrfactor lapack user guid applic rank reveal qr factor determin rank presenc error modifi truncat svd method regular gener form rankrev factoris matrix comput rd ed bla version qr factor column pivot rank degeneraci least squar problem work note robust increment condit estim ctr c h bischof g quintanaort algorithm code rankrev qr factor dens matric acm transact mathemat softwar tom v n p june enriqu s quintanaort gregorio quintanaort maribel castillo vicent hernndez effici algorithm block hessenberg form journal supercomput v n p august peter benner maribel castillo enriqu s quintanaort vicent hernndez parallel partial stabil algorithm larg linear control system journal supercomput v n p feb