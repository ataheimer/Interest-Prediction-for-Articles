t hybrid gausstrapezoid quadratur rule a new class quadratur rule integr regular singular function construct analyz rule quadratur weight posit class includ rule arbitrarili highord converg quadratur result alter trapezoid rule small number node weight end integr interv replac new node weight determin asymptot expans result rule provid gener eulermaclaurin summat formula prescrib number vanish term superior perform rule demonstr numer exampl applic sever problem discuss b r eulermaclaurin summat formula function f cpr p eulermaclaurin summat formula see exampl deriv repeat integr part rst consid interv appli obtain z ch z deriv eulermaclaurin formula interv a b let h ban rearrang term obtain fa fb express lefthand side wellknown trapezoid rule evalu express righthand side simpli fact gener riemann zetafunct gener riemann zeta function dene formula v function continu analyt entir complex splane except simpl pole follow shall concern primarili real v s v use hybrid gausstrapezoid quadratur rule follow represent deriv plana summat formula see exampl section vs vs z sin arctan t dt equat use deriv asymptot expans v we treat integr sum laplac integr asymptot expans given watson lemma see exampl p obtain v arbitrari posit integ equat isa slight gener section direct connect bernoulli polynomi gener dierenc dierenti formula hold v s v orthogon polynomi gaussian quadratur suppos posit continu function interv a b integr a b dene inner product respect realvalu function f g integr exist polynomi pp degre respect pnpm uniqu choic lead coecientswith lead coecient one obtain recurs formula see exampl p pxandnn dene formula zero xn xn pn distinct lie interv a b exist posit number n n whenev f polynomi degre less n christoel number given formula see exampl p moreov xb x x integr a b then denit exist posit number n n whenev f polynomi degre less equal n modi christoffel number given formula in pnb in given summat nnode gaussian quadratur respect n node gaussradau quadratur respect hybrid gausstrapezoid quadratur rule section introduc new quadratur rule regular integrand singular integrand power logarithm singular improp integr determin rate converg number quadratur node increas notat conveni gener consid quadratur canon inter val primarili understood readili transform quadratur nite interv a b appropri linear transform node weight regular integrand jn posit integ g dene linear oper tnja c depend node x xj weight w wj formula h n a chosen ah n h ah theorem suppos f cp asymptot expans tnjaf is given formula hybrid gausstrapezoid quadratur rule proof appli eulermaclaurin formula interv ah ahto obtain combin equal taylor expans quantiti bernoulli polynomi expans formula dierenc formula obtain corollari suppos node x xj weight w wj satisfi equat r tnja quadratur rule converg order j f cp j moreov n provid remain node x xj weight w wj satisfi equat r tnja quadratur rule converg order j f cp n provid fj fj we shall see solut node weight posit sucient larg numer solut equival comput root particular polynomi statement hold well singular integrand jkn posit integ a b r dene linear oper snjkab c depend node v vjx xk weight u ujw wk formula chosen ah n h bh follow theorem follow gener eulermaclaurin formula due navot gener due lyness present somewhat dierent proof earlier one theorem suppos gxxfx f cp asymptot expans snjkabg n is given formula proofforc r dene polynomi pcpc analog bernoulli polynomi formula r dierenti verifi dx and combin dierenc formula obtain cn addit dene function qcqc observ qnc dx hybrid gausstrapezoid quadratur rule denit proof follow eulermaclaurin formula z bh nx z taylor expans frah denit pcn qnc binomi theorem combin yield likewis taylor expans fr bh denit pcn qnc asymptot expans bernoulli polynomi expans formula binomi theorem combin yield combin equal expans latter two integr dierenc formula bernoulli polynomi obtain corollari suppos node u uj weight v vj satisfi equat node x xj weight w wj satisfi equat r snjjab quadratur rule converg order j minfg gxxfx f cp p j moreov n corollari suppos node u uj weight v vj satisfi equat r node x xk weight w wk satisfi equat xk r brb r snjkab quadratur rule converg order minfj j kg minfjkg corollari even number constraint node weight end interv consid clearli analog quadratur rule aris odd number constraint one end similar explicit present omit consid dierent type singular theorem suppos gxfx log x f cp asymptot expans snjkabg n is given formula hybrid gausstrapezoid quadratur rule denot deriv respect rst argument proof asymptot expans deriv theorem dierenti respect evalu result corollari suppos node u uj weight v vj satisfi equat ui vir log r node x xk weight w wk satisfi equat xk r brb r snjkab quadratur rule error order ominfhj log h hkg gxx log x minfjkg improp integr jn posit integ dene linear oper rnj cn depend node x xj weight w wj theorem suppos gxeixfx r f cp and exist posit constant p xr asymptot expans rnj g n is given formula proof integr part repeatedli obtain comput taylor expans f lie xk k j combin obtain exampl function f dene formula ar xr jarj satis assumpt theorem everi posit integ p remark theorem can instanc gener correspond asymptot expans depend detail knowledg f f given exampl quadratur node weight corollari suppos f cp fsatis x r f analyt halfplan rex afor r suppos v vj root laguerr polynomi lj degre j coecient u uj satisfi equat oper rnj dene node xk ivk weight wk iuk k j suppos nalli tmja dene quadratur rule tmja node weight satisfi translat scale interv n p j express tjnangrnj g approxim integr error order onj n proof result combin quadratur rule corollari interv n asymptot expans theorem interv n provid follow equat see exampl fact gaussian quadratur exact polynomi degre less twice number node node coincid root correspond orthogon polynomi see section complet denit new quadratur along demonstr asymptot perform shall see exist rule depend solvabl nonlinear system equat dene node weight assur theori chebyshev system uniqu rule similarli assur issu exist uniqu treat next hybrid gausstrapezoid quadratur rule exist uniqu chebyshev system materi subsect taken minor alter karlin studden suppos interv r possibl innit collect n realvalu continu function f fn dene chebyshev system linear combin ai zero n zero i condit equival statement distinct x xn i det b ca fxn fnxn chebyshev properti characterist space rather basi f fn chebyshev system basi spanff fngif u continu posit function i scale u preserv chebyshev system final u strictli increas continu interv j rang i f u fn u chebyshev system j f fn i here fi u denot composit u follow fi bestknown exampl chebyshev system set polynomi interv r shall concern also chebyshev system log x x xlog x xnxn log x a rnz a system special case system muntz function see exampl p pwhere j distinct real number n nj posit integ see chebyshev system suppos f span use induct n dd log xfx xj combin roll theorem anoth chebyshev system aris system p j distinct posit real number n nj posit integ n inde chebyshev system f spanl qj function fx ix ini polynomi x degre n suppos f fn chebyshev system interv i moment space mn respect f fn set measur rang set nondecreas rightcontinu function bound variat i shown mn convex cone associ point curv c word mn repres index icofapointc mn minimum number point c use represent c convent point fx fnx count half point x boundari receiv full count otherwis index quadratur involv x xp determin count likewis proof next three theorem somewhat elabor omit here found karlin studden theorem see p suppos a b close interv point boundari point mn ic n moreov ifi measur correspond boundari point c mn uniqu quadratur theorem see p suppos a b close interv point c interior mn satis icn moreov measur correspond c exactli two quadratur index n wi i p particular n m theorem see p let pn denot nonneg linear combin function f fn hybrid gausstrapezoid quadratur rule point c c cn element mn impli ai ci moreov c interior mn impli ai ci theorem see p suppos fixxi n a bifn m c c cn element mn two quadrat form xm xm nonneg denit n m c mn two quadrat form nonneg denit moreov either pariti n c interior mn correspond quadrat form posit denit proof theorem lukac see exampl p state polynomi f degre n nonneg a b repres form p q polynomi degre term exceed n combin theorem prove theorem muntz system quadratur system dene quadratur rule section special case system equat dxne distinct real number j posit integ n nj k denot kth deriv respect rst argument exist uniqu solut follow exist uniqu quadratur chebyshev system establish measur z word moment space mn chebyshev system muntz function a contain point show condit satis provid sucient larg would conveni tight bound a particular system appear bound dicult obtain even regular case theorem exist equival posit denit two matric precis bound arbitrari j appear dicult numer exampl provid evid aj may chosen small theorem suppos j dipstinct real number greater n nj posit integ n sucient larg a exist measur system satis c dene interior moment space mn proof construct continu weight function satisfi show sucient larg a x posit x a linearli combin equat obtain equival system use binomi theorem expand logkxa log xlog akw dene weight formula combin equal x log xdx k obtain equat a na ndimension linear system nonsingular sinc set function form chebyshev system establish thu possess uniqu solut a na hybrid gausstrapezoid quadratur rule determin asymptot expans riaasa can deriv dierenti rst sever term given combin chang order summat twice appli product dierenti rule dr xr r dr obtain immedi reduc combin give lim axx impli sucient larg x x a point c dene interior mn sinc small perturb c preserv posit theorem ensur exist gaussian quadratur chebyshev system f fn dene interv i assumpt close wherea system chebyshev a consequ requir follow result theorem suppos collect function f fn form chebyshev system a b integr a b respect measur correspond point c interior mn exist uniqu quadratur index n wi xi i p particular n m proof chebyshev properti impli exist absuch fi nonzero a n dene function u formula observ u continu posit integr a b respect dene function g gn a b formula fix x a b xa system grxgn chebyshev system a b integr respect measur ut dt theorem therefor applic ensur exist exactli two quadratur index n interv a b one includ point assumpt xi a b exclud case left singl quadratur present next theorem princip analyt result section follow directli theorem exist uniqu quadratur dene section follow it also hint exist somewhat gener quadratur singular form x logk x evalu here theorem suppos j dipstinct real number greater n nj posit integ n sucient larg a system equat dxne uniqu solut w wdnex xdne satisfi wi dne x xdne a xdne n odd comput node weight node weight quadratur dene section comput numer solv nonlinear system convent techniqu problem either overli cumbersom converg slowli practic recent ma rokhlin wandzura address need develop practic numer algorithm eectiv fairli gener set construct simpli newton method combin continu homotopi method present method abbrevi form section reader refer detail system regular integrand howev solv even simpli see next regular integrand classic theori gaussian quadratur polynomi summar section exploit solv particular suppos p pj orthogon polynomi a given hybrid gausstrapezoid quadratur rule recurr assumpt z r bra x root x xj pj correspond christoel number w wj satisfi polynomi p pj calcul symbol form coecient ration ration root pj comput newton iter christoel number obtain use similar treatment appli system contain odd number equat use interv a assumpt z r bra x gaussradau quadratur comput use formula modi christoel number task conveni use softwar system manipul polynomi fullprecis ration coecient author implement code comput parigp note propos procedur suitabl rel small valu j less than say neither ecient stabl quit adequ purpos unlik situat standard gaussian quadratur number node depend size problem depend desir order converg requir comput node weight larg j reader may consid numer scheme gaussian quadratur propos author exampl gautschi golub welsch singular integrand system singular integrand cannot solv use method standard gaussian quadratur sinc node comput coincid root close relat orthogon polynomi employ instead algorithm system develop ma rokhlin wandzura describ collect n realvalu continu dierenti function f fn dene interv a bisahermit system choic distinct x xn i hermit system also chebyshev system extend hermit system follow theorem direct consequ denit proof subsequ two theorem contain theorem suppos function f fn constitut hermit system interv a b x xn n distinct point a b exist uniqu coecient ijiji n j n k n function ii dene formula n theorem see p suppos function f fn constitut hermit system a b suppos a bn set point distinct coordin x xn suppos nalli map f dene formula function n dene x xn gaussian node system function f fn respect weight fx xn theorem see p suppos function f fn extend hermit system a bs a bn set point distinct coordin map g dene formula x x dx nx x dx x x dx nx x dx function n n dene suppos fi ca b n function f dene suppos nalli x uniqu zero f x arbitrari point s sequenc x x dene formula exist sequenc x x gener converg x initi point x kx xk key featur theorem quadrat converg indic solut x obtain iter procedur step consist comput coecient determin n n invert matrix comput integr dene g take linear combin use coecient integr f fn theorem ensur appropri choic start valu x converg rapid certain quadratur node x x xn quadratur weight given integr i name hybrid gausstrapezoid quadratur rule note theorem concern gaussian quadratur n node weight integr n function interv a b exactli gaussradau quadratur node xn b xed n function integr exactli slight chang requir particular function n without n n dene except summat exclud fn coecient ij n j n obtain invert matrix result remov last row column matrix revis map compon dene rst n compon final befor quadratur weight given order obtain sucient good start estim solut fx continu procedur use outlin follow theorem theorem see exampl p suppos f rn function uniqu solut xt equat ft x suppos xt continu function t suppos final suppos x given procedur p comput xt given estim xt jxt xtj exist posit integ follow procedur use comput solut fx use p comput xim given estim xim requir solut fx x typic cours bound jxt xtj depend practic implement step size chosen adapt comput solut eectiv use continu procedur respect j a solut rst valu j readili obtain without requir good initi estim given solut interv a node u uj weight v vj choos initi estim u ujv vj interv a dene uii j vii j choic exactli satis equat r follow immedi dierenc formula bn correspond equat satis equat approxim satis howev start actual valu sum requir valu vari continu obtain correspond solut coincid intend valu ja bja j procedur use without alter solut interv a obtain continu vari continu procedur obtain solut dierent interv bradley k alpert tabl minimum valu a function j point ba bjaj moment space mj polynomi x xj interv a moment space dene j min j min j min j min numer exampl procedur describ section implement parigp regular case singular case matrix must invert poorli condit mani choic n x xn f fn diculti met use extend precis capabl parigp node weight node weight determin quadratur section comput rang valu paramet j choic j chosen experi smallest integ lead posit node weight see theorem regular case character express theorem use determin minimum valu r j satis particular obtain minimum valu quadrat form nonneg denit determin made calcul determin correspond matrix symbol solv largest root result polynomi a valu given tabl evid suggest limj j min exist roughli mean number trapezoid node displac less number gaussian node replac them quadratur rule order relationship also appear hold even greater extent singular case valu select node weight regular case singular x log x present appendix particular simplic rst two rule regular integrand rule third fourthord converg respect rst noteworthi weight as higher order than trapezoid rule second asymptot error simpson rule number node lowestord rule present logarithm singular hybrid gausstrapezoid quadratur rule tabl rel error comput integr regular case sx quadratur rule converg order use variou number node oversampl factor tabl rel error singular case sxx variou number node order converg approxim gx dx error order oh log h gxx log x regular function correspond rule singular x quit simpl quantiti replac quadratur perform demonstr perform quadratur rule use fortran routin with real arithmet numer comput integr dxfor function sxsxx log x integr also obtain analyt rel error quadratur comput numer integr comput variou order quadratur variou number node minimum sampl taken two point per period cosin ie quadratur node accuraci compar variou degre oversampl quadratur error list tabl plot function oversampl factor figur note graph tabl rel error singular case log x error order ohl log h l shown rel oversampl f oversampl f oversampl f fig rel error quadratur shown tabl plot use logarithm scale axe nearli straight line until limit machin precis reach predict theoret converg rate remark also excel accuraci attain even quit modest oversampl quadratur highord converg employ problem number quadratur node major cost therefor one may benet use highord quadratur even modest accuraci requir hybrid gausstrapezoid quadratur rule tabl rel error comput integr quadratur rule dene corollari j use variou number node test quadratur improp integr numer comput integr h heavisid step function integrand oscillatori decay like x x quadratur dene corollari employ integr split regular integr nite interv chosen m m total number quadratur node two improp integr imaginari direct use laguerr quadratur quadratur error shown tabl applic summari chief motiv hybrid gauss trapezoid quadratur rule accur comput integr oper dene integr oper formula z regular simpl close curv complex plane function f regular kernel regular function argument except coincid assum regular regular integr singular larg varieti problem classic physic formul integr equat involv oper oper occur integr equa tion choic discret must use reduc problem nitedimension one numer solut nystrom method integr replac quadratur yield nite system equat xm bradley k alpert linear system solv fx fxm varieti techniqu particular choic xi wij mdetermin order converg and therefor ecienc method curv parametr scale arc length oper becom conveni use uniform discret m m int wij determin assum moment f avail locat x xm continu period period use gausstrapezoid quadratur obtain z im dene formula determin singular k provid period continu sucient regular quadratur converg integr order greater j m relax restrict f avail outsid x xm use local lagrang interpol order equispac node j c r ssrnow wij determin combin comput coecient requir mm j evalu kernel k therefor order om oper cost often substanti reduc use techniqu exploit kernel smooth see exampl slightli dierent applic quadratur comput fourier transform function fail satisfi assumpt usual made use discret fourier transform particular function decay slowli larg argument compactli support singular end support interv quadratur use comput fourier transform one exampl function sinc node quadratur equispac function valu given equal weight fast fourier transform use bulk comput overal complex on log n n number fourier coecient comput applic may includ hybrid gausstrapezoid quadratur rule represent function solv ordinari partial dierenti equat highord method requir addit extens quadratur integr surfac studi summari characterist hybrid gausstrapezoid quadratur rule includ arbitrari order converg regular function function known singular power logarithm type posit weight node equispac weight constant invari node weight asid scale problem size increas primari disadvantag quadratur rule share gaussian quadratur exacerb poor condit comput node weight trivial nevertheless tabul node weight given order converg allow issu avoid construct highord generalpurpos quadratur routin appendix tabl quadratur node weight quadratur node weight may also obtain electron author tabl thepnod weight quadratur rule sever choic j correspond minimum integ aforf regular function converg fx dx n withconverg order o oa xi wi hybrid gausstrapezoid quadratur rule tabl continu oa xi wi d d d tabl pthe node vp vj weight pu uj quadratur rule sn g gxxxx regular function node x xk weight w wk found tabl oa vi ui d d d d d d d d d d hybrid gausstrapezoid quadratur rule tabl continu oa vi ui d d d d d d d d d d d d d d d tabl pthe node vp vj weight pu uj quadratur rule sn g function error order ohl log h node x xk weight w wk found tabl la vi ui hybrid gausstrapezoid quadratur rule tabl continu la vi ui d d d d bradley k alpert acknowledg author thank gregori beylkin vladimir rokhlin ronald wittmann help discuss encourag r numer solut onedimension integr dierenti equa tion nystro gener gaussian quadratur rule system arbitrari function handbook mathemat function th print ing higher transcendent function advanc mathemat method scientist engi neer introduct numer analysi tchebych system applic analysi statist polynomi polynomi inequ user guid parigp construct gaussian quadratur rule modi moment calcul gaussian quadratur rule tr ctr roberto camassa jingfang huang long lee integr integr algorithm nonlinear shallowwat wave equat journal comput physic v august thoma hagstrom georg hagstrom grid stabil highord onesid differenc i firstord hyperbol system journal comput physic v n p april donna calhoun cartesian grid method solv twodimension streamfunctionvort equat irregular region journal comput physic v n p march sheonyoung kang israel koltracht georg rawitsch nystrmclenshawcurti quadratur integr equat discontinu kernel mathemat comput v n p april bradley alpert lesli greengard thoma hagstrom nonreflect boundari condit timedepend wave equat journal comput physic v n p juli