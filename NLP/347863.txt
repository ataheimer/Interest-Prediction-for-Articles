t automat sampl ratioofuniform method a appli ratioofuniform method gener random variat result effici fast easytoimpl algorithm howev paramet everi particular type densiti must precalcul analyt articl show ratioofuniform method also use design blackbox algorithm suitabl larg class distribut includ logconcav densiti use polygon envelop squeez result algorithm extrem fast opposit ratioofuniform algorithm expect number uniform random number less two furthermor show method sens equival transform densiti reject b introduct exist larg literatur gener method standard continu distribut see exampl devroy algorithm often especi design particular distribut tailor featur densiti howev mani situat applic standard distribut adequ montecarlo simul besid sheer brute forc invers that is tabul distribut function mani point sever univers method larg class distribut develop avoid design special algorithm case method either slow eg devroy need slow setup step larg tabl eg ahren kohrt marsaglia tsang devroy chap vii recent two effici method propos transform densiti reject gilk wild hormann accep tancereject techniqu use concav transform densiti gener hat function automat user need provid probabl densiti function perhap approxim locat mode tabl method ahren also acceptancereject method use piecewis constant hat area piec same region immedi accept make algorithm fast larg number constant piec use tail region distribut treat separ ratioofuniform method introduc kinderman monahan anoth flexibl method adjust larg varieti distribut becom popular transform method gener nonuniform random variat sinc result exact effici fast easi implement algorithm typic algorithm line code eg barabesi give survey exampl fortran code sever standard distribut base follow theorem mathemat subject classif primari c random number gener sec ondari u numer method probabl statist k pseudorandom number mont carlo method key word phrase nonuniform random variat ratioofuniform univers method adapt method patchwork reject continu distribut logconcav distribut concav distribut transform densiti reject theorem kinderman monahan let x random variabl densiti function r gxdx gx posit integr function support necessarili finit v u uniformli distribut sampl random point uniformli distribut g reject conveni envelop region r g use basic form ratioofuniform method given algorithm rou algorithm rou requir densiti fx envelop region r repeat gener random point v u uniformli distribut r x vu u fx return x usual input rou prepar design algorithm particular distribut reduc number evalu densiti function step squeez use obviou perform simpl algorithm depend reject constant ie ration jrjjaj jrj denot area region r kinderman monahan other use reject minim bound rectangl ie smallest possibl rectangl g basic algorithm improv sever fit enclos region decreas reject constant possibl choic parallelogram eg cheng feast quadrat bound curv eg leva often conveni decompos countabl set nonoverlap subregion composit ratioofuniform method robertson wall give simpl exampl dagpunar p consid possibl enclos polygon paper develop new algorithm use polygon envelop squeez random variat insid squeez gener mere invers therefor opposit ratioofuniform method less two uniform random number requir larg class distribut includ logconcav distribut possibl construct envelop squeez automat moreov show new algorithm sens equival transform densiti reject new method sever advantag ffl envelop squeez construct automat probabl densiti function necessari random number necessari made arbitrarili small ffl small method close invers thu result random variat use varianc reduct techniqu moreov structur result random variat similar underli random uniform random number gener henc nonuniform random variat inherit qualiti properti moreov method extend wakefield gelfand smith replac function gener strictli increas differenti function qu stadlob give modif discret distribut jone lunn emb method gener random variat gener framework wakefield et al stefanescu vaduva appli method gener multivari distribut ffl avoid possibl defect qualiti result pseudorandom variat report ratioofuniform method see hormann a hormann b ffl first ratioofuniform method first implement transform densiti reject requir less two random number section give outlin new approach section discuss problem get proper envelop region r section describ algorithm detail section show algorithm applic concav densiti x remark qualiti random number gener new algorithm given section method envelop polygon given distribut probabl densiti function r gxdx convex set g notic g must continu bound sinc otherwis g convex simplifi develop method first assum unbound support g thi restrict drop later distribut easi make envelop polygon select coupl point c boundari use tangent point edg enclos polygon p e see figur denot vertic p e simpli intersect point tangent obvious choic construct point tangent result bound polygon p e procedur even work tangent uniqu point v u ie gx differenti furthermor simpl construct squeez take insid polygon p vertic c construct point tangent figur polygon envelop squeez convex set g sampl envelop polygon notic origin alway contain polygon p e moreov everi straight line origin correspond thu intersect alway connect therefor use c first construct point vaxi tangent sampl uniformli enclos polygon triangul p e make segment illustr situat segment vertic c c last segment segment divid triangl insid squeez dark sn figur triangul envelop polygon shade triangl outsid light shade notic segment sn three vertic triangl n gener random point uniformli distribut p e first sampl discret distribut probabl vector proport js j js j select segment triangl done algorithm get segment requir list segment gener r u find smallest k ik p return triangl k els return triangl k step index search or guid tabl appropri method chen asau see also devroy xiii uniformli distribut point triangl v gener follow simpl algorithm devroy p algorithm triangl requir triangl v gener r r return sampl algorithm much improv everi point triangl immedi accept without evalu probabl densiti function thu interest ratio compon sinc vertex c arriv r r c ij jth compon vertex c r uniform random variat rationofuniform theorem sinc r kinderman monahan notic save one uniform random number domain p method furthermor reus random number r routin get segment r risk find ik ik sampl p seen invers cumul distribut function defin boundari squeez polygon thu ratio jp jjp e j close almost invers gener random variat invers method two advantag thu favor simul commun see bratley fox schrage structur gener simpl easili investig see section random variat use varianc reduct techniqu expect number uniform random number let j need gener one ratio vu sinc reject ratio v u find expect number uniform random number per gener nonuniform notic proper choic construct point made arbitrarili small bound domain g x situat nearli same distinguish two case exist limit point x use x construct point respect triangular segment sn necessari otherwis restrict triangular segment sn ie use tangent line instead vaxi notic differ tangent line c sn ad construct point add new point given ratio need c outer boundari tangent line point given posit root u total differenti tangent ratioofuniform transform densiti reject transform densiti reject one effici univers method transform densiti reject introduc devroy differ name gilk wild gener hormann accep tancereject techniqu use concav transform densiti gener hat function squeez automat mean tangent secant user need provid densiti function perhap approxim locat mode util densiti f strictli increas differenti transform exist fx concav see hormann detail densiti call logconcav densiti exampl logx figur illustr situat standard normal distribut transform logx left hand side show transform densiti three tangent right hand side show densiti function result hat squeez drawn dash line evan swartz shown techniqu even suitabl arbitrari densiti provid inflect point transform densiti known josef leydold figur construct hat function normal densiti util transform densiti reject densiti convex region a stadlob dieter clarifi relationship ratioofuniform method ordinari accep tancereject method also deeper connect transform densiti reject give us use character densiti convex region g first provid proof theorem proof theorem consid transform r theta sinc jacobian transform joint densiti probabl function x given wx otherwis thu x margin densiti w r gx consequ r gxdx w probabl densiti function fx transform map g onetoon onto b ie set point graph gx xaxi moreov outer boundari g fv u map onto graph gx theorem g convex gx concav transform x proof sinc x strictli monoton increas transform onetoon onto c ie region transform densiti henc r theta map g onetoon onto c g notic g concav c g con vex thu remain show g convex c g convex consequ straight line remain straight line transform let xb straight line c g ie straight line g analog find straight line line x remark theorem new univers ratioofuniform method sens equival transform densiti reject differ method gener point uniformli distribut region hat function opposit new method transform densiti reject alway need two uniform random number similar approach transform densiti re jection ie decompos hat function squeez region immedi accept region squeez hat work well sampl second part awkward prone numer error hormann sinc everi logconcav densiti concav x hormann algorithm appli larg class distribut exampl given tabl given condit paramet impli concav support densiti howev densiti concav wider rang paramet subset support eg densiti gamma distribut concav x distribut densiti support concav normal e gammax r lognorm x expgamma pexponenti e gamma x beta x weibul x perk e x gen inv gaussian x pearson vi x planck x e burr x snedecor f x tabl concav densiti normal constant omit construct point perform new algorithm depend small ratio thu choic construct point tangent envelop polygon three possibl solut simpli choos equidistribut point use adapt method use optim point obviou setup time increas margin gener time decreas given number construct point equidistribut point simplest method choos point x equidistribut angl densiti function bound domain modifi tan l tan r left right boundari domain see also section numer simul sever densiti function shown accept good choic construct point sever distribut ratio length width minim bound rectangl far one adapt reject sampl gilk wild introduc ingeni concept adapt reject sampl problem find appropri construct point tangent transform densiti reject method adopt situat work follow way start at least two point side mode sampl point envelop polygon p e add new construct point stop criterion fulfil eg maxim number construct point aim ratio jp jjp e j reach ensur start polygon p e bound construct point or least close to mode use third start point sampl point domain p e n p much expens sampl squeez region firstli gener random point requir random number multipl secondli evalu densiti check accept condit thu minim ratio done perfectli well adapt reject sampl sinc method region automat approxim envelop squeez polygon probabl ad new point segment depend ratio js ie probabl fall henc adapt algorithm tend insert new construct point more necessari obvious ratio n random variabl converg almost sure number construct point n tend infin simpl consider leydold hormann figur show result simul standard normal distribut non optim start point sampl n plot number n construct point rang n given light shade area percentil given dark shade area median solid line figur converg ratio standard normal distribut start point sampl run simul distribut start valu made observ converg even faster nonnorm di tribut howev analyt investig interest upper bound expect valu n open problem optim construct point theorem area hat squeez transform densiti reject method map onetoon onto automat sampl ratioofuniform method thu use method comput optim construct point transform densiti reject find optim envelop new algorithm three construct point use see hormann point requir derfling hormann describ effici method howev modif necessari improv adapt reject sampl rather small seen figur the lower boundari rang give good estim optim choic construct point algorithm algorithm arou consist three main part construct start envelop polygon p e squeez polygon p routin arou start take care possibl bound domain two case describ section start point must provid eg use equidistribut point describ section sampl given distribut routin arou sampl add new construct point routin arou add whenev fall store envelop list segment object use algorithm first initi gener call arou start sampl done call arou sampl object segment paramet variabl definit remark left construct point c right construct point c i pointer store next segment tangent left point tangent right point i pointer store next segment intersect point area insideoutsid squeez accumul area cum fast invers algorithm arou start requir densiti fx deriv f x domain cosarctanx tangent line k cosarctanx k tangent line k fx iv gammaf add list segment cannot use construct point segment insert c i i alreadi store next segment list comput cum check polygon p e bound return list segment algorithm arou sampl requir densiti fx list segment loop gener r u find smallest cum use guid tabl r cum r return gener r u r number segment maximum call arou add x return x algorithm arou add requir densiti fx deriv f x new construct point xn segment r fxn cannot add point return c n nv gammaf insert sn list segment take care c i remov old segment r list comput mn comput segment comput cum return new list segment implement algorithm link list segment necessari whenev cum recalcul guid tabl made use linear search might good method find random variat sampl special care necessari comput arou start arou add three possibl case numer problem solv correspond linear equat vertic c c i close consequ js j small simpli reject c i new construct point close c small boundari c c i almost straight line almost case set possibl way defin veri small compar number smallest posit m use program languag denot magnitud maximum densiti function in ansi c defin macro dbl epsilon import check whether outer side secant c c i condit violat arou start polygon p e unbound may violat arou start arou add convex c implement test version algorithm arou code c avail anonym ftp leydold email request author note qualiti random number new algorithm composit method similar acceptancecompl method see devroy x ii x distribut defin squeez region g theorem algorithm exact ie gener random variat requir distribut howev defect underli uniform random number gener may result poor qualiti nonuniform random variat moreov transform nonuniform random variat may caus defici although littl literatur topic ratioofuniform method combin linear congruent gener lcg report defect hormann a hormann b due lattic structur random pair gener lcg alway hole without point probabl order modulu lcg random variat gener invers inherit structur underli uniform random number consequ qualiti consid great advantag method sinc gener whose structur properti well understood precis describ may look less random complic less understood necessarili better may hide strong correl import defect avoid gener without convinc theoret support statement lecuy build uniform random number gener also valid nonuniform distribu tion method may hidden infer make predict qualiti result nonuniform random number imposs leydold leeb hormann notic random variat densiti g x gener invers thu ratio tend random variat gener invers new algorithm immedi consequ small new gener avoid defect basic ratioofuniform method figur show scatter plot overlap tupl use babi gener a show underli gener bf show tupl phiu differ number construct point use equidistribut method phi denot cumul distribut function standard normal distribut made empir investig use mtupel test good marsaglia setup leydold leeb hormann standard normal distribut variou number construct point use linear congruenti gener fish fishman moor explicit invers congruenti gener eichenauerherrmann twist gfsr gener tt matsumoto kurita last infam randu again lcg exampl gener bad lattic structur see park miller test demonstr small ratio qualiti normal gener strongli correl qualiti underli uniform random number gener especi use randu result normal gener bad qualiti notic howev correl exist close inde use construct point result normal gener might better eg fish test wors eg randu underli gener a uniform b c r figur scatter plot babi gener mod a normal variat use algorithm arou equidistribut construct point bf possibl variant nonconvex region algorithm modifi work nonconvex region f adapt idea evan swartz partit f segment use inflect point transform densiti transform x segment f fx concav use secant boundari envelop polygon p e tangent squeez p notic squeez region segment quadrangl triangul multivari distribut wakefield gelfand smith stefanescu vaduva gener ratioofuniform method multivari distribut use reject enclos multidimension rectangl howev accept probabl decreas fast higher dimens multivari normal distribut four dimens use polyhedr envelop similar leydold hormann leydold possibl increas accept probabl howev requir addit research acknowledg author wish thank hann leeb help discuss qualiti random number gener r comput method effici sampl larg arbitrari statist distribut random variat gener use ratioofuniform method guid simul gener random variat empir distribut simpl gamma variat gener principl random variat gener optim select hat function reject algorithm simpl algorithm gener random variat logconcav densiti mathemat aspect variou method sampl classic distribut statist independ new class invers congruenti pseudorandom number random variabl gener use concav properti transform densiti see erratum adapt reject sampl gibb sampl appli statist serial test sampl number test random reject techniqu sampl tconcav distri bution privat commun transform random variat gen erat generalis ratioofuniform method comput gener random variabl use ratio uniform deviat random number gener fast normal random number gener reject techniqu sampl logconcav multivari distribut arou user manual sweepplan algorithm gener random tupl simpl polytop higher dimension properti nonuniform pseudorandom variat current view random number gener twist gfsr gener ii random number gener good one hard find random number gener normal gamma distribut use ratio uniform method ratio uniform approach gener discret random variat comput gener random vector transform uniformli distribut vector effici gener random variat via ratioofuniform method univers econom busi administr tr exhaust analysi multipl congruenti random number gener modulu supscrpt guid simul nd ed comput gener random vector transform uniformli distribut vector random number gener good one hard find mathemat aspect variou method sampl classic distribut ratio uniform approach gener discret random variat fast normal random number gener note qualiti random variat gener ratio uniform method twist gfsr gener ii reject techniqu sampl italictitalicconcav distribut reject techniqu sampl logconcav multivari distribut sweepplan algorithm gener random tupl simpl polytop comput gener random variabl use ratio uniform deviat ctr leydold gerhard derfling gnter tirler wolfgang hrmann automat code gener nonuniform random variat gener mathemat comput simul v n p march john t kent patrick d l constabl fikret er simul complex bingham distribut statist comput v n p januari josef leydold short univers gener via gener ratioofuniform method mathemat comput v n p juli josef leydold simpl univers gener continu discret univari tconcav distribut acm transact mathemat softwar tom v n p march wolfgang hrmann josef leydold continu random variat gener fast numer invers acm transact model comput simul tomac v n p octob w hrmann j leydold randomnumb randomvari gener automat random variat gener simul input proceed nd confer winter simul decemb orlando florida dongu lee wayn luk john d villasenor peter y k cheung gaussian nois gener hardwarebas simul ieee transact comput v n p decemb