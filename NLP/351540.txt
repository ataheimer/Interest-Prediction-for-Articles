t robust scalabl algebra multigrid a algebra multigrid amg current undergo resurg popular due part dramat increas need solv physic problem pose larg unstructur grid amg prove use variou problem type commonli understood wide rang applic method ha studi demonstr rang applic describ recent advanc amg technolog moreov light imper modern comput environ also examin amg term algorithm scalabl final show situat standard amg work well indic current direct taken amg research allevi difficulti b introduct algebra multigrid amg rst introduc earli s immedi attract substanti interest research continu modest pace late s earli s recent howev major resurg interest eld classic amg dene well host algebra type multilevel method larg resurg amg research due need solv increasingli larger system hundr million billion unknown unstructur grid size problem dictat use largescal parallel process turn demand algorithm scale well problem size increas two dierent type scalabl import implement scalabl requir singl iter scalabl parallel comput less commonli discuss algorithm scalabl requir comput work per iter linear function problem size converg factor per iter bound bound independ problem size type scalabl properti algorithm independ parallel necessari condit scalabl implement attain multigrid method well known scalabl both type ellipt problem regular grid howev mani modern problem involv extrem complex geometri make structur geometr grid extrem dicult imposs use applic code design turn increas number larg unstructur grid amg seen mani one promis method solv largescal problem aris context studi four compon first examin perform classic amg varieti problem regular structur intent determin robust second examin perform amg suit problem unstructur grid andor irregular domain third studi algorithm scalabl amg examin perform sever center appli scientic comput casc lawrenc livermor nation laboratori livermor ca emailfcleari rfalgout vhenson jjonesgllnlgov depart appli mathemat univers colorado boulder co email ftmanteuf stevemgbouldercoloradoedu z uss florida ssbn naval submarin base silverdal wa email jerrytrishaolcom x front rang scientic boulder co email jrugesobolevcoloradoedu problem use grid increas size final introduc new method comput interpol weight show certain troublesom case signicantli improv amg perform studi dier previou report perform amg eg primarili examin algorithm scalabl emphasi unstructur grid introduct new algorithm comput interpol weight section descript detail amg algorithm given provid understand result later discuss section present result amg appli rang symmetr scalar problem use nite element discret structur unstructur mesh amg also test nonsymmetr problem structur unstructur mesh result present section version amg design system equat test focu problem elast result discuss section section introduc report test new method comput interpol weight conclud remark section scalar amg algorithm begin outlin basic principl techniqu compris amg detail explan may found consid problem form n n matrix entri ij conveni indic iden tie grid point u denot valu u point i grid denot ng multigrid method central idea error e elimin relax must remov coarsegrid correct appli ellipt problem exampl simpl relax jacobi gaussseidel reduc high frequenc error compon ecient slow remov smooth compo nent howev smooth error remain relax approxim accur coarser grid done solv residu equat coarser grid interpol error back ne grid use correct negrid approxim coarsegrid problem solv recurs applic method one iter process proceed level known multigrid cycl geometr multigrid standard uniform coarsen linear interpol often use main design task choos relax scheme reduc error coarsen process cannot approxim one purpos amg free solver depend geometri amg instead xe relax normal gaussseidel main task determin coarsen process approxim error relax cannot reduc underli assumpt amg smooth error character small residu is ae basi choos coars grid dene interpol weight simplic discuss here assum symmetr positivedenit mmatrix ii ij j i assumpt made conveni amg frequent work well matric mmatric dene multigrid method sever compon requir use superscript indic level number denot nest level compon amg need follow grid grid oper grid transfer oper interpol k restrict k relax scheme level compon dene recurs dene cycl follow algorithm mv k otherwis time k u perform coars grid correct set solv level k mv k correct solut time k u cycl work ecient relax coarsegrid correct must work togeth eectiv reduc error compon give two principl guid choic compon p error compon ecient reduc relax must well approxim rang interpol p coarsegrid problem must provid good approxim negrid error rang interpol aect dierent set compon given relax scheme p determin coars grid interpol p aect restrict coars grid oper order satisfi p amg take algebra relax xed coars grid interpol automat chosen rang interpol oper accur approxim slowli diminish error compon which may alway appear smooth usual sens p satis dene restrict coarsegrid oper galerkin formul k symmetr posit denit ensur correct exact solut coarsegrid problem best approxim rang interpol best meant anorm jjvjj hav vi choic compon amg done separ preprocess step partit disjoint set c k f k a b dene interpol k set k small enough set set go step step core amg setup process sinc focu coarsen particular level k superscript omit c f substitut necessari avoid confus goal setup phase choos set c coarsegrid point and negrid point small set c c interpol point interpol form f c u c dene interpol weight dene interpol weight recal slow converg equival small residu ae thu focu error satisfi ii e now ij rel small could substitut e e j approxim relat would still hold motiv denit set depend point i denot consist set point j ij larg sens henc depend j becaus satisfi ith equat valu u aect valu u j variabl denit use amg ik typic set also dene set is set point j depend point i say set uenc point i note terminolog dier classic use refer strongli connect strongli depend j j use specic terminolog basic premis amg relax smooth error direct uenc henc may select c set interpol point i adher follow criterion choos c f p f j either c j c is ne point point uenc must either coars point must depend coars point use interpol u allow approxim necessari dene interpol rewritten as ii e ik e k amg interpol dene make follow approxim jk e k jk otherwis substitut solv e give desir interpol weight point select coars grid coars grid chosen satisfi criterion abov attempt control size employ twostag process describ modi slightli ect modi terminolog grid rst color provid tent cf choic essenti point largest number uenc in uenc count color c point point depend c point color f point point uenc f point like use c point uenc count increas process repeat point either c f point detail initi cf choic follow repeat k set the number point depend point i pick u maxim set fig fig point depend fig do fjg k j u set increment point uenc new f point u set next second pass made f point may recolor c point ensur p satis pass f point examin coars interpolatori set c c dene then depend anoth f point j point uenc j scan see c case j tent convert cpoint ad c depend examin anew f point depend depend point c j perman made cpoint algorithm proce next f point repeat if howev algorithm nd anoth f point depend depend point c made cpoint j return pool f point procedur follow minim number f point convert cpoint make brief comment comput storag cost setup phase unlik geometr multigrid cost cannot predict precis instead comput cost must estim base averag stencil size grid averag number interpol point per f point ratio total number gridpoint grid number point ne grid grid complex ratio number nonzero entri matric negrid matrix oper complex detail analysi beyond scope work good rule thumb comput eort setup phase typic equival four ten v cycl result symmetr problem section result amg appli symmetr scalar problem present initi constantcoeci diusion problem test baselin comparison begin introduc complic includ unstructur mesh irregular domain anisotrop discontinu coecient result problem follow problem run use amg solver xed paramet mani problem possibl improv result tune input paramet there mani purpos show amg basic behavior robust rang problem primari indic speed algorithm asymptot converg factor per cycl determin appli cycl homogen prob lem start random initi guess measur reduct norm residu one cycl next we use homogen problem avoid contamin machin represent gener ratio start small rst cycl increas asymptot valu cycl slowli converg compon becom domin asymptot valu also good indic actual error reduct one cycl next use norm residu although easi show asymptot converg factor spectral radiu amg v cycl iter oper henc independ choic norm time given setup singl v cycl setup time take choos coarser grid dene interpol comput coars grid matric cycl time one cycl full solut time three machin use studi major smaller test perform pentium mhz pc although perform sun sparc ultra larger problem demonstr scalabl use dec alpha reason time compar within individu problem addit time smallest problem high rel error larger test give better pictur perform grid complex dene number grid point level k give idea quickli grid reduc size comparison standard multigrid number point reduc factor d yield grid complex respect amg tend coarsen slowli oper complex better indic work per cycl dene averag number nonzero entri per row or stencil size level k thu oper complex ratio total number nonzero matrix entri level nest level sinc relax work proport number matrix entri give good idea total amount work relax rel relax work nest grid also total storag need rel requir ne grid matrix geometr multigrid grid oper complex equal amg oper complex usual higher sinc averag stencil size tend grow somewhat coarser level note converg factor complex entir independ specic machin test perform test report here focu nite element discret r x y x y sever dierent mesh diusion coecient use regular domain structur unstructur grid rst problem poisson equat dierent domain mesh use demonstr behavior amg simpl equat begin simplest model problem success amg regulargrid poisson problem welldocu purpos assess scalabl problem simpl point laplacian oper homogen dirichlet boundari condit unit squar experi run uniform mesh converg factor vs log problem size cycl time vs log problem size vs log problem size fig top left converg factor function number mesh point problem uniformmesh point laplacian top right loglog plot setup time circl cycl time triangl uniformmesh point laplacian dot line refer show perfectli linear scale bottom oper circl grid triangl complex uniformmesh point laplacian n n interior grid point yield mesh size result problem display figur converg factor per cy cle stabl approxim problem size setup cycl time nearli linear n compar dot line depict perfectli linear hypothet data set here setup time averag roughli time cycl note befor oper complex higher correspond grid complex appear unaect problem size data indic amg appli uniformmesh laplacian algorithm scalabl comput work on per cycl converg factor o per cycl import compon studi determin extent algorithm scalabl retain increas problem complex problem equat problem discret unstructur triangular mesh mesh obtain uniform triangul randomli choos node collaps neighbor node smooth result mesh result oper might repres mmatric case gener case use mesh typic exampl shown top left figur result experi display figur unstructur mesh converg factor tend show depend mesh size grow around nest grid note howev grid tend less structur mani found practic care taken ensur good mesh mesh may dier characterist such aspect ratio larg degre random construct complex also higher unstructur mesh setup time increas correspondingli main point amg deal eectiv unstructur mesh without much degrad converg uniform case irregular domain continu use laplacian irregular domain sinc emphasi eect irregular restrict test two repres mesh size give snapshot algorithm scalabl problem comput domain unstructur triangular discret toru dierent mesh size use result grid condit around hole impos neumann condit outer boundari problem domain problem shown figur boundari condit neumann except dirichlet condit impos around small hole right mesh uniform result mesh respect domain easili admit much coarser mesh problem domain problem shown bottom figur dirichlet condit impos exterior boundari neumann condit interior boundari triangular unstructur mesh use result problem given tabl among problem problem simplest domain least structur mesh slowest converg indic domain congur gener littl eect amg behavior structur and perhap qualiti mesh import tabl result problem poisson problem unstructur mesh irregular domain converg problem n factorcycl sec sec complex complex converg factor vs log problem size cycl time vs log problem size vs log problem size fig top left typic unstructur grid problem obtain randomli delet node regular grid smooth result top right converg factor function number mesh point unstructuredmesh point laplacian bottom left loglog plot setup time circl cycl time triangl unstructuredgrid point laplacian dot line refer show perfectli linear scale bottom right oper circl grid triangl complex unstructuredgrid point laplacian fig domain top left typic grid top right problem note mesh size necessari display triangul coars observ dirichlet hole finer mesh use calcul bottom typic grid problem isotrop diusion next problem set deal isotrop diusion discontinu dx y caus problem mani solut method includ standard multigrid method although possibl get good result either align discontinu along coars grid line use operatordepend interpol amg noth special requir sinc base operatordepend interpol problem categor accord diusion coecient use unit squar discret four mesh two structur mesh two unstructur mesh diusion coecient dene term paramet c allow either follow problem dx problem dx problem dx max jx j jy j c otherwis problem dx c otherwis result problem present tabl contain observ converg factor oper complex variou combin grid size type diusion coecient function discontinu jump size overal result fairli predict converg factor fairli uniform structur mesh tend grow slightli increas grid size notic larger unstructur grid appear grow somewhat increas grid size as note befor comparison among unstructur grid variou size must take account gener involv random may dier import way converg factor seem depend signicantli size jump diusion coecient mani case result better inde amg appli success problem much larger jump see also problem note minor variat oper complex dierent problem dierent grid size signic eect oper complex appear whether grid structur unstructur latter show complex increas note howev even case entir oper hierarchi store three time storag requir negrid alon tabl result problem poisson problem variabl discontinu coecient uniform mesh size unstructur mesh size problem c conv cmplxti conv cmplxti conv cmplxti conv cmplxti problem design examin case diusion coecient discontinu determin whether scale discontinu region aect perform accordingli problem use checkerboard pattern even specic problem problem problem last problem group problem dx result problem display tabl overal trend similar result problem show converg factor grow slightli problem size notic larger unstructur grid tabl result problem poisson problem variabl discontinu coecient uniform mesh size unstructur mesh size problem c conv cmplxti conv cmplxti conv cmplxti conv cmplxti best result isotrop diusion problem obtain problem coecient continu worst converg factor obtain checkerboard pattern problem note amg perform well problem smooth function approxim constant center region zero highdius zone near boundari smoothli vari be tween good interpol lowdius band essenti good converg amg appear work quit well discontinu diusion coecient even vari randomli larg factor point point problem anisotrop diusion next seri problem deal anisotrop diusion aris sever way anisotropi introduc mesh rene dierent direct perhap resolv boundari layer local phenomenon anoth case tensor product grid use order rene area x mesh size small x x larg elsewher maintain logic rectangular mesh caus anisotrop discret dierent part domain rel easi deal geometr multigrid line relax andor semicoarsen use nonalign anisotropi dicult handl standard multigrid aris oper itself case full potenti oper transon ow perform amg gridinduc align anisotropi report previous instead focu nonalign anisotropi type anisotropi written term diusion equat use coecient matrix co sin sin constant give oper direct rectangular grid mesh size h x h usual poisson equat correspond diusion equat x problem problem featur nonalign anisotrop oper unit squar dirichlet boundari condit condit two side case examin combin discret uniform squar mesh with bilinear element uniform unstructur triangular mesh with linear element uniform mesh unstructur mesh converg factor problem shown figur gener degrad increas expect indic lessen align anisotropi grid direct strong anisotropi case yield converg factor high note abov nonalign case dicult even standard multigrid subject ongo studi one encourag result unstructur grid formul rel insensit grid anisotropi converg factor hover case except result indic amg rather robust anisotrop problem although converg factor somewhat higher typic obtain amg isotrop problem converg factor vs converg factor vs fig converg factor plot function anisotropi direct left moder anisotropi plot solid line uniform mesh squar discret dot line uniform mesh triangular discret dash line unstructur triangul case larger grid size indic symbol o problem use oper problem r dru yield discret that circl center origin depend tangenti direct none radial direct problem dicult solv convent method use mesh problem amg produc converg factor given tabl tabl result problem circular diusion coecient uniform mesh squar uniform mesh triangular unstructur mesh converg factor illustr diculti problem cannot handl easili geometr method even regular mesh polarcoordin mesh would allow block relax strongli coupl point would suer diculti polarcoordin grid eg singular origin would useless gener anisotropi converg amg much slower normal associ multigrid method exampl show amg use even extrem dicult problem problem turn attent three dimens expect special diculti here sinc amg base algebra relationship variabl problem poisson problem unit cube discret trilinear nite element rectangular mesh dirichlet boundari condit impos condit impos boundari mesh line space number mesh interv vari produc sever grid dierent space extent three coordin direct variou combin mesh size use converg factor oper complex shown tabl tabl result problem poisson problem regular rectangular mesh converg oper nx hx ny hy nz hz n factorcycl complex problem unstructur mesh problem gener code use lawrenc livermor nation laboratori diusion problem gx domain segment sphere coecient ax larg constant r small constant r step discontinu boundari dirichlet boundari surfac symmetri discret nite element use hexahedr element figur show locat node element corner one prob lem three problem size given converg factor oper complex problem given tabl tabl result problem unstructur diusion problem converg oper amg appar work quit well problem includ discontinu coecient converg factor good case complex vari signicantli highest valu uniform grid decreas markedli increas grid anisotropi may taken evid amg automat take advantag direct uenc perform well suit symmetr scalar test problem mani problem design dicult often unrealist so especi circular anisotrop diusion pattern random diu sion coecient recal amg algorithm paramet tune use case number tool increas ecienc amg especi symmetr problem prove use mani case one fig node element corner diusion problem top left view node locat top right view directli overhead show radial line node azimuth direct bottom distribut node within plane constant azimuth socal v cycl coarsegrid correct multipli optim paramet determin minim anorm correct error anoth success appli amg maxwel equat use outer conjug gradient iter amg cycl precondition often amg fail perform well problem lie small number compon reduc ecient relax coarsegrid correct conjug gradient ecient case method improv ecienc includ f cycl full multigrid fmg method whose applic amg subject futur research amg appli nonsymmetr scalar problem although much motiv theori amg base symmetri matrix requir good converg behavior mildli nonsymmetr problem behav essenti like symmetr counterpart case aris nonsymmetr discret symmetr problem use origin problem predominantli ellipt import requir current version amg point gaussseidel relax converg howev slowli thu central dierenc rstorder term domin cannot use sever loss diagon domin even case success version amg develop use kaczmarz relax nevertheless restrict upstream dierenc retain use gaussseidel relax problem convectiondius problem form sin dirichlet boundari condit triangular mesh use structur unstructur diusion term discret nite element convect term discret use upstream dierenc is integr convect term comput triangl ad equat correspond node largest coecient the node most upstream note result matrix odiagon entri sign two choic employ conduct result present figur curv top left graph structur grid result display solid line unstructuredgrid result display dash line pair curv curv marker o indic mesh larger n convectiondomin case shown top right structur grid bottom unstructur grid case smaller n shown solid line larger n dash line note converg gener good fairli uniform particularli unstructur case result smaller uniform mesh especi good ow align direct due triangul obtain uniform mesh domain partit squar squar split two triangl diagon go lower left upper right good direct align edg triangl also eect qualiti discret converg ow direct here discret use convect term caus rather sever loss posit odiagon fault discret amg smaller uniform mesh converg factor vs converg factor vs structur grid converg factor vs unstructur grid fig converg factor plot function direct nonsymmetr prob lem top left weaker convect case solid line uniform mesh dash line unstructur triangul case larger grid size indic placement symbol o top right convectiondomin case structur grid solid line smaller n larger n indic dash line bottom convectiondomin case unstructur grid solid line smaller n larger n indic dash line amg unabl handl discret produc fail setup phase often multigrid applic problem converg indic problem discret case here note unstructur grid ow cannot align or against grid converg gener uniform interest point that mani case smaller diusion coecient reduc converg factor particularli strike unstructur mesh final note gener much dierenc result benet accident align relax ow direct and convers slow converg due upstream relax due cf order relax test show amg appli nonsymmetr problem converg factor test gener less certainli accept concern may rais scalabl issu sinc converg factor larger unstructur mesh notic greater smaller unstructur grid remain determin converg factor continu grow increas problem size reach asymptot limit amg system equat extens amg system problem one function approxim straightforward mani dierent approach formul consid problem two unknown function form u scalar algorithm could work special circumst for exampl b c rel small sens but gener scalar idea smooth break down one approach would iter block fashion two equat two separ applic amg one use matrix solv u hold v xed one use b solv v hold u xed repeat converg often slow altern use block iter precondition outer conjug gradient solut process anoth fairli simpl altern coupl block iter process level is coarsen separ function obtain two interpol oper u v dene full interpol oper form galerkin approach use construct coars grid oper setup process complet multigrid cycl perform usual call function approach sinc treat function separ determin coarsen interpol u v dene grid also possibl coupl coarsegrid choic both allow nodal relax unknown updat simultan point follow result function approach appli sever problem elast problem problem planestress elast u v displac x direct respect dicult problem standard multigrid method especi domain long thin problem discret rectangular grid use bilinear nite element sever dierent problem size domain congur use problem problem elast u v w displac three coordin direct problem discret rectangular grid use trilinear nite element sever dierent problem size domain congur use test take function approach v cycl use test result problem contain tabl problem tabl note complex stabl d depend problem size d converg depend fairli heavili number xed boundari d converg degrad number free boundari increas tabl result elast problem xed converg oper tabl result elast problem xed converg oper iter interpol weight occasion encount situat converg amg poor yet specic reason appar experi lead us believ fundament problem mani case stem limit matrix entri jk ect true smooth e j e k often true uenc variabl clear one case limit quit evid nite element extrem aspect ratio use especi case extrem grid anisotropi thinbodi elast simpl exampl consid ninepoint neg laplacian base quadrilater element stretch xdirect stencil chang limit case longer mmatrix inde even moder aspect ratio eg odiagon entri sign immedi clear neighbor east west central point treat uenc central point even treat uenc similar question aris corner point relat central point geometr intuit indic decoupl center treat uenc yet common choic amg treat uenc anoth diculti aris two f point j uenc other e j must approxim second sum right side determin weight i e must approxim role j revers determin weight j howev sinc e e j interpol be f point valu make sens use interpol obtain approxim is approxim e e j e respect note approxim point c unchang equat give implicit system interpol weight solv iter scheme initi approxim new interpol weight calcul gaussseidellik manner use recent comput weight make approxim two sweep gener sucient import addit process that rst sweep interpol set modi remov c point neg interpol weight comput second sweep use comput nal interpol weight present result two experi illustr eectiv certain type problem use iter weight denit scheme exampl may found problem oper stretch quadrilater laplacian mention abov discret stretch factor repres ratio xdimens ydimens quadrilater valu use case converg factor comput choic latter case corner point treat uenc amg select semicoarsen coars grid method geometr multigrid would take tabl result problem converg factor standard weight iter weight result display tabl smallest problem iter weight eect howev converg rate problem quit good even standard weight moder stretch eect iter weight correct misidenti uenc ie improv improv result even correctli identi uenc extrem stretch latter eect appli problem use unstructur diusion oper problem whose grid display figur problem size problem includ larg jump discontinu o diusion coecient tabl result problem converg factor standard weight iter weight result display tabl see that smallest problem iter weight eect converg fairli good anyway even standard weight two larger problem iter weight produc signic improv choic appar iter weight counter eect poor element aspect ratio near boundari jump discontinu identifi uenc among variabl problem similar problem character coecient discontinu andor extrem aspect ratio element iter weight denit prove quit eectiv howev iter weight alway eectiv improv slow amg converg case actual caus minor degrad perform studi new approach call element interpol amg promis overcom diculti associ poor aspect ratio misidenti uenc thinbodi elast provid individu element stiness matric avail conclus need fast solver mani type problem especi discret unstructur mesh clear indic market softwar capabl amg oer studi demonstr robust amg solver wide rang problem test indic extend robust ecient code develop problem dicult solv techniqu amg also shown good scalabl model problem scalabl tend degrad somewhat increas problem complex converg factor remain tractabl even worst situat r multigrid method diusion equat strongli discontinu coecient stabil algebra multilevel iter algebra multilevel iter method theori applic class hybrid algebra multilevel precondit method toward algebra multigrid ellipt problem second order guid multigrid develop guid applic uid dynam outlin modular algebra multilevel method interpol relat coarsen techniqu algebra multigrid method addit multilevelprecondition base bilinear interpol note vector algebra multigrid algorithm matrix analysi converg algebra multigrid method symmetr posit de multigrid method variat problem gener theori vcycl interpol weight algebra multigrid smooth properti sor relax algebra multigrid method simpl parallel algebra multigrid multigrid method solv time harmon maxwel equat variabl materi paramet energyminimizinginterpol robust multigrid method tr ctr emden henson ulrik meier yang boomeramg parallel algebra multigrid solver precondition appli numer mathemat v n p april chi shen jun zhang kai wang distribut block independ set algorithm parallel multilevel ilu precondition journal parallel distribut comput v n p march randolph e bank compat coarsen multigraph algorithm advanc engin softwar v n p may k krau j schicho algebra multigrid base comput molecul scalar ellipt problem comput v n p februari oliv brker marcu j grote spars approxim invers smoother geometr algebra multigrid appli numer mathemat v n p april touihri variat algebra recurs multilevel solver arm solut cfd problem appli numer mathemat v n p novemb j j hey t a manteuffel s f mccormick l n olson algebra multigrid higherord finit element journal comput physic v michel benzi precondit techniqu larg linear system survey journal comput physic v n p novemb