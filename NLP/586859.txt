t evolutionari tree learn polynomi time twostat gener markov model a jstate gener markov model evolut due steel stochast model concern evolut string alphabet size j particular twostat gener markov model evolut gener wellknown cavenderfarrisneyman model evolut remov symmetri restrict which requir probabl turn along edg probabl turn along edg farach kannan show probabl approxim correct paclearn markov evolutionari tree cavenderfarrisneyman model provid target tree satisfi addit restrict pair leav suffici high probabl same show remov restrict therebi obtain first polynomialtim paclearn algorithm in sens kearn et al proceed th annual acm symposium theori comput pp gener class twostat markov evolutionari tree b introduct jstate gener markov model evolut propos steel model concern evolut string such dna string alphabet size j model describ follow jstate markov evolutionari tree consist topolog a root tree edg direct away root togeth follow paramet root tree associ j probabl ae sum edg tree associ stochast transit matrix whose state space alphabet probabilist experi perform use markov evolutionari tree follow root assign letter alphabet accord probabl ae letter chosen probabl ae letter propag edg tree letter pass edg undergo probabilist transit accord transit matrix associ edg result string length n concaten letter obtain n leav tree jstate markov evolutionari tree thu defin probabl distribut lengthn string alphabet size j the probabilist experi describ produc singl sampl distribut avoid get bog detail work binari alphabet thu consid twostat markov evolutionari tree follow farach kannan erdo steel szeke warnow ambaini desper farach kannan interest problem learn markov evolutionari tree given sampl output distribut follow farach kannan ambaini et al consid problem use polynomi mani sampl markov evolutionari tree learn markov evolutionari tree whose distribut close use variat distanc metric measur distanc two distribut string length n variat distanc nleaf markov evolutionari tree use denot variat distanc distribut distribut use probabl approxim correct pac distribut learn model kearn mansour ron rubinfeld schapir selli main result first polynomialtim paclearn algorithm class twostat markov evolutionari tree which refer met theorem let ffi ffl posit constant algorithm given polyn ffl ffi sampl met nleaf topolog probabl least met construct algorithm satisfi varm interest paclearn algorithm biolog import restrict class met given farach kannan ambaini desper farach kannan algorithm and relat algorithm discuss fulli section point simpli note algorithm appli met satisfi follow restrict restrict transit matric symmetr the probabl turn along edg probabl turn biologist would view n leav exist speci intern node hypothet ancestr speci model singl experi describ would produc singl bit posit for exampl dna n speci restrict posit constant ff everi pair leav x y satisfi explain section restrict significantli simplifi problem learn markov evolutionari tree though certainli make easi main contribut paper remov restrict use variat distanc l distanc measur distanc target distribut hypothesi distribut kearn et al formul problem learn probabl distribut term kullbackleibl diverg distanc target distribut hypothesi distribut distanc defin sum lengthn string ds logdsd s kearn et al point kl distanc give upper bound variat distanc sens kl distanc omegagamma ard henc class distribut paclearn use kl distanc paclearn use variat distanc justifi use variat distanc metric show revers true particular prove follow lemma appendix class probabl distribut domain f g n paclearn variat distanc metric paclearn kldistanc measur lemma prove use method relat ffl bayesian shift abe warmuth note result requir discret domain support target distribut domain f g n use here rest section organis follow subsect discuss previou work relat gener markov model evolut relationship work work subsect give brief synopsi algorithm paclearn markov evolutionari tree subsect discuss interest connect problem learn markov evolutionari tree problem learn mixtur ham ball studi kearn et al previou work relat work twostat gener markov model studi paper generalis cavenderfarrisneyman model evolut describ cavend farrisneyman model let us return twostat gener markov model fix attent particular twostat alphabet f g thu stochast transit matrix associ edg e simpli matrix e denot probabl turn along edg e e denot probabl turn along edg e cavenderfarrisneyman model simpli special case twostat gener markov model transit matric requir symmetr is special case twostat gener markov model restrict from page hold so e describ past work learn markov evolutionari tree gener markov model cavenderfarrisneyman model throughout paper defin weight we edg e steel show jstate markov evolutionari tree satisfi i ae i ii determin everi transit matrix outsid fgamma g distribut uniqu determin topolog case show recov topolog given joint distribut everi pair leav state case suffic know exact valu covari everi pair leav case defin weight e edg e node v node w we w leaf we r steel observ distanc multipl along path distanc two leav equal covari sinc distanc multipl along path logarithm addit therefor method construct tree addit distanc method bandelt dress use reconstruct topolog steel method show recov paramet markov evolutionari tree even exact distribut known particular quantiti obtain edg e onedimension distanc rather twodimension vector give two transit probabl e e method show recov paramet exactli given exact distribut recov paramet approxim well enough approxim distribut given polynomiallymani sampl farach kannan ambaini desper farach kannan work primarili special case twostat gener markov model satisfi two restrict page farach kannan paper breakthrough prior paper noth known feasibl reconstruct markov evolutionari tree sampl given posit constant ff show paclearn class met satisfi two restrict howev number sampl requir function ff taken constant ambaini et al improv bound given farach kannan achiev asymptot tight upper lower bound number sampl need achiev given variat distanc result eleg import nevertheless restrict place model significantli simplifi problem learn markov evolutionari tree order explain true explain approach farach et al algorithm use sampl met satisfi restrict abov estim distanc two leav the distanc relat covari leav author relat distanc two leav amount evolutionari time elaps them distanc thu turn time algorithm use approxim evolutionari time time close form addit metric fit onto tree final time turn back transit probabl symmetri assumpt essenti approach symmetri relat onedimension quantiti evolutionari time otherwis twodimension quantiti the probabl go probabl go second restrict also essenti probabl x differ allow approach evolutionari time x would tend would mean order approxim interleaf time accur algorithm would get distanc estim accur would requir mani sampl ambaini et al generalis result symmetr version jstate evolutionari model subject two restrict abov erdo steel szeke warnow also consid reconstruct markov evolutionari tree sampl like steel unlik paper paper farach et al erdo et al interest reconstruct topolog met rather paramet distribut interest use sampl possibl reconstruct topolog show reconstruct topolog jstate gener markov model markov evolutionari tree satisfi i everi root probabl bound ii everi transit probabl bound iii posit quantiti determin transit matrix along edg number sampl requir polynomi worst case polylogarithm certain case includ case met drawn uniformli random one sever specifi natur distribut note restrict iii erdo et al weaker farach kannan restrict from page howev erdo et al show reconstruct topolog thu work restrict case topolog uniqu construct use sampl show reconstruct paramet markov evolutionari tree approxim distribut synopsi method paper describ first polynomialtim paclearn algorithm class twostat markov evolutionari tree met algorithm work follow first use sampl target met algorithm estim pairwis covari leav met second use covari leav met partit relat set leav essenti leav differ relat set small covari alway possibl use polynomi mani sampl discov relat set connect target topolog nevertheless show close approxim distribut target met approxim distribut relat set close join relat set cut edg first step relat set discov approxim correct topolog sinc restrict class met consid cannot guarante construct exact induc topolog in target met nevertheless guarante construct good enough approxim topolog construct look tripl leav show ensur tripl consid larg interleaf covari deriv quadrat equat allow us approxim recov paramet tripl use estim interleaf covari estim probabl particular output compar outcom differ tripl use comparison construct topolog topolog use quadrat equat discov paramet tree show section abl prevent error estim accumul abl guarante estim paramet within small addit error real paramet normalis target met thi show variat distanc hypothesi target small markov evolutionari tree mixtur ham ball ham ball distribut binari string length n defin center a string c length n corrupt probabl p gener output distribut one start center flip bit or not accord independ bernoulli experi probabl p linear mixtur j ham ball distribut defin j ham ball distribut togeth j probabl ae sum determin ham ball distribut particular sampl taken fix j kearn et al give polynomialtim paclearn algorithm mixtur j ham ball provid j ham ball corrupt probabl pure distribut binari string length n defin n probabl gener output distribut ith bit set independ probabl otherwis pure distribut natur generalis ham ball distribut clearli everi linear mixtur j pure distribut realiz jstate met starshap topolog thu algorithm given paper show learn linear mixtur two pure distribut furthermor generalis result jari alphabet would show learn linear mixtur j pure distribut algorithm descript paclearn algorithm analysi requir follow defini tion posit constant ffi ffl input algorithm consist polyn ffl ffi sampl met nleaf topolog let ffl made effort optimis constant howev state explicitli reader verifi constant defin consist defin ffl contract met topolog tree form contract intern edg e edgedist e defin steel see equat x leav topolog use notat covx y denot covari indic variabl event the bit x the bit thu use follow observ observ met topolog e intern edg root r node v topolog except v root so e goe v r construct met topolog distribut thi simpli set appropri from distribut set e from distribut set e from distribut otherwis set e observ met topolog v degre node edg e lead v edg f lead v topolog except e kind paclearn consid paper gener kearn et al also show evalu special case mixtur j ham ball describ abov use observ output distribut subtre node met independ provid bit node fix also solv evalu problem met particular calcul in polynomi time probabl given string output hypothesi met f contract form edg g met topolog distribut construct it simpli set observ met topolog met topolog distribut leav everi intern edg e satisfi e e proof observ say edg e good e start root make edg along path leaf good except perhap last edg path edg e u v first nongood edg path simpli set e make edg good side effect interchang mean node v long interchang even number time along everi path preserv distribut leav thu make edg good except possibl last one use get pariti number interchang correct describ algorithm subsect prove probabl least gamma ffi met construct satisfi varm ffl thu prove theorem estim covari pair leav pair x y leav obtain observ covari covx y that probabl least gamma ffi observ covari satisfi lemma step requir polyn ffl ffi sampl proof consid leav x let p denot prxi chernoff bound see k sampl observ proport output p probabl least pair x y leav estim estim calcul covx y within sigmaffl use equat step partit leav relat set consid follow leaf connect graph whose node leav node x connect posit edg connect neg edg covx y gammaffl connect compon graph ignor sign edg form set relat leav set relat leav let ss denot leaf smallest index met properti leav x z covi z posit iff covx y covi z sign to see thi use follow equat prove algebra manipul equat v taken least common ancestor x ff ff transit probabl along path v x fi fi transit probabl along path v y therefor long observ covari accur state step sign edg leaf connect graph partit leav two set way ss covari pair leav posit covari pair leav posit covari leaf leaf neg set relat leav let s denot subtre form delet leav contract degre node root neighbour ss let ms met topolog s distribut leav satisfi follow ffl everi intern edg e ms e ffl everi edg e node e ffl everi edg e node e observ guarante ms exist observ long observ covari accur state step which happen probabl least gamma ffi relat set leaf x leaf jcovx yj ffl observ long observ covari accur state step which happen probabl least gamma ffi relat set edg e s leav b connect e jcova bj ffl observ long observ covari accur state step which happen probabl least gamma ffi relat set everi intern node v ms proof observ suppos contrari v intern node ms use observ reroot ms v without chang distribut let w child v equat everi pair leav b connect v w satisfi jcova bj observ follow observ long observ covari accur state step which happen probabl least gamma ffi relat set everi edg e ms we ffl proof observ follow observ use equat recal step relat set find ffl contract s s section assum observ covari accur state step thi happen probabl least gamma ffi let relat set probabl least gamma ffin find ffl contract s s sinc n relat set ffl contract construct probabl least gamma ffi recal ffl contract ms tree form s contract intern edg e e start follow observ allow us redirect edg conveni observ e intern edg s e remain unchang e redirect observ proof observ prove algebra manipul equat observ note from observ everi endpoint v e satisfi thu redirect observ degener e defin describ algorithm construct ffl contract s s build s induct ad leav one one is ffl contract s subset consid leaf x build ffl contract precis order leav ad matter add new leaf x unless contain leaf jd covx yj ffl add new leaf x proceed follow first consid use method follow section section estim e specif let u v node adjac s show estim e afterward in section show insert x estim e section suppos met ms set leav form singl relat set s topolog ms s ffl contract edg s edg s wish estim e within sigmaffl ensur overal probabl estim rang ffin proof follow equat straightforward typic appli situat z error approxim case e intern edg first estim e e correct valu observ ffl estim within factor sigma ffl correct valu similarli estim within factor sigma ffl gamma correct valu use equat estim e within sigmaffl particular estim e inequ use equat fact e similarli equat estim e least show estim e e say path node ff node fi met strong jcovff fij ffl follow equat node fl path say quartet c b j a d leav a b c good estim edg edg s follow hold s see figur descend v undirect path c strong pass u v path u descend b strong intersect undirect path c node u path v descend strong intersect path v node v say d appar good estim e follow hold descend v undirect path c strong pass u v path u descend b strong intersect undirect path c node u path v descend strong intersect path v node v e c figur find observ e edg s c b j a d good estim e leav proof observ follow equat definit good estim d good estim e use along polyn ffl ffi sampl ms estim e e use suffici mani sampl probabl estim within sigmaffl correct valu ffin proof let q q denot transit probabl v see figur let transit probabl u a first show estim loss gener by observ assum c descend u otherwis reroot s u without chang distribut node p p let fi path u b let fl path u c defin these quit correspond condit covari b c relat these also defin covb c follow equat prove algebra manipul equat equat definit f d case a case equat observ equat equat impli also sinc equat clear could find p exactli show polynomiallymani sampl approxim valu suffici accur use approxim equat obtain approxim within sigmaffl proof lemma use equat estim within sigmaffl ffl whose invers polynomi n ffl note estim covb c nonzero observ as long ffl ffl abl use estim f definit now use definit f equat estim f observ error ffl ffl whose invers polynomi n ffl thi accomplish make ffl small enough respect ffl accord equat similarli bound amount underestim f use definit estim d estim use equat covb c again observ error made within sigmaffl ffl whose invers polynomi n ffl by make ffl ffl suffici small follow estim us upper bound valu function ffl estim within sigmaffl ffl whose invers polynomi n ffl impli estim p p within sigmaffl observ equat impli wp ffl thu estim nonzero impli similarli estim use equat estim within sigmaffl correct valu repeat trick find estim q q also within sigmaffl use leaf thi observ impli use equat estim e equat observ wp ffl impli error ffl ffl similarli estim e least e estim e within sigmaffl e estim e e explain begin section use estim estim case b case equat observ equat equat impli equat remain unchang process estim from new equat case a conclud proof lemma observ suppos e edg u v s edg s u u v v good estim c b j a d e furthermor everi good estim e appar good estim e refer figur ae oe ae c figur d good estim appar good estim c figur d appar good estim e good estim proof leav c found satisfi first two criteria definit good estim observ leaf b found satisfi third criterion observ equat fact degre u least see text equat similarli leaf found satisfi fourth criterion d appar good estim e intern edg s contract ffl contract s observ suppos e edg u v s edg s u u v v suppos c b j a d appar good estim e let u meet point c b s let v meet point c s refer figur c b j a d good estim path p u v s also p e proof fact c b j a d good estim p follow definit good estim fact p e follow fact distanc multipl along path bound observ impli order estim e within sigmaffl need estim e use appar good estim e take maximum lemma failur probabl given estim ffin probabl least gamma ffin estim give estim within sigmaffl correct valu sinc n edg e s add new leaf x n time estim within sigmaffl probabl least gamma ffin case e intern edg case leaf s say pair leav b c good estim e follow hold s path leav v b c meet u jcovv bj jcovv cj jcovb cj least ffl say b c appar good estim e follow hold s path leav v b c meet u jcovv bj jcovv cj jcovb cj least ffl previou case result follow follow observ observ c good estim e use along polyn ffl ffi sampl ms estim e e the probabl estim within sigmaffl correct valu ffin proof follow proof lemma observ suppos e edg u leaf v s edg s u u good estim b c e furthermor everi good estim e appar good estim e proof follow proof observ equat observ suppos e edg u leaf v s edg s u u suppos b c appar good estim e let u meet point b v c s b c good estim path p u v s also p e proof follow proof observ use estim e return problem show add new leaf x s indic abov everi intern edg e use method section estim e edg s u u v v observ valu e exce contract e accuraci estim guarante contract e definit contract e add new leaf x s follow insert new edg either identifi x node alreadi s splice x middl edg s show decid attach x s start follow definit let subset everi jcovx yj ffl let subtre s induc leav let subset everi jd covx yj ffl subtre s induc leav observ s fxg x attach edg edg correspond e s that is e edg proof observ good estim c b j a d e sinc x ad use equat jcovx x j ffl thu observ equat everi leaf fa b c dg jcovx yj ffl thu a b c e attach edg contain node u s u node proof sinc u intern node s degre least observ equat three leav meet u jcovu j ffl similarli jcovu vj ffl thu jcovx j ffl observ proof follow accuraci covari estim step use follow algorithm decid attach x algorithm use follow tool tripl a b c leav fxg let u denot meet point path leav a b c s fxg let u met distribut ms fxg root u m u exist observ let c a b c denot weight path u c u observ c a b c equal weight path u c ms fxg thi follow fact reroot u redirect intern edg follow definit equat equat c a b c cova ccovb c a b c fxg accuraci covari estim equat absolut valu pairwis covari pair least ffl section estim cova c covb c cova b within factor sigma ffl correct valu ffl whose invers polynomi n ffl thu estim c a b c within factor sigma ffl correct valu take suffici mani sampl ensur probabl estim outsid requir rang ffin thu probabl estim outsid rang x ffin determin attach x choos arbitrari intern root u first see x place respect u neighbour v u pair leav a u leaf b v side perform follow two test figur set intern node if v leaf perform test x f u figur either test succe observ valu x a least test succe observ valu b a gamma ffl make follow observ observ x u side u v s fxg u u v v u test fail proof sinc u intern node degre least thu construct test one depict figur if x figur still correct would mean f similarli v leaf simpli f edg v b havef howev succeed left hand fraction least furthermor succeed right hand fraction estim accur within factor sigma ffl least one two test fail observ x u v s fxg edg f u x succeed choic b x figur succeed choic b f x f x figur succeed choic b proof everi test form depict figur g might degen erat case g observ x a estim least succe furthermor estim gamma ffl test succe observ x v side u v s fxg begin section e gamma ffl u v differ node succeed choic b proof note case appli v intern node s thu everi test one form depict figur edg may degener observ case x a estim least test succe also case estim gamma ffl test succe note use observ node u one neighbour v test succeed furthermor impli x merg u case dealt case exactli one v test succeed case v leaf insert x middl edg otherwis either insert x middl edg insert subtre root v order decid which perform similar test node v check whether testv succeed choic b so put x middl edg otherwis recurs place x subtre root v step relat set construct met s close ms set relat leav construct met s leafset edg paramet s within sigmaffl correspond paramet ms topolog s s assum without loss gener s root s failur probabl ffin overal failur ffi start observ problem easi one two leav observ construct met s edg paramet s within sigmaffl correspond paramet ms consid case least three leav edg s contract s regard e e set fact within sigmaffl true valu follow follow lemma lemma e intern edg ms v w proof first observ observ g observ use algebra manipul one see thu equat prove observ thu need show label remain paramet within sigmaffl note alreadi shown section total failur probabl ffin failur probabl ffin associ n edg step form met s make new root r set relat set leav let u denot root s let p denot probabl u distribut s make edg e r u e proof theorem let met form follow ffl relat set form step ffl relat set copi s ms made ffl met s combin step theorem follow follow lemma lemma suppos everi set relat leav everi paramet s within correspond paramet ms varm proof first observ use crude estim n paramet each at n met s one root paramet n edg paramet show chang singl paramet met sigmaffl yield met whose variat distanc origin ffl impli ffl suppos e edg u v e chang probabl output string leav v string remain leav thu variat distanc met obtain chang valu e within similarli ae root paramet met probabl output variat distanc origin met one ae chang within x prove lemma provid background materi recal weight we edg e met defin weight w leaf product weight edg path root use follow lemma lemma met root r variat distanc distribut leav condit distribut leav condit mostp w sum leav proof proceed induct number edg met base case edg r leaf result hold induct step let e edg r node x string leav x string leav algebra manipul formula show pr follow variat distanc sum absolut valu quantiti equat result follow induct lemma met n leav e edg node u node v let met deriv replac e z maximum pair x y leav connect via e jcovx yj proof observ assum without loss gener u root m string leav v string remain leav find via littl algebra manipul differ probabl output probabl thu variat distanc time product variat distanc distribut leav v condit distribut leav v condit variat distanc distribut remain leav condit distribut remain leav condit v equat isx connect via e n lemma if two differ relat set edg e u v ms s e proof definit leaf connect graph step leav a b b path path b b go jd cova remain covari estim amongst leav a b b less ffl without loss gener use observ assum u root met let denot path u use similar notat leav equat accuraci estim step thu equat result follow proof lemma clearli bound statement lemma weaker prove need proof lemma let met except everi edg e contain ms ms two differ relat set contract similarli let met except everi edg copi contract clearli varm number edg contract wish bound varm s s intersect edg for relat set suppos s s contain node u modifi without chang distribut way avoid overlap thi replac node u two copi u connect two copi edg e e note chang affect oper algorithm thu without loss gener assum relat set s s intersect thu ident except edg go submet s now edg e go two submet properti pair leav x connect via e jcovx yj ffl thi follow accuraci covari estim step thu lemma chang edg accord step add n ffl variat distanc thu varm number edg modifi accord step conclud varm acknowledg thank mike paterson use idea discuss r approxim numer taxonomi nearli tight bound learnabl evolut polynomi learnabl probabilist concept respect kullbackleibl diverg reconstruct shape tree observ dissimilar data element inform theori log suffic build almost tree i infer big tree short quartet effici algorithm invert evolut probabl model infer evolutionari tree learnabl discret distribut method bound differ molecular studi evolut sourc novel statist problem recov tree leaf colour gener markov model tr ctr elchanan mossel distort metric tree phylogenet forest ieeeacm transact comput biolog bioinformat tcbb v n p januari elchanan mossel sbastien roch learn nonsingular phylogeni hidden markov model proceed thirtyseventh annual acm symposium theori comput may baltimor md usa