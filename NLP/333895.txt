t backward error analysi numer integr a backward error analysi becom import tool understand long time behavior numer integr method true particular integr hamiltonian system backward error analysi use show symplect method conserv energi exponenti long period time result typic base two aspect backward error analysi i shown modifi vector field qualit properti share given problem ii estim given differ best interpol vector field numer method aspect investig recent exampl benettin giorgilli j statist phi pp hairer ann numer math pp hairer lubich numer math pp paper aim provid unifi framework simplif exist result correspond proof approach backward error analysi base simpl recurs definit modifi vector field requir explicit taylor seri expans numer method correspond flow map abovecit work applic discuss long time integr chaotic hamiltonian system approxim time averag along numer comput trajectori b introduct paper consid relationship solut given system ordinari differenti equat vector field dt numer approxim them solut associ modifi equat dt vector field formul term asymptot expans stepsiz ffit ie chosen numer solut formal inter prete increas index i accur solut modifi equat previou paper backward error analysi differenti equat includ warm hyett griffith sanzserna beyn feng fiedler scheurl sanzserna anoth earli refer relat idea moser discuss approxim symplect map near equilibrium flow map hamiltonian vector field recent gener formula comput modifi vector field deriv hairer calvo murua sanzserna be nettin giorgilli reich paper neishtadt benettin giorgilli hairer lubich question close numer approxim solut modifi equat address konradzusezentrum takustr d berlin current address depart mathemat statist univers surrey guildford surrey gu xh uk sreichsurreyacuk particular shown paper differ made exponenti small stepsiz ffit ie provid vector field z numer one step method psi ffit real analyt appropri constant phi ffit denot timeffitflow map vector field index ffit chosen differ minim backward error analysi utmost import understand qualit behavior symplect method hamiltonian problem shown hairer calvo murua sanzserna reich benettin giorgilli symplect discret modifi vector field hamiltonian special case see also paper auerbach friedman yoshida hamiltonian structur modifi equat impli symplect integr almost preserv total energi exponenti long period time similarli adiabat invari hamiltonian system rapidli rotat phase also preserv exponenti long period time provid symplect method use fact symplect method lead modifi equat hamiltonian special instanc call geometr properti backward error analysi mean follow vector field z belong certain class vector field like integr preserv divergencefre vector field numer approxim phi ffit also preserv correspond quantiti modifi vector field class z besid symplect method special instanc geometr aspect discuss befor see exampl paper reich hairer stoffer gonzalez higham stuart paper revisit backward error analysi use simpl recurs scheme definit modifi vector field first propos author unpublish report main advantag formul requir taylor seri expans numer one step method psi ffit flow map phi ffit term step size ffit use paper benettin giorgilli hairer hairer lubich turn allow simpl character geometr properti modifi vector field rather simpl proof exponenti small truncat error approach close one discuss benettin giorgilli sens consid gener one step method use direct approach howev differ techniqu use discuss detail x x consid numer integr chaotic hamiltonian system symplect method discuss approxim timeaverag along numer comput trajectori assum poincar section defin correspond poincar section uniformli hyperbol backward error gener idea alreadi found report hairer lubich consid method repres pseri note rungekutta partit rungekutta method fall categori contrast indirect approach use neishtadt one step method first interpol flow timedepend vector field averag time use obtain optim approxim timeindepend vector field analysi shadow lemma use show numer comput trajectori stay close exact solut exponenti long period time larg deviat theorem allow us discuss converg long time averag along numer comput trajectori anisotrop kepler problem serv us numer illustr problem requir applic symplect variabl stepsiz method first discuss author technic report independ hairer modifi vector field recurs let us consid smooth vector field dt discret one step method assum psi ffit u ae r n r n smooth map method order p ie x u phi ffitz timeffitflow map differenti equat describ introduct look famili vector field phi ffit or equival ffit suffici small phi x denot timeoneflow map vector field xffit famili modifi vector field xffit ffit formal defin term asymptot expans stepsiz ffit ie formal infinit sequenc vector field fdeltax g i obtain taylor seri expans one step method psi ffit ie x ident map comparison seri expans timeoneflow map phi xffit term ffit vector field deltax chosen two seri coincid term term gener approach follow benetttin giorgilli hairer two paper differ way taylor seri expans written down lead exactli sequenc vector field fdeltax g i obvious deltax method order p give recurs definit modifi vector field xffit requir explicit taylor seri expans recurs introduc author unpublish report first formal introduc truncat expans mean obvious let us assum x ffit chosen differ time oneflow map x ffit numer one step method psi ffit offit i suggest consid follow recurs deltax inde definit deltax i impli x i ffit defin gener timeoneflow map offit i away numer method psi ffit seen thu eq recurs defin modifi vector field x recurs start x ffitz gener sequenc is cours equival sequenc obtain use taylor seri expans describ throughout paper exclus work recus x shown lead simpl character geometr properti modifi vector field and x explicit estim differ timeoneflow map modifi vector field x ffit numer method given like point result also and deriv use explicit taylor seri expans flow map numer method howev feel applic recurs lead simplif present result geometr properti backward error analysi section consid differenti equat whose correspond vector field z belong certain linear subspac g infinit dimension lie algebra smooth vector field r n assumpt given linear subspac g infinit dimension lie algebra smooth vector field r n let us assum correspond subset g infinit dimension frechet manifold diffeomorph r n algebra oper lie bracket xy two vector field x id g defin set vector field x psi oneparametr famili diffeomorph psi g smooth psi linear space lie algebra hamiltonian vector field r n is exampl subset canon transform import aspect differenti equat correspond flow map phi tz form oneparametr subgroup g especi context long term integr desir discret differenti equat type way correspond iter map psi ffit belong subset g phi tz call integr geometr integr follow result concern backward error analysi geometr integr first state unpublish report theorem let us assum vector field z dt belong linear subspac g lie algebra smooth vector field r n let us assum furthermor geometr integr subspac g ie psi ffit g ffit suffici small perturb vector field x defin recurs belong g ie proof statement certainli true us assum also hold ffit suffici small sinc ffit suffici small well deltax g impli x i ffit g requir remark often linear subspac g is fact subalgebra lie bracket g properti need theorem let us discuss five exampl exampl consid subspac g vector field preserv particular first integr f r n r fact space subalgebra lie bracket word impli show differenti wrt x give procedur appli use ident definit yield desir result correspond subset g given f preserv diffeomorph psi ie fact let psi smooth famili f preserv diffeomorph psi x psi sinc thu id appli theorem particular numer method modifi vector field x possess f first integr result recent deriv gonzalez higham stuart use contradict argument pi exampl consid lie subalgebra divergencefre vector field z ie correspond subset g volum preserv diffeomorph ie det id g name x psi x trace x psi x thu numer method psi ffit volum conserv modifi vector field x divergencefre again result formul gonzalez higham stuart use contradict argument pi exampl let involut r nthetan given consid subspac g vector field z r n satisfi timerevers symmetri subspac subalgebra lie bracket correspond subset g given timerevers diffeomorph psi ie psi let psi g smooth psi theta spsi impli x psi g follow id appli theorem thu numer method psi ffit satisfi timerevers symmetri modifi vector field x timerevers result first proven hairer stoffer use idea pi exampl let f g denot poisson bracket linear poisson manifold lie algebra hamiltonian vector field p given dt r smooth function correspond subset g given set smooth diffeomorph p preserv poisson bracket f g let psi famili map g psi smooth function f condit vector field x local hamiltonian sinc p simpli connect vector field also global hamiltonian discret evolut satisfi psi ffit g ffit psi ffit call symplect method follow theorem modifi vector field hamiltonian vector field p result also found symplect method expand pseri vector field x ffit global hamiltonian even phase space p ae r n simpli connect result appli symplect rungekutta partit rungekutta method furthermor symplect method defin gener function third kind also alway global hamiltonian statement true symplect method base composit exact flow map pi exampl let us consid differenti equat matrix lie group g ae r nthetan gener time independ differenti equat g written form dt involut nonsingular matrix satisfi ae r nthetan lie algebra g mani recent paper see refer therein devot method preserv lie group structur ie n g impli n g thu psi ffit diffeomorph defin submanifold g ae r nthetan fact submanifold character least local set nonlinear equat denot f y f integr preserv map ie f ffi psi g follow exampl know modifi vector field as well given vector field satisfi henc modifi vector field x ffit vector field g give rise modifi differenti equat type dt g see result backward error analysi numer method manifold pi truncat error backward error analysi like deriv explicit estim norm vector field deltax i differ timeoneflow map phi x ffit numer approxim psi ffit assum vector field z real analyt also introduc follow notat let b r denot complex ball let us consid compact subset k ae r n phase space constant r given real analyt vector field bound b r defin also defin b find estim deltax i defin need estim map appear right hand side start estim map psi ffit lemma let us assum vector field z real analyt compact subset k phase space constant k r also assum numer method psi ffit real analyt exist constant k proof given assumpt flow map z zphi tz x dt defin complex valu c integr right hand side independ path zero complexifi flow map satisfi z jjzphi tz xjj jdtj consist numer method impli exist constant deltak complexifi map psi take k remark let us consid sstage rungekutta method coeffici ij s fb g i s satisfi assum rungekutta method uniqu defin real analyt map psi stepsiz c j j rk follow fact that state assumpt stage variabl brk vector field z bound constant k similar statement hold partit rungekutta method pi theorem let assumpt lemma satisfi exist famili real analyt vector field order method famili modifi vector field xffit satisfi estim r implicit method solut obtain fixpoint iter j j suffici small p constant depend order p method exampl proof know x psi ffit method order p thu jjx jj r j jm deltax next find estim differ timeoneflow map phi x map psi use obtain sinc map real analyt differ offit p obtain estim use next show estim true compar proceed induct first note that replac paramet ff formula ff j yield ff c j use particular substitut j j j ff use inequ deriv next introduc vectorvalu real analyt function observ use x b ffr k impli phi tx j x find estim differ timeoneflow map phi x j map psi use obtain sinc map real analyt differ offit j obtain estim use final obtain verifi next need estim differ timeoneflow map map psi ffit compact set k use immedi r famili vector field xffit defin take optim number ffit iter take ffit integ part thu ffit complet first part proof accord differ modifi vector field xffit z given r r next use ffit r c i obtain r e r r p chosen j remark proof theorem similar spirit one given benettin giorgilli exponenti small differ optim interpol vector field neartotheident map howev coupl import differ i explicitli take order method account ii directli deriv estim differ flow map phi x psi ffit instead use taylor seri expans phi x psi ffit correspond estim element seri believ simplifi proof theorem iii introduc paramet ff shrink domain definit vector field x iter index increas feel simplifi proof iv work directli estim given vector field z instead make assumpt map psi ffit rather pessimist constant enter estim seem main disadvantag approach pi elabor version proof theorem found applic ergod hamiltonian system let us consid real analyt hamiltonian system dt dt togeth smooth function r n r interest evalu timeaverag along trajectori qt pt hamiltonian system ie assum exist equal microcanon ensembl averag correspond hamiltonian ie assum system ergod or even mix thu r aq p z z inner product ffie gamma h let us write equat compact form dt hamiltonian h preserv flow map phi th let us assum hypersurfac constant energi precis ergod system impli time averag equival ensembl averag except for most set initi condit measur zero compact subset r n also assum constant jjrxhxjj fl x impli smooth dimension compact submanifold furthermor famili hypersurfac suffici small smooth compact well in fact diffeomorph defin open subset u phase space u egammadeltaedelta far made fairli gener assumpt sequel becom specif ensur hamiltonian system ergodicmix first step construct poincar return map let r smooth function posit constant jf hgxj fl level set delta suffici small let us assum defin poincar section follow way x posit number solut xt initi condit xt posit number call poincar return time point x know poincar return time x defin global poincar map assum poincar return time p x x v bound constant interest solut particular level set constant energi simplic take level set suffici consid restrict defin restrict pi thu reduc studi dynam properti hamiltonian system energi shell studi properti poincar ergod mix map hamiltonian system ergod mix note pi volum preserv ie det x pi assum pi uniformli hyperbol map ie d linear x pi x x possess strictli expand contract direct stochast behavior determinist map investig exampl point four main result ffl uniqu invari densiti invari pi furthermor given lebesgu measur d ffl autocorrel function ha holder continu function exponenti fast ie appropri constant ffl timeaverag along trajectori fx g i n pi satisfi central limit theorem ffl timeaverag hain along trajectori pi initi valu x satisfi larg deviat theorem specif given c hc larg n result proven see exampl care studi properti correspond frobeniusperron oper defin definit call hamiltonian system introduc properti poincar hyperbol particular assum i level set constant energi compact submanifold ii constant global poincar map pi defin uniformli hyperbol map restrict poincar return time p x x v bound constant k v constant let e h perturb h x u ffl call e h fflperturb h lemma properti poincar hyperbol stabl ffl perturb hamiltonian h provid ffl suffici small proof assumpt jjrxhxjj fl level set impli set persist small perturb furthermor exist constant perturb hamiltonian h x v thu poincar map also defin perturb hamiltonian h uniform hyperbol also stabl small perturb poincar map let us discret symplect real analyt integr psi ffit order assumpt assum backward error analysi appli compact subset k u ae k correspond perturb hamiltonian denot e ie x k constant let stepsiz ffit suffici small perturb hamiltonian system also poincar hyperbol simplic shift modifi hamiltonian e hffit hx let us introduc coupl notat perturb system unperturb system defin compact level set f open set e u replac h e h definit without loss gener assum e u ae k furthermor e delta correspond set e v e defin obviou way final global poincar map e pi reduc poincar map e pi introduc unperturb system again without loss gener assum ae e extend discret time map psi ffit map psi ffit use exact flow map phi t e h modifi problem interpol ffit map extend ffit obviou way composit k step psi ffit one step phi dt e thu correspond definit global poincar map e defin x e poincar return time e p x x e v definit e pi lemma impli constant e sup follow backward forward error analysi constant x e v ffit suffici small importantli let fx g i n numer comput sequenc point x correspond sequenc map e pi x d sequenc fx g respect gener two sequenc real number fe g fs g f e fe g respect defin e result map discontinu multipl stepsiz ffit smooth interpol could defin need context paper e obvious e drift valu e per step away zero exponenti small sum linearli number step energi conserv properti symplect method discuss benettin giorgilli hairer lubich exponenti slow drift follow sequenc fs g lipschitz constant e word start initi e d point comput numer poincar map b pi stay exponenti small neighborhood e exponenti mani iter b pi now sinc numer method order p compact manifold f offit p away other ie modifi hamiltonian e h fflperturb hamiltonian h ffl ffit p thu sequenc fx g also stay offit p neighborhood long number iter n satisfi appropri constant shadow lemma appli sequenc fx g i n proposit exist exact trajectori fx g i n poincar map pi numer comput sequenc fx g i n stay offit p neighborhood shadow exact trajectori provid number iter n satisfi proof first project sequenc fx g i n onto use search direct orthogon manifold d denot result fx g project sequenc fx g sequenc fx g offit p close provid n satisfi local error per step exact poincar map pi numer poincar map b pi also order p stepsiz ffit follow standard forward error analysi thu shadow lemma uniformli hyperbol map appli poincar map project sequenc fx g d shadow distanc offit p shadow result also appli sequenc fx g let us assum want comput ensembl averag smooth r certain accuraci c larg deviat theorem hyperbol map tell us probabl obtain ensembl averag desir accuraci time averag along singl trajectori goe one exponenti fast length n trajectori increas numer comput approxim trajectori system know proposit trajectori offit p close exact trajectori exponenti mani integr step n let us denot time averag along exact trajectori hai e n numer comput time averag hain n satisfi bound type thu obtain follow proposit let poincar hyperbol realanalyt system discret symplect method order p stepsiz ffit timeaverag hain observ along numer comput trajectori fxn gn n satisfi hai e n timeaverag along exact trajectori number step n satisfi bound type furthermor assum want comput ensembl averag within given accuraci c assum simplic constant c larger differ time averag alway true suffici small stepsiz ffit probabl obtain averag desir accuraci time averag along numer comput trajectori goe one exponenti fast number integr step n increas take maximum number step probabl made doubl exponenti close one ffit exampl numer exampl look follow planar anisotrop kepler problem dt dt initi condit chosen note angular momentum l conserv defin poincar section record sequenc point conserv energi impli thu defin sequenc restrict subset subset awkward shape transform rectangl mean area preserv transform correspond poincar map hyperbol ie stabl unstabl manifold intersect transvers dynam encod binari bernoulli shift main comput difficulti consist exist weak singular remov singular scale equat motion introduc time transform impli that new time norm vector field remain bound time transform introduc transform equat motion still hamiltonian constant stepsiz symplect method use integr transform system let us describ gener assum hamiltonian function hq scale function aeq given follow zare szebeh introduc modifi hamiltonian function correspond hamiltonian equat motion extend phase space r n theta r particular let us consid case p simplifi hypersurfac constant energi scale vector field desir hamiltonian anymor therefor suggest author independ hairer hamiltonian equat discret symplect method exampl equat discret symplect euler method ie method explicit variabl q unfortun impli method first order ffi howev method symplect and therefor time time averag time time averag time averag time time averag a time actual stepsiz time angular momentum time total energi b fig a time evolut averag hrin mean distanc shown four differ initi condit equal initi energi evolut error energi angular momentum actual stepsiz bottomright figur show intersect trajectori poincar section x x coordin one thousand intersect plot hamiltonian conserv offi exponenti long period time secondord symplect discret obtain use secondord lobatto iiiab partit rungekutta formula ie result scheme implicit aeq approach appli anisotrop kepler problem scale function chose initi valu equat motion integr use second order symplect method time averag observ aq along trajectori comput accord recurs formula hain t n time averag comput four differ initi condit evolut correspond time averag hri n found fig a differ length time interv due fact number step stepsiz ffi taken lead differ actual stepsiz ffit n within toler c averag converg valu fig b total energi h angular momentum l variat actual stepsiz found particular trajectori also plot intersect trajectori q x x theoret point fill rectangl uniform way the invari meassur lebesgu meassur one thousand point plot uniform distribut satisfi quit well pi acknowledg like thank ernst hairer chu sanzserna andrew stuart claudia wulff comment earlier version paper refere make valuabl suggest r lie group structur diffeomorph group invert fourier integr oper applic geometr method theori ordinari differenti equat mathemat method classic mechan hamiltonian interpol near ident symplect map applic symplect integr algorithm numer method dynam system modifi equat ode aspect backward error analysi numer ode formal power seri numer algorithm dynam system discret homoclin orbit invis chao scope modifi equat qualit properti modifi equat dynam system bifurc vector field chao classic quantum mechan backward analysi numer integr symplect method variabl time step integr symplect method lifespan backward error analysi numer integrat or solv ordinari differenti equat revers longterm integr variabl step size invers function theorem nash moser lectur hamiltonian system separ motion system rapidli rotat phase numer integr gener euler equat backward error analysi numer integr higher order semiexplicit symplect partit rungekutta method constrain hamiltonian system preserv adiabat invari symplect discret dynam system symplect integr hamiltonian problem overview rigor verif trajectori comput simul dynam system symplect partit rungekutta method stochast dynam determinist system introduct ergod theori modifi equat approach stabil accuraci finitediffer method larg deviat dynam system construct higher order symplect integr time transform extend phase space tr ctr p f tupper comput statist hamiltonian system case studi journal comput appli mathemat v n p august ernst hairer import aspect geometr numer integr journal scientif comput v n p octob yk zou wj beyn manifold connect orbit discret dynam system nonlinear analysi theori method applic v n p februari b cano a durn analysi variablesteps linear multistep method special emphasi symmetr one mathemat comput v n p octob m p calvo a portillo high order variabl step equistag initi better standard start algorithm journal comput appli mathemat v n p august brian e moor sebastian reich multisymplect integr method hamiltonian pde futur gener comput system v n p april fong eric darv adrian lew stabil asynchron variat integr proceed st intern workshop principl advanc distribut simul p june jess a izaguirr scott s hampton shadow hybrid mont carlo effici propag phase space macromolecul journal comput physic v n p novemb b cano a durn techniqu construct symmetr variablesteps linear multistep method secondord system mathemat comput v n p octob