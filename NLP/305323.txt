t preserv symmetri precondit krylov subspac method a consid problem solv linear system nearli symmetr system precondit symmetr posit definit matrix m symmetr case recov symmetri use minner product conjug gradient cg algorithm idea also use nonsymmetr case near symmetri preserv similarli like cg new algorithm mathemat equival split precondit requir factor better robust specif sens also observ combin truncat version iter method test show effect common practic forfeit nearsymmetri altogeth b introduct consid solut linear system precondit krylov subspac method assum first symmetr posit definit spd let spd matrix precondition matrix a one possibl solv either leftprecondit system work support nsf contract nsfccr onr contract onrnj aro contract daalc univ tenn subcontract ora amend depart mathemat univers california lo angel hilgard avenu lo angel california chanmathuclaedu myeungmathuclaedu z depart comput scienc minnesota supercomput institut univers minnesota eecsci bldg union st se minneapoli minnesota chowcsumnedu saadcsumnedu rightprecondit system system lost symmetri remedi exist precondition avail factor form eg incomplet choleski factor case simpl way preserv symmetri split precondition left right ie could solv involv symmetr posit definit matrix also done factor unfortun requir avail factor form often stringent howev remedi requir wellknown preserv symmetri use differ inner product specif observ gamma selfadjoint minner product sinc rewrit cgalgorithm new inner product denot r origin residu z residu precondit system would obtain follow algorithm see eg algorithm precondit conjug gradient start comput iter converg do a b x c r d z note even though minner product use need multipli may avail explicitli need solv linear system matrix coeffici also seen chang variabl iter produc algorithm ident cg split precondit cg rightprecondit use gamma inner product three algorithm thu equival question rais follow nearli symmetr often case exist precondition spd situat use either form unsatisfactori fulli symmetr case inde whatev degre symmetri avail entir lost although remedi base minner product alway use symmetr case rather surpris problem seldom ever mention literatur nearli symmetr case nonsymmetr case exist factor form form balanc also achiev split precondition left right howev seem much work done exploit minner product even avail factor form dichotomi treatment symmetr nonsymmetr case motiv studi ashbi et al fulli consid case use altern inner product matrix symmetr work awar consid use altern inner product nearsymmetr young jea meyer latter product with spd use orthomin orthodir paper organ follow section shown altern inner product may use preserv symmetri gmre section consid use truncat iter method precondit system close symmetr hypothes mani author exampl axelsson meyer section consid symmetr precondit bicg algorithm section test algorithm numer use navierstok problem parameter reynold number thu near symmetri conclud paper section precondit gmre nearli symmetr split precondit may use preserv origin degre symmetri altern leftprecondit minner product right precondit gamma inner product may use latter two altern develop arnoldi process use basi symmetr precondit version gmre like cg shown symmetr version mathemat equival split precondit requir precondition symmetr factor begin explor option implement issu associ left symmetr precondit left symmetr precondit gmre algorithm base arnoldi process without precondit arnoldi algorithm base classic gramschmidt process follow algorithm arnoldiclass gramschmidt choos vector v norm comput h enddo consid case leftprecondit ie matrix involv algorithm replac precondition assum spd wish defin procedur implement algorithm use minner product possibl avoid addit matrixvector product eg accomplish defin correspond gmre procedur precondit case customari defin intermedi vector product precondit get reformul oper algorithm minner product comput inner product chang classic gramschmidt formul would first comput scalar h ij line algorithm would modifi vector z j obtain next arnoldi vector befor normal complet orthonorm step must normal final z j morthogon z j versu previou v s observ thu desir mnorm comput accord comput one potenti seriou difficulti procedur inner product comput may neg presenc roundoff two remedi first comput mnorm explicitli expens addit matrixvector multipl ie point earlier undesir sinc oper often avail explicitli inde mani case precondit oper gamma avail sequenc oper case multigrid precondit anoth difficulti comput h ij immedi amen modifi gramschmidt implement inde consid first step hypothet modifi gramschmidt step consist morthonorm z v observ inner product z equal w v comput need z comput modifi gramschmidt process howev vector avail comput z v classic gramschmidt altern save set vector mv again comput multipli m would allow us accumul inexpens vector z j vector via relat obtain inner product z given form inner product guarante nonneg desir lead follow algorithm algorithm arnoldiclass gramschmidt minner product choos vector w v mnorm comput w note algorithm requir save two set vector v j s w s v s form need arnoldi basi w s requir comput vector w j line save two set vector also easili formul algorithm modifi gramschmidt version arnoldi procedur algorithm arnoldimodifi gramschmidt minner product choos vector w v mnorm enddo h enddo right symmetr precondit matrix gamma selfadjoint gamma inner product situat right precondit inner product much simpler mainli gamma z avail z need normal gamma norm howev gamma z normal comput next iter standard arnoldi algorithm slight reorgan arnoldi modifi gramschmidt algorithm yield follow algorithm arnoldimodifi gramschmidt gamma inner product choos vector v gamma norm comput w enddo note precondit vector comput line standard algorithm comput line again vs ws need save case addit storag ws howev make algorithm natur flexibl ie accommod situat vari step gamma v result unspecifi comput gamma constant oper basi rightprecondit krylov subspac cannot construct vs alon howev vector w form basi subspac gamma denot precondit oper jth step use extra set vector exactli standard flexibl variant gmre implement use minner product gmre vector v form orthonorm basi krylov subspac follow denot matrix whose column vector vector v produc arnoldimodifi gramschmidt algorithm minner product algorithm similar notat use matrix wm also denot hm m theta upper hessenberg matrix whose nonzero entri h ij defin algorithm hm denot portion hm matric satisfi number relat similar one obtain use standard euclidean inner product proposit follow properti satisfi vector v w algorithm hm hm v w hermitian hm hermitian tridiagon consid implement gmre procedur base orthogon process algorithm sinc use minner product abl minim mnorm residu vector vector affin subspac z first coordin vector have hm therefor equal hm result equal minim mnorm precondit residu vector gamma bgammaax simpli minim norm fie gamma hm standard gmre algorithm algorithm leftprecondit gmre minner product comput enddo h enddo comput minim kfie gamma comput approxim solut satisfi stop els set x equal similar shown rightprecondit case inner product summar follow theorem state without proof theorem approxim solut xm obtain leftprecondit gmre algorithm minner product minim residu mnorm km gamma b gamma axkm vector affin subspac x km z also approxim solut xm obtain rightprecondit gmre algorithm gamma inner product minim residu gamma norm kb affin subspac equival algorithm show left right symmetr precondit mathemat equival split precondit latter case must factor solv denot b precondit matrix gmre procedur appli system u variabl minim residu norm vector u space u k u note variabl u x relat result procedur minim x space x k x make follow observ k have z inde easili prove induct henc space k x ident space noth note prove follow result theorem let approxim solut obtain gmre appli split precondit system ident obtain gmre algorithm left precondit system use minner product again statement made rightprecondit must notic minim take place minim subspac left right split precondit option sec emphas particular split precondit residu minim three algorithm truncat iter method truncat iter method altern restart number step requir converg larg comput storag krylov basi becom excess exactli symmetr threeterm recurr govern vector arnoldi process necessari orthogon current arnoldi vector previou two vector nearli symmetr incomplet orthogon small number previou vector may advantag restart method advantag may offset cost maintain extra set vector maintain initi degre symmetri incomplet arnoldi procedur outlin store previou k arnoldi vector orthogon new vector them differ full arnoldi procedur line would normal loop j consid full arnoldi procedur k set infin algorithm incomplet arnoldi procedur choos vector v norm enddo h h enddo truncat version gmre use incomplet arnoldi procedur call quasigmr practic implement algorithm allow solut updat iter thu call direct version dqgmre suggest truncat iter method may effect case near symmetri studi asymptot behavior iter dqgmre coeffici matrix vari nonsymmetri skew symmetri first decompos symmetr skew symmetr set first establish asymptot relat among variabl incomplet full arnoldi procedur appli incomplet procedur a full procedur s use superscript f distinguish variabl appear two procedur note sinc skew symmetr full procedur incomplet procedur k moreov denot degre minim polynomi v f respect h f proof follow lemma also use v j denot vector w w f obtain end line incomplet complet arnoldi procedur lemma assum truncat paramet k v h proof proof induct index j line arnoldi procedur h h henc lemma hold assum lemma prove hypothesi prove arnoldi procedur h yield induct hypothesi therefor w w f line arnoldi procedur use anoth induct index line induct hypothesi j and mean time note h last equat h induct step complet qed turn dqgmre algorithm consid linear system denot x g x q approxim solut gmre dqgmre algo rithm respect let degre minim polynomi vector b gamma sx respect s result lemma state follow theorem given initi guess x gmre dqgmre k given step proof definit dqgmre gmre h h h b b lemma h therefor desir equat hold qed let xa exact solut exact solut obviou o sinc hand x g immedi follow corollari corollari initi guess x k corollari suggest may use dqgmre small k nearli symmetr nearli skew symmetr symmetr precondit bicg bicg algorithm base lanczo biorthogon leftsymmetr rightsymmetr precondit rel straightforward extra vector re quir refer algorithm give rightprecondit bicg algorithm precondition symmetr rightprecondit bicg algorithm rightprecondit use gamma inner product develop immedi afterward algorithm rightprecondit bicg comput r converg do ff x r r enddo note line algorithm precondit coeffici matrix dual system am dual residu r residu leftprecondit version linear system develop symmetr rightprecondit bicg gamma inner product use algorithm abov howev precondit coeffici matrix dual system must adjoint gamma gamma inner product gamma shown dual system thu involv coeffici matrix gamma algorithm give symmetr rightprecondit bicg algorithm precondition algorithm rightprecondit bicg gamma inner product comput m gamma r converg do ff x r r enddo like gmre left right symmetr precondit version bicg equival split precondit version shown chang variabl howev left right symmetr precondit version exact rather split precondit residu avail unprecondit bicg algorithm cannot seriou breakdown spd r chosen r r vector ap never becom orthogon fact cosin bound reciproc condit number a similarli symmetr rightprecondit version bicg spd r measur cosin rather quantiti ap r vector magnitud go algorithm progress recal case m lucki breakdown case regular right leftprecondit r symmetr precondit case lower bound exist algorithm liabl break down nearsymmetr hypothesi probabl breakdown lower symmetr precondit case shown experi next section numer experi section test idea use symmetr precondit truncat iter meth od section test breakdown behavior symmetr precondit bicg truncat iter method test idea use symmetr precondit truncat iter method nearli symmetr system select standard fluid flow problem degre symmetri matric parameter reynold number flow problem twodimension squarelid driven caviti discret galerkin finit element method rectangular element use biquadrat basi function veloc linear discontinu basi function pressur consid segreg solut method navierstok equat veloc pressur variabl solv separ matric aris fullycoupl solut method otherwis indefinit particular consid express conserv momentum u denot vector veloc variabl p denot pressur variabl reynold number boundari condit driven caviti problem unit squar top edg squar three side corner refer pressur specifi bottomleft corner matric initi jacobian newton iter assum zero pressur distribut conveni howev chose righthand side linear system vector one mesh element use lead momentum equat matric order nonzero entri node correspond boundari assembl matrix degre freedom number element element reynold number matrix spd equal symmetr part matric nonzero reynold number gener matric reynold number less give rise nearli symmetr case reynold number degre symmetri measur valu theta gamma measur increas linearli reynold number at least re numer experi below show number matrixvector product consum gmresk dqgmresk reduc actual residu norm less gamma origin residu norm zero initi guess sever valu k use dagger y tabl indic converg within matrixvector product incomplet choleski factor ic re problem use precondition problem comparison first show tabl result use standard rightprecondit tabl show result use rightprecondit gamma inner product equiva lentli split precondit latter case care taken assur gmre stop actual residu norm within twice toler dqgmre sinc accur residu norm estim avail within algorithm exact residu norm comput use stop criterion purpos com parison rightprecondit method slight advantag comparison by mani matvec sinc directli minim actual residu norm wherea symmetr precondit method minim precondit residu norm tabl matvec converg rightprecondit method tabl matvec converg symmetr rightprecondit method result tabl show irregular perform dqgmresk small valu k precondit system symmetr perform entir regular tabl precondit system near symmetr reynold number system suffici symmetr dqgmre behav dqgmre much larger k perform remain regular beyond reynold number number step converg begin becom irregular like rightprecondit case gmre either right symmetr precondit show mark differ perform appar symmetri precondit system essenti problem howev result show dqgmresk small valu k may perform well term number step gmresk larg valu k particularli nearsymmetri preserv sinc former much effici combin preserv symmetri truncat iter method may result much econom method well regular behavior shown abov also perform experi orthogon project method name full orthogon method fom truncat variant direct incomplet orthogon method diom result similar result abov shown here inde develop algorithm theori ident method interest also perform test ilu precondition construct matrix compar right split precondit nearsymmetr system here littl differ result compar use ic construct re case matric thu deterior perform reynold number increas entir due rel less accur precondition due increas nonsymmetri nonnorm matric although eigenvalu precondit matric ident eigenvector henc degre nonnorm may chang complet unfortun difficult quantit relat nonnorm converg breakdown behavior bicg test breakdown behavior bicg matlab use gener random matric order approxim percent normal distribut nonzero entri matric adjust ie symmetr part shift lowest eigenvalu gamma time skewsymmetr part ad back paramet alter get vari degre nonsymmetri test matric gener smallest valu cosin correspond denomin algorithm record right precondit case record minimum j symmetr rightprecondit case record minimum j rel residu norm reduct gamma iter stop initi guess r set r ic symmetr part use precondition tabl show frequenc size minimum cosin rightprecondit first row pair row symmetricallyprecondit case second row pair row exampl minimum cosin symmetricallyprecondit case averag number bicg step averag minimum cosin also shown last column label better show number time minimum cosin higher improv algorithm tabl show rightprecondit algorithm produc much smaller cosin indic greater probabl breakdown differ algorithm less degre nonsymmetri increas almost differ breakdown behavior algorithm tabl show number bicg step significantli reduc new algorithm averag minimum cosin modifi algorithm significantli increas probabl small cosin encount better import note behavior appli r set r r chosen randomli gain symmetricallyprecondit algorithm shown tabl tabl show number step minimum cosin two algorithm appli driven caviti problem describ section abov figur show plot minimum cosin two algorithm progress note minimum cosin higher much smoother symmetricallyprecondit case problem cosin still higher smooth lost conclus solv linear system matric close symmetr paper shown possibl improv upon standard practic use nonsymmetr precondition matrix along left rightprecondit iter method origin degre symmetri may maintain use symmetr precondition altern inner product or split precondit appropri combin idea truncat iter method solut procedur converg quickli requir less storag develop truncat method also seem becom robust truncat paramet k nearsymmetri maintain bicg algorithm also seem robust respect seriou breakdown nearsymmetri maintain step e e e e e e e e e averag better tabl frequenc minimum cosin rightprecondit first row pair row symmetricallyprecondit second row pair row bicg step e e e e e e e e e averag better tabl frequenc minimum cosin r chosen randomli bicg step min cosin re right symm right symm e e tabl step minimum cosin driven caviti problem figur minimum cosin rightprecondit bicg solid line symmetr precondit bicg dash line acknowledg first third author wish acknowledg support riac nasa ame contract na collabor origin second third author also wish acknowledg support minnesota supercomput institut r taxonomi conjug gradient method conjug gradient type method unsymmetr inconsist system linear equat iter solut method linear system coeffici matrix symmetr mmatrix concept special inner product deriv new conjug gradientlik solver nonsymmetr spars linear system flexibl innerout precondit gmre algorithm iter method spars linear system dqgmre direct quasiminim residu algorithm base incomplet orthogon gener conjugategradi acceler nonsym metriz iter method tr