t unsymmetricpattern multifront method spars lu factor a spars matrix factor algorithm gener problem typic character irregular memori access pattern limit perform parallelvector supercomput symmetr problem method multifront method avoid indirect address innermost loop use dens matrix kernel howev effici lu factor algorithm base primarili dens matrix kernel exist matric whose pattern unsymmetr address defici present new unsymmetricpattern multifront method base dens matrix kernel classic multifront method advantag taken repetit structur matrix factor one pivot frontal matrix thu enabl use level level bla perform compar classic multifront method unsymmetr solver cray c b introduct convent spars matrix factor algorithm gener problem reli heavili indirect address give irregular memori access pattern limit perform typic parallelvector supercomput cachebas risc architectur contrast multifront method duff reid design regular memori access innermost loop modifi amestoy duff use standard kernel multifront method assum structur symmetri base factor assembl tree gener origin matrix order minimumdegre comput kernel execut node tree one step lu factor within squar dens frontal matrix defin nonzero pattern pivot row column step lu factor comput contribut block a schur complement later assembl ad frontal matrix parent assembl tree henceforth call approach classic multifront method although structur asymmetri accommod classic multifront method hold pattern aa store explicit zero poor perform matric whose pattern unsymmetr assum outset matrix may structur asymmetr situat becom complic exampl frontal matric rectangular instead squar contribut block must assembl one subsequ frontal matrix consequ longer possibl repres factor comput inform scienc depart univers florida gainesvil florida usa phone email daviscisufledu support project provid nation scienc foundat asc dm cray research inc florida state univers alloc supercomput resourc portion work support postdoctor grant cerfac rutherford appleton laboratori chilton didcot oxon x qx england european center research advanc train scientif comput cerfac toulous franc t a davi i s duff assembl tree gener structur assembl dag direct acycl similar gilbert liu eisenstat liu requir current work explicitli use structur develop new unsymmetricpattern multifront approach symmetr multifront case advantag taken repetit structur matrix factor one pivot frontal matrix thu algorithm use higher level dens matrix kernel innermost loop level bla refer unsymmetricpattern multifront method describ paper umfpack version avail netlib parallel factor version umfpack base assembl dag discuss hadfield dissert multifront method symmetr posit definit matric review section present overview basic approach brief outlin algorithm introduc data structur context small spars matrix section describ factor first frontal matrix section develop algorithm discuss subsequ frontal matric factor split discuss algorithm two section defin import term earlier section consid less complic situat section present full outlin algorithm use notat introduc previou section section compar perform algorithm two algorithm base classic multifront method mup ssgetrf two algorithm base convent compress spars vector data structur gilbert peierl partialpivot code gplu a successor gplu use dens matrix kernel use dens matrix kernel switch dens factor code toward end factor activ submatrix fairli dens basic approach goal umfpack algorithm achiev high perform gener unsymmetr spars factor code use level bla accomplish develop multifront techniqu use rectangular frontal matric choos sever pivot within frontal matrix high perform also achiev approxim degre updat algorithm much faster asymptot practic comput true degre gener spars code must select pivot base numer symbol fillreduc criteria therefor combin analysi phase pivot select symbol factor numer factor construct rectangular frontal matric dynam sinc know structur prior factor although base assembl dag construct analyzefactor phase use although hadfield davi develop use factorizeonli algorithm particular stage frontal matrix initi choos pivot activ matrix call global pivot search use zlatevstyl pivot search except keep track upper bound degre row column activ submatrix rather true degre the degre row column simpli number entri row column call first pivot seed pivot storag frontal matrix alloc contain entri pivot row column plu room expans determin input paramet defin current frontal matrix f submatrix compris row column alreadi pivot c call c contribut block subsequ pivot within frontal matrix found within contribut unsymmetricpattern multifront method fig rectangular frontal matrix within larger work array empti u l u block c shown figur frontal matrix grow pivot chosen denot arrow figur assembl contribut block earlier frontal matric frontal matrix need select pivot within frontal matrix stop next choic pivot would caus frontal matrix becom larger alloc work array complet factor frontal matrix use level bla store lu factor place contribut block c onto heap contribut block dealloc assembl subsequ frontal matrix continu factor choos anoth seed pivot gener factor new frontal matrix expens comput actual degre row column activ submatrix would requir least much work numer factor itself would defeat perform gain use dens matrix kernel instead comput upper bound degre much lower complex true degre sinc obtain frontal matrix data structur instead convent spars vector avoid form union spars row column would need comput fill pattern row column activ submatrix perform achiev umfpack algorithm thu depend equal two crucial factor approxim degre updat algorithm numer factor within dens rectangular frontal matric outlin umfpack algorithm shown algorithm permut block upper triangular form algorithm appli block diagon use matrix illustr algorithm section algorithm consist initi follow three step follow algorithm outlin unsymmetricpattern multifront algorithm initi factor global pivot search seed pivot t a davi i s duff form frontal matrix f pivot found within frontal matrix assembl prior contribut block origin row f comput degre row column c the contribut block f numer updat part c level level bla local pivot search within c endwhil complet factor f use level bla endwhil initi phase algorithm step convert origin matrix two compress spars vector form rowori columnori numer valu a symbol pattern a row column use delet factor assembl frontal matric given step k say use k k refer entri origin matrix yet delet entri defin valu matrix actual store thu nonzero entri entri may valu zero use denot absolut valu scalar signifi number entri set sequenc matrix mean alway quit clear context true degre r i c j number entri row column j activ submatrix respect store these cost updat would prohibit instead use upper bound r i d r i r i c j d c j c j howev true degre comput initi phase search seed pivot correspond upper bound set equal true degre first frontal matrix label frontal matrix gener stage e index e describ factor first frontal matrix discuss is howev also applic subsequ frontal matric discuss full section differ case detail step perform global pivot search form frontal matrix algorithm perform pivot maintain numer stabil reduc fillin first pivot frontal matrix chosen use global zlatevstyl search candid column lowest upper bound degre search number search control input paramet which denot nsrch whose default valu four among nsrch column select pivot entri rc smallest approxim markowitz cost d r r gamma d c c gamma rc also satisfi threshold partial pivot condit ic note true column degre sinc column entri gener explicitli enabl threshold test equat pivot chosen row column structur defin frontal matrix denot row indic entri column column indic entri row defin l u r row column indic respect current jljbyju j frontal matrix f partit set l u pivot unsymmetricpattern multifront method row column indic l u nonpivot row column indic l u assembl pivot row r column lambdac origin matrix f delet k which also delet k sinc k defin tri find pivot row column ident pattern frontal matrix process call amalgam relax amalgam pivot similar nonident pattern permit relax amalgam f place upper left corner larger newli alloc s byt work array relax amalgam control choos valu input paramet g default valu paramet umfpack use exampl illustr discuss permut would needlessli obscur exampl assum pivot exampl matrix diagon order note assumpt would true perform global pivot search step sinc exampl pivot lowest possibl markowitz cost first pivot g let g by frontal matrix would store by array step choos pivot perform assembl partial factor continu pivot search within contribut block c current frontal matrix f repeat long suffici space work array use term assembl addit contribut term origin entri via extendadd l oper oper align row column index set two matrix vector operand add togeth valu referenc indic implicit assembl one mathemat repres data structur comput postpon explicit assembl one actual comput entri activ submatrix explicitli assembl contribut term ad it usual done entri normal held implicitli pivot row column alway explicitli assembl scan k lambdaj column j u scan k lambdaj stop soon row l found scan complet without row found row indic k lambdaj also l delet k lambdaj assembl f assembl done true degre column j c j scan stop earli comput upper bound degre column j the size worst case fillin oe k current step gaussian elimin ff j number entri scan k lambdaj stop row l scan k analog manner exampl k lambda assembl c entri delet uncomput true degre degre bound shown tabl valu ff j use construct upper bound obtain assumpt k store ascend order row column t a davi i s duff tabl true degre degre bound exampl matrix r lambdac c divid pivot column lambdac pivot rc obtain kth column l nbyn lower triangular factor pivot row kth row u nbyn upper triangular factor step k gaussian elimin complet except updat kth pivot counter k increment next step gaussian elimin frontal matrix f partit four submatric accord partit l u l l l l updat c ju j pivot f appli one time instead delay updat pend b pivot allow effici use level bla cray ymp good valu paramet b l b u denot portion l u respect whose updat yet fulli appli c ju pend updat appli u b updat would appli exampl sinc search next pivot within current frontal matrix search column u find candid pivot column c minimumd c c among column u appli pend updat candid column u lambdac comput candid column lambdac pattern true degre c c select candid pivot row r l lowest r r rc also satisfi threshold pivot criterion equat comput pattern r candid pivot row true degre r r c c current work array small accommod candid pivot stop pivot search also candid column entri outsid current frontal matrix threshold pivot criterion might prevent us find accept candid pivot l case also stop factor current frontal matrix f candid pivot unsymmetricpattern multifront method rc accept let r repartit l u pivot row column indic l u nonpivot row column indic l u appli pend updat pivot row u exampl candid column column fit by work array that is c meet threshold criterion row select candid row candid row is howev reject true degre comput the work array small accommod row sinc r step complet factor f last pivot select within current frontal matrix f appli pend updat contribut block u pivot row column f place storag alloc lu factor contribut block c pattern l u form call element element contribut block factor frontal matrix yet assembl subsequ frontal matric both numer valu symbol pattern particular let c e denot contribut block element e let pattern c e l e u e note l initi row column indic l e u e unmark row or column c e assembl subsequ frontal matrix correspond index mark l e or u e element e which consist term c e l e refer unmark portion onli element e delet entri assembl subsequ frontal matric exampl c c associ row column activ submatrix element list list element hold pend updat row column respect denot list element contain row r list element contain column j c j element list contain local index identifi row column element matrix equival row column activ matrix facilit numer assembl individu row column row l e place elementlocalindex pair e m element list r row mth entri l e similarli column u e place e m element list c j column j mth entri u e let denot summat use l oper n activ submatrix repres implicit assembl k element set e l set element remain step elimin l oper equat explicitli perform postpon unless state otherwis defin earlier notat k refer t a davi i s duff origin entri nonpivot row column origin matrix yet assembl frontal matric element list allow equat evalu one row column time need column j pattern similarli row pattern interest correspond data structur georg liu quotient graph represent factor symmetr posit definit matrix suppos factor symmetr posit definit matrix use algorithm restrict pivot diagon k u e adj gk unelimin node quotient graph g k unelimin node x correspond row column is set r k elimin supernod unelimin node respect adjac unelimin node x terminolog elimin supernod x e correspond element e set l e contain unelimin node adjac elimin supernod x e is adj gk first frontal matrix exampl c c l note column four delet k refer section also longer appear k element list given tabl appli equat obtain row exampl obtain l unsymmetricpattern multifront method tabl element list exampl matrix first frontal matrix subsequ frontal matric describ later step differ element list empti continu exampl second frontal matrix step perform global pivot search form frontal matrix comput nsrch candid pivot column use equat exampl next pivot g by frontal matrix store by array step choos pivot perform assembl partial factor exampl second pivot a found second frontal matrix repeat step twice discuss earlier comput true degre c lambdaj j equat would time consum loos upper bound c j deriv assum overlap l l e viz c j min comput bound row column c would take time scan k time scan r c singl column j total time thetaff j jc j j oja k sinc ff j ja k lambdaj j similarli time comput loos degre bound row howev much tighter bound obtain asymptot time set l e split two disjoint subset extern subset l e n l intern subset n standard set differ oper defin jl e n lj extern column degre element e respect f similarli defin ju e n u j extern row degre element e t a davi i s duff respect f use bound tighter sinc jl e n j equat r i analog effici way comput extern row column degre given algorithm cost amort subsequ degre updat current front use term amort time defin much total work ascrib comput singl degre bound c j r i note comput amort time estim actual includ cost comput extern row degre within estim column degre bound although actual extern column degre use comput bound amort time way comput extern row column degre row column degre bound row column current frontal matrix relat approxim degre algorithm georg liu quotient graph algorithm take amort time oja k comput c j correspond hold symmetr pivot select diagon much less time take comput true degre true degre c degre node x j implicitli repres elimin graph g k indistinguish unelimin node present quotient graph as use exampl time complex bound reduc comput true degre still take much time comput approxim degre describ comput degre bound c j amort time oja k comput extern column degre scan e r new row l shown algorithm row column new appear l u prior current pivot sinc e r impli must intern that is algorithm comput extern column degre assum new row l element e element list r row end end algorithm scan element e term we initi jl e j decrement intern row case end algorithm three equival condit hold e appear list r row l intern subset l e l empti algorithm scan element e r three follow equival condit hold unsymmetricpattern multifront method e appear r row l intern subset l e l empti combin two case obtain ae we we oe comput extern row degre element scan element list c j new column j u analog manner with separ work array total time comput extern column degre algorithm extern row degre theta comput c j assembl element scan element list c j evalu c j use equat extern row column degre element e zero delet e m c j assembl c e f element e longer exist ident assembl child element e parent the current frontal matrix f assembl tree classic multifront method also refer element absorpt costli point delet refer delet element refer delet element found later on discard extern column degre element e zero extern row degre zero e m delet c j column j assembl c e f column j delet element e final scan origin entri lambdaj column j discuss section remain entri assembl current frontal matrix perform assembl delet column j k thu amort time comput c j oja k includ time perform numer assembl scan row l analog amort time comput r i oja k pivot exampl one previou element element element list shown tabl extern column degre element one sinc appear element list three row l extern row degre element zero sinc ju appear element list two column u g row but assembl c f delet row column k also assembl f column assembl c f column scan sinc extern column degre element zero have c c t a davi i s duff r lambdac c mark alreadi assembl part element c gamma would possibl recov space comput chosen interest avoid expens updat associ element list note list refer posit within origin element assembl delet row element affect extern column degre element new row scan algorithm similarli assembl delet column element affect extern row degre element local pivot search within f evalu candid column c row r use equat exampl second pivot found local pivot search set l remain unchang set u augment new column row assembl k f subsequ execut step pivot assembl c made step substanti reduc new row column f assembl k c e done sinc possibl assembl would done previou pivot necessari decrement c j j l r i u step complet factor f work array w must reset next frontal matrix rather rescan element reset counter use follow modif algorithm counter w counter equal zero respect start factor algorithm modifi comput extern column degre assum new row l element e element list r row end end extern column degre ae oe enabl reus w degre comput next pivot step increment would overflow reiniti w w zero respect unsymmetricpattern multifront method exampl final factor frontal matrix l l l c c c l l c c c note u due relax amalgam two pivot row nonident pattern relax amalgam result higher perform sinc level bla use small exampl activ submatrix repres implicit assembl c c l l element list shown tabl tabl element list exampl matrix second frontal matrix algorithm algorithm full outlin umfpack version algorithm perform result section compar perform umfpack version mup gplu ssgetrf singl processor cray ymp although mup ssgetrf parallel code method set input paramet control behavior use recommend default these except indic below method factor gener unsymmetr matric supersed code first perform order phase also comput factor discard them perform t a davi i s duff algorithm unsymmetricpattern multifront algorithm initi global search kth pivot rc r form rectangular frontal matrix f sbyt work array more pivot found assembl kth pivot row column f scan element list comput extern degre assembl k contribut block f comput degre bound comput entri l u ju find candid column c u u lambdac d c c jl assembl column c comput c c find candid row r l r found goto step row r comput r r r u endwhil save l l l u u u u delet f add e element list endwhil numer factor comput entir lu factor matrix becom dens enough near end factor default dens switch dens factor code preorder matrix block upper triangular form alway preced find maximum transvers factor block diagon offdiagon block suffer fillin restrict unsymmetricpattern multifront method tabl input paramet method method option umfpack mup ssgetrf gplu scale yesno yesno yesno yesno yesno block upper triangular form yesno yesno yesno maximum transvers yesno ye preserv symmetri yesno yesno ye ye total number test per matrix pivot search diagon thu preserv symmetri exist mup perform minimum degre order symbol factor nonzero pattern construct assembl tree numer factor phase numer factor candid pivot entri must pass threshold partial pivot test similar equat except test row instead column sinc method compar perform test column factor mup use factor solv origin system option preorder matrix maxim modulu smallest entri diagon use maximum transvers algorithm mup alway attempt preserv symmetri permut matrix block upper triangular form ssgetrf classic multifront method cray research inc librari version instal cray ymp use liu multipl minimum degre mmd algorithm pattern includ threshold partial pivot test specifi document result conclud ssgetrf alway use maximum transvers algorithm base conclus observ mup ssgetrf obtain similar fillin highli unsymmetr matric matric mup perform poorli maximum transvers algorithm use like mup alway preserv symmetri permut matrix block upper triangular form gplu code gilbert peierl includ preorder phase factor use threshold partial pivot row interchang onli first explicitli form a find fillreduc order via liu multipl minimum degre algorithm use permut column order as suggest time report includ analysi phase also test gplu block upper triangular form as found ma appli gplu preorder block diagon gplu option preserv symmetri umfpack similar input paramet ma explicitli includ switch dens factor code each frontal matrix dens howev umfpack symmetrypreserv option similar ma except input paramet set prefer diagon pivot prefer strict test method scale unscal matric scale factor comput harwel subroutin librari routin mca row matrix scale mca subsequ divid maximum absolut valu row or column select threshold partial pivot factor u five method tabl summar differ option use method indic number run perform experi number case determin number option avail particular code method test singl processor cray ymp cmw t a davi i s duff tabl test matric name n jaj sym disciplin comment bcsstk structur eng bcsstk solid element model bcsstk corp eng dam plat oceanographi atlant indian ocean eng xx irregular grid sherman xx grid fulli implicit pore full grid shale sherman xx grid ln fluid flow linear navierstok shyy viscou fullycoupl navierstok exmat cylind plate heat exch shyy viscou fullycoupl navierstok mcfe astrophys radi transfer pollut eri electr power linear program basi migrat mahinda econom victoria australia finan portfolio optim radfr chemic eng nonreact separ light hydrocarbon recoveri section reactiv distil extr dynam simul reactiv distil lhr light hydrocarbon recoveri reactiv distil hydr dynam simul light hydrocarbon recoveri gre discret simul comput system megaword memori byte word version fortran compil cft use method given mw memori factor test matric list tabl tabl list name order number entri jaj symmetri disciplin matrix came addit comment symmetri number match offdiagon entri total number offdiagon entri entri ij j i match ji also entri tabl subdivid disciplin disciplin order decreas averag symmetri matric disciplin matric within disciplin order size n matric avail via anonym ftp includ matric harwellbo collect at orioncerfacsfr numericalccrlacuk saad sparskit collect at ftpcsumnedu test matric tabl avail ftpcisufledupubumfpackmatric petroleum engin problem list oil reservoir simul best time run list tabl method shown tabl best set option tend depend disciplin rather particular matrix optim paramet preserv symmetri scale permut block triangular form usual determin priori time unsymmetricpattern multifront method tabl run time second singl processor cray ymp cmw method matrix disciplin umfpack mup ssgetrf gplu bcsstk structur eng bcsstk plat oceanographi fail eng sherman pore sherman ln fluid flow exmat fail shyy fail fail mcfe astrophys eri electr power fail mahinda econom finan fail chemic eng lhr fail fail gre discret simul second includ analysi factor time includ time comput scale factor sinc use scale algorithm method fastest time matrix shown bold mup fail lhr shyy matric insuffici memori illcondit problem caus mup unabl numer ground choos pivot select analysi lead increas fillin subsequ failur ssgetrf fail plat unabl determin numer accept pivot order ssgetrf erron declar plat matrix singular gplu exceed time limit which one hour five matric umfpack faster four method matric usual twice slow fastest method except exmat matrix a larg matrix symmetr nonzero pattern howev umfpack normal requir storag four method shown tabl tabl list memori use run whose time list tabl smallest memori usag shown bold umfpack use time memori requir method need t a davi i s duff tabl memori usag megaword singl processor cray ymp cmw method matrix disciplin umfpack mup ssgetrf gplu bcsstk structur eng bcsstk plat oceanographi fail sherman pore sherman ln fluid flow exmat fail shyy fail fail eri electr power fail mahinda econom finan fail chemic eng lhr fail fail gre least memori usual gplu unsymmetr matric ssgetrf symmetr matric median two valu signific high enough limit use umfpack larger matric the shyy psmigr finan lhr matric exampl part reason umfpack use much memori store origin matrix both pattern numer valu row column form doubl storag matrix slightli facilit scan assembl entri see section plan remov doubl storag real next releas umfpack level bla matrixmatrix multipli sgemm routin attain perform mflop by matrix multipli store by array one processor cray ymp cmw reach peak perform quit quickli mflop by matric mflop by matric umfpack achiev peak mflop exmat matrix mup ssgetrf obtain mflop respect matrix perform much less work umfpack highest perform obtain umfpack matrix fastest unsymmetricpattern multifront method finan matrix mflop peak perform mflop psmigr matrix peak perform gplu mflop for bcsstk primarili innermost loop readili vector even appropri compil direct fundament limit gplu howev ng report gplu attain much higher rel perform ibm rs exampl gplu faster umfpack rs ln matrix although fastest bla use comparison scale matrix littl effect factor time solut qualiti as measur rel residu half matric test set scale improv result bcsstk psmigr matric hydr radfr rdist matric code except mup ssgetrf permut matrix block upper triangular form btf usual reduc execut time fillin btf nontrivi gplu alway improv howev trivial btf is symmetri usual worth preserv pattern symmetr moder so one class matric zero diagon note none method use by pivot unabl preserv symmetri zero diagon fill earlier pivot step unabl find stabl diagon pivot diagon pivot option request immedi switch full code earli switch may caus larg increas storag requir prevent us perform diagon pivot ln matrix matrix umfpack select offdiagon pivot entri symmetrypreserv option enabl perform statist includ analysi numer factor time five code list factorizeonli option usual much faster combin analysisfactor phase inde design criterion code for exampl ma minim factor time even caus increas initi analys time factorizeonli option version fast could sinc librarycod develop effort gone toward combin analysisfactor phase parallel factorizeonli code includ umfpack version result show unsymmetricpattern multifront method competit algorithm compar classic multifront approach mup ssgetrf algorithm base convent spars matrix data structur ma gplu acknowledg thank patrick amestoy mario arioli michel dayd theodor johnson steve zitney mani help discuss joseph liu provid us copi mmd order code john gilbert provid us copi gplu factor code mani research provid us larg unsymmetr matric class matric weak releas harwellbo collect matric avail via anonym ftp ftpcisufledu pubumfpackmatric directori r vector multiprocessor multifront code mup parallel packag solv spars unsymmetr set linear equat cray research user guid unsymmetricpattern multifront packag umfpack distribut mathemat softwar via electron mail algorithm obtain maximum transvers direct method spars matric user guid harwellbo spars matrix collect releas implement tarjan algorithm block triangular matrix exploit structur symmetri unsymmetr spars symbol factor comput solut larg spars posit definit system implement gaussian elimin partial pivot spars system elimin structur unsymmetr spars lu factor spars partial pivot time proport arithmet oper lu factor sequenc ident structur spars matric within distribut memori environ lost pivot recoveri unsymmetricpattern multifront method modif minimumdegre algorithm multipl elimin elimin form invers applic linear program comparison direct method solv spars nonsymmetr linear system pivot strategi gaussian elimin spars techniqu tr ctr cong fu xiangmin jiao tao yang effici spars lu factor partial pivot distribut memori architectur ieee transact parallel distribut system v n p februari olaf schenk klau grtner twolevel dynam schedul pardiso improv scalabl share memori multiprocess system parallel comput v n p februari olaf schenk klau grtner solv unsymmetr spars system linear equat pardiso futur gener comput system v n p april timothi a davi john r gilbert stefan i larimor esmond g ng column approxim minimum degre order algorithm acm transact mathemat softwar tom v n p septemb timothi a davi iain s duff combin unifrontalmultifront method unsymmetr spars matric acm transact mathemat softwar tom v n p march anshul gupta recent advanc direct method solv unsymmetr spars system linear equat acm transact mathemat softwar tom v n p septemb timothi a davi column preorder strategi unsymmetricpattern multifront method acm transact mathemat softwar tom v n p june xiang zhiqe l fast algorithm base partial basic solut vector domain decomposit method scatter analysi electr larg cylind journal comput physic v n p decemb