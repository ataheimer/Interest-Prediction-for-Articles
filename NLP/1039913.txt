t approxim algorithm extens problem a extens problem given weight graph node mark termin semimetr set termin goal assign rest node termin minim sum edg product edg weight distanc termin endpoint assign problem gener multiway cut problem dahlhau et al siam j comput pp close relat metric label problem introduc kleinberg tardo proceed th ieee annual symposium foundat comput scienc new york pp we present approxim algorithm sc extens arbitrari graph present olog kapproxim algorithm k number termin also give oapproxim guarante weight planar graph result base natur metric relax problem previous consid karzanov european j combin pp similar flavor linear program relax garg vazirani yannakaki siam j comput pp multicut problem similar relax graph partit problem prove integr ratio metric relax least c sqrtlg k posit c infinit mani k result improv result kleinberg tardo understand use metric relax b introduct let v finit set let v let semimetr semimetr v extens v iff everi addit everi extens v consid follow optim problem denot extens given graph e nonneg edg weight c subset node semimetr find extens v minim total weight length edg help compar extens multiway cut problem dahlhau johnson papadimitri seymour yannakaki multiway cut follow problem given graph e nonneg edg weight r subset v termin find map minim x word find set edg minimum total weight whose remov disconnect termin pair defin uniform metric ie exactli problem find minim cu v dfu fv extens natur gener multiway cut which instead uniform metric arbitrari semimetr word must find minim cu v dfu fv dahlhau et al show multiway cut and therefor extens apxhard thu exist constant polynomialtim algorithm find solut within factor optimum unless pnp paper develop approxim algorithm extens problem studi seem us natur linear program relax problem specif given semimetr extend semimetr larger set v minim uve cu vu v we call metric relax obvious set feasibl extens defin ojv linear constraint object function linear thu find best extens linear program problem solv polynomi time deriv approxim algorithm use metric relax thu bound also integr ratio relax arbitrari graph give random olog jt japproxim algorithm show integr ratio least constant time log jt j infinit mani jt j improv upper bound o weight planar graph or fact famili graph exclud k rr minor fix r karzanov consid metric relax extens problem character case relax give optim solut multiway cut problem known metric relax yield jt japproxim algorithm see inde observ use idea underli combinatori algorithm dahlhau et al perform guarante gener case qualiti metric relax known prior work multiway cut differ relax give better approxim asymptot ratio significantli see calinescu karloff rabani r semimetr iff everi metric improv bound cunningham tang karger klein stein thorup young clear calinescu et al relax extend handl gener case extens recent paper kleinberg tardo give approxim algorithm similar problem classif pairwis relat call metric label problem termin distinct vertic call label semimetr label node graph vector assign cost label goal minim total assign cost plu sum weight edg length formal given graph e nonneg edg weight c set label metric nonneg assign cost function problem find map minim cu v dfu fv case uniform metric kleinberg tardo give approxim algorithm base relax similar calinescu et al relax multiway cut unlik multiway cut problem integr ratio relax least jt j chuzhoy improv result three four termin achiev tight bound three termin kleinberg tardo give constant approxim algorithm class hierarch wellsepar tree metric hst follow bartal small distort embed metric hst metric use result tree give olog jt j log log jt japproxim algorithm arbitrari metric gupta tardo later give local searchbas approxim algorithm case truncat linear metric ie kleinberg tardo gupta tardo motiv work sever applic mostli concern comput vision imag restor visual correspond applic node graph pixel raster imag edg model adjac so fact graph twodimension mesh imag restor applic label model pixel intens color assign label pixel amount determin true intens or color pixel observ valu assign cost penal differ observ assign intens visual correspond applic label model possibl shift two imag assign label pixel amount determin shift pixel two imag assign cost penal differ valu supposedli match pixel type applic structur graph aris assum priori distribut true label gener markov random field where distribut pixel depend distribut neighbor notic extens special case metric label set u cu result improv upon result case note extens formul seem appropri mani comput vision applic mention exampl connect pixel weight edg label correspond observ intens get assign cost proport distanc observ assign valu algorithm weight planar graph actual use fact v n induc planar graph altern constantratio approxim algorithm comput vision problem anoth problem relat multicut problem first consid context approxim algorithm two paper garg vazirani yannakaki and implicitli klein agarw ravi rao problem given weight graph k pair termin node graph goal find set edg minimum weight whose remov disconnect everi pair termin differ gener multiway cut the latter view multicut problem k pair termin incompar extens problem sens neither problem special case other garg et al give olog jt approxim algorithm multicut problem base metric relax assign length edg distanc everi specifi pair termin least result tight relax exampl achiev asymptot integr ratio expand upper bound use regiongrow techniqu similar use leighton rao approxim minimum flux edg expans graph klein plotkin rao improv leightonrao techniqu planar graph and gener graph exclud k rr minor get constant factor approxim minimum flux use techniqu tardo vazirani exhibit constant factor approxim algorithm multicut problem planar graph and k rr result seen counterpart garg et al tardosvazirani result regiongrow techniqu give good approxim case extens howev result view form random region grow applic scale function distanc implicit gener case algorithm explicit planar graph algorithm use klein et al techniqu scale distanc may worth note expand particularli bad case relax see section rest paper organ follow section present algorithm gener case section improv bound planar graph section discuss qualiti linear program relax underli approxim algorithm throughout rest paper use k denot number jt j termin call vertic v n nontermin olog kapproxim algorithm section present random algorithm find extens weight olog time optimum begin comput optim solut follow natur linear program relax denot met minim cu vu v subject v semimetr assign defin optim solut extens problem put u defin feasibl solut met weight optim solut therefor optim valu z met lower bound minimum weight extens exhibit round procedur take feasibl solut met valu z construct extens assign weight oz log k round procedur work follow pick uniformli random permut independ choos uniformli random interv real number round algorithm iter assign node termin remain node termin on everi round procedur given below round procedur t pick random permut termin pick uniformli random interv unassign nontermin u u j u set assign u j endfor endfor first show round procedur produc extens claim round procedur assign everi nontermin termin proof consid nontermin v let termin v choos j v assign termin iter must assign iter j pair node u v v defin random variabl su say separ fu fv notic u v separ su goal bound expect esu v first state bound probabl u v separ lemma fix u pru v separ h k u v k kth harmon number prove bound state prove consequ bound esu v core analysi algorithm lemma pair distinct vertic proof fix u v put u v triangl inequ v u u termin therefor inequ su v alway u v nontermin triangl inequ termin j u therefor u assign termin regardless choic su alway thu may assum u v nontermin consid two case depend whether small compar u v not u v inequ su v similarli v su v therefor u v lemma hold assum therefor g recal also assum u v u v first inequ follow lemma inequ conclud theorem random polynomialtim olog kapproxim algorithm extens proof let optim solut met cost z lemma expect weight extens obtain round procedur oz log k therefor exist choic produc solut weight oz log k obtain polynomialtim algorithm notic given permut two differ valu produc combinatori distinct solut termin j node u u thu enumer kjv j interest valu determin valu sort fraction u ja u node u u constant somewhat arbitrari definit could improv proof lemma let eu v denot event termin j j process u assign j wherea v remain unassign defin ev u similarli show symmetri prev u h k a v therefor lemma follow inequ let let notic m s disjoint subset termin put assum round procedur use then v must assign termin s equival r j similarli u cannot assign termin m s inde u assign termin j l j base whether r j not j either s m moreov eu v happen first termin ms process m inde first termin j s v and possibl also u assign j thu notic exist j r s never empti distribut uniformli get z m d need follow claim fix posit integ k let nonneg real let nondecreas sequenc real let hr anoth sequenc real r j j z m proof notic m function integr welldefin let largest index l so k l t prove induct valu integr h h k z m z r so assum claim true case valu l j consid sequenc exactli js l j compar valu integr case valu integr sequenc hl first sequenc becom hl notic latter sequenc satisfi condit claim furthermor js l j therefor induct hypothesi h l r claim hold case thu may assum l r rang integrand differ l minfr g rang everi j t l j therefor second pair sequenc origin sequenc l minfr g m greater s same differ integrand therefor therefor minfr g l t r l t l r l henc complet proof claim proceed proof lemma notic l j u use assumpt u j v u u u u u u henc use claim z m combin equat inequ get preu v h k a u prove inequ thu lemma oapproxim algorithm planar graph section use linear program relax met get improv bound planar graph achiev improv bound present differ round procedur show input graph e k rr minor round procedur present section guarante or approxim ratio planar graph k minor free give polynomialtim oapproxim algorithm planar graph and gener k rr minor free graph everi fix r main tool use follow theorem klein plotkin rao the extens weight case state tardo vazirani theorem klein plotkin rao constant polynomialtim algorithm kprh c r take input graph nonneg integr edg nonneg edg cost c eh q posit ration posit integ r find either k rr minor h set edg total ccost r eeh ece whose remov decompos h connect compon shortest path in h use edg length two node compon r let r posit integ let r feasibl solut met weight z use theorem exhibit determinist round procedur obtain extens weight oz assum input graph g k rr minor free main idea round procedur partit nontermin cluster that two node u v cluster u twice v assign node cluster termin closest one node cluster formal round procedur comput extens follow second round procedur everi termin t everi nontermin u v endfor let e subgraph g induc remain nontermin v g everi edg uv cuv cu v maxfa g endfor execut kpr g result cluster c v choos x c minim x choos endfor first establish simpl fact round procedur let uv uvcuv z z min proof notic u v u v min maxfa uv uv u v uv total ccost edg remov kpr g c r min r or z result cluster c diamet min proof theorem sum cuv edg uv u v differ cluster r z claim r z or z also theorem diamet result cluster c relat distanc origin distanc lemma let u v length shortest path g u v respect edg length min u v u proof let vi shortest path g u v respect edg length j let triangl inequ x u notic j therefor j x x also therefor x use thi j last inequ follow hypothesi length hx min conclud j u final notic triangl inequ u v j readi analyz perform round procedur lemma let r integ everi input graph g k rr minor free everi feasibl solut met weight z round procedur produc extens weight or z proof let uv e edg g endpoint u v endpoint either termin node distanc termin henc dfu u togeth cluster c contain it assign termin i definit round procedur node x c x combin claim lemma v x v therefor use triangl inequ v i v use triangl inequ again dfu howev u therefor dfu fv u v left edg uv e denot cluster contain u uv uv howev g second inequ follow fact definit algorithm everi nontermin u fu termin closest x cu fu argu previou case x u u inequ follow triangl inequ fu u therefor uv uv uv cuv uv state uv e cucv cuv or z conclud main result section theorem let r fix integ determinist polynomialtim oapproxim algorithm extens k rr minor free weight graph proof solv met optim use round procedur section clearli implement polynomi time lemma establish perform guarante algorithm integr ratio section use max flowmin cut theorem prove follow lower bound integr ratio natur relax theorem c infinit mani posit integ k instanc extens k termin optim valu object function least c lg k time optim valu relax proof real infinit mani graph g known expand maximum degre g subset jv gj node least jsj node adjac least one node s fact given prime q congruent mod of infinit mani lubotzki phillip sarnak construct regular expand either qq qq node take given suffici larg q use expand e need n maxfn g n determin later defin l dlg nee n dnle choos k distinct node h new node l new edg current graph get new path p start h end new node label new node i finish let new graph g vertic je defin instanc extens follow vertex set v set termin f kg k distanc g j defin cu v uv cu show integr ratio instanc larg first studi relax defin u v distanc g u v clear i also clear semimetr g follow uv cu vu adjac vertic g distanc prove univers c feasibl solut ie function uv cu vdfu fv cn lg n note first minimum distanc two distinct termin i j least l lg n see below howev least k termin distanc termin least lg n fix posit constant lg n need lemma lemma least k vertic h g whose distanc h exce lg k proof contradict assum k vertic g distanc h degre bound number vertic g distanc h henc k a henc choos n larg enough k function n must least give us contradict show without loss gener everi vertex v v p map i lemma given except new vertic path p map f i f uv cu vdfu fv proof name vertic h path v uv uv l triangl inequ l differ nonposit let us assum map new vertic p termin i let r ig two case lg n g expand jr j n i number edg uv u least jr j henc lg n each cross edg count twice case r say r size exceed n use expans max flowmin cut theorem prove theorem choos dke termin distanc g h h least lg k exist let f set chosen termin n lg n lg uniqu neighbor h v v let build direct network n v fs tg s new node follow start subgraph g induc v replac edg pair antiparallel arc capac one add arc u t u capac add arc s x x x capac r v finit capac cut defin fsg x choos finit capac cut c possibl c set arc u v s expans g jcj jsj let sg correspond f h arc total thu total number arc c least penultim inequ follow fact either h x m f follow minimum capac cut n least k max flowmin cut theorem maximum flow valu arc flow u v v u u v chang flow arc result maximum flow use one u v v u u v flow decompos least k arcdisjoint path n u v one u v v u appear path follow least k arcdisjoint path x f vertex path then use fx least lg n sinc path arcdisjoint least k them infer lg use definit k last sum least lg lg n sinc feasibl solut met valu je j n ratio two least lg k choos proof theorem complet follow theorem show analysi asymptot tight also suggest altern round procedur instanc perform better result section though gener far wors theorem polynomialtim algorithm take input connect graph e subset termin comput function du v minimum number edg path u v proof add new vertex g connect termin run breadthfirst search start s comput everi node v v distanc lv s notic everi class c r smallest posit integ jc r j jej max max defin f let arbitrari termin everi t everi v v lv r set v termin closest v g least one inequ strict therefor dt consid edg uv c r lu lv r dfu r lu lv r dfu remain case use trivial bound dfu fv max use bound r jc r j ir uvcr ir interest note bound degre expand bound much better use argument similar proof theorem prove theorem everi suffici larg posit integ constant infinit mani k expand e maximum degre jv j ok log k set v size k integr ratio met extens instanc defin g gpath metric least log log k hand everi everi nnode expand g maximum degre choic termin integr ratio met extens instanc defin g gpath metric log log n and polynomialtim algorithm achiev bound r approxim arbitrari metric tree metric improv approxim algorithm multiway cut optim termin cut linear program privat commun complex multiway cut complex multitermin cut approxim maxflow minmulticut theorem applic round algorithm geometr embed minimum multiway cut minimum extens graph metric approxim multicommod flow planar graph approxim maxflow mincut theorem uniform multicommod flow problem applic approxim algorithm ramanujan graph tr ctr howard karloff subhash khot aranyak mehta yuval rabani earthmov distanc metric label extens proceed thirtyeighth annual acm symposium theori comput may seattl wa usa