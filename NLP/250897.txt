t adapt verlet method a discuss integr autonom hamiltonian system via dynam rescal vector field reparameter time appropri rescal eg base normal vector field minimum particl separ nbodi problem alter timerevers symmetri flow desir maintain symmetri discret standard form mechan system without rescal achiev use explicit leapfrogverlet method show explicit timerevers integr reparameter equat also possibl parameter depend posit veloc onli gener rescal scalar nonlinear equat must solv step one forc evalu need new method also conserv angular momentum nbodi problem use revers scheme togeth step control base normal vector field arclength reparameter demonstr sever numer experi includ doubl pendulum kepler problem threebodi problem b introduct articl consid numer integr autonom differenti equat r n dt aris celesti mechan classic atom molecular dynam mani import theoret practic situat direct integr or simul princip tool studi problem fix stepsiz numer integr nonlinear system lead difficulti particularli neighborhood singular vector field articl describ famili effici adapt method numer solut initi valu problem equat base normal or dynam scale of vector field recent research focus develop timestep scheme preserv underli geometr structur flow system eg symplect case hamiltonian system regardless whether scheme faith preserv avail underli structur accur stabl fix stepsiz numer integr often requir excess small timestep particularli true integr vicin fix point singular principl possibl incorpor stepsiz variat mechan base local error estim mani advantag structurepreserv scheme appear lost stepsiz vari use tradit approach consid approach base introduct time reparameter given appropri smooth scalarvalu function mm integr differenti equat ds ds depart mathemat univers kansa lawrenc ks usa whuangmathukansedu support part nsf epscor grant no osr z depart mathemat univers kansa lawrenc ks usa leimkuhlmathukansedu support nsf grant no nsf behavior trajectori extend phase space highli sensit reparameter term phase space orbit reparameter irrelev flow preserv integr invari flow reparameter integr appropri fixedsteps discret scheme natur choic r given heurist r kfk kk euclidean norm choic normal vector field also view associ step time directli step arclength measur along phase space orbit choic inde variant reparameter idea use variou applic exampl base r separ particl manyparticl system singular potenti techniqu view framework r construct base embed local error estim heurist would retain approxim constant arclength project solut accur and complic control could incorpor estim orbit curvatur point relat recent work use reparameter framework design scheme better conserv variou integr energi particularli interest system base separ hamiltonian well known larg system type one encount molecular dynam comput cost simul domin forc evalu problem often solv explicit leapfrog verlet method second order symplect timerevers symmetr requir one forc evalu per step larg nbodi problem much recent work concentr find method handl singular wide vari forc without evalu full forc field everi integr step base method potentialspecif split sometim achiev effect variabl stepsiz method see articl take differ approach rather tri adapt time stepsiz directli accord prescrib rescal time use correspond reparameter base norm gradient hamiltonian henc accord densiti flow line along solut gener reparameter destroy hamiltonian structur timerevers flow easili preserv coupl structur alter reparameter natur gener leapfrogverlet scheme which retain featur conserv angular momentum timerevers becom implicit exampl scheme lead implicit integr strategi requir evalu forc gammarv sever time per integr step main practic contribut articl show implicit remov use special discret method treat reparameter factor new variabl propag togeth physic variabl call new method adapt verlet actual discuss two variant method one base differenti equat defin reparameter factor base introduct algebra equat solv tandem equat motion use ad hoc discret scheme latter differentialalgebra approach requir addit forc evalu step recommend method typic applic stress reparameter depend q base arclength addit work adapt verlet method standard verlet consist solut singl scalar quartic polynomi equat timestep effici implement would also possibl mani choic rescal fact special case rescal base either posit momenta onli equat becom fulli explicit control minimum maximum stepsiz also easili incorpor framework method implement variou simpl nonlinear model meant repres typic autonom system doubl pendulum kepler problem threebodi problem found robust effici experi background smooth f initi valu problem ut least local solut given u assum solut exist time associ thu flowmap oet take given point u r n point u solut forward trajectori pass given point set g two way trajectori unnatur describ solut autonom differenti equat first autonom follow oet in sequel write oet oe t mean inclus initi time descript solut inher arbitrari second rescal vector field solv instead dt solut u unchang except rescal time reason gener natur replac trajectori u orbit u defin set foetu g orbit scale translat invari onestep method solv comput approxim flow map ie map deltat r n kdeltatu given stepsiz deltat numer forward orbit point u discret set g method said pth order accur fix k independ deltat implicit midpoint method defin second order accur scheme popular method integr separ system leapfrogverlet scheme deltat deltatrv q n w huang b leimkuhl scheme explicit requir one forc evalu per step nd order accur hamiltonian system timerevers flow consequ fact even function mean integr start point deltat unit forward time chang sign momentum integr anoth deltat unit return us start posit flow map also symplect mean two form dq dp integr motion geometr symmetri symplect timerevers impos strong restrict possibl type fix point stabil motion neighborhood fix point recent research timestep scheme concentr find numer method deltat share timerevers andor symplect flow exampl leapfrog implicit midpoint method timerevers also symplect implicit midpoint method and gausslegendr gener preserv quadrat integr invari leapfrog scheme and broader famili lobatto iiiab pair partit rungekutta method shown preserv angular momentum constant stepsiz use method show remark long term stabil respect energi error except presenc larg forc symplect or timerevers method exhibit linear error growth period integr case composit two symplect timerevers map symplect timerevers natur consid vari stepsiz step step stepsiz select strategi add layer complex discret dynam system sinc stepsiz becom function dynam variabl experi standard variabl stepsiz integr heurist disappoint exampl gener stabil energi linear growth error integr system lost timerevers variabl stepsiz method use conjunct underli symplect scheme consid calvo hairer observ recaptur favor featur symplecticrevers scheme articl mainli concern treatment gener nonintegr dynam also observ linear growth error kepler problem revers scheme singular normal vector field interact pair bodi coulomb potenti r distanc particl regular introduct new coordin system remov singular nbodi problem twobodi interact similarli regular singular repres collis three particl cannot elimin similar problem aris singular potenti mean sort timestep contract need neighborhood singular order resolv behavior accur even without singular unlik singl fix timestep appropri along whole orbit insight select timestep obtain note mani problem norm gradient hamiltonian and henc norm vector field larg place time scale chang rapidli fix stepsiz integr perform poorli norm gradient h measur fastest direct rate chang hamiltonian henc fix stepsiz integr appear fail point mani orbit get squeez togeth put anoth way fix stepsiz integr may develop instabl point densiti figa figb figd figc fig fix stepsiz verlet method problem flowlin system larg exampl simpl singular system consid bond problem hamiltonian orbit system phase space consist two lobe close curv separ line sampl orbit shown fig a although orbit quit smooth timescal chang dramat neighborhood origin path lower left extrem point orbit upper left point travers extrem rapidli fig b rapid variat appear except steep deriv p appli fixedsteps verlet scheme integr bond problem result sever orbit shown fig cd singl fix stepsiz integr proce without difficulti even high energi level long particl stay roughli right vertic line pass fix point nearer origin curv breakup rel low energi level integr becom unstabl fig d anoth type difficulti occur equat motion possess isol nearsingular point doubl pendulum unequ mass case cusplik turn point appear solut creat difficulti fix stepsiz integr although diagon rescal weight variabl sometim remov nearsingular behavior gener feasibl complic problem mechan need improv situat consid local reparameter time accord kfuk normal vector field view control arclength measur along phase space orbit travers per unit time similar heurist view normal arclength travers along trajectori w huang b leimkuhl per unit time although articl focus vector field normal method could appli work mani choic r exampl particl motion central forc may typic assum closest twobodi approach determin largest forc problem introduc control min r min repres smallest interparticl separ ff posit constant idea suggest normal vector field reason use fix stepsiz integr howev sometim necessari limit variat r avoid excess small step neighborhood singular point easi incorpor maximum minimum stepsiz exampl given minimum time stepsiz deltat min maximum time stepsiz deltat max fictiv timestep delta set deltasdeltat min deltat bound deltat min deltat max one drawback normal becom evid case separ hamiltonian normal vector field separ mean explicit scheme particularli leapfrogverlet cannot directli appli next section show verlet method modifi provid effici semiexplicit approach variabl stepsiz integr below first show effect combin reparameter timerevers integr procedur exampl exampl doubl pendulum consid doubl pendulum problem hamiltonian graviti constant mass posit bob relat equat motion make problem challeng gave two bob differ mass m hamiltonian nonsepar use symplect timerevers implicit midpoint method fix step size method littl difficulti resolv x fig b x fig timestep hh fig c timestep hh fig fig implicit midpoint scheme fix stepsiz doubl pendulum problem use comput ac solut smooth region may fail near cusp result error increas dramat jump behavior illustr fig fix stepsiz gamma succe resolv motion near cusp stepsiz gamma use howev result instabl energi poor resolut especi long time interv remark stabil energi observ smaller valu deltat hallmark symplect also timerevers method partli explain backward error analysi symplect method see cusp point occur point case vector field nearli singular conclud norm vector field larg vicin unabl integr doubl pendulum stepsiz larger fix stepsiz method extrem wast term comput sinc larg stepsiz feasibl smooth region result integr reparameter equat time interv summar fig scheme place mani point neighborhood turn point use larg timestep smooth segment incorpor stepsiz minimum deltat restrict smallest step taken vicin cusp point step integr need problem would requir approxim fix step similar accuraci semiexplicit integr adapt verlet method section turn attent mechan system separ hamiltonian w huang b leimkuhl time hh fig c time timestep fig x fig b x fig fig implicit midpoint scheme normal vector field doubl pendulum use comput modifi equat motion reparameter time dq ds ae dp ds p system longer solvabl standard verlet method second order lobatto iiiab partit rungekutta formula view gener verlet method appli equat with delta start and view scheme map phase space one may also replac two step delta delta discret follow import featur i reduc verlet timerevers iii symplect problem hamiltonian ie preserv angular momentum higher order lobatto pair retain featur restrict second order method articl equat implicit requir solut nonlinear system step fact r scalar use develop rel effici newton solver base rankon updat howev still effici scheme possibl differenti control subsect describ approach base introduc stepsiz control new variabl differenti equat lead discret algorithm requir evalu hessian potenti energi functionor finit differ approxim two forc evalu per step next subsect see scheme improv differenti equat ae rq p respect reparameter time yield ds ds ds theta r q r idea treat coupl system q p ae illustr choic similar scheme obtain upper lower bound builtin r describ abov r gamma p r q ds discret result coupl system obtain partit variabl q p ae use second order lobatto iiiab pair ae n p n ae n ae ngamma delta delta delta ae n rewritten ae n delta get ae n or multipli ae ae delta observ ae n p n ae n p ngamma gamma deltasrv q n ae n ae ngamma linear function ae n allow us conclud cubic polynomi ae n start may use formula ae n ae n ae n given converg timerevers scheme follow directli correspond featur underli lobatto scheme introduct new scalar variabl fact scheme longer symplect destroy preserv angular momentum sinc assum central forc n theta p n theta p n theta p ae n p n theta p experi use precis method describ here instead replac slightli differ midpoint formula ae n ae ngamma deltasgq result scheme converg order two linear stabil observ evid degrad perform case look at mani case comput hessian matrix v q intoler expens situat suggest use approxim appropri chosen ffl modif chang definit time reparameter phase space dynam requir two comput forc at time step may use effici implement observ forc comput two close point configur space mean forc evalu base list nearbi interact particl list use calcul coupl differentialalgebra system prefer approach view reparameter equat dq ds ae dp ds ae coupl differentialalgebra dae system method previou section view regular base differenti constraint potenti drift effect degrad numer result long time interv integr sinc long time interv simul precis applic timerevers method expect make substanti differ may import correct situat moreov would like find method requir comput hessian matrix one forc evalu per step reason propos instead follow direct discret coupl dae ae deltasrv ae n ae ngamma rqn method requir singl evalu gammarv step scheme deriv base differenti control reduc implicit singl scalar equat ae n ae n ae ngamma normal dynam easili seen that multipli side ae n left quartic polynomi ae n gener situat arbitrari parameter r would still obtain scalar nonlinear equat solv ae particular situat comput ae n becom complet explicit ae n rqn depend p one simpli revers role p q stagger discret develop explicit method discret index differentialalgebra integr standard form easili seen second order accur analyz linear stabil scheme confirm bounded converg iter standard assumpt smooth vector field bounded exact solut particular condit stabil analysi go ae remain strictli bound away zero along exact solut interest argument precis analog given x easili seen differentialalgebra method conserv angular momentum method clearli timesymmetr set deltat ae n solv p n substitut obtain deltat n deltat n deltat deltat thu view method tradit variabl stepsiz version stormer rule start differentialalgebra scheme given valu q could employ differenti constraint approach previou section instead use follow start step good success delta ae rq numer experi section give sever numer experi use new scheme case integr normal vector field without minimum stepsiz control maximum stepsiz deltat use experi conduct ieee float point arithmet use doubl precis machin excel result also obtain bond problem use normal conjunct integr larg nbodi problem typic appropri sinc effect separ strong contribut forc field unreason compound determin stepsiz outsid wellstudi gravit pure electrostat nbodi problem pairwis potenti r see awar systemat studi appropri time transform numer integr small problem consid experi normal vector field appear suitabl choic kepler problem kepler problem hamiltonian long standard benchmark numer integr low eccentr orbit integr without difficulti use standard fixedsteps verlet method one recov good fidel relev featur flow notabl featur that contrast standard result numer integr error growth use symplect method verlet linear time goal variabl stepsiz method obtain method robust respect variat eccentr e use small stepsiz orbit pass near origin thu improv effici also demonstr similar behavior three differ method method base differenti control method finit differ approxim evalu hessian differentialalgebra system figur compar behavior three adapt approach give similar result experi figur see adapt method easili outperform fix stepsiz method observ fig energi error maximum time interv record adapt method essenti constant independ eccentr e in fact rel energi error decreas slightli increas e number step variou energi error shown fig b sever order magnitud smaller fix stepsiz fig b also show second order converg adapt method fix stepsiz version difficult case shown fig use adapt scheme comput high eccentr w huang b leimkuhl hh_ figa hh_ figb hh_ figc time step time stepsiz figd time step time stepsiz fige time step time stepsiz figf fig comparison three adapt method kepler problem f delta use fig a d differenti formula b e differ formula c f algebra formula adapt fix e figa adapt fix number step figb figc fix stepsiz figd adapt fig comparison adapt verlet differentialalgebra method nonadapt verlet method kepler problem f plot everi step a delta use b use d delta use hh_ figa figb fig adapt verlet differentialalgebra method kepler problem use comput plot everi step threebodi problem final exampl look classic problem well known present sever challeng standard numer method threebodi problem gravit or electrostat interact three point particl problem recent treat detail thorough studi classic dynam helium sinc insight quantum mechan atom obtain understand bifurc phase space structur period orbit author point out quan tit classic studi complic multidimension nonsepara biliti unbound charact motion govern singular longrang potenti problem also someth benchmark celesti mechan model calcul sought resolv format binari pair tripl follow threebodi nearcollis experi regular twobodi collis suggest somewhat effici integr probabl possibl howev threebodi approach stumbl block experi introduct fictiv time time reparameter separ two atom frozen nucleu helium use improv behavior dynam simul use unit mass normal gravit constant assign initi posit momenta result appli adapt method delta delta shown fig abc respect latter two integr produc nearli ident orbit sinc timestep use fig def order magnitud smaller third case second conclud high probabl success comput true motion notic qualit chang behavior timestep t time particl locat small region fig fig b fig c time timestep fig time timestep fig e time timestep fig f fig adapt verlet method threebodi problem ad cf delta point forc becom larg one particl eject two form binari pair small stepsiz need resolv close threebodi interact much larger stepsiz use resolv motion binari pair qualit chang also illustr energi plot three calcu lation shown fig averag stepsiz use three variabl stepsiz simul attempt solv problem use fix stepsiz disastr result shown fig abc case integr becam complet unstabl vicin threebodi approach energi error extrem small earli go rose dramat suddenli event fig show closeup earli behavior case stepsiz smaller orbit success integr fix stepsiz method shown fig conclus long known use time reparameter improv behavior numer method dynam system particularli orbit pass neighborhood singular point vector field articl introduc adapt verlet method timerevers integr reparameter nbodi problem shown robust effici numer experi one limit approach yet precis quantit understand relationship free paramet delta accuraci orbit subject current work also investig effici higherord adapt timerevers method work time energi error fig fig energi error adapt verlet method step refer delta appli method constrain mechan system acknowledg skeel read preliminari draft articl provid use comment x fig x fig b x fig c time energi error fig time energi error fig e time energi error fig f fig fix stepsiz integr threebodi problem ad time energi error fig b x fig fig fix stepsiz integr threebodi problem vicin time energi error fig b x fig fig fix stepsiz integr threebodi problem w huang b leimkuhl r integr method small nbodi system numer solut initi valu problem differentialalgebra equat accur longterm integr dynam system develop variablestep symplect integr stabil rungekutta method trajectori problem canon integr techniqu variabl stepsiz ruin symplect integr symplect partit rungekutta method matrix comput backward error analysi numer integr symplect method build better leapfrog numer integr method moleculardynam numer experiment view fewbodi problem explicit canon method hamiltonian system classic mechan twoelectron atom chapman hall stabil symplect energymomentum algorithm nonlinear hamiltonian system symmetri symplect integr variabl stepsiz variabl step revers integr method aspect chaotic behavior solar system tr ctr b cano a durn techniqu construct symmetr variablesteps linear multistep method secondord system mathemat comput v n p octob b cano a durn analysi variablesteps linear multistep method special emphasi symmetr one mathemat comput v n p octob ben leimkuhl effici multipl timescal revers integr gravit nbodi problem appli numer mathemat v n p octob