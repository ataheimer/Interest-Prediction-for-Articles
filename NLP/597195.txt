t optim schedul parallel cbr video server a parallel video server necessari largescal videoondemand multimedia system paper address schedul problem parallel video server discuss schedul requir constant bit rate cbr video stream optim algorithm present conflictfre schedul delay minim request reloc admiss control algorithm video stream precis schedul qualiti servic requir perform algorithm also present b introduct increas demand capac video server largescal videoon demand system parallel video server becom inevit provid larg capac requir system servic thousand concurr client two major type parallel video server share memori multiprocessor distribut memori cluster architectur figur show diagram sharedmemori architectur architectur set storag node set comput node connect share memori video data sent memori buffer highspe network bu client mass storag system present capac support hundr request howev yet clear multiprocessor video server scalabl cluster architectur easi scale thousand server node system set storag node set deliveri node connect interconnect network data retriev storag node sent deliveri node send data client figur show diagram cluster architectur number work describ cluster system cluster architectur extend directaccess architectur provid interfac storag system network figur show diagram directaccess architectur elimin deliveri node cluster architectur storag node send video data direct high speed wan network interfac video file store singl storag node architectur cannot guarante order data arriv differ storag node problem solv project mar use chain connect atmbas interconnect within server connect storag devic atmbas broadband network storag node storag node storag node storag node memori bank processor high speed wan network interfac figur sharedmemori architectur video server storag node storag node storag node storag node node deliveri node deliveri node deliveri node deliveri high speed wan interconnect network figur cluster architectur video server optim schedul parallel cbr video server storag node storag node storag node storag node high speed wan network interfac interconnect network figur directaccess architectur video server paper evalu schedul strategi cluster architectur shown figur interconnect network connect storag node deliveri node storag node respons store video data storag medium disk storag node deal disk schedul problem separ provid specifi bandwidth deliveri node respons client request receiv request client deliveri node schedul time interv deliv appropri data block within time deadlin client playout video deliveri node output buffer interfac highspe wan wan congest output buffer becom full feedback signal sent correspond storag node stop send video block logic storag deliveri node map differ physic node cluster configur call twotier architectur also node storag node deliveri node call flat architectur paper flat architectur assum schedul polici critic perform video server current mani schedul algorithm parallel video server particular cluster video server without good schedul algorithm video stream may conflict other result delay reject larger buffer size may requir toler delay good schedul algorithm guarante qualityofservic effici util resourc reduc buffer size increas system throughput paper organ follow section briefli describ underli model parallel cbr video server conflictfre schedul algorithm delay minim present section section request reloc algorithm present admiss control discuss section perform comparison present section section give relat work section discuss futur work system architectur background section model schedul problem video server first assum wide stripe is video data stripe across node roundrobin fashion differ video file start differ node balanc load exampl first file start node second file start node etc result obtain extend short stripe distribut video block subset node depend select block size base stream rate r time divid time cycl length cycl sr time access n block one storag node call time period thu time period includ n time cycl gener data transfer rate singl disk disk array much higher base stream rate r therefor time cycl multipl video stream servic storag node individu stream rate still preserv time cycl thu divid time slot length slot equal longer time requir retriev block storag node transmit deliveri node whichev larger valu determin experi similar qualityofservic qo problem two type guarante determinist guarante statist guarante determinist guarante determin use worst case number approach describ approach guarante qo request system may underutil statist guarante determin use averag number period time increas system util data may miss deadlin buffer space necessari smooth delay jitter number slot cycl m determin adjust f m similar model use tiger system experi result show model work well real system assum video server consist n storag node n deliveri node interconnect highspe network individu request r handl deliveri node node respons deliv data block retriev storag node client via network entir lifetim request r unless request reloc requir block video file consecut distribut n storag node request r time cycl t retriev data block storag node retriev data block node sr video block schedul illustr simpl exampl figur show schedul balanc load video stream start differ storag node entri figur show request optim schedul parallel cbr video server slot node node node node r r r r time cycl r r r time cycl r r r time cycl r r r r time cycl deliveri node request r k storag node j figur complet video schedul time period number r k deliveri node number i storag node number j request retriev block storag node j deliveri node i video stream access pattern list horizont row block singl stream separ time slot exampl request r schedul time slot first row request deliveri node retriev block storag node time cycl retriev block storag node next three cycl schedul tabl wrap around n theta m request schedul time slot one request need retriev block storag node compet resourc order avoid conflict request access differ storag node schedul onto time slot thu everi time slot n request schedul retriev block differ storag node first cycl conflictfre schedul follow cycl conflict therefor discuss schedul problem show first time cycl long access pattern video stream chang model extend schedul interact oper fast forward rewind access pattern interact oper irregular set schedul algorithm design retain access order storag node now defin conflictfre schedul follow minyou wu wei shu definit conflictfre schedul conflictfre schedul schedul time slot two video stream request block storag node conflictfre schedul impli two constraint first one impos disk retriev bandwidth storag node measur total number request retriev block storag node j time cycl t one request access storag node time slot request access storag node time cycl second one limit io bandwidth deliveri node within time slot deliveri node cannot handl one stream differ storag node total number request handl deliveri node bound m request may access arbitrari storag node necessarili distinct two constraint summar follow lemma lemma necessari condit conflictfre schedul time cycl now question whether necessari condit also suffici condit word given set request satisfi necessari condit exist conflictfre schedul next section prove lemma also suffici condit conflictfre schedul give algorithm find conflictfre schedul conflictfre schedul video stream go gener conflictfre schedul given set request v greedi algorithm propos schedul request arriv order whenev request arriv next avail slot conflict exist one assign request exampl illustr algorithm exampl assum set request arriv order shown figur a greedi algorithm schedul request shown figur b d request r cannot schedul slot schedul slot r request r r must schedul slot request r abl schedul thu nine request schedul greedi algorithm cannot schedul request even lemma satisfi rearrang alloc exist request request accommod let revisit exampl figur c request r arriv cannot schedul empti slot slot due conflict r howev exchang r r r schedul slot shown figur a r schedul slot shown figur b optim schedul parallel cbr video server node node node node r r r slot node node node r r r r r r r r slot r r r node node node r r r r r r r slot r r r r b a c d r r deliveri node request r storag node j figur exampl greedi schedul algorithm request r arriv cannot schedul slot sinc conflict r tabl rearrang move r slot slot r slot slot schedul slot shown figur c final r schedul slot shown figur d exampl show better schedul achiev rearrang request need systemat approach schedul request without conflict now present optim algorithm conflictfre schedul problem algorithm convert schedul problem match problem bipartit graph then perfect match algorithm appli solv problem algorithm conflictfre schedul construct bipartit graph g bipartit x join j deliveri node handl request retriev block storag node j deliveri node handl request request retriev block storag node j construct graph mregular bipartit graph first time slot whether exist set request access differ storag node differ deliveri node equival find perfect match g accord marriag theorem g kregular bipartit graph k g perfect match determin perfect match time slot elimin match edg origin problem schedul nm request time slot reduc problem schedul n m gamma request m gamma slot thu appli perfect match algorithm time schedul time slot gener perfect match algorithm call hungarian method found give brief descript algorithm start arbitrari match perfect match yet munsatur node u chosen search maugment path origin u construct larger match procedur repeat perfect match found exampl conflictfre algorithm shown figur use set request figur three iter result schedul shown figur d equival figur d algorithm also use situat less nm request exist v request insert algorithm easi see lemma also suffici condit conflictfre schedul algorithm call request arriv conflictfre slot multipl request arriv simultan request schedul empti slot one one conflict occur algorithm call schedul request instead singl request optim schedul parallel cbr video server node node node r r r r r r r slot r r r node node node r r r r r r r r node node node r r r r r r r r r r node node node r r r r r r r r r rr b d a slot r r c slot figur improv exampl node node node r r r r r r r r r rr slot deliveri node storag node deliveri node storag node deliveri node storag node a slot b slot c slot d optim schedul figur bipartit graph request set exampl optim schedul parallel cbr video server request delay minim consid situat total number request less equal nm w exist j v m case request fulfil storag node j v must delay here node j call peg hand storag node j v m leav space node j call hole peg request fulfil delay hole larg system delay signific problem minim delay peg request problem solv simpl pegandhol algorithm present follow algorithm pegandhol let rj hold kth request node v p m extra request remov request x node p v h found hole node h in algorithm request r repres fsr stand number cycl delay request r initi zero entri twodimens array rj indic kth request storag node j variabl p h indic point peg hole storag node respect basic request cannot fulfil current time cycl delay nearest unpack time slot algorithm guarante minimum delay exampl set request given shown figur a v thu storag node peg storag node hole request r r delay two time cycl request r delay one time cycl given figur b result schedul shown figur c r r r r r r r r r r rr a r r r r r rr r r r r slot start request b r r r r r r r r r r r r r r r r r r r rr r r r node node node node time cycl deliveri node request r storag node j figur exampl request delay optim schedul parallel cbr video server request reloc section consid situat load unbalanc definit load balanc differ tradit definit video stream schedul realtim problem system long everi w m consid balanc load otherwis request need reloc assum total number request less equal nm case total number request nm nm request fulfil mani exist load reloc algorithm appli problem object move request overload node underload node minim cost rip runtim increment parallel schedul algorithm design balanc independ task largescal parallel machin algorithm modifi parallel video server everi node present handl request send excess load nearest underload node figur present modifi algorithm assumpt node arrang linear chain algorithm topolog develop similarli first step obtain accumul number request use scan sum oper node n gamma node node record partial sum second step node calcul accumul quota algorithm seen anoth pegandhol algorithm peg overload node hole underload node respect quota correspond flow also calcul posit flow mean flow node gamma node neg flow mean flow node node gamma third step proxim calcul distanc nearest hole node assum everi hole unlimit capac minim flow f igammai result deliveri everi extra work nearest hole case tie leftnearest hole henc flow across hole node therefor node result minim flow f igammai determin node leftnearest hole rightnearest hole bound indic b l b r is f igammai summat possibl flow lefthand node node b r nearest hole righthand node node b l nearest hole fourth step two flow igammai f igammai avail construct optim flow x igammai close f igammai much possibl overload hole node case flow igammai optim one otherwis auxiliari variabl g use record mani stream adjust initi g maximum number stream allow adjust g becom zero rest optim flow f must accord valu x workload exchang node request number commun step algorithm n step take n step calcul step take n step one calcul p one f step take n step one calcul x one load exchang algorithm minim number commun commun distanc also maxim local minyou wu wei shu algorithm request reloc let w number video stream node i global reduct perform scan sum oper w quota calcul accumul quota correspond flow node comput proxim calcul node i proxim leftrightnearest hole defin p l follow l node i segment leftnearest hole rightnearest hole bound indic b l b r l assum everi hole unlimit capac minim flow f igammai result deliv everi extra work nearest hole case tie leftnearest hole l load exchang receiv x igammai task node gamma receiv jx ii j task node task node gamma task node figur request reloc algorithm chain optim schedul parallel cbr video server exampl tabl figur show exampl loadbalanc algo rithm calcul step step p l calcul compar valu overload node determin intent send extra load valu f exampl node intend send request node f gamma similarli node intend send request node f p l node intend send extra load left step valu x calcul accord valu g sinc valu x must rang y gamma g y final flow could differ valu f exampl node intend send request node accord valu f final send request node otherwis node would overload tabl exampl request reloc igammai l l x igammai figur exampl request reloc complex algorithm list below conflictfre schedul omn log n request delay omn request reloc on admiss control conflictfre schedul algorithm request delay algorithm loadbalanc algorithm readi defin admiss control polici new request new request admit schedul without conflict could schedul time slot immedi upon arriv deliveri node conflictfre time slot avail otherwis new request must delay video stream need reschedul accommod new request admiss reject request request reloc delay conflictfre schedul tnm empti slot new request find figur admiss control algorithm admiss control algorithm shown figur let current total number video stream servic one request arriv condit nm check r number newli arriv request condit hold request admit otherwis r request admit other must reject admit request test whether deliveri node overload so request reloc next step check whether storag node overload so request delay final check whether nonconflict time slot new request not conflictfre schedul algorithm appli rearrang video stream admiss control algorithm deal singl request multipl request separ follow step appli multipl request arriv system simultan ffl deliveri node i w m request reloc algorithm appli ffl storag node j v m request delay algorithm appli optim schedul parallel cbr video server ffl request cannot find empti conflictfre slot conflictfre schedul algorithm appli situat singl request arriv system simpl polici appli describ follow ffl assum new request r k arriv w m leftnearest right nearest underload node node search new request transfer nearest underload node m request delay nearest hole ffl conflictfre time slot new request schedul time slot otherwis conflictfre schedul algorithm appli polici schedul multipl request togeth reduc schedul overhead sometim lead better schedul simul perform conduct simul studi variou schedul algorithm includ greedi algorithm conflict free schedul cf cf delay cfsd cf delay reloc cfsdr simul configur five paramet total number storagedeliveri node n number slot per time cycl m load measur l base avail capac averag file size z specifi term number slot requir retriev entir file durat simul term number time cycl follow simul averag file size time slot simul durat cycl arriv rate r calcul follow equat z step probabl exactli r new request given by where ae calcul as r x simul proce step step time cycl follow a step number new request calcul accord probabl ae b new request randomli gener deliveri node start storag node first block file store size file term number slot c admiss control polici appli determin request admit reject admit schedul algorithm use schedul request singl new request gener step algorithm singl request employ one new request gener algorithm multipl request employ end simul statist obtain includ total number request gener number reject request number delay request number reloc request etc differ version cf algorithm first studi test differ arriv rate tabl show perform algorithm cf cfsd cfsdr differ load instanc list tabl are percentag delay request averag delay per delay request term time cycl percentag reloc request averag distanc per reloc request term hop reject rate ratio number reject request total number request here item give detail inform delay request reloc request respect shown system lightli load delay around one time cycl load increas averag delay may increas time cycl number delay request averag delay cfsdr algorithm substanti larger cfsd algorithm cfsdr admit much request reject cfsd request must reloc delay also number reloc request averag distanc cfsdr algorithm increas load heavilyload system more cf cfsd exhibit high reject rate wherea cfsdr reduc reject rate significantli penalti paid low reject rate larg number reloc delay enforc incom request due highli satur system next compar perform greedi algorithm differ version cf algorithm figur show perform differ valu m number time slot time cycl increas reject rate four algorithm decreas partial reason phenomenon deliveri node handl request differ number request arriv becom smaller figur show perform differ number node n substanti chang reject rate n vari greedi cf cfsd algorithm cfsdr reject rate decreas n increas sinc could chanc reloc newli arriv request final figur show perform differ load obvious reject rate four algorithm becom high load increas cfsdr reject rate remain around load becom load reject rate gener reject rate less consid accept optim schedul parallel cbr video server tabl perform varianc differ load m n load algorithm delay avg delay reloc avg distanc reject request per delay request per reloc rate request request cfsd cfsdr cfsd cfsdr cfsd cfsdr cfsdr cfsd cfsdr cfsd cfsdr cfsd cfsdr cfsd cfsdr reject rate greedi cf cfsd cfsdr figur reject rate number time slot vari reject rate greedi cf cfsd cfsdr figur reject rate number storag node vari optim schedul parallel cbr video server load reject rate greedi cf cfsd cfsdr figur reject rate load increas minyou wu wei shu relat work past year sever research project investig techniqu design video server relat issu includ disk layout schedul strategi admiss control strategi realtim support etc research work assum singl disk storag system sever research project investig design techniqu parallel video server video data strip scheme studi howev video stream schedul problem formal address mani system reli statist multiplex cannot truli guarante qualiti servic system resourc cannot fulli util without sophist schedul strategi arrang video stream properli larg buffer space requir particular prefetch techniqu request huge memori space greedi schedul cluster architectur propos reddi approach aim precis schedul video stream maxim system throughput minim usag buffer mitra scalabl media server cluster multidisk workstat connect use atm switch data partit mani block distribut across disk piec block term fragment time period fix media type time period schedul issu read request block disk disk transfer fragment client schedul appli transfer fragment tiger directaccess architectur use wide stripe strategi balanc load similar delay strategi describ paper assum file bit rate howev tiger conflictfre schedul algorithm avoid unnecessari delay instead schedul current time slot newli arriv request delay next avail slot larg system delay signific system load reach delay increas drastic algorithm appli directaccess architectur equal well use conflictfre schedul algorithm request exceed disk capac delay experiment result show request delay averag delay less three time cycl reject rate less system load conclus futur work paper address schedul problem parallel cbr video server number algorithm includ conflictfre schedul request delay minimiza tion request reloc admiss control present combin algorithm abl achiev optim schedul distribut memori cluster architectur current schedul techniqu base statist multiplex guarante time video signal deliveri system abl reach maximum capac statist multiplex method precis schedul video stream qualiti servic requir method maxim video server capac optim schedul parallel cbr video server minim delay time minim buffer size requir reduc effect unpredict network delay scheme describ paper extend support interact oper fast forward rewind discuss network conflict problem paper network traffic schedul import issu address topolog omega network hypercub network set request schedul without conflict time cycl conflict cycl howev network topolog might necessari schedul individu time cycl paper address schedul problem cbr video appli cation client may request retriev variabl bit rate encod media stream schedul type request much difficult address futur work acknowledg author would like thank xin help discuss karthikeyan samuthiram simul work research partial support nsf grant ccr ccr r stagger stripe multimedia inform system graph theori applic hierarch storag manag distribut vod system scalabl video data placement parallel disk array storag subsystem larg multimedia server highspe network environ tiger video fileserv spiffi scalabl videoondemand server multimedia storag server tutori continu retriev multimedia data use paral lelism scalabl continu media server repres subset perform mass storag system videoondemand techniqu schedul io high perform multimediaondemand server schedul data distribut multiprocessor video server runtim increment parallel schedul rip distribut memori comput design perform tradeoff cluster multimedia server admiss control algorithm multimedia ondemand server schedul interact oper parallel video server tr ctr minyou wu sujun wei shu schedul video deliveri scalabl ondemand servic proceed th intern workshop network oper system support digit audio video may miami florida usa harald kosch ahm mostefaoui lszl bszrmnyi lionel bruni heurist optim multiclip queri video databas multimedia tool applic v n p march chows lin yichi cheng pmcmd scalabl approach vod servic peertop network journal parallel distribut comput v n p august minyou wu wei shu chows lin odyssey highperform cluster video server softwarepractic experi v n p june