t strength two data encrypt standard implement time attack a studi vulner two implement data encrypt standard de cryptosystem time attack time attack method recent propos paul kocher design break cryptograph system exploit engin aspect involv implement cryptosystem might succeed even cryptosystem remain impervi sophist cryptanalyt techniqu time attack is essenti way obtain user privat inform care measur time take user carri cryptograph oper work analyz two implement de show time attack yield ham weight key use de implement moreov attack comput inexpens also show design characterist target system necessari carri time attack infer time measur b introduct ingeni new type cryptanalyt attack introduc kocher kocher new attack call time attack exploit fact cryptosystem often take slightli differ amount time differ input kocher gave sever possibl explan behavior among these branch condit statement ram cach hit processor instruct run nonfix time etc kocher signific contribut show run time differenti exploit order find target system privat infor mation inde kocher shown cryptanalyz simpl modular exponenti modular exponenti key oper diffiehellman key exchang protocol diffi hellman rsa cryptosystem rivest et al modular exponenti procedur input k n n n cryptograph protocol mention n public k privat kocher report passiv eavesdropp measur time take target system comput y k mod n sever input y recov secret expon k moreov overal comput effort involv attack proport amount work done vic tim concret sake clariti exposit describ essenc kocher method recov secret expon fixedexpon modular exponenti shown fig code k binari l output z fig modular exponenti attack allow someon know k l delta recov k tgamma to obtain entir expon attack start repeat attack attack first comput l iter loop next iter requir first unknown bit k tgamma bit set oper n perform otherwis skip assum time observ correspond observ random variabl time requir multipl squar step correspond bit k lgammai e random variabl repres measur error loop overhead etc attack correctli guess k tgamma may factor effect obtain adjust random variabl known varianc provid time need perform modular multipl independ measur error incorrect guess produc adjust random variabl higher varianc one expect comput varianc easi provid attack collect enough time measur correct guess identifi success adjust valu smaller varianc strength two data encrypt standard implement time attack delta theori time attack yield target system privat inform practic order success mount time attack remot cryptosystem prohibit larg number time measur may requir order compens increas uncertainti caus random network delay nev ertheless situat feel realist mount time attack describ one them challengerespons protocol use establish whether two entiti involv commun inde genuin entiti thu allow continu commun other protocol one entiti challeng random number predetermin calcul must perform often includ secret key order gener correct result comput devic must poss correct secret key therefor assum authent mani smart card particular dynam password gener token electron wallet card implement challengerespons protocol eg messag authent code gener accord ansi x menez et al page standard expect extens use made smart card base gener purpos programm integr circuit chip thu specif function smart card achiev program secur smart card provid use tamperproof technolog cryptograph techniqu describ scenario ideal set carri time attack widespread avail particular type card make easi inexpens determin time characterist system mount attack later obtain precis time measur eg monitor alter card reader gain possess card could use retriev secret inform store card mean time attack thu card implement challengerespons protocol master key involv could give rise secur problem see dhem et al discuss practic implement time attack earlier version cascad smart card new unanticip strain time attack might aris henc time attack given seriou consider work contribut ultim further understand strength new cryptanalyt techniqu weak exploit way elimin possibl becom practic kocher implement attack diffiehellman key exchang proto col also observ time attack could potenti use cryptosystem particular data encrypt standard de claim motiv work result organ studi vulner one wide use cryptosystem world de time attack start point work observ kocher kocher dess key schedul gener process move nonzero bit c valu use condit statement test whether onebit must wrap around could sourc nonconst encrypt run time henc conjectur time attack de alejandro hevia marco kiwi could reveal ham weight key show although kocher observ incorrect for de implement analyz conjectur true but more sect give brief descript de sect describ time attack de assum attack know target system design characterist first discuss experiment result show comput inexpens time attack two implement de could yield enough inform recov ham weight de key use henc assum de key randomli chosen attack recov approxim bit key inform best knowledg first implement time attack symmetr cryptosystem sinc preliminari version work appear two time attack rc report handschuh hey sect describ comput experi measur threat impli actual implement time attack de recov bit de key modest improv brute forc search but recov ham weight key is potenti threaten particular adversari restrict attent key determin either significantli low high ham weight although key may rare adversari determin one key use ensu search may significantli sped up thu adversari balanc time find rare key time need key recoveri system even recoveri singl although rare key may seriou concern sect identifi sourc depend encrypt time key ham weight implement de studi relev condit statement de implement analyz encrypt time roughli equal linear function key ham weight x plu normal distribut nois e sinc de key bit long string key chosen uniformli random key space x binom thu ff fi oe sect show necessari order perform time attack de assum design characterist target system known inde propos two statist method wherebi passiv eavesdropp infer time measur target system design inform requir success mount time attack de best knowledg first proof possibl infer target system design characterist time measur would like stress time attack describ work requir precis measur encrypt time knowledg encrypt plaintext produc ciphertext recal ham weight bitstr equal number bit nonzero recal distribut binom np correspond distribut sum n independ ident distribut f grandom variabl expect p strength two data encrypt standard implement time attack delta sect propos blind techniqu use elimin almost execut time differenti analyz de implement blind techniqu make de implement studi impervi sort time attack describ work final discuss condit all ham weight of de key might recov time attack relat work modern cryptographi advoc design cryptosystem base sound mathemat principl thu mani cryptosystem design last two decad prove resist mani sophist mathemat base cryptanalyt techniqu provid one will accept reason assumpt tradit techniqu use attack cryptosystem exploit algorithm design weak cryptosystem hand time attack take advantag decis made implement cryptosystem special produc nonfix run time but time attack type attack exploit engin aspect involv implement cryptosystem inde recent boneh lipton demillo boneh et al introduc concept fault toler attack attack take advantag possibl induc hardwar fault boneh et al point attack show danger hardwar fault pose variou cryptograph protocol conclud even sophist cryptograph scheme seal insid tamperresist devic might leak secret inform new strain fault toler attack differenti fault analysi dfa propos biham shamir biham shamir attack applic almost secret key cryptosystem propos far open literatur dfa work variou fault model use cryptanalyt techniqu recov secret inform store tamperresist devic particular biham shamir show hardwar fault model consid boneh et al full de key extract seal tamperresist de encryptor analyz ciphertext gener unknown relat plaintext furthermor biham shamir techniqu develop identifi key complet unknown cipher seal tamperresist devic new type attack describ receiv widespread attent see exampl english hamilton markoff de wide use cryptosystem world special among financi institut develop ibm adopt standard nb review everi five year sinc adopt de held remark well year cryptanalysi but faster cheaper processor allow use current technolog build reason price special purpos machin recov de key within hour stinson pp concret sake provid brief descript de detail descript see nb easili access descript de found schneier stinson de symmetr privatekey cryptosystem ie cryptosystem delta alejandro hevia marco kiwi key schedul encrypt plaintext perm perm key fig de encrypt process parti wish use must agre advanc common secret key must kept privat de encrypt messag plaintext bitstr length use bitstr key length obtain ciphertext bitstr length three main stage first stage bit plaintext permut accord fix initi permut second stage iter certain function success appli bitstr result first stage final stage invers initi permut appli bitstr obtain second stage strength de resid function iter encrypt process give brief descript iter process input iter output bitstr iter long string k actual k permut select bit de key string call key schedul iter bit long output string comput appli fix rule two input string encrypt process depict fig decrypt done encrypt algorithm use key schedul revers order k best tradit cryptanalyt attack known de due biham shamir biham shamir biham shamir matsui matsui a matsui b howev consid threat de practic environ see menez et al pp time attack de consid problem recov ham weight de key target system mean time attack first address problem sect assum attack know design target system show sect assumpt remov time characterist two implement de studi time characterist two implement de first one obtain rsaeuro cryptograph toolkit kapp henceforth refer rsade implement de look one due louko louko henceforth refer lde studi implement mhz pentium tm comput run msdo tm advantag work msdo tm environ singl process oper system facilit carri time measur sinc strength two data encrypt standard implement time attack delta ham weight key time encrypt key schedul fig rsade ham weight key time key schedul encrypt fig lde interf process run less oper system mainten task perform measur time microsecond s first experi fix input messag bitstr length whose bit set randomli chose key ham weight i select key encrypt messag total time encrypt measur time took gener schedul total time took encrypt messag plot implement look at averag for key encrypt key schedul gener time shown fig fig obviou outlier elimin fact outlier notic appear fix interv clock tick outlier caus system mainten task alejandro hevia marco kiwi randomli chosen de key ham weight probabl approxim thu relev data point shown fig fig close middl plot variou key chosen random perform for key encrypt key schedul gener time discard obviou outlier graph empir frequenc distribut collect data empir distribut observ roughli symmetr concentr contigu valu usual three four concentr valu due fact abl perform time measur accuraci s time differenti among encrypt perform rare larger s for explan measur time precis msdo tm environ see appendix a suggest one would expect variat run time observ process execut mani time input due effect normal distribut random nois differ valu randomli chose key ham weight i throw away outlier graph empir frequenc distribut collect data empir frequenc observ look like normal distribut small deviat typic s lde s rsade conclud variat encrypt key schedul gener time observ among key ham weight mostli due total number bit key set posit set bit occur thu effect bit set among key ham weight neglig repeat experi describ far instead leav input messag fix chose new randomli select messag start encrypt process result report remain essenti unchang neglig increas measur deviat assum attack know design target system build tabl averag encrypt time versu ham weight key clear monoton increas relat encrypt time ham weight key elicit experi signific implement flaw allow attack determin ham weight de key inde attack obtain encrypt time measur look tabl built determin key ham weight time measur could come thu attack recov bit key inform h denot binari entropi function remark precis estim ham weight de key achiev mean time attack two situat hold first accur time measur obtain second variat encrypt keyschedul gener time produc differ key ident ham weight small compar time variat produc key one one less set bit notic latter situat approxim hold exact estim ham weight de key achiev attack accur perform time measur sever encrypt plaintext but requir power attack one capabl fix strength two data encrypt standard implement time attack delta time take de gener ciphertext c messag code let l g randomli choos g let k m lexicograph first elem k l de encrypt key k yield c returnk fig key recoveri procedur base time attack reveal ham weight key input messag fed encrypt process remark establish monoton increas relat encrypt time ham weight key linear depend exist two measur quantiti correl factor data shown fig fig respect sharp linear depend encrypt time ham weight allow attack infer target system inform requir carri attack describ abov topic discuss next section experiment result section describ comput experi show expect reduct size key space search would achiev implement time attack describ previou section assum everi r correspond expect time take target de implement encrypt messag key ham weight i furthermor assum support experiment observ consid procedur fig recov de encrypt key time attack exploit fact report sect note possibl experiment determin expect number key procedur would tri without actual execut it inde de encrypt plaintext key k gener ciphertext c s expect size key space search given procedur is de implement studi randomli chose de messagekey pair measur encrypt time comput expect number key procedur fig would tri find correct encrypt key discuss sect follow best one hope tri half key whose ham weight equal correct encrypt key correspond percent key space sinc k pk log pk found rsade unlik event l uniqu defin perturb valu uniformli chosen interv gammao oe oe tini compar precis time measur alejandro hevia marco kiwi tabl result comput experi percent key space would search averag find correct encrypt key lde percentag goe percent tabl show detail data collect experi column label accord weight de key denot weight key k second row repres percentag total key space correspond de key ham weight k with precis denot valu p k de key weight k estim time expect percentag key space would search find encrypt key these estim base delta p k measur order insur least measur consid everi estim associ nonzero p k s last two row tabl show de implement key weight averag valu obtain recov bit de key give modest improv time need recov key but tabl impli time attack reveal ham weight key potenti threaten particular adversari restrict attent key determin either significantli low high ham weight adversari perform time measur one found either significantli low high adversari detect rare key subsequ key search much less usual amount thu adversari balanc time find rare key time need key recoveri system recoveri even singl may caus total disrupt andor forward vulner sourc depend de encrypt time key ham weight key schedul gener lde carri procedur call de set key procedur comput result key schedul bitstr perform bitwis precomput constant bit key bitwis or comput key bit set purpos use piec code follow form condit els instr number time condit true turn exactli ham weight de key main sourc run time differenti lde rsadess key schedul gener code also procedur contain two condit statement condit statement use comput subkey precis implement fix permut strength two data encrypt standard implement time attack delta pc bit key code follow form condit instr total number time condit true equal sum ham weight subkey thu number time instr execut directli proport ham weight de key mention sect kocher kocher conjectur dess key schedul rotat nonzero bit use condit statement could give rise run time differenti implement de analyz found evid support conjectur final note clear fig lde sourc nonfix run time depend key schedul gener process evidenc nonconst distanc two curv shown fig sourc time differenti due condit statement abl identifi caus depend abl exploit order recov de key deriv time characterist target system discuss sect de implement studi encrypt time roughli equal linear function key ham weight plu normal distribut random nois section exploit fact order deriv necessari inform need perform time attack reveal ham weight target system de key first need introduc notat assum measur time take target system perform de encrypt time measur might correspond encrypt perform differ de key g denot k ith key use target system period time measur perform make realist assumpt k chosen random f g independ other let x i denot ham weight key k thu distribut x i binom sinc assum k s chosen independ x independ random variabl note success time measur correspond encrypt messag key index last measur correspond encrypt perform key k con venienc sake let m denot set indic correspond time measur key k ie g let i j random variabl repres time take target system perform jth encrypt messag key k final random variabl repres effect random nois jth encrypt key k thu e i inaccuraci target system run time fluctuat notat necessari formal state problem want address inde linear depend encrypt time ham weight key de implement studi impli alejandro hevia marco kiwi exist ff fi oe problem infer time measur paramet ff fi oe hold address two variat problem sect show deal case s known sect show handl case s unknown former case realist one inde standard cryptanalyt assumpt attack know manag procedur target system known propos two altern statist method deduc paramet ff fi oe hold one method base maximum likelihood estim one asymptot unbias estim sinc follow discuss heavili reli standard concept result probabl statist refer reader unfamiliar subject feller ross zack background materi terminolog maximum likelihood estim let thu xt more let actual valu taken x i respect oe margin distribut given ff fi oe fix collect time measur valu ff fi oe maxim maximum likelihood estim look for maximum likelihood estim valu like produc observ time measur also regard valu minim loss explain maximum likelihood estim thought good predictor thu order determin good estim ff fi oe first comput f t ff fi oe proposit margin distribut given ff fi oe proof let f xt delta ff fi oe f txx delta ff fi oe f x delta ff fi oe denot joint densiti function x densiti function given probabl distribut x respect conveni sake henceforth omit ff fi oe express f xt f txx f x observ independ x i s e i s impli i s independ thu joint densiti function x given ff fi oe last equal follow sinc x i s independ i s independ strength two data encrypt standard implement time attack delta get i like norm moreov fix i i j s independ random variabl henc know f x i thu margin distribut given ff fi oe equal sum valu taken x f xt x t henc conclus follow directli previou equal fact x i binom given valu ff fi oe maxim right hand side express proposit maximum likelihood estim sought often case deal maximum likelihood estim difficult solv explicitli them see zack ch x discuss comput routin use calcul maximum likelihood estim advantag describ approach determin paramet relev carri time attack use avail time measur but allow us determin mani measur suffici order obtain accur estim paramet sought altern approach describ solv problem asymptot estim goal find good estim b ff b fi b oe ff fi oe moreov interest determin asymptot on number time measur behavior estim particular asymptot distribut limit valu rate converg deriv good predictor ff fi oe start key observa tion sinc expect varianc binom respec tive take expect varianc yield henc knew oe oe could solv ff fi suggest find good estim oe oe deriv good estim ff fi provid candid c c oe estim oe respect but first need introduc addit delta alejandro hevia marco kiwi notat let e i c solv ff fi yield two natur candid b ff b fi estim ff fi prove b ff well defin proposit c proof note c henceforth denot chisquar distribut l degre freedom l proposit ji distribut c proof sinc i j i sinc e i averag n independ norm delta addit de moivrelaplac theorem hazewinkel pp state binom m p distribut express term standard normal distribut moreov express exact mp gamma p express provid good approxim binomi distribut ross pp thu sinc x i binom distribut x i well approxim norm henc sinc x i independ e i sum independ normal distribut normal distribut follow i approxim distribut norm desir conclus follow classic statist result hogg tani theorem proposit proposit ji neglig converg in distribut norm small constant error term k recal x random variabl probabl strength two data encrypt standard implement time attack delta proof first note neglect oe n proposit definit b ff impli distribut b second recal sum squar l independ ident distribut normal random variabl zero mean varianc equal distribut accord l equival sum l independ distribut variabl distribut accord l henc sinc expect varianc random variabl respect central limit theorem impli in distribut norm put two observ togeth show distribut norm small constant term k state result follow immedi theorem ji neglig k suffici larg distribut b ff approxim norm proof law larg number impli c c almost sure oe oe respect henc continu b converg almost sure fact proposit yield k ffff converg in di tribut norm small error term desir conclus immedi remark theorem provid approxim distribut b ff approxim error aris three sourc first one use de moivrelaplac theorem express binom term norm second one due use central limit theorem approxim distribut estim limit distribut final sourc error due use law larg number approxim estim asymptot valu three sourc approxim error bound de moivrelaplac theorem berryessen inequalityhazewinkel pp chebyshev inequalityross pp respect bound accumul approxim error show theorem fairli accur corollari ji neglig k suffici larg proof bound concern b ff follow theorem chebyshev in equalityross pp order prove bound recal b said xn converg distribut x n p point x fx recal x random variabl probabl said converg almost sure x event whose probabl alejandro hevia marco kiwi c ff last inequ consequ appli chebyshev inequ twice note theorem v b n result follow corollari tell us probabl least suffic take n time measur differ key approxim ff fi within multipl factor sigma ffl unknown s assumpt s known made previou section strictli necessari sinc attack may altern perform sever time measur short period time rest appropri long period time henc problem deduc target system design characterist reduc case s known provid key chang often attack rest period longer key lifetim chang key often creat key manag problem cryptosystem user thu reason assum key lifetim excess short discuss anoth approach handl case unknown s assumpt attack access sever ident copi target system eg sever copi smart card support de base challengerespons protocol let make reason assumpt target system independ gener case attack may perform short period time sever time measur copi target system key chang often attack deduc target system relev time characterist sect inde attack assum time measur aris copi system come encrypt perform key sinc key correspond differ copi target system independ gener copi system ident problem deduc target system design characterist reduc case s known test statist hypothesi give rise anoth altern handl case unknown s inde consid situat attack determin time measur aris random variabl satisfi assum key chang often ie least n time measur come encrypt perform key thu j attack perform test equal two normal distri butionshogg tani pp sampl j signific level test allow attack determin measur around chang key occur discard measur around attack suspect chang key occur yield sequenc strength two data encrypt standard implement time attack delta time measur target system design characterist deduc case known s final comment kocher blind techniqu similar use blind signatur chaum propos order prevent time attack modular exponenti implement de studi blind techniqu adapt produc almost fix run time key schedul gener process inde let k de key ham weight wtk whose key schedul want gener let k bitstr length gener fol low randomli choos b wtkc respect gammawtk bit k set respect set correspond bit k respect denot bitwis xor k k k phik note wtk ham weight k even wtk wtk phik ham weight k odd modifi key schedul gener process schedul key k k phi k gener note work requir independ ham weight k henc sourc nonfix run time introduc step let k key schedul obtain recal k respect k permut select bit key k phi k respect k thu key schedul k figur plot encrypt time rsade previous explain note clear reduct time differenti reduct achiev expens increas encrypt time factor approxim unfortun blind techniqu still leak pariti weight origin de key ie bit inform care look fig confirm fact fact fix use idea develop abov inde given de key k one gener three de two ham weight one ham weight three key one spuriou mean key schedul gener result discard xor key schedul gener two non spuriou key give rise key schedul sought ham weight origin de key even respect odd spuriou key one ham weight respect one key ham weight seen main sourc nonfix run time caus key schedul gener procedur mani fast softwar implement key setup oper separ encrypt would thwart time attack encrypt time constant but sever system impract precomput key schedul exampl smart card precomput undesir due memori constraint de implement studi fairli resist time attack lead us question whether time attack find de key ham weight although succeed tune time attack techniqu order recov bit de key identifi lde sourc nonfix run time due key gener process inde differ slope curv plot fig show encrypt time count key gener process depend use fact weak could potenti exploit order alejandro hevia marco kiwi ham weight key time blind rsade rsade fig rsade modifi rsade encrypt time recov de key open possibl time take encrypt messag key k nonlinear function k eg monoton increas function ham weight phi k would allow time attack recov de key care choos messag encrypt abl identifi clear sourc nonlinear depend time differenti input de encrypt process either de implement studi nevertheless feel partial inform leak implement de analyz suggest care must taken implement de otherwis key could compromis time attack acknowledg grate shanghua teng call attent work kocher thank raul gouet lui mateu alejandro murua jaim san martin help discuss also thank paul kocher advis measur run time accur msdo tm environ final thank anonym refere point blind techniqu sect leak inform pariti ham weight key a standard c routin allow measur time event msdo tm environ accuraci s heidenstrom order measur time precis s pentium tm comput run msdo tm follow kocher advic kocher suggest read valu highprecis timer access port whenev timer overflow gener one interrupt interrupt occur everi s henc one measur time interv precis s s also good idea run ram disk inform perform accur time strength two data encrypt standard implement time attack delta measur pc famili do reader refer heidenstrom perform time measur window unix environ clearli bad idea sinc multiprocess oper system r differenti cryptanalysi deslik cryptosystem journal cryptolog differenti cryptanalysi full round de import check cryptographicprotocol fault blind signatur untrac payment practic implement time attack new direct cryptographi network secur sieg introduct probabl theori applic time attack rc encyclopaedia mathemat faqappl note time pc famili do probabl statist infer fifth rsaeuro cryptograph toolkit time attack implement diffiehellman privat commun de packag potenti flaw seen cash card secur first experiment cryptanalysi data encrypt standard linear cryptanalysi method de cipher method obtain digit signatur publickey cryptosystem first cours probabl third appli cryptographi protocol theori statist infer tr linear cryptanalysi method de cipher appli cryptographi nd ed network secur sieg method obtain digit signatur publickey cryptosystem cryptographi time attack rc practic implement time attack differenti cryptanalysi full round de first experiment cryptanalysi data encrypt standard time attack implement diffiehellman rsa dss system ctr ruggero lanott andrea maggioloschettini simon tini inform flow hybrid system acm transact embed comput system tec v n p novemb