t symplect balanc hamiltonian matric a discuss balanc hamiltonian matric structur preserv similar transform method close relat balanc nonsymmetr matric eigenvalu comput propos osborn j acm pp and parlett reinsch numer math pp implement linear algebra softwar packag shown isol eigenvalu deflat use similar transform symplect permut matric balanc base equilibr row column norm hamiltonian matrix use symplect scale matric due given structur suffici deal lead half row column matrix numer exampl show method improv eigenvalu calcul hamiltonian matric well numer method solv continuoustim algebra riccati equat b introduct eigenvalu problem hamiltonian matric g a g q r nthetan g q symmetr play fundament role mani algorithm control theori area appli mathemat well comput physic chemistri comput eigenvalu hamiltonian matric requir eg comput h norm transfer matric see eg calcul stabil radiu matrix comput respons function mani more hamiltonian matric also close relat continuoustim algebra riccati equat care form a g q x r nthetan symmetr solut matrix mani numer method solv base comput certain invari subspac relat hamiltonian matric see eg detail discuss relat hamiltonian matric continuoustim algebra riccati equat refer eigenvalu comput matric matrix pencil often preprocess use balanc procedur describ gener matrix r nthetan first permut via similar transform order isol eigenvalu ie permut matrix p r nthetan comput upper triangular matric then diagon matrix universitat bremen fachbereich mathematik und informatik zentrum fur technomath matik bremen germani email bennermathunibremend comput row column gamma z zdz close norm possibl is balanc consist permut step scale step scale step row column matrix scale usual lead decreas matrix norm preprocess step often improv accuraci comput eigenvalu significantli isol eigenvalu ie contain even comput without roundoff error unfortun appli balanc strategi hamiltonian matrix h given gener destroy hamiltonian structur problem subsequ eigenvalu algorithm preserv use hamiltonian struc ture past fifteen year sever structur preserv method hamiltonian eigenproblem suggest particular squarereduc method hamiltonian qr algorithm if rank recent propos algorithm base symplect urvlik decomposit implicitli restart symplect lanczo method larg spars hamiltonian eigenproblem appropri choic develop subroutin librari usag rais need symplect balanc routin similar transform symplect matric preserv hamiltonian structur thu order balanc hamiltonian matrix preserv structur requir permut matrix diagon scale matrix symplect section give necessari background isol eigenvalu hamiltonian matric without destroy structur achiev use symplect permut matric topic section equilibr row norm hamiltonian matric similar way propos use symplect diagon scale matric present section invari subspac eigenvector solut algebra riccati equat target comput postprocess step requir applic propos symplect balanc method discuss section numer exampl use propos balanc strategi eigenvalu comput numer solut algebra riccati equat given section preliminari follow class matric employ sequel definit let n n theta n ident matrix a matrix h r nthetan hamiltonian hj lie algebra hamiltonian matric r nthetan denot h n b matrix h r nthetan skewhamiltonian hj jordan algebra skewhamiltonian matric r nthetan denot sh n c matrix r nthetan symplect sj lie group symplect matric r nthetan denot n d matrix u r nthetan unitari symplect u n uu compact lie group unitari symplect matric r nthetan denot us n observ everi h h n must block represent given import relat symplect hamiltonian matric prove proposit let r nthetan nonsingular gamma hs hamiltonian h h n result show gener similar transform preserv hamiltonian structur symplect scale real scalar follow proposit show structur n theta n orthogon symplect matric permit repres pair n theta n matric henc arithmet cost storag accumul orthogon symplect matric halv proposit orthogon matrix u r nthetan symplect take form follow wellknown properti spectra hamiltonian matric see eg refer given therein proposit spectrum real hamiltonian matrix denot oe h symmetr respect imaginari axi ie oe h gamma oe h spectrum hamiltonian matric therefor partit oe solv hamiltonian eigenproblem one would like comput schur form hamiltonian matric analog real schur form nonsymmetr matric done structurepreserv way definit a let h form g r nthetan real schur form quasiupp triangular real hamiltonian quasitriangular b h h n exist u us n real hamiltonian quasitriangular h real hamiltonian schur form u hu call hamiltonian schur decomposit hamiltonian schur decomposit exist h u chosen oe structurepreserv method hamiltonian eigenproblem ie use symplect similar transform reli follow result hamiltonian matric pure imaginari eigenvalu result first state full gener given prove theorem let h h n let iff pairwis distinct nonzero pure imaginari eigenvalu furthermor let associ hinvari subspac span column u k follow equival exist n gamma hs real hamiltonian quasitriangular ii exist u us n u hu real hamiltonian schur form congruent j alway appropri dimens note theorem follow pure imaginari eigenvalu h must even algebra multipl order hamiltonian schur form h exist isol eigenvalu symplect permut let p denot n theta n permut matrix easi see symplect permut matric form matric type possibl transform hamiltonian matrix z z z z z z upper triangular either q exist p prove construct way later algorithm transform hamiltonian matrix form given hamiltonian matrix form total p h read directli seen follow result lemma let h h n form either g exist permut matrix nthetan upper triangular g r theta r hamiltonian submatrix h proof let h g g gammaa diag pi q r r q thu desir form eigenvalu relat follow gammai q gammai q lemma mere theoret interest demonstr order solv hamiltonian eigenvalu problem proceed work h transform use proof gener nonsymplect want comput invari subspac eigenvector andor hamiltonian schur form given theorem transform hamiltonian matrix hamiltonian schur form row column accomplish use symplect permut matric form therefor need anoth class transform matric definit matrix p j r nthetan call jpermut matrix a symplect ie p c row column exactli one nonzero entri p j us n clear similar transform jpermut matrix preserv hamiltonian structur analog standard permut similar transform p j perform without float point opera tion moreov repres sign integ vector ip length n row column k j interchang sign indic correspond entri p j gamma entri p j row n deduc ip proposit furthermor symplect permut matric given jpermut matric lemma h h n form exist jpermut matrix p j g g t g upper triangular notat proof let hamiltonian matrix h given need jpermut matrix first step let obvious p jpermut matrix gammag g g assum g q then g g thu obtain form anoth similar transform pi q defin case ie q case jpermut matrix p hamiltonian matrix desir form order isol eigenvalu suffici restrict symplect permut comput form possibl still isol eigenvalu h appli procedur use isol eigenvalu h h transform h form process repeat isol eigenvalu found accumul permut symplect permut matrix p form result similar transform gp gp here jj t upper triangular either hamiltonian submatrix tt g tt isol eigenvalu defin p partit h first step proof lemma perform obtain form blockstructur upper left lower right diagon block complic still possibl bring upper triangular form use repeatedli sequenc permut use proof lemma show p q eigenvalu hamiltonian matrix read directli h permut similar z further h tt eigenvalu requir continu work h tt also eigenvector andor invari subspac requir similar transform use solv reducedord eigenproblem h tt appli whole matrix h case h transform form given partit h perform first step proof lemma jpermut matrix p subsequ step achiev upper triangular form first p q row column perform first distinguish case q procedur transform hamiltonian matrix h form given follow algorithm note given algorithm t algorithm input matric a g q r nthetan defin hamiltonian output symplect permut matrix p matric a g q defin hamiltonian matrix form end end end end end end execut outer whileloop first search row isol eigenvalu row found look column isol eigenvalu fashion guarante end isol eigenvalu although alway touch first n row column hamiltonian matrix actual implement one would cours never form permut matric explicitli store relev inform integ vector multipl permut matric realiz swap data contain row column permut detail see eg rather difficult give complet account cost algorithm isol eigenvalu algorithm requir n float point addit n comparison oppos n addit n comparison unstructur permut procedur implement lapack subroutin xgebal appli h r nthetan worst case algorithm would execut outer whileloop isol eigenvalu found last execut second inner whileloop case cost consist n float point addit move float point number worstcas analysi eigenvalu isol permut noth left do hamiltonian matrix hamiltonian schur form worstcas studi xgebal show permut part requir n move float point number therefor conclud algorithm half expens procedur propos appli hamiltonian matrix symplect scale suppos transform hamiltonian matrix form sinc subsequ transform determin h tt scale paramet balanc h tt chosen row column h tt instead close norm possibl order simplifi notat sequel call hamiltonian matrix h let h offdiagon part h ie may without loss gener assum none row column h vanish ident otherwis could isol anoth pair eigenvalu want scale h norm row column close norm note befor employ techniqu parlett reinsch destroy hamiltonian structur diagon scale thu perform use symplect diagon matrix matrix must form r nthetan nonsingular diagon matrix let us first note obviou result hamiltonian matric sequel use colon notat see eg h k hj indic kth column jth row respect matrix h lemma let h r nthetan hamiltonian matrix p ie pnorm ith column equal norm n ith row norm ith row equal norm n proof result obviou note kxk x r n observ structur hamiltonian matric furthermor equat follow analog note conclud suffici equilibr norm first row column n theta n hamiltonian matrix use consequ lemma corollari let h r nthetan hamiltonian matrix p sinc similar transform diagon matrix affect diagon element transform matrix follow suffici consid h employ notat ith column h transpos ith row h sequel conveni use result also hold pnorm comput point view also reason use norm sinc comput involv float point multipl furthermor reduc norm h one norm usual impli also reduct norm equilibr achiev similar way parlettreinsch method fi denot base float point arithmet oe sign integ comput fi oe closest real scalar thu h gener longer hamiltonian unfortun use symplect diagon matrix comput d i obtain thu gener k nevertheless equilibr norm h h achiev requir solv result quartic equat jg ii j remain show equat posit solut theorem let h r nthetan hamiltonian matrix denot offdiagon part h assum none row column h vanish ident exist uniqu real number h proof solut equat nonzero solut k k k recal g ii coeffici polynomi p satisfi sinc one chang sign coeffici polynomi p descart rule sign show one posit zero p exist posit solut uniqu assumpt kh therefor either ii part h either as q ii part h thu know p polynomi degre least posit lead coeffici henc lim t hand use mean valu theorem follow exist posit zero p g ii zero p third order polynomi posit zero mean valu theorem least one posit zero henc equat least one posit real solut regardless valu g ii hand alreadi observ one solut conclud exist uniqu solv equat whenc k h equal follow immedi corollari comput exact valu equilibr ith nith row column would requir solut fourthord equat sinc diagon similar transform chosen set machin number suffici find machin number fi oe closest ffi done similarli comput gener case propos implement fortran subroutin balanc eispack successor xgebal lapack is start quantiti evalu compar k h repeat use achiev follow algorithm algorithm input hamiltonian matrix h h n isol eigenvalu base float point arithmet output diagon matrix n h overwritten gamma row column norm equilibr far possibl r end r end end diag diag diag end one execut outer forloop algorithm consid sweep algorithm termin whole sweep usual row column norm approxim equal sweep afterward iter make limit progress therefor parlett reinsch propos modif which translat problem becom let ffi determin two inner whileloop algorithm comput jg ii j where fl given posit constant comput algorithm otherwis set behavior essenti algorithm in case algorithm increas kh happen slightli smaller one step skip would produc insubstanti reduct kh actual comput similar transform s appli directli block a g q hamiltonian matrix without form hamiltonian matrix itself thu similar transform perform use n gamma multipl standard not structur preserv scale procedur appli h similar transform requir multipl recal algorithm two row column equilibr time one row column treat step inner forloop standard procedur number sweep requir converg similar gener case sinc theori deriv requir assumpt similar transform diagon matric step sweep ith row column equilibr far possibl accomplish algorithm moreov ffi taken exact solut converg sequenc similar transform stationari point prove is solut sweep k lim k ffi k henc limit h balanc hamiltonian matrix note here sweep length n standard balanc algorithm one go rowcolumn pair matrix thu sweep length n thu comput cost scale n theta n hamiltonian matrix algorithm assum k sweep requir n n oppos n n standard scale procedur given assum sweep requir converg gener k k structurepreserv scale strategi half expens standard procedur flop count base assumpt cost determin consid small o compar similar transform remark propos solv matrix balanc problem use convex program approach compar complex approach algorithm suppos algorithm termin k sweep matrix h balanc let ng theta ng eg assum e here theorem state complex comput diagon matrix posit diagon entri row column gamma hy balanc accuraci achiev algorithm ne hmin numer experi assum respect n henc algorithm consid complex on complex clearli superior convex program approach still case k algorithm requir care implement guard over underflow due largesmal ffi here use bound discuss implement lapack subroutin xgebal take account step scale fi sigma rather fi xgebal backtransform order eigenvalu applic far consid problem comput eigenvalu hamiltonian matrix order comput eigenvector invari subspac solut algebra riccati equat transform hamiltonian matrix real schur form consid structurepreserv method goal transform hamiltonian matrix real hamiltonian schur form given theorem a exist assum appli algorithm hamiltonian matrix obtain symplect permut matrix p p hp form given then appli jpermut p j permut hamiltonian matrix row column number hamiltonian schur form ie p form given from lemma know p j exist next appli algorithm hamiltonian submatrix h tt h r obtain diagon matrix diag g t g r pqthetapq upper triangular hamiltonian submatrix h q g isol eigenvalu row column equilibr algorithm assum hamiltonian schur form h exist comput u u v v u us r transform h real hamiltonian schur form set real hamiltonian quasitriangular first n column span lagrangian hinvari subspac applic cstabl hinvari subspac desir let us assum method use transform h hamiltonian schur form choos u first r column u ie column u v span h invari subspac choic guarante isol eigenvalu desir one case reorder hamiltonian schur form order move undesir eigenvalu lower right block h desir one upper left block assum want comput lagrangian hinvari subspac correspond set ae oe h close complex conjug note necessari condit order obtain lagrangian invari subspac use standard reorder algorithm real schur form n theta n unsymmetr matrix given find orthogon matrix u orthogon symplect matrix u diag u u g g t g quasiupp triangular therefor swap eigenvalu gamma note eigenvalu reorder among isol eigenvalu henc real impli upper triangular reorder achiev analog reorder eigenvalu real schur form given follow procedur use standard reorder order swap eigenvalu within requir rotat work exclus row column n n order exchang eigenvalu eigenvalu gamma assum sn gamma n cn given rotat matrix annihil second compon gnn u n symplect given rotat matrix act plane n n n g g t g gnn here bar indic element chang similar transform next step move n upper diagon block use standard order subroutin obtain form given r ngammakthetangammak again relat hold procedur repeat remark hamiltonian matrix form h correspond linear system stabiliz c detect isol eigenvalu given diagon element neg real part otherwis eigenvalu unstabl undetect stabilizeddetect therefor mix block jpermut matrix p j ie algorithm n cstabl hinvari subspac requir reorder necessari remark solv algebra riccati equat use approach base hamiltonian eigenproblem symplect balanc strategi propos often enough minim error caus illscal due effect balanc hamiltonian matrix h g still may kqk ae kgk may caus larg error comput invari subspac therefor anoth symplect scale use similar transform diag ae n ae r appli h order achiev kak kgk kqk far possibl see detail discuss sever heurist strategi achiev thi remark everyth deriv far hamiltonian matric appli way skewhamiltonian matric n sh n h g skewhamiltonian structur preserv symplect similar transform henc isol eigenvalu reorder etc achiev way hamiltonian matric consid transform depend sign matrix block a g q distinct zerononzero isol eigenvalu absolut valu entri equilibr row norm note algorithm even simplifi quit lot real skewhamiltonian matric q comput gener balanc algorithm nonsymmetr matric obtain k eigenvalu skewhamiltonian matric well skewhamiltonian schur form comput numer strong backward stabl way van loan method advis balanc skewhamiltonian matric use propos strategi prior appli algorithm remark consid far real hamiltonian skew hamiltonian matric isol eigenvalu equilibr row column complex skewhamiltonian matric achiev exactli way structurepreserv numer backward stabl and henc numer strong backward stabl method solv complex skewhamiltonian eigenproblem recent propos propos symplect balanc method and should also use prior appli algorithm numer exampl test symplect balanc strategi eigenvalu comput comput done matlab version machin precis theta gamma algorithm implement matlab function use modifi algorithm suggest set suggest implement lapack subroutin xgebal eigenvalu balanc unbalanc hamiltonian matrix matlab trademark mathwork inc comput squarereduc method use matlab function sqred implement explicit version squarereduc method see also test effect symplect balanc numer backward stabl structurepreserv method hamiltonian eigenvalu problem present like squarereduc method algorithm use squar hamiltonian matrix avoid form squar explicitli use symplect urvtyp decomposit hamiltonian matrix refer valu use eigenvalu comput unsymmetr qr algorithm parlettreinsch balanc implement lapack expert driver routin dgeevx appli hamiltonian matrix use quadrupl precis moreov test effect balanc solv algebra riccati equat structurepreserv multishift method present exampl benchmark collect present intrigu result exampl exampl system data come optim control problem j jet engin special case multivari servomechan problem result hamiltonian matrix h r theta isol eigenvalu tripl eigenvalu sigma simpl eigenvalu sigma algorithm return permut hamiltonian matrix hnni l gammanni l next hamiltonian submatrix scale use algorithm six sweep obtain balanc hamiltonian decreas norm matrix use subsequ eigenvalu comput five order magnitud eigenvalu comput squar reduc method appli unbalanc hamiltonian matrix triplet isol eigenvalu return pair conjug complex eigenvalu rel error gamma simpl eigenvalu rel error theta gamma simpl eigenvalu rel error theta gamma balanc version eigenvalu return full accuraci sinc affect roundoff error rel error not isol eigenvalu given figur use rel distanc comput eigenvalu comput dgeevx estim real rel error figur contain rel error eigenvalu posit real part sqred return eigenvalu exact plusminu pair th eigenvalu miss comput rel error balanc version zero respect machin precis eigenvalu order increas absolut valu figur increas accuraci decreas ratio khk jj obviou without balanc comput eigenvalu balanc matrix accur unbalanc one increas accuraci signific eigenvalu smaller magnitud reflect decreas ratio khk jj less determin accuraci comput eigenvalu see decreas factor khk theta gamma accuraci eigenvalu smaller magnitud increas almost factor figur see symplect balanc also improv eigenvalu comput method propos method suffer perturb accuraci comput eigenvalu similar also note unbalanc version isol eigenvalu comput rel accuraci rang theta gamma theta gamma eigenvalu number rel error symplect balanc o without balanc fig squarereduc method eigenvalu number rel error symplect balanc o without balanc fig symplect urv use balanc matrix order solv algebra riccati equat multishift method describ obtain follow result multishift method appli unbalanc data comput solut yield residu size theta gamma use balanc hamiltonian matrix get r show numer method solv algebra riccati equat substanti improv employ balanc exampl exampl hamiltonian matrix defin diag denot fourth unit vector four sweep algorithm khk reduc theta accuraci comput eigenvalu improv significantli stabil solut algebra riccati equat frobeniu norm residu defin drop r conclud remark seen isol eigenvalu real hamiltonian matrix deflat use similar transform symplect permut matric deflat problem scale order reduc norm deflat hamiltonian matrix equilibr row column norm remain not isol eigenvalu determin comput eigenvalu deflat balanc hamiltonian submatrix invari subspac requir use jpermut matric symplect reorder strategi order obtain desir invari subspac method appli order balanc skewhamiltonian complex skewhamiltonian matric numer exampl demonstr symplect balanc significantli improv accuraci eigenvalu hamiltonian matric well accuraci solut associ algebra riccati equat comput structurepreserv method final remark acknowledg work present articl continu preliminari result deriv author would like thank ralph byer heik fabend volker mehrmann help suggest r multishift algorithm numer solut algebra riccati equat contribut numer solut algebra riccati equat relat eigenvalu problem collect benchmark exampl numer solut algebra riccati equat i continuoustim case structur preserv method comput eigenvalu real hamiltonian symplect pencil bisect method comput h norm transfer matrix relat problem fast algorithm comput hnorm transfer function matrix matrix factor symplect qrlike method matrix eigensystem routin eispack guid extens matrix comput matrix balanc complex matrix balanc algebra riccati equat invari subspac method numer solut riccati equat canon form hamiltonian symplect matric pencil autonom linear quadrat control problem solut larg matrix equat occur respons theori schur decomposit hamiltonian matric balanc matrix calcul eigenvalu eigenvec tor comput method linear control system solv continuoustim matrix algebra riccati equat condit accuraci estim algorithm linearquadrat optim fast algorithm comput real structur stabil radiu algorithm hqr exchng fortran subroutin calcul order eigenvalu real upper hessenberg matrix symplect method approxim eigenvalu hamiltonian matrix tr ctr peter benner daniel kressner volker mehrmann structur preserv challeng comput control futur gener comput system v n p octob pierluigi amodio comput eigenvalu posit definit hamiltonian matric futur gener comput system v n p march peter benner daniel kressner algorithm fortran subroutin comput eigenvalu hamiltonian matric ii acm transact mathemat softwar tom v n p june