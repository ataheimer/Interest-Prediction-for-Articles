t finit mass method a finit mass method new lagrangian method numer simul ga flow present analyz contrast finit volum finit element method finit mass method found discret mass space mass subdivid small mass packet finit extens equip finit mani intern degre freedom mass packet move influenc intern extern forc law thermodynam undergo arbitrari linear deform method base approach recent develop yserent attain high accuraci b introduct fluid mechan usual state term conserv law link chang quantiti like mass momentum insid given volum flux quantiti across boundari volum finit volum method directli base formul space subdivid littl cell balanc law mass momentum energi set cell separ similarli also finit element method base discret space choic trial function result cell contrast finit mass method found discret mass idea least obviou trace back work von neumann pasta ulam late s s instead divid space elementari cell divid mass finit number mass packet finit extens equip given number intern degre freedom mass packet move influenc intern extern forc law thermodynam intersect penetr other contract expand rotat even chang shape intern mass distribut describ fix shape function similarli finit element although finit mass method pure lagrangian approach much particl method use boltzmannlik transport equat way much closer finit element finit volum scheme approxim produc differenti function discret measur method basic second order experi observ even fourth order converg lagrangian form descript fluid flow mani advantag exampl problem free surfac convect term aris featur make numer method base lagrangian view especi attract unbound space fact one popular method type monaghan smooth particl hydrodynam origin astrophys like smooth particl hydrodynam finit mass method complet gridfre approach method de facto imit statist mechan possess sounder mathemat physic foundat finit mass method gener extens particl model compress fluid propos last author base principl develop there compact converg result mathematisch institut der universitat tubingen tubingen germani obtain concern transit continuum limit transfer present situat one essenti differ approach articl mention singl mass packet undergo arbitrari linear deform rotat chang size although dimens configur manifold singl mass packet increas that strongli simplifi equat motion mass packet subject configur manifold linear space equat motion take form space dimens main advantag howev superior approxim properti due fact mass packet deform flow main issu method like equat motion mass packet particl often prefer say set up start basic physic principl final lead euler navierstok equat equat least squar galerkin approach consequ equat motion also break particl complet cover other simpl case adiabat inviscid flow equat motion particl deriv lagrangefunct intern energi potenti energi damp fluctuat part local kinet energi necessarili aris everi model friction forc vanish limit particl size tend zero ad potenti forc break invari time revers make method consist second law thermodynam paper organ follow x finit mass method explain deriv detail inviscid viscou fluid shown mass densiti veloc field and second independ thermodynam quantiti entropi discret discuss sort approxim properti expect equat motion describ local interact mass packet time evolut system set up main featur approach mass momentum angular momentum energi exactli conserv conserv mass follow immedi construct discuss x conserv energi momentum angular momentum studi x conserv angular momentum remark fact continuum mechan conserv angular momentum hidden symmetri stress tensor appear explicitli conserv law consequ discret violat principl finit mass method describ x invari arbitrari translat rotat and concern shape mass packet attain even everi linear transform space properti reflect quadratur formula develop x evalu integr defin forc act upon particl conserv momentum angular momentumand energi maintain x also discuss forc moment act upon particl calcul comput x suitabl time discret present propos scheme exponenti integr spirit recent paper hochbruck lubich case pure pressur forc transfer wellknown stormerverlet method second order equat conserv momentum angular momentum exactli final x typic test calcul flow two space dimens document exampl clearli demonstr potenti high accuraci method restrict attent articl free flow vacuum inviscid case reflect law need particl touch wall bound volum alreadi given numer realiz discuss elsewher certain background mechan fluid dynam refer textbook landau lifschitz one hand chorin marsden hand classic monograph courant friedrich particl model compress fluid basic ingredi finit mass method continu differenti shape function r r space dimens compact support attain valu function describ intern mass distribut insid mass packet fluid subdivid assum z z second properti state origin bodi coordin system attach particl center mass suppos z k compon y exampl function may built piecewis polynomi function e one space variabl let e condit equival z e z e second condit also impli integr vanish k l constant j given z e depend space dimens suitabl choic e use numer comput document x normal third order bspline given e jj e compos smaller copi use build basi cubic spline function uniform grid e fulfil condit constant take valu advantag tensor product like shape function good approxim properti point particl move along trajectori vector q t determin posit particl matrix h t size shape orient space correspondingli bodi coordin point posit x space time t let denot mass particl i total mass densiti result superposit mass densiti singl particl point particl veloc insert express y one get veloc field particl relat space coordin total mass flux densiti result superposit mass flux densiti singl particl local mass fraction veloc field v flow defin relat convex combin veloc field singl particl simplifi notat introduc abbrevi gradient deriv respect x can deriv express term intern variabl y deriv express deriv respect matrix h suppress index serv distinct particl write instead first observ that h fix e tend zero e and tend zero similarli e kl denot inner product two matric b one findsdeth e det h ry mean linear map det h y total deriv det h given h insert ej l entri e use follow continu equat express conserv mass automat satisfi given ansatz independ size shape particl distribut space ae t follow fact equat hold everi singl particl one prove use div v christoph gauger peter leinen harri yserent studi potenti accuraci approach start given twice continu differenti veloc field u fix particl trajectori q t matric h t given initi valu solut differenti equat veloc field particl read therefor second order approxim u neighborhood mass fraction form partit uniti result overal veloc field remain second order approxim u region occupi mass independ particl locat mass densiti exact solut transport equat respect perturb veloc field therefor correspond initi valu good approxim true densiti sens backward error analysi care detail analysi type also cover motion extern forc field refer complet descript thermodynam state compress fluid besid mass densiti ae second thermodynam quantiti like temperatur need conveni purpos entropi densiti given form t denot specif entropi singl particl particular specif entropi convex combin specif entropi singl particl veloc one recogn represent potenti lead first order approxim exact specif entropi independ distribut particl actual accuraci much higher pressur absolut temperatur intern energi per unit volum function mass densiti entropi densiti function independ connect gibb fundament relat thermodynam take form ae s s present variabl assum intern energi ae s defin ae real twice continu differenti set suppos s ae requir ae first order partial deriv extend valu ae function continu sector jsj ae barytrop ideal gase ae ae repres simpl exampl constant characterist pressur constant mass densiti constant c v characterist heat constant volum constant fl ratio specif heat constant pressur constant volum typic valu particl kinet energi attain close represent denot euclidean norm vector frobeniu norm matrix respect total kinet energi system kinet energi intern energi z lagrangefunct system form complet adiabat case describ eulerequ ga dynam equat motion dt dt deriv lagrangefunct normal forc explicitli given ae s ae s equat read note mass particl cancel appear implicitli mass densiti ae entropi densiti s deriv occur express written function intern particl coordin given pressur forc act upon group particl interpret kind surfac forc long specif entropi singl particl assum constant time evolut system complet determin equat motion system time revers fact contradict behavior actual fluid heat gener shock front therefor propos add normal friction forc f r z righthand side first equat forc damp local veloc fluctuat coupl particl softli togeth differ veloc given particl veloc field surround flow determin direct forc scalar function r size quantiti equat h correspond forc smooth flow forc compar small vanish second power local particl size domin shock better quantit understand friction forc paus moment consid littl model problem neglect pressur forc keep r constant fix veloc field equat motion singl particl read is within time veloc particl reduc factor e justifi call local relax time system trajectori particl thu particl stop distanc jv j posit given time friction among particl gener heat therefor specif entropi longer constant increas time obey differenti equat quantiti defin mean valu z absolut temperatur around particl z specif heat suppli quantiti densiti fluctuat energi rewritten conveni comput purpos equat second law thermodynam ensur conserv energi shown x note specif entropi particl never decreas q h function r kept fix linear map studi map util energi norm given correspond energi inner product respect note squar energi norm vector consist veloc compon q total kinet energi system denot b v veloc form b instead q one z symmetr bilinear form veloc v b v show linear map neg semidefinit selfadjoint respect energi inner product r constant eigenvalu rang interv gammat proof base argument proof theorem below viscou fluid addit forc z act upon mass contain volum w transport flow mass initi contain given volum insid region occupi mass symmetr tensor viscou part stress tensor function densiti temperatur symmetr part gradient veloc field newtonian fluid depend linearli v respect given space dimens first term righthand side trace zero describ shear forc fluid second part come bulk visco iti viscos coeffici j nonneg function ae guarante fundament properti need satisfi second law thermodynam gase assum model viscou forc one start observ z z ffi continu differenti function valu vanish outsid w tend pointwis characterist function w ffi tend denot set indic particl initi contain region w mass fraction ii serv discret counterpart function ffi lead viscou forc z act upon group particl normal forc f v z act upon particl i integr extend region occupi mass given time t note express correctli take account part boundari move volum touch mass exterior therefor construct also cover case directli includ part boundari move volum belong boundari region occupi mass quantiti correspond forc z z addit specif heat suppli particl z provid given particl locat interior region occupi mass forc formal vanish stress tensor diverg zero continuum mechan requir proof partial integr second integr righthand side cancel problem approach that one space dimens deriv mass fraction singular alway squar integr fortun effect often compens behavior properti shape function assum form viscos coeffici behav like ff let gradient satisfi pointwis invers estim hold cubic spline exist constant c depend number local interact particl mass size shape ae ff jr provid ff gamma k demonstr integrand continu tend zero point ae tend zero therefor given circumst one refrain replac regular mass fraction propos howev consider would immedi transfer case incorpor heat conduct righthand side entropi equat supplement z heat flux vector k mostli given fourier law coeffici function heat conduct heat flux well defin k satisfi estim similar estim viscos coeffici rest section restrict newtonian fluid given q h map linear denot b tensor form veloc b q instead q z ddx hold integr discret describ abov gammad tr dtr b prove also linear map symmetr neg semidefinit respect energi inner product given proof refer proof theorem below conserv energi momentum angular momentum conserv energi momentum angular momentum basic physic properti close system must therefor reproduc finit mass method moreov energi estim basic mathemat examin model and particular need transfer compact converg result present situat particl underli arbitrari linear deform conserv energi also prevent determin h becom arbitrarili small sinc equat state like would requir much energi first result is theorem total energi compos kinet energi particl intern energi constant motion proof util represent kinet energi singl particl one first obtain dt therefor equat motion yield term come pressur forc cancel correspond deriv v come friction forc viscou forc start calcul state two simpl algebra relat repeatedli use section name squar matric b vector b squar matric a b c exampl first two relat yield arbitrari vector f choos z follow becaus definit v lead represent z rq dx first two term abov insert tr f one find z second part come viscou forc symmetri definit v second integr formula cancel sum attain valu z christoph gauger peter leinen harri yserent z z prove proposit demonstr exactli right amount kinet energi convert heat surprisingli vanish friction viscou forc one conserv energi entropi contradict usual concept ga flow would possibl continuum mechan explain fact kinet energi consid compos kinet energi singl particl ident mean kinet energi et z known continuum mechan consist addit local fluctuat energi z ae smooth flow fluctuat energi neglig small part total kinet energi vanish fourth power particl size domin particl clash role friction forc convert kind fluctuat energi true intern energi total momentum system defin z close represent theorem total momentum constant motion proof represent equat motion yield dt three part come pressur forc friction forc viscou forc first part read ae s definit mass densiti entropi densiti mean z given assumpt continu differenti function compact support yield p one obtain z as definit veloc field v form partit uniti final also part z result viscou forc vanish last consid scalar quantiti z aex fix skewsymmetr matric w have definit v close represent three space dimens compon total angular momentum z quantiti form vice versa quantiti form compos compon angular momentum therefor threedimension case follow theorem state angular momentum system constant motion space dimens one get less first integr correspond dimens space skewsymmetr matric theorem arbitrarili given skewsymmetr matric w scalar quantiti l defin constant motion proof delta vector delta one get dl dt represent l equat motion therefor yield dl first part come pressur forc second part friction forc third part viscou forc show three part vanish separ represent partial deriv skewsymmetri w first follow thu yield ae s or take account definit ae s sum z continu differenti function compact support partial integr give therefor l w skewsymmetr way yield therefor z as definit veloc field v one obtain l symmetri viscou stress tensor skewsymmetri w give therefor z form partit uniti final also l discret integr particl model compress fluid pure lagrangian invari arbitrari translat rotat and concern shape particl attain even everi linear transform space properti must reflect quadratur formula need evalu integr defin forc act upon particl start observ integr scalar vector function f weight mass densiti written sum z z contribut singl mass packet integr righthand side live refer domain shape function strictli posit replac fix quadratur formula z ff ga weight ff node insid support shape function consid weight function here result composit rule z z f weight j ff node q j h j base given discret mass subdivis space elementari cell therefor desir invari properti util quadratur rule one replac potenti energi fulli discret express z denot specif intern energi discret potenti normal forc temperatur form specif intern energi quadratur point depend q h forc f correspondingli split two part differ structur f ae s ae s quadratur point q j h j contain support given particl enter wherea f correspond term complet determin function valu first order deriv mass densiti entropi densiti quadratur point q h assign particl itself local temperatur around particl transfer z s forc replac forc lagrangian equat motion respect local temperatur local temperatur entropi equat note that assumpt made ae s ff quantiti behav numer well friction forc heat suppli directli discret use quadratur rule viscou forc heat suppli heat flux one proceed correspondingli method react sensit choic weight quadratur rule refer domain experi shown quit quadratur point need exploit full accuraci approach small number quadratur point lead instabl particular quadratur point properli space high polynomi accuraci alon suffic tabl basic onedimension quadratur rule cubic bspline node tensorproduct third order bspline describ begin x good experi tensorproduct counterpart onedimension quadratur rule given tabl quadratur formula exact fifth order polynomi assign quadratur point particl two space dimens total number quadratur point q j h j enter comput given particl depend overlap bspline gener much higher much less two space dimens conserv energi momentum angular momentum transfer present case discret integr proof last section taken minor chang concern pressur term proof total momentum remain constant motion one util z z r quantiti vanish proof quantiti associ angular momentum constant motion relat z z enter give l essenti idea comput forc act upon particl separ quadratur point particl reflect fact particl interact directli global field like mass densiti veloc two differ data structur use first data structur associ particl themselv contain fix particl mass valu q h final determin storag local temperatur forc act upon particl heat suppli particl cours second data structur associ quadratur point first contain posit weight necessari global inform xz like valu ae z mass densiti z entropi densiti j z mass flux densiti vz veloc quantiti associ viscou stress tensor t occas aris field inform need comput procedur comput integr involv differenti equat quit simpl consist three phase describ procedur inviscid case case addit viscou forc similar first phase quadratur point gener valu ae z mass densiti z entropi densiti j z mass flux densiti intermedi quantiti well gradient ae quadratur point assembl loop particl phase inform transfer particl quadratur point second phase valu deriv ae s and incorpor friction forc ae z comput oper work singl quadratur point final third phase discret integr determin forc heat suppli local temperatur comput use result phase phase phase inform transfer quadratur point back particl phase phase requir effici access quadratur point contain support given particl search tree use purpos set quadratur point gener inform need access quadratur point assign given particl store separ timestep procedur remain big system differenti equat particl posit q deform matric h entropi solv numer section present simpl robust second order method adapt structur system properti solut method propos us christian lubich inspir recent work hochbruck lubich exponenti integr stabil rang de facto independ strength friction viscou forc shrink scheme type equat approach incompress first combin vector q matric h big vector dimens d vector z dimens n system differenti equat togeth addit friction forc viscou forc written form entropi equat read first term righthand side correspond f discret counterpart pressur forc second term correspond discret version friction forc viscou forc newtonian fluid notat reflect forc depend linearli q consider x shown matric symmetr neg semidefinit respect energi inner product determin final righthand side correspond ffi q discret version respect plu eventu term come heat conduct function depend nonlinearli argument propos method numer solut system leapfrog scheme come approxim time k gamma z time k new approxim time k k respect one first comput new valu deriv new valu oe given theta oe oe oe entir function new valu z k final implicitli determin equat z christoph gauger peter leinen harri yserent use new b k next time step approxim obtain littl addit cost approxim enter comput comput start approxim approxim quantiti z comput abov method construct would yield exact valu f constant vanish friction viscou forc ie scheme transfer timerevers integr known verlet method molecular dynam reduc start step abov verlet method equival onestep method k consid intermedi valu verlet method symplect therefor favor properti hamiltonian system aris present case pure pressur forc particular preserv momentum angular momentum let denot total momentum scalar quantiti asomega skewsymmetr matrix theorem theorem consider x respect quantiti retain valu transit one time level next matrixvector product oe ab comput krylovspac method base symmetr lanczo process use energi inner product start vector b step lanczo algorithm deliv matrix v consist column orthonorm respect inner product symmetr tridiagon matrix h dimens theta m rank one matrix r matrixvector product approxim spectral decomposit small symmetr tridiagon matrix h oe h given note comput ax correspond evalu discret friction forc and necessari discret viscou forc perform without explicit knowledg a approxim converg fast entir function oe much faster conjug gradient method solut linear system coeffici usual krylov step suffic exampl present next section solv equat approxim two step simpl fix point iter sophist method need heat conduct present exampl section compil twodimension exampl exhibit typic behavior compar numer known exact solut shape function particl use bicub bspline togeth point quadratur rule describ x find good approxim given initi data assum region occupi mass time contain insid axiparallel rectangl cover rectangl regular grid gridsiz h initi matric h initi posit select gridpoint denot x k here determin particl mass first comput coeffici k minim appropri chosen distanc linear combin k given initi mass densiti ae exampl project gauseidel method point x k k particl locat remain gridpoint ignor sequel initi veloc determin solv interpol problem particl posit q set discret mass flux virtual fourth order approxim continu mass flux aev time suffici smooth specif entropi comput way interpol entropi densiti s altern choos initi veloc correspondingli work better domin extern forc advantag veloc field linearli depend x like rigid bodi motion exactli reproduc refer recal navierstok equat ae t ae t s t govern time evolut smooth compress flow absenc heat conduct transfer euler equat inviscid case equat complet materi law like basic thermodynam relat often equat state differ mathemat equival form also written conserv law replac conserv law energi special case inviscid ideal gase entropi equat replac equat t coupl pressur veloc ga cloud first exampl serv less consist check show accur method be reproduc selfsimilar solut finit mass euler equat function satisfi continu equat regardless choic densiti profil psi matrix function ht cours also entropi equat start intern energi barytrop ideal ga momentum equat read ae set h abbrevi determin h normal ae function compact support satisfi relat appropri chosen function ht function continu differenti correspond matrix function ht solut differenti equat ae det ht initi valu det h differenti equat coincid differenti equat one would obtain motion singl shape function one let particl move accord differenti equat veloc field whole configur would simpli undergo seri linear transform wonder high accuraci reach exampl comput present here start materi constant initi valu yield rotat first contract expand ga ball initi posit q mass matric h determin describ introduct section reproduc initi veloc field exactli initi veloc q fix via linear system exampl initi entropi set r exampl solv problem period stepsiz timestep procedur x start grid gridsiz theta bspline final yield particl fig show initi configur particl time final configur time latter rescal radiu determin initi radiu fig particl ga cloud exampl time initi configur particl almost retain long period although ga ball first shrink radiu expand final radiu factor thousand exact approxim solut cannot distinguish nake eye maximum norm error one per thousand maximum norm solut fig show cross section mass densiti togeth differ approxim mass christoph gauger peter leinen harri yserent densiti along line x rescal radiu error multipli factor thousand order compar exact solut astonishingli fig mass densiti absolut error ga cloud exampl time rel size error increas probabl one could run exampl infin viscou counterpart solut abov densiti profil viscos coeffici j constant multipl ae also solut well reproduc even slightli reduc accuraci exampl like these shear viscos must counterbal bulk viscos otherwis physic instabl occur shock front second exampl show particl method behav shock develop inviscid fluid demonstr friction forc work exampl transform kinet energi intern energi play domin role consid spheric symmetr shock front ct ideal ga make veloc densiti pressur ansatz r x r r r ct constant valu ae jxj ct determin valu c ae function v p c initi state first observ differenti equat transfer space dimens differenti equat use comput v p numer next step express c ae function valu fix time be let u c radial compon veloc side shock front rel veloc front itself continuum mechan teach see exampl mass flux momentum flux energi flux across shock front continu equival relat help equat replac hugoniot equat equival express conserv energi ideal ga pressur intern energi coupl equat state conserv mass lead c hugoniot equat take form insert one final obtain quadrat equat veloc shock front posit solut equat interest neg solut lead rarefract shock compat second law thermodynam take account function depend repres equat unknown veloc c correspond valu equat solv numer one yield also valu ae densiti pressur insid shock exampl christoph gauger peter leinen harri yserent one obtain two space dimens valu mean that time fluid collid origin nearli doubl speed sound take valu p here set r ae exampl idea behind form r friction grow densiti matter increas physic intuit suggest actual comput place theta particl regular grid cover squar gamma follow motion time interv approxim particl contain region gamma interest time slightli time time stepsiz exponenti integr need krylov step time step typic behavior also observ exampl fig show cross section exact approxim solut along interv gamma x fig correspond contour line approxim densiti time posit height shock solut profil outsid shock well reproduc approxim solut retain spheric symmetri shock practic well resolv possibl particl given size closer look result singl time step show shock smear comput except shock region small neighborhood origin error densiti pressur less one per thousand hold veloc field outsid shock pass shock particl almost loos kinet energi veloc practic zero insid shock error mass densiti around origin probabl due discontinu initi data region error extend seem shrink proport particl size interest observ behind shock particl rearrang rectangular grid seen fig fig densiti pressur veloc shock front exampl time fig contour line densiti shock front exampl time fig particl contour neighborhood shock shear flow last exampl serv test model shear viscos keep mass densiti pressur constant neglect heat product set righthand side zero consid veloc field form n given unit vector fix direct flow compon x direct unit vector e orthogon n again continu equat fulfil independ choic function oe c newtonian fluid constant shear viscos j momentum equat read mean either oe linear ct constant translat direct e correspondingli solut correspond veloc field remark far reproduc exactli provid initi data exact integr defin forc evalu exactli reason forc act upon particl vanish particl distort way mass densiti pressur remain constant solut veloc field repres sever test one let particl move accord differenti equat veloc field particl posit q matric h time would function fft given thu littl while particl practic lost kinet energi get stuck experi use data fix physic properti fluid set v first exampl exclud influenc come align particl flow avoid problem infinit extens flow region set p p problem becom period period interv theta comput time interv time stepsiz particl fig stem comput initi locat axiparallel grid sidelength fig show veloc fig deform particl shear flow exampl field error correspond initi gridsiz evolv time function valu sampl theta grid associ l norm taken distanc measur better comparison error multipli factor respect pictur demonstr viscou time scale fig time evolut veloc rescal error shear flow exampl perfectli reproduc transit theta theta theta theta particl error decreas approxim factor clear fourth order converg fine confirm finit mass method r mathemat introduct fluid mechan new york solv ordinari differenti equat krylov subspac approxim matrix exponenti oper lehrbuch der theoretischen physik lehrbuch der theoretischen physik heurist numer work problem hydrodynam propos analysi new numer method treatment hydrodynam shock problem particl model compress fluid particl variabl size entropi gener shock resolut particl model compress fluid converg analysi finit mass method flow extern forc veloc field tr