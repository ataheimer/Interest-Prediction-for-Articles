t sequenti regular method simul mechan system mani close loop a numer simul problem larg multibodi system often treat two separ stage i forward dynam problem comput system acceler given forc function constraint ii numer integr problem advanc state time forward dynam problem algorithm given optim linear complex number bodi case system topolog contain mani close loopsbut interact two stage import use explicit time integr scheme propos sequenti regular method srm linear complex number bodi per time step even presenc mani close loop method also handl certain type constraint singular b introduct grow interest develop effici algorithm multibodi dynam simul increas size complex spacecraft robot system one motiv develop anoth physicallybas model comput graphic numer simul process institut appli mathemat depart comput scienc univers british aschercsubcca work author partial support nserc canada grant ogp institut appli mathemat univers british columbia vancouv bc canada vt z new address program scientif comput comput math stanford univers durand stanford ca usa plinsccmstanfordedu typic treat two separ stage first stage consist forward dynam problem comput system acceler given variou constraint torqu forc function treestructur multibodi system algorithm propos optim on complex n total number rigid bodi system see eg also extend cope system small number close loop compar total number n link system close loop m n typic complex on obtain use cutloop techniqu appear hard find on algorithm chain larg number eg close loop second stage simul algorithm design address numer integr problem advanc state time obtain gener bodi posit veloc comput acceler explicit implicit time discret scheme gener use two stage usual treat separ situat specif treatment one affect other global unifi view benefici eg paper use global view simul process devis method requir on oper per time step even presenc mani close loop specif propos use sequenti regular method srm purpos combin explicit time integr scheme method produc iter get arbitrarili close solut discret differenti system also handl certain type constraint singular mathemat model constrain multibodi system yield differentialalgebra equat dae index treestructur system ie close loop one formul model term minim set rel solut coordin obtain system ordinari differenti equat ode see eg exist commerci softwar packag eg sdfast util approach forward dynam algorithm complex on interpret imbed ode dae given time elimin unknown local larger sparser system work howev consid equat motion descriptor form see eg formul nonminim redund set coordin yield often simpler albeit larger dae even treestructur case dae typic treat differenti constraint acceler level use one wellknown stabil techniqu see eg on forward dynam algorithm formul recal x follow system close loop may consid compos treestructur system plu set loopclos constraint latter treat use srm techniqu method describ x prove number oper need per time step use explicit time discret scheme sdfast trademark symbol dynam inc bush street mountain view ca usa remain on n method also handl certain type constraint singular final x demonstr algorithm two closedloop chain exampl algorithm optim comput complex treestructur problem gener multibodi system consid ideal multibodi system consist rigid bodi point mass kinemat treestructur use redund world coordin p posit system ie describ posit orient individu bodi set feasibl posit correspond physic possibl geometr configur given holonom constraint differenti constraint respect time yield correspond constraint veloc acceler gp constraint jacobian matrix g p eulerlagrang equat combin constraint equat acceler level eulerlagrang equat form dae index differenti variabl p v algebra variabl constraint posit level veloc level defin invari manifold wellknown simpli simul numer may caus sever drift constraint manifold manifest mild instabl formul figur exampl treestructur chain phenomenon prevent use stabil techniqu eg invari stabi lizat baumgart stabil project method regular techniqu eg penalti sequenti regular method numer integr paper assum stabil techniqu alreadi appli includ concentr aspect solv system algorithm treestructur problem consid case multibodi system kinemat tree structur consid graph whose node correspond joint whose edg repres bodi system see eg figur close loop graph consist tree tree one joint singl root everi joint uniqu father tree neighbor bodi path root introduc node father root if fix joint usual number give one tree label node follow joint number n label joint alway greater father bodi link number bodi connect father joint son joint number son exampl figur joint father joint two joint connect bodi kind treestructur system mass matrix symmetr posit definit blockdiagn block symmetr posit definit constraint equat bodi connect two joint k father k form see assum full row rank k then analyz mani articl see eg recurs algorithm deriv obtain on algorithm invert lefthand matrix b explain algorithm start termin joint ie one set obtain next consid equat joint j termin son k kson j father j son hold substitut yield kson j kson j system form recurs algorithm result algorithm step climb tree toward root recurs repeatedli form f j step start root tree solv local system u j with climb tree recurs note step replac origin problem n local problem algorithm on complex oper local one bodi climb tree onc work differ subtre done parallel well result forward dynam algorithm describ express v term p ode system must integr time note dimens u v p n contrast treatment use minim coordin u v p may dimens small n howev save latter formul chiefli time advanc faster forward dynam algorithm small n on forward dynam algorithm see algorithm system mani close loop consid multibodi system loop problem seen treestructur system plu extra loopclos constraint form x k x j repres gener posit joint k j respect compon p repres number loop write mthetan constant matrix full row rank closedloop case need invert matrix instead matrix b d block gaussian elimin give schur complement obtain use on algorithm describ last section use usual techniqu invert on result satisfactori small cf problem larg number loop appear difficult extend on algorithm cf particular om algorithm invert schur complement avail also found discuss literatur perform method constraint jacobian matrix rank defici situat often happen closedloop chain exampl slidercrank problem first exampl x sequenti regular method propos provid possibl address two challeng algorithm write eulerlagrang equat multibodi system loop constraint correspond tree structur c number row may larg assum g full rank assumpt gener true chain problem see exampl x alreadi on algorithm treestructur problem ie system a b without c so develop on algorithm treestructur part problem keep structur a b c loopclos constraint one possibl penalti method penalti paramet howev well known use implicit integr scheme system like sinc ffl small stiff system therefor invert matrix like discret stepsiz h block diagon more previou algorithm difficult appli propos new sequenti regular method srm modif usual penalti method allow us use explicit scheme solv regular problem henc srm combin explicit time discret make possibl obtain on algorithm problem mani loop appli srm problem treat loopclos constraint obtain new algorithm given t appli stabil method eg baumgart stabil first stage invari stabil project method first constraint c follow system must consid c becom even simpler algorithm suggest gener multibodi system without singular form form on comput complex simpler form sinc need invert block diagon matrix howev problem singular or illcondit often appear closedloop chain form recommend indic alreadi x numer exampl show perform wors form also indic form best choic ffl gener ch for reason stabil explicit differ scheme h step size chosen differ scheme c constant depend eigenvalu matrix g g henc best choic ffl form chang time g gener depend time t see exampl x ffl chosen quit larg henc srm iter need make explicit discret stabl whole time interv comput on therefor still recommend form sinc perform better shown x sinc best choic ffl form depend eigenvalu matrix dm which constant constant matrix case mani chain problem includ exampl x is best choic ffl often independ form comparison usual stabil method addit advantag never invert singular matrix even singular sinc g full rank assum summar algorithm consist appli explicit time discret scheme on forward dynam algorithm underli treestructur system solv next discuss converg srm prove iter number method independ bodi count n henc per time step method on algorithm even chain mani close loop converg stabilizationsrm form want analyz converg iter procedur method analysi base differ appli srm part constraint ie loopclos constraint problem consid may larg number unknown linear n indic system clearli singularli perturb ffl start arbitrari t may therefor expect initi layer simplic converg analysi assum as assumpt initi valu problem possibl obtain exact j advanc gener semiexplicit dae assumpt initi layer solut lth deriv let us make assumpt bounded solut nbodi chain reason assum solut deriv bound linearli n case solut may bound independ n make correspond assumpt p v sinc regular nearbi problem origin system initi layer involv solut condit let l assumpt solut p v satisfi may depend n b c solv term ie write assum jacobian matrix respect p v satisfi also satisfi impli repres maximum norm k gener posit constant independ n remark give converg bound case assum note mass matrix posit definit blockdiagon closingloop constraint matrix blockspars exampl x see jacobian matrix g constraint blockspars too thu assum assumpt matric g finit multipl ie number multipl independ n blockspars precis multipli matrix vector norm on k product norm still on k k posit number fact closingloop constraint matrix blockspars also block roworthogon concret one nonzero element column see eg x combin properti thu obtain dm posit definit blockdiagon henc eigenvalu matrix dm union eigenvalu diagon block matrix thu eigenvalu posit independ n sinc size element diagon block dm independ n write lemma lemma mass matrix closingloop constraint matrix properti eigenvalu matrix dm gamma posit independ n final assum follow perturb bound cf perturb index correspond discuss assumpt let exist constant k independ n that z solut z satisfi perturb here although invert need on oper see algorithm x oper involv perturb t ffit believ bound k independ n consid converg stabilizationsrm form choos o let u drift equat initi condit u appli use assumpt lemma obtain u a yield compar stabilizationsrm form need bound deriv appear alreadi a obtain use condit dm obtain b d so b differenti b use o obtain d w obtain henc differenti a next impli thu use obtain desir conclus subtract a b a b respect use also differenti d conclud o first henc also estim also hold yield right hand side b offl want get better estim differenti b obtain want show offl purpos must estim use condit fact also exact obtain henc differenti obtain precis estim need use obtain differenti applic well estim obtain abov note thu previou estim allow conclus henc conclud repeat procedur final obtain theorem let assumpt describ begin section hold then solut stabilizationsrm form o follow error estim solut multibodi problem remark bound assum p v may gener obtain jth deriv would o j final yield follow error estim result obvious weaker correspond weaker bounded assumpt comput complex stabilizationsrm form consid algorithm regular iter use on algorithm describ x so consid comput complex algorithm need studi number iter requir simpl show independ n given worst error estim must choos ffl small enough srm iter reduc error viz differ solut solut least factor ff fix number iter s independ n need reduc error given toler note though may grow n depend problem simul henc rang choic ffl ffl ff restrict depend n sinc time discret scheme explicit step size h must restrict absolut stabil requir satisfi appropri constant fl moder size number time step requir may therefor depend n cf still number iter requir obtain given accuraci obvious remain independ n henc oper count per time step remain on worst error estim suppos fi given posit constant simplic let us appli rth order explicit differ scheme stabilizationsrm form sth iter worst combin error algorithm o ffl see remark tri roughli equat two sourc error set henc use obtain rough upper bound number iter s requir like aris also accuraci stabil consider remark error estim condit weaken significantli read arbitrari integ independ n case replac numer experi present coupl exampl demonstr algorithm propos analyz previou section first build system special kind nbodi chain see figur includ two exampl use method describ consid chain consist n bodi bodi model line segment length l j mass j uniform mass distribut choos cartesian coordin joint x j vector connect joint along link order describ posit p chain n d chain p j six compon d chain four compon label chain joint shown figur explain x henc holonom constraint includ length condit connect condit father j therefor due uniform mass distribut center mass bodi coincid geometr center x moment inertia center mass total kinet energi given figur squar chain label let joint fix potenti energi due graviti given ge e v unit vector along vertic axi d case e d case e note e height center mass bodi j zero level graviti constant give forc vector f b henc know mass matrix forc term f constraint g write system kind treestructur chain problem chain loop need impos addit geometr constraint onto correspond treestructur formul see discuss begin x next consid two specif exampl exampl consid squar chain unit length mass link ie label correspond tree structur shown figur label henc write jacobian matrix gp treestructur constraint gp exampl gammai theta unit matrix extra loopclos constraint dp are equal number squar thu form jacobian matrix d exampl jacobian matrix gp constraint rank defici four link squar line let chain fall freeli posit shown figur joint fix mention befor srm iter algorithm solv treestructur problem use on algorithm x here demonstr number srm iter independ n mean comput complex algorithm on per time step choos step size regular paramet appli explicit secondord rungekutta method regular problem iter comput clearli see relat number iter n want avoid singular happen around whose error situat complic count number srm iter error constraint exhibit obviou improv tabl list iter count constraint error variou n iter iter tabl relat number iter n squar chain theoret expect two srm iter suffici sinc differ scheme second order oh tabl see second third success iter maximum drift almost same especi n h addit experi need two iter algorithm achiev second order discret accuraci next compar perform algorithm algi al gii set comput result show first singular occur use simpl forward euler scheme take algorithm still take algorithm algorithm cannot take h algorithm unstabl immedi first time step take algorithm blow around take becom stabl take agre expect algorithm x is sake stabil differ scheme smallest ffl choos depend often larger need algorithm henc iter need simpler algorithm algorithm iter ffl t t t t algi e e e e algi e e e e algii e e e e algii e e e e tabl maximum drift two algorithm list tabl maximum drift produc two algorithm variou time tabl see overal perform algi better algii also seem exampl error improv algii iter much slower motion squar chain describ figur exampl exampl consid motion squar net veil start breez correspond tree structur net label shown figur fix joint label determin father given joint jacobian matrix gp constraint extra loopclos constraint are ae x squar net number bodi l set step size regular paramet h appli on algorithm time step secondord rungekutta method regular problem srm iter breez assum net move right largest angl to verticl axi consid motion net whose initi posit locat angl with respect vertic line list number iter variou n tabl tabl see drift error improv second iter two iter need algorithm independ n motion squar chain describ figur figur motion squar chain time increas increment deltat left right top bottom l l l l l l l l l l l l l wl l wl figur tree structur label squar net iter iter tabl relat number iter n squar net r recent advanc numer integr multibodi system stabil invari discret differenti system stabil dae invari manifold sequenti regular method higher index dae constraint singular linear index case sequenti regular method nonlinear higher index dae formul stiff robot simul stabil constraint integr motion dynam system numer solut initialvalu problem differentialalgebra equat robot dynam algorithm solv ordinari differenti equat ii regular differenti unifi formulaion dynam serial rigid multibodi system penalti function method simul mechan system subject constraint stabil comput procedur constrain dynam system numer solut differentialalgebra equat illcondit constraint fast recurs sqp method largescal optim control problem tr