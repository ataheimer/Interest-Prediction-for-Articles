t step toward accur reconstruct phylogeni geneord data a report progress reconstruct phylogeni geneord data develop polynomialtim method estim genom distanc greatli improv accuraci tree obtain use popular neighborjoin method also improv run time grappa softwar suit combin tighter bound better use bound present new experiment result that extend present ismb wabi demonstr accuraci robust distanc estim wide rang model condit moreov use best distanc estim ede grappa softwar suit along sophist bound techniqu produc spectacular improv alreadi huge speedup wherea earlier experi show onemillionfold speedup when run processor cluster latest experi demonstr speedup one hundr million combin variou advanc enabl us conduct new phylogenet analys subset campanulacea famili confirm variou conjectur relationship among member subset confirm invers view princip mechan evolut chloroplast genom give repres result extens experiment conduct real simul dataset order valid character approach b introduct genom rearrang modern laboratori techniqu yield order stranded gene chromosom allow us repres chromosom order sign gene where sign indic strand evolutionari event alter order rearrang invers transposit collect call genom rearrang event rare give us inform ancient event evolutionari histori group organ consequ mani biologist embrac new sourc data phylogenet work appropri tool analyz data remain primit compar develop dna sequenc data thu develop tool becom import area research attest recent meet topic optim problem natur optim problem phylogeni reconstruct geneord data reconstruct evolutionari scenario minimum number permit evolutionari event treewhat known parsimoni tree unfortun problem nphard criteriaeven simpl problem comput median three genom model nphard howev suboptim solut yield differ evolutionari reconstruct exact solut strongli prefer approxim solut see moreov rel probabl rearrang event invers transposit invert difficult estim overcom latter problem blanchett et al propos use breakpoint phylogeni tree minim total number breakpoint breakpoint adjac two gene present one genom neighbor tree note construct breakpoint phylogeni remain nphard method reconstruct phylogeni blanchett et al develop bpanalysi softwar implement variou heurist breakpoint phylogeni reimplement extend approach grappa softwar run sever order magnitud faster thank algorithm engin techniqu heurist solv breakpoint phylogeni problem propos rather attempt deriv parsimoni tree or approxim thereof use exist distancebas method neighborjoin nj perhap popular phylogenet method conjunct method defin leaftoleaf distanc phylogenet tree leaftoleaf distanc comput linear time current includ breakpoint distanc invers distanc the latter thank new algorithm also estim true evolutionari distanc or rather expect true evolutionari distanc specif model evolut work backward breakpoint distanc minimum invers distanc approach suggest sankoff caprara develop us seri paper show estim significantli improv accuraci tree obtain use neighborjoin method result paper paper report new experiment result use distanc estim reconstruct phylogeni geneord data use simul real data present sever new result the first two extens result present ismb third extens result present moret tang wang warnow simul studi examin relationship true evolutionari distanc distanc estim find distanc estim give good predict actual number event varieti model condit includ match assumpt simul studi examin relationship topolog accuraci neighborjoin specif distanc measur use breakpoint invers one three distanc estim find neighborjoin significantli better distanc estim breakpoint invers distanc detail investig robust neighborjoin use distanc estim assum rel probabl three rearrang event differ true rel probabl find neighborjoin use estim remark robust hardli show worsen even erron assumpt detail studi efficaci use best distanc estim significantli improv lower bound still comput low polynomi time invers length candid phylogeni novel way structur search maxim use bound find combin yield much stronger bound natur occur rang evolutionari rate yield addit speedup one two order magnitud grappa code success analysi dataset campanulacea bluebel flower use combin techniqu result onehundredmillionfold speedup origin approachin particular abl analyz dataset singl workstat hour wherea previou analysi requir use node superclust research combin develop mathemat techniqu extens experiment perform studi present crosssect result experiment studi conduct character valid approach use larg varieti simul dataset well sever real dataset chloroplast mitochondri genom test speed in sequenti parallel implement robust in particular mismatch model efficaci for new bound techniqu accuraci for reconstruct distanc estim background nadeautaylor model evolut genom set gene gene appear exactli onc genom describ order circular linear gene gene given orient either posit g neg g let g genom sign order g g g k invers indic b b produc genom linear order transposit linear circular order g act three indic a b c b c a b pick interv g g a g b insert immedi g c thu genom g with assumpt c b replac invert transposit transposit follow invers transpos subsequ gener nadeautaylor model genom evolut use genom rearrang event genom retain equal content model assum number three type event obey poisson distribut edg rel probabl type event fix across tree event given type equiprob thu repres nadeautaylor model tree triplet t e triplet defin rel probabl three type event invers transposit invert transposit instanc triplet indic three event class equiprob triplet indic invers happen distancebas estim phylogeni given tree set genom given two leav i j denot path j let e denot number event invers transposit invert transposit edg e evolut genom within tree actual number event edg defin actual distanc addit given addit matrix mani distancebas method guarante reconstruct tree edg weight but root atteson show nj guarante reconstruct true tree given estim addit matrix ij long estim bound error theorem from let binari tree let e ij defin describ abov let let n n dissimilar matrix ie symmetr zero diagon x nj tree njd comput ident is nj guarante reconstruct true tree topolog input distanc matrix suffici close addit matrix defin tree topolog consequ techniqu yield good estim matrix ij signific interest distanc measur edit distanc two gene order minimum number invers transposit invert transposit need transform one gene order other invers distanc edit distanc invers permit invers distanc comput linear time transposit distanc unknown comput complex given two genom g g set gene breakpoint g order pair gene g g b g g b appear consecut order g neither g g b g b g appear consecut order g number breakpoint g rel g breakpoint distanc g g breakpoint distanc easili calcul inspect linear time see figur exampl distanc estim true evolutionari distanc estim true evolutionari distanc requir assumpt model case geneord evolut assumpt moret tang wang warnow fig exampl transposit invers breakpoint distanc obtain g g invers the gene invers interv highlight step g also obtain g one transposit move gene segment posit gene b transposit invers breakpoint distanc respect genom evolv common ancestor nadeautaylor model evolut sankoff techniqu applic invers calcul valu exactli iebp ede applic gener model evolut obtain approxim valu exactiebp calcul valu exactli combin invers transposit invert transposit estim comput low polynomi time perform criteria let tree leaflabel set s delet edg e produc bipartit e two set let true tree let estim illustr figur fals neg respect denot fnt bipartit appear appear fals neg rate number fals neg divid number nontrivi bipartit similarli fals posit respect defin bipartit appear fals posit rate ratio fals posit number nontrivi edg exampl figur edg correspond bipartit present true tree estim thu fals neg note that tree binari number fals neg equal number fals posit report result use fals neg rate a true tree b estim fig fals posit fals neg edg true tree reconstruct tree bold edg fals neg edg a fals posit edg b true distanc estim definit given two sign permut comput breakpoint distanc one edit minimum distanc for now invers distanc actual number evolutionari event directli recover done estim number assumpt model evolut thu true distanc estim return like number evolutionari event given breakpoint invers distanc develop three estim iebp estim approxim like number evolutionari event work breakpoint distanc use simplifi analyt deriv exactiebp estim refin analyt deriv return exact valu quantiti ede estim use curv fit approxim like number evolutionari event work invers distanc three estim provid consider accur estim true evolutionari distanc breakpoint invers distanc at least larg moreov tree obtain appli neighborjoin method estim accur obtain also use neighborjoin base upon breakpoint distanc invers distanc comparison distanc estim simul nadeautaylor model evolut differ weight set studi behavior differ distanc estim number gene dataset anim mitochondria chloroplast genom mani plant dataset experi chose number upper bound b number rearrang event b chosen time number gene accord experiment result enough make distanc two genom similar distanc two random genom comput bp breakpoint inv invers distanc correct get iebp exactiebp ede distanc figur plot unnorm comput distanc actual number eventsus inversiononli scenario case gene scenario equal like event well inversiononli scenario case gene figur indic that expect bp inv distanc underestim actual number eventsalthough number event low highli accur small varianc linear regionth rang xcoordin valu curv straight linei longer inv distanc bp distanc inv distanc produc unbias estim larger rang bp distanc contrast three estim provid good estim averag although varianc increas sharpli edit distanc valu exactiebp produc good estim rang clearli improv iebp ede tend underestim distanc unless scenario use invers also plot differ actual true evolutionari distanc minimum estim distanc variou model evolut mixtur inver sion transposit invert transposit two differ genom size variou number event rate evolut figur show result three differ model evolut gene respect valu plot cumul fashion posit x along horizont axi plot mean absolut differ gener pair true evolutionari distanc x figur show exactiebp usual best choic ede distanc moret tang wang warnow breakpoint distanc actual number event invers distanc actual number event a bp distanc b inv distanc iebp distanc actual number event exactiebp distanc actual number event distanc actual number event c iebp distanc d exactiebp distanc e ede distanc fig mean standard deviat plot two distanc three distanc estim gene inversiononli scenario dataset divid bin accord xcoordin valu the bp inv distanc actual number event actual number event a bp distanc b inv distanc actual number event actual number event actual number event c iebp distanc d exactiebp distanc e ede distanc fig mean standard deviat plot two distanc three distanc estim gene scenario three type event equal like dataset divid bin accord xcoordin valu the bp inv distanc actual number event actual number event a bp distanc b inv distanc actual number event actual number event actual number event c iebp distanc d exactiebp distanc e ede distanc fig mean standard deviat plot two distanc three distanc estim gene inversiononli scenario dataset divid bin accord xcoordin valu the bp inv distanc actual number event absolut differ actual number event absolut differ actual number event absolut differ a invers b transposit c equal like event actual number event absolut differ actual number event absolut differ actual number event absolut differ a invers b transposit c equal like event fig mean differ true evolutionari distanc five distanc estim three model evolut plot function tree diamet gene top gene bottom moret tang wang warnow nearli good and occasion better model use inversionsalthough varianc larger distanc high make difficult draw firm conclus iebp ede clearli improv bp inv neighborjoin perform conduct simul studi compar perform nj use five distanc figur plot fals neg rate normal pairwis invers distanc three differ model weight set transposit onli all three event equal like plot pool result model weight differ number genom note njede remark robust even though ede engin inversiononli scenario handl dataset signific number transposit invert transposit almost well njede recov edg even nearli satur dataset maximum pairwis invers distanc close maximum valu njede improv njiebp spite fact iebp compar estim may attribut greater precis smaller varianc ede smaller distancesmost choic made neighborjoin made among small distanc ede like return approxim within small factor true distanc exactiebp expens three estim comput yield second best perform although differ error rate njede njexactiebp small statist signific normal maximum pairwis invers distanc fals neg rate normal maximum pairwis invers distanc fals neg rate normal maximum pairwis invers distanc fals neg rate a invers b transposit c equal like event fig fals neg rate nj method variou distanc estim function maximum genom result differ number genom pool singl figur model weight ident robust distanc estim discuss earlier estim true evolutionari distanc requir assumpt model paramet case ede assum evolut proceed invers onlyso well njede perform face dataset produc combin transposit invert transposit case two iebp method comput requir valu respect rate inver sion transposit invert transposit respect obvious leav lot room mistaken assumpt ran seri experi condit similar shown earlier deliber mismatch evolutionari paramet use product dataset use comput distanc estim use nj figur show result exactiepb estim result normal maximum pairwis invers distanc fals neg rate normal maximum pairwis invers distanc fals neg rate normal maximum pairwis invers distanc fals neg rate a invers b transposit c equal like event fig robust exactiebp method respect model paramet tripl legend indic model valu use exactiebp method estim similar indic estim use conjunct nj remark robust face erron model assumpt maximum parsimoni topolog accuraci main goal phylogeni reconstruct produc correct tree topolog two basic approach current use phylogeni reconstruct whole genom distancebas method nj appli techniqu estim distanc maximum parsimoni mp approach attempt minim length tree suitabl defin measur length examin two specif mp problem section breakpoint phylogeni prob lem seek minim total number breakpoint tree edg phylogeni problem seek minim total number invers want determin use simul studi whether topolog accuraci improv reduc number invers number breakpoint possibl also want determin whether breakpoint phylogeni problem invers phylogeni problem topolog accur certain evolutionari condit so condit ran larg seri test model tree investig hypothesi minim total breakpoint distanc invers length tree would yield topolog accur tree ran nj total dataset invers breakpoint distanc test consist least data point set genom use two genom size gene repres mitochondri chloroplast genom respect variou ratio invers transposit invert tran posit well variou rate evolut dataset comput total invers breakpoint distanc compar valu percentag error measur fals neg use nonparametr coxstuart test detect trendsi test whether reduc breakpoint invers distanc consist reduc topolog error use confid level found dataset invers distanc breakpoint distanc exhibit trend inde even confid level dataset still exhibit trend figur show result score differ nj tree two optim criteria breakpoint score invers length tree gener rel order trend curv agre curv figur suggest de normal maximum pairwis invers distanc rel breakpoint score a breakpoint score gene normal maximum pairwis invers distanc rel invers length c invers length gene normal maximum pairwis invers distanc rel breakpoint score b breakpoint score gene normal maximum pairwis invers distanc rel invers length d invers length gene fig score nj method variou distanc estim function maximum pairwis invers distanc genom plot ratio nj tree score model tree score breakpoint invers inversiononli model tree normal maximum pairwis invers distanc rel breakpoint score a breakpoint score gene normal maximum pairwis invers distanc rel invers length c invers length gene normal maximum pairwis invers distanc rel breakpoint score b breakpoint score gene normal maximum pairwis invers distanc rel invers length d invers length gene fig score nj method variou distanc estim function maximum pairwis invers distanc genom plot ratio nj tree score model tree score breakpoint invers model tree three class event equiprob creas number invers breakpoint lead improv topolog accuraci correl strongest gene case may becaus number event larger number gene rate evolut effect goe overlap event becom less like final trend still hold evolutionari model such transposit occur search maximum parsimoni tree lower bound use follow theorem well known theorem let n n matrix pairwis distanc taxa set let tree leaflabel taxa s let w edgeweight circular order leav planar embed corollari immedi follow corollari let matrix minimum distanc everi pair genom set s let fix tree s let n circular order leav planar embed length least d corollari form basi old twice around tree heurist tsp base minimum span tree note theorem corollari hold distanc measur obey triangl inequ earlier work use bound simpl manner reduc cost search tree space obtain initi upper bound minimum achiev invers length use nj invers distanc upper bound updat everi time search find better tree tree examin present standard nestedparenthes format the nexu format format defin particular circular order leav use order comput lower bound corollari use invers distanc lower bound exce upper bound tree discard bound may reduc run time substanti bound comput effici wherea score tree tool like grappa involv solv numer tsp instanc howev rate evolut high size genom bound often prove looseth bound exact distanc addit high rate evolut produc distanc much smaller addit valu thu set improv bound well use context grappa prune tree score them new result come three separ idea i tighten lower bound ii return accur score tree larg edg length iii process tree take better advantag bound tighten bound particular circular order defin tree descript one larg number circular order compat tree sinc tree intern order ie notion left vs right child swap two subtre alter moret tang wang warnow phylogeni yield differ circular order order defin valid lower bound could search order retain largest bound produc order tighten bound unfortun number compat circular order exponenti number leav full search ex pensiv develop test fast greedi heurist swapasyougo provid highqual approxim optim bound heurist start given tree impli circular order travers tree preorder arbitrarili chosen initi leaf decid local node whether swap children comput score result circular order move toward larger valu standard greedi fashion increment comput search take linear time swap alter coupl adjac differenti cost swap comput constant time experi result bound alway close even equal optim bound much better origin valu almost case test relat bound techniqu propos bryant found slow in order yield reason tight bound requir introduct lagrangian variabl solut system linear equat determin valu alway in experi domin algorithm sinc use bound strictli reduc total amount work essenti lower bound comput littl effort accur score long edg long edg tree suffer problem larg leaftoleaf distanc serious underestim edit distanc comput thu decid use remedi present first part paper correct edit distanc one true distanc estim chose ede estim offer best tradeoff accuraci comput cost three estim use within grappa wherev distanc comput comput distanc matrix nj comput circular lower bound matrix and importantli comput distanc along edg comput medianofthre lie heart grappa approach distanc estim effect stretch rang possibl valu stretch pronounc edit distanc alreadi larg the worst case circular bound use distanc estim yield signific benefitsa number challeng instanc suddenli becam tractabl combin ede distanc improv circular bound layer search ad third signific improv bound scheme sinc bound longer significantli improv obtain better prune requir better use bound have origin approach prune simpli enumer tree keep score best tree date upper bound comput lower bound new tree decid whether prune score it approach tree gener onc bound onc score onc upper bound use comput may quit poor close end optim nearoptim tree appear toward end enumerationin case program must score nearli everi tree remedi problem devis novel radic differ approach motiv fact gener bound tree inexpens wherea score one involv solv potenti larg number instanc travel salesperson problem expens new approach call layer search still bound tree still score onc typic examin tree onc work follow first phase comput nj tree use ede distanc score obtain initi upper bound origin code second phase everi tree turn gener lower bound comput describ abov bound compar cost nj tree tree prune away store along comput lower bound bucket order valu lower bound begin layer search itself proce principl lower bound tree correl actual parsimoni score tree search look success bucket tree turn score tree cannot prune lower bound updat upper bound whenev better score found search techniqu applic class optim problem cost evalu object solut space much larger cost gener object work well whenev good correl lower bound valu optim solut experi indic that unless interleaf distanc nearli maxim for given number gene correl lower bound parsimoni score quit strong layer search strategi quickli reduc upper bound score optim nearli so therebi enabl drastic better prune detail below frequent observ prune rate experiment assess bound measur percentag tree prune bound and thu score function three model paramet number genom number gene number invers per edg use inversiononli scenario well one approxim half invers half transposit invert transposit data consist two collect dataset combin paramet number genom number gene rate evolut vari event per tree edg total paramet combin dataset use ede distanc score edg swapasyougo bound comput layer searchbecaus layer search requir enumer tree front someth simpli possibl genom data set genom grappa test tree score updat upper bound necessari kept statist prune rate genom number tree well beyond realm enumerationwith genom case began run grappa hour score mani tree possibl use best score obtain first phase upper bound second phase ran anoth hour random select requir storag exceed memori capac machin case store bucket disk suitablys block cost secondari memori access easili amort comput moret tang wang warnow gene fig percentag tree elimin bound variou number gene genom three rate evolut tree bound use method bound compar upper bound obtain first phase result potenti veri pessimist estim prune rate figur show percentag tree prune away circular lower bound tabl paramet r denot expect number invers per edg use simul evolut we could run enough test set gene mere score tree accur easili take day computationth instanc tsp gener circumst timeconsum comparison similar tabl earlier approach new approach show dramat improv especi high rate evolut found circular order dataset genom elimin howev tabl also show bound elimin mani tree dataset genom unless dataset larg number gene reason clear number gene dictat rang valu pairwis distanc thu also tree scorein term invers distanc instanc roughli mn possibl tree score number gene n number genom yet number distinct tree n number larg that even small fraction tree near optim fraction contain mani tree cannot effici distinguish other mn bucket cours grappa hour examin vanishingli small fraction tree space upper bound use almost certainli much high contrast find layer method gave us prune rate genom case gene huge improv complet failur prune normal search method test method real repeat analysi campanulacea dataset consist chloroplast genom one outgroup tobacco time reconstruct ede as oppos breakpoint invers phylogeni genom segment and though highli rearrang consid low rate evolut previou analysi found grappa first bound ap proach prune tree substanti speedup on order version without prune use ede distanc improv bound compu tation increas percentag anoth substanti speedup ad layer search howev manag prune almost billion treesal hundr thousand quickli score dispatch speedup close prune rate reduc number tree score factor nearli result dataset requir coupl hour processor superclust use first bound strategi run hour singl workstationand one minut cluster term origin comparison bpanalysi code achiev speedup on superclust one hundr million also confirm result previou analysisthat is tree return new analysi use ede distanc match return analysi use minimum invers distanc pleasantli robust result speedup obtain bound depend two factor percentag tree elimin bound difficulti tsp instanc avoid use bound tabl show rate evolut high close tree elimin use bound howev tsp instanc solv grappa quit small evolutionari rate low due compress data see consequ speedup also depend rate evolut lower rate evolut produc easier tsp instanc thu smaller speedup campanulacea dataset good exampl dataset quit easi grappa sens produc easi tsp instancesbut even case signific speedup result gener speedup increas larger number genom and point higher rate evolut one forc exhaust search tree space speedup repres substanti save time conclus futur work describ new theoret experiment result enabl us analyz signific dataset term invers event also extend model incorpor transposit work part ongo project develop fast robust techniqu reconstruct phylogeni geneord data distanc estim develop clearli outperform straight distanc measur term accuraci when use conjunct distancebas method neighborjoin effici when use searchbas optim method implement grappa softwar suit current softwar suffer sever limit particularli exhaust search constrain tree space howev bound describ use conjunct branchandbound base insert leav subtre extend circular order well heurist search techniqu acknowledg thank r jansen introduc us research area d sankoff j nadeau invit us dcaf meet idea paper came fruition work support part nation scienc foundat grant aci moret deb moret warnow eia david lucil packard foundat warnow r perform neighborjoin method phylogenet reconstruct grappa run record time lineartim algorithm comput invers distanc sign permut experiment studi sort permut transposit breakpoint phylogeni gene order breakpoint evid anim mitochondri phi logeni complex breakpoint median problem lower bound breakpoint phylogeni problem formul hard multipl sort revers experiment statist analysi sort revers practic nonparametr statist empir comparison phylogenet method chloroplast gene order data campanulacea new fast heurist comput breakpoint phylogeni experiment phylogenet analys real synthet data workshop gene order dynam dimac workshop whole genom comparison use chloroplast dna rearrang reconstruct plant phylogeni grappa genom rearrang analysi parsimoni phylogenet algorithm transform cabbag turnip polynomi algorithm genom distanc problem travel salesman problem minimum span tree person commun extens file format systemat infor mation new approach reconstruct phylogeni base gene order new implement detail studi breakpoint analysi length chromosom segment conserv sinc diverg man mous chloroplast dna systemat review method data analysi chloroplast mitochondri genom evolut land plant median problem breakpoint npcomplet chloroplast dna evid ancient evolutionari split vascular land plant neighborjoin method new method reconstruct phylogenet tree multipl genom rearrang breakpoint phylogeni probabl model genom rearrang linear invari phylogenet infer phylogenet infer exactiebp new techniqu estim evolutionari distanc whole genom estim true evolutionari distanc genom tr transform cabbag turnip formul hard multipl sort revers probabl model genom rearrang linear invari phylogenet infer sort permut tansposit estim true evolutionari distanc genom highperform algorithm engin comput phylogenet new fast heurist comput breakpoint phylogeni experiment phylogenet analys real synthet data lower bound breakpoint phylogeni problem ctr bernard m e moret lisan wang tandi warnow toward new softwar comput phylogenet comput v n p juli nikla eriksen revers transposit median theoret comput scienc v n p april bernard m e moret tandi warnow reconstruct optim phylogenet tree challeng experiment algorithm experiment algorithm algorithm design robust effici softwar springerverlag new york inc new york ny