t approxim invers techniqu blockpartit matric a paper propos precondit option system matrix blockpartit form form may aris natur exampl incompress navierstok equat may impos domain decomposit reorder approxim invers techniqu use gener spars approxim solut whenev need form precondition storag requir precondition may much less incomplet lu factor ilu precondition tough largescal comput fluid dynam cfd problem numer experi show precondition help solv difficult linear system whose coeffici matric highli indefinit b introduct consid block partit matrix a form block natur occur due order equat variabl matric form aris mani applic incompress navierstok equat scalar momentum equat continu condit form separ block equat d case system form b pc b f u f pc u v repres veloc compon p repres pressur here b submatrix convectiondiffus oper f submatric pressur gradient oper e submatric veloc diverg oper tradit techniqu uzawa algorithm use problem often linear system must solv much smaller zero small valu diagon fullycoupl system socal segreg approach howev suffer slow converg rate compar aggreg fullycoupl solut techniqu anoth sourc partit matric form class domain decomposit method method interior node subdomain order consecut subdomain subdomain follow interfac node order end order unknown give rise matric follow structur typic linear system associ b matrix produc reorder easi solv result restrict origin pde problem set independ similar pde problem much smaller mesh one motiv approach parallel approach ultim requir solut method schur complement s danger howev gener matric b may singular reorder much work done exploit form block conjunct precondit one earlier paper subject concu golub meurant introduc idea block precondit design blocktridiagon matric whose diagon block tridiagon invers tridiagon matric encount approxim approxim tridiagon matric exploit exact formula invers tridiagon matrix later extend gener case diagon block arbitrari mani case incomplet block factor develop matric aris discret pde util approxim invers diagon block need invert recent elman silvest propos techniqu specif case stoke navierstok problem number variat block precondition also develop techniqu offblock diagon term either neglect attempt made approxim effect paper explor precondit option matrix express blockpartit form either natur domain decomposit type re order iter method act fullycoupl system precondit similar segreg method approach requir precondit approxim solv submatric submatric correspond combin oper reaction diffus convect particularli advantag use blockpartit form know enough submatric appli special precondition exampl operatorsplit semidiscret well lowerord discret blockpartit techniqu also requir spars approxim solut spars linear system solut need spars form row column precondition use comput dens solut caus construct applic precondition expens problem ideal suit spars approxim invers techniqu approxim solut spars system found use iter method implement spars matrixspars vector spars vectorspars vector oper intermedi final solut forc spars numer drop element x small magnitud righthand side b initi guess x spars econom method comput spars approxim solut use techniqu construct precondition base approxim invers directli paper organ follow section describ spars approxim invers algorithm techniqu find spars approxim solut schur complement section describ blockpartit factor may use precondition effect approxim block lu factor approxim block gaussseidel precondition section report result sever numer experi includ perform new precondition problem aris incompress navierstok equat spars approxim invers use common develop precondition base block techniqu face need comput approxim invers spars matrix approxim column f b f spars particularli case block precondition blocktridiagon matric algorithm practic must provid approxim spars number techniqu recent develop construct spars approxim invers matrix use precondition mani techniqu approxim row column independ focus in columnori case individu minim e j jth column ident matrix precondition distinctli easier exist precondition construct appli massiv parallel comput reli matrix factor precondition often complementari ilu precondition previou approach select sparsiti pattern x minim least squar sens approach minim method reduc residu norm step minim residu fgmre begin spars initi guess sparsiti preserv drop element search direct current solut step base magnitud criteria relat residu norm reduct final number nonzero column guarante paramet lfil case fgmre krylov basi also kept spars drop small element keep iter econom comput perform spars matrixspars vector spars vectorspars vector oper applic here point approxim invers techniqu column may gener find spars approxim solut spars linear problem minim possibl exist precondition a approxim invers algorithm describ modif techniqu report guarante reduct residu norm minim residu step start spars initi guess fillin increas one iter end iter possibl use second stage exchang entri solut new entri caus reduct residu norm without second stage entri solut cannot annihil introduc problem paper howev second stage necessari first stage search direct deriv drop entri residu direct r sparsiti pattern solut x control chosen sparsiti pattern x plu one new entri largest entri absolut valu minim perform choos steplength ad ad thu residu norm new solut guarante previou residu norm solut residu updat end stage indefinit normal equat residu direct r may use search direct simpli determin locat new fillin interest note largest entri r give greatest residu norm reduct onedimension minim explain transpos initi guess approxim invers combin selfprecondit precondit r current approxim invers effect problem mani possibl second stage choos drop one entri x introduc one new entri caus decreas residu norm candid drop smallest absolut nonzero entri x candid ad largest absolut entri previou search direct at begin stage alreadi includ d previou direct use candid may determin stage addit search requir steplength fi chosen minim new residu norm e ith coordin vector x entri x drop posit fi entri ad posit l largest gener notat b righthandsid vector previous denot j let j denot jth column a minim give involv one spars saxpi sinc b gamma ax alreadi avail r one spars dotproduct sinc may scale column unit norm guarante l sinc l chosen among entri includ s precondit version algorithm minim kb gamma axk explicit precondition may summar follow assum scale column unit norm number inner iter usual chosen lfil somewhat larger algorithm approxim invers algorithm start initi guess x r b gamma ax mr choos pattern x one entri largest remain entri absolut valu q ad ff rq r r gamma ffq x index smallest nonzero absx l index largest nonzero abst gamma d fi r r r krk krk set x x l fi r r end end spars solut schur complement spars approxim solut schur complement often requir precondit blockpartit matric briefli describ three approach section approxim s approxim gamma exploit partial approxim invers a approxim approxim spars matrix use comput approxim invers techniqu possibl precondit whatev use solv b sinc spars comput way also spars moreov sinc usual rel dens solv econom approach typic zero initi guess use remark usual expens form solv b approxim drop small element sinc rather costli search element drop also note gener columnbycolumn necessari comput factor columnbycolumn basi well linear system solv fashion includ iter process without precondit approxim gamma anoth method comput approxim gamma use idea induc pre condit block gamma comput spars approxim use approxim invers techniqu appli last blockcolumn throw away upper block practic upper part column may discard comput next column experi sinc approxim invers algorithm appli a indefinit matrix problem normal equat search direct r use algorithm scale ident initi guess invers partial approxim invers drawback approach top submatrix last blockcolumn discard result approxim gamma may actual contain nonzero relat techniqu comput partial approxim invers last blockrow techniqu give approxim gamma defin simpl precondit method itself write invers form get approxim solut f necessari solv accur b again normal equat search direct use approxim invers algorithm numer experi result rel inexpens method given section blockpartit factor consid spars linear system put block form condit requir partit b nonsingular use extens follow block lu factor a schur complement wellknown solv solv reduc system comput y backsubstitut first blockrow system obtain x ie comput x block structur exploit sever differ way defin precondition a thu block precondition defin section combin one precondition seen section choic block factor next describ option solv precondit reduc system method often use solv reduc system possibl help certain precondition schur complement matrix s although involv block factor discuss abov indirectli relat wellknown algorithm exampl uzawa method typic formul full system view richardson or fix point iter appli reduc system matrix need comput explicitli instead one perform matrixvector product matrix s via follow sequenc oper comput solv comput wish use krylov subspac techniqu gmre precondit reduc system need solv system step exactli ie direct solver iter solver requir high accuraci matrix coeffici matrix system solv must constant throughout gmre iter experi approach found seriou limit converg reach number step typic compar obtain method base full matrix howev step cost much more unless direct solut techniqu use case initi lu factor may expens altern highli accur ilu factor employ b reduc cost mani system must solv success outer step approxim block diagon precondition one simplest block precondition matrix partit blockdiagon matrix mc precondit matrix c case incompress navierstok equat defin exampl interest particular case c nonsingular mc c correspond blockjacobi iter case eigenvalu squar root eigenvalu matrix c converg fast eigenvalu small approxim block lu factor block factor suggest use precondition base block lu factor izat precondit a precondition schur complement matrix s spars approxim schur complement could comput precondit matrix s exampl form approxim lu factor must point precondition induc precondition a discuss section notabl disadvantag approach base solv reduc system iter process action vector must comput accur krylov acceler part approach base larger system necessari fact iter process use solv b provid use flexibl variant gmre fgmre system involv b may solv mani way depend difficulti know b b known wellcondit triangular solv incomplet lu factor may suffici difficult b matric incomplet factor may use precondition inner iter process b further incomplet factor unstabl see section approxim invers b may use either directli precondition b oper approxim may use factor may use either directli precondition kind flexibl typic avail use iter method blockpartit matric import observ solv exactli b error block ilu factor lie entir block sinc one rais question whether approach better one base solv reduc system precondit known fact two approach mathemat equival start proper initi guess specif initi guess make xpart residu vector equal origin system ie initi guess result due eisenstat report immedi follow show precondit matrix particular form thu initi residu xcompon equal zero iter vector compon onli gmre iter system reduc gmre iter matrix gamma involv variabl mani possibl option choos matrix among consid follow one ffl precondit s ffl precondit c matrix nonsingular altern precondit ilu factor c construct spars approxim use precondition gener need approxim action vector exampl method describ section follow algorithm appli one precondit step get algorithm approxim block lu precondit x x experi number option solv system step algorithm abov exampl may approxim comput approxim invers techniqu approxim use possibl also use place b gamma f step approxim block gaussseidel ignor u factor approxim block lu factor led form block gaussseidel precondit defin remark way solv system b way defin precondit matrix appli here algorithm precondition algorithm without step analyz precondition start observ show differ precondit matrix addit posit iter associ block form associ schur complement approach gamma longer simpli relat howev connect first spectra two matric ident mean howev two matric requir number iter converg gener consid gmre iter solv precondit system here take initi guess form x arbitrari denot precondit initi residu gmre find vector u form belong krylov subspac minim km arbitrari u affin space precondit residu form becom result ks note ks repres precondit residu norm reduc system obtain approxim larg system ks impli residu bigger system less ffl residu obtain use full gmre associ precondit reduc system also less ffl observ pass second term righthandsid alway reduc zero postprocess step consist forc first part residu zero chang ffi onli into equival current pair x obtain x recomput satisfi first block equat ie postprocess step requir one addit b solv assum know someth residu vector associ step gmre appli precondit reduc system say someth residu norm associ precondit unreduc system begin establish simpl lemma lemma let then follow equal hold proof first easi prove multipli member equal gamma z obtain we state main result concern comparison two approach theorem assum reduc system solv gmre use precondition start arbitrari initi guess let precondit residu obtain mth step precondit residu vector r m obtain m st step gmre solv block system precondit matrix initi guess u x arbitrari satisfi inequ particular proof precondit matrix unreduc system form s residu vector mth gmre approxim associ reduc system form ae mth residu polynomi minim kpg k among polynomi p degre satisfi constraint consid polynomi degre m defin clear residu um mst approxim solut obtain gmre algorithm solv precondit unreduc system minim pzr polynomi p degre m consist ie therefor use equal establish lemma observ first matrix righthandsid last equal noth gamma z henc residu vector r m complet proof also interest relat converg algorithm blockdiagon approach particular case case correspond block gaussseidel iter exploit young frankel theori cyclic matric compar converg rate block jacobi approach inde case therefor eigenvalu matrix squar matrix associ blockjacobi precondition section numer experi section organ follow section describ test problem list method use section illustr comparison purpos difficulti incomplet lu factor solv problem fullycoupl manner section make comment regard domain decomposit type reorder section show result new precondition simpl pde problem final section present result new precondition realist problem aris incompress navierstok equat linear system construct solut vector one zero initi guess rightprecondit fgmre restart everi iter use solv system tabl show number iter requir reduc residu norm gamma iter stop matrixvector multipl reach indic dagger y code written fortran use mani routin sparskit run singl precis cray c supercomput test problem method first set test problem finit differ laplac equat dirichlet boundari condit three differ size grid use matric reorder use domain decomposit reorder subdomain follow tabl n order matrix nnz number nonzero entri nb order b submatrix nc order c submatrix second set test matric extract exampl incompress navierstok problem fidap packag problem zero c submatrix test case transient problem matric jacobian newton iter converg matric reorder continu equat grid n nnz nb nc tabl laplacian test problem order last scale mani matric poor sinc matrix contain differ type equat thu scale row unit norm scale column way problem origin nonsymmetr except matrix n nnz nb nc hamel flow ex stoke flow surfac disturb attenu ex fountain flow coat ex driven thermal convect ex two merg liquid speci deposit radiat heat transfer ex chemic vapor deposit tabl fidap exampl matric third set test problem finiteel discret squar lid driven caviti problem rectangular element use biquadrat basi function veloc linear discontinu basi function pressur show result problem reynold number matric aris mesh element lead matric size nnz nonzero entri matric veloc unknown pressur un known matric scale way fidap matricesth problem otherwis difficult solv use follow name denot method test ilutnfil ilutpnfil incomplet lu factor threshold nfil nonzero per row l u factor precondition describ section parlfil partial approxim invers precondition describ section use lfil nonzero per row abj approxim blockjacobi precondition describ section precondition appli c ablulfil approxim block lu factor precondition describ section approxim lfil nonzero per column use ablu ylfil abov use whenev b need appli step algorithm ablu slfil approxim block lu factor precondition use approxim gamma lfil nonzero per column approxim last block column invers a abgslfil approxim block gaussseidel precondition describ section approxim lfil nonzero per column use storag requir precondition given tabl ilut precondition describ next subsect requir consider storag approxim blockpartit factor sinc storag depend n rather nc approxim gamma discard upper block storag less lfil thetan c storag requir difficult estim sinc least product two spars matric gener less theta lfil theta nc tabl section give exact number nonzero fidap problem ilu fullycoupl system wish compar new precondition gener experi enc one effect generalpurpos precondition solv fullycoupl system particular show result ilut dualthreshold incomplet lu factor precondition base droptoler maximum number new fillin element allow per row l u factor latter threshold allow storag precondition known beforehand droptoler ilu rather levelfil ilu often effect indefinit problem numer valu play much import role variant perform column pivot call ilutp even suitabl highli indefinit problem matric matrix locat abj none none less theta lfil theta nc ablu ylfil lfil theta nc less theta lfil theta nc tabl storag requir precondition use small modif found often perform better rare wors matric wide rang number element per row column aris variou reason includ fact matrix contain discret differ equat instead count number new fillin keep nonzero row l u fix nfil regardless number origin nonzero row also found better perform keep nfil constant rather increas decreas factor progress highli indefinit larg nonsymmetr part ilu factor often produc unstabl l u factor ie klu gamma k extrem larg caus long recurr forward backward triangular solv illustr point comput number factor rough lower bound e vector one fidap exampl matrix ex model natur convect order nonzero see tabl norm bound increas dramat nfil decreas incomplet factor gmre could solv linear system factor precondition matrix chose strike exampl solv without precondit log tabl estim klu gamma k ilut factor ex illustr difficulti solv fidap problem ilutp progress allow fillin problem could solv increment nfil multipl drop toler result shown tabl type prob lem typic larg amount fillin must use factor success iter solut attempt lu condit lower bound greater zero pivot must use ilut ilutp attempt complet factor use small valu proport norm row matric taken origin band order degre freedom node element number togeth discuss next subsect type order low bandwidth often essenti ilutyp preconditioningmani problem includ cannot solv otherwis matrix nfil ex tabl nfil requir solv fidap problem ilutp note ilutp occasion wors ilut allevi somewhat use low valu mbloc paramet ilutp determin far search pivot summari indefinit problem aris incompress navierstok equat may tough ilutyp precondition domain decomposit reorder consider graph partition subdivid domain number piec use give domain decomposit reorder describ section techniqu impos blockpartit structur matrix adapt parallel process sinc b blockdiagon matrix techniqu also use b highli indefinit produc unstabl lu factor limit size factor instabl cannot grow beyond point factor use gener nonsymmetr matric partition may appli symmetr graph tabl show result ilut driven caviti problem differ matrix reorder use origin unblock order degre freedom element order togeth block order continu equat order last domain decomposit reorder found use simpl automat recurs dissect procedur four subdomain latter order found node intern subdomain interfac node re unblock block dd order tabl effect order ilut caviti problem poorer qualiti incomplet factor driven caviti problem blockpartit form due poor order rather instabl l u factor fact zero pivot encount problem reynold number unblock format produc nonzero strictli lowertriangular part incomplet factor which drop less ntheta nonzero blockpartit format produc nonzero almost three time more factor domain decomposit reorder matric encount mani zero pivot reach block latter order necessarili caus ilut fillin zero diagon nevertheless substitut small pivot describ seem effect here domain decomposit reorder also reduc amount fillin shape matrix a downward point arrow combin tendenc limit growth instabl result show reorder advantag even serial comput tabl compar difficulti solv b subsystem block domain decomposit reorder driven caviti problem comput comput use approxim invers techniqu lfil use ilut solv linear system toler gamma solv submatric blockpartit precondition usual need much less accur experi follow use unprecondit iter toler gamma matrixvector multipl solv b s method would necessari depend difficulti problem tabl give idea difficult solv b s show advantag use domain decomposit reorder hard problem re block dd order tabl solv b differ order a test result laplacian problem tabl present result laplacian problem three differ grid size use precondit approxim block diagon partial approxim invers approxim block lu approxim block gaussseidel precondition note tabl lfil zero approxim block lu gaussseidel precondition respect indic precondition grid nopr abj par tabl test result laplacian problem grid ablu abg tabl test result laplacian problem test result fidap problem blockpartit factor precondition unprecondit gmre restart everi iter use approxim solv inner system involv b reduc initi residu norm factor use matrixvector multipl solv matrix b usual difficult problem posit definit zero initi guess solv use result number precondition variou option shown tabl best precondition appear ablu use b gamma f better solv system b inaccur number nonzero small illustr tabl two valu lfil matrix tabl test result fidap problem test result driven caviti problem driven caviti problem much challeng b block longer posit definit fact acquir larger larger neg eigenvalu reynold number increas problem unprecondit gmre iter b done toler gamma maximum matrixvector multipl again ablu appear best precondition result shown tabl lfil ex ex tabl number nonzero s ablu ablu abg tabl test result driven caviti problem conclus present precondition defin combin two ingredi spars approxim invers techniqu obtain precondition schur complement part invers a block factor full sy tem schur complement appear block factor approxim precondition approxim invers techniqu use differ way approxim either directli part gamma seen compar tabl solv problem block approach standard ilu factor addit typic achiev far smaller memori requir ilut direct solver better robust method due fact solv perform small matric effect implicitli use power divideandconqu strategi characterist domain decomposit method smaller matric obtain block partit precondit standard ilut approach larger matric use blockilu glue two precondit schur complement acknowledg author wish acknowledg support minnesota supercomput institut provid comput facil excel environ conduct research r incomplet block matrix factor precondit method iter solut method approxim factor method block matric suitabl vector parallel processor iter solut larg spars linear system aris certain multidimension approxim problem approxim invers precondition gener spars matri ce block precondit conjug gradient method approxim invers precondit spars linear system paralleliz block diagon precondition compress navierstok equat new approach parallel precondit spars approxim invers stabil analysi incomplet lu factor multigrid krylov subspac method discret stoke equa tion fast nonsymmetr iter precondit navierstok equat fidap exampl manual parallel precondit approxim invers connect machin comparison domain decomposit techniqu ellipt partial differenti equat parallel implement famili twolevel precondit incomplet block factor type factor spars approxim invers precon dition incomplet block factor precondition spars spd matric flexibl innerout precondit gmre algorithm ilut dual threshold incomplet lu factor precondit krylov subspac method cfd applic sparskit basic tool kit spars matrix comput tr ctr n guessou o souhar multilevel block ilu precondition spars nonsymmetr mmatric journal comput appli mathemat v n p januari kai wang jun zhang multigrid treatment robust enhanc factor spars approxim invers precondit appli numer mathemat v n p decemb prasanth b nair arindam choudhuri andi j kean greedi learn algorithm spars regress classif mercer kernel journal machin learn research edmond chow michael a heroux objectori framework block precondit acm transact mathemat softwar tom v n p june howard c elman victoria e howl john n shadid ray s tuminaro parallel block multilevel precondition incompress navierstok equat journal comput physic v n p may michel benzi precondit techniqu larg linear system survey journal comput physic v n p novemb