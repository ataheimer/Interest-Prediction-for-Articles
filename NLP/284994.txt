t algorithm find largest approxim common substructur two tree a abstractord label tree tree node label lefttoright order children if ani fix tree mani applic vision pattern recognit molecular biolog natur languag process consid substructur order label tree connect subgraph t given two order label tree integ d largest approxim common substructur problem find substructur u substructur u u within edit distanc u exist substructur v v v v satisfi distanc constraint sum size v v greater sum size u u present dynam program algorithm solv problem run fast fastest known algorithm comput edit distanc two tree distanc allow common substructur constant independ input tree demonstr util algorithm discuss applic discov motif multipl rna secondari structur which order label tree b introduct order label tree tree node label lefttoright order children if ani fix tree mani applic vision pattern recognit molecular biolog natur languag process includ represent imag pattern secondari structur rna frequent use disciplin well larg amount work perform compar two tree base variou distanc measur recent gener one commonli use distanc measur name edit distanc root unroot unord tree work laid foundat use compar graph paper extend previou work consid largest approxim common substructur problem order label tree variou biologist repres rna secondari structur tree find common pattern also known motif secondari structur help predict rna fold function studi rna process mechan previou method detect motif rna molecul tree base one follow two approach transform tree sequenc use sequenc algorithm repres molecul use highli simplifi tree structur search common node tree neither two approach satisfactorili take full tree structur account contrast util propos algorithm pair tree enabl one locat treestructur motif occur multipl rna secondari structur experiment result concern rna classif show signific motif preliminari edit distanc map use edit distanc measur dissimilar two tree three type edit oper ie relabel delet insert node relabel node n mean chang label n delet node n mean make children n becom children parent n remov n insert invers delet insert node n child node n make n parent consecut subsequ current children n fig illustr edit oper purpos work assum edit oper unit cost edit distanc simpli distanc tree tree denot cost minimum cost sequenc edit oper transform notion edit distanc best illustr concept map map graphic specif edit oper appli node two tree exampl map fig show way transform transform includ delet two node label insert throughout paper shall refer order label tree simpli tree ambigu occur c r b r r r f c r r f e f f fig i relabel chang one node label a anoth b ii delet delet node children delet node label b becom children parent label r iii insert insert node consecut sequenc sibl among children node label r here f left g becom children newli insert node label b r b c e pt r b c e pt fig map tree tree use postord number node tree let ti repres node whose posit lefttoright postord travers i confus also use ti repres label node ti formal map tripl m simpli context clear set order pair integ i ii pair i onetoon left left preserv ancestor ancestor j ancestor order preserv condit cost cost delet node touch map line plu cost insert node touch map line plu cost relabel node pair relat map line differ label prove ffit equal cost minimum cost map tree tree cut oper defin substructur u tree connect subgraph is u root node n gener cut subtre subtre root n formal let i repres subtre root ti oper cut node ti mean remov i set node k said set consist subtre cut k i ti impli ti node k ii ti tj impli neither ancestor k intuit set root remov subtre k use cutt s repres tree subtre remov node s let subtreest set possibl set consist subtre cut given two tree integ d size largest approxim common rootcontain substructur within distanc i j denot fit j or simpli fii j context clear maxfjcutt jg subject fficutt j find largest approxim common substructur lac within distanc d i j amount calcul max uivj ffit v dg locat cutt v achiev maximum size size lac within distanc d dg shall focu comput maximum size memor size inform comput simpl backtrack techniqu one find maximum size one correspond substructur pair yield size time space complex algorithm notat use desci repres set postord number descend node ti li denot postord number leftmost leaf subtre i i leaf order forest tree induc node number j inclus see fig j definit map order forest tree let f f two forest distanc f f denot deltaf cost minimum cost map f set node f said set consist subtre cut f i tp impli p j ii tp tq impli neither ancestor f use cutf s repres subforest f subtre remov node s let subtreesf set possibl set consist subtre cut f defin size largest approxim common rootcontain substructur within distanc k f f denot psif k subject deltac utf li f ljt also repres confus fig induc order forest basic properti lemma suppos desci descj proof immedi definit lemma suppos desci descj k k d ae psit ae psi proof i follow definit ii suppos li smallest set consist subtre cut maxim jcutt j deltacutt follow two case must hold true psit li iii prove similarli ii lemma suppos desci descj ls li lt lj proof suppos li subtreest ljt two smallest set consist subtre cut maxim jcutt j deltac utt least one follow case must hold case ie subtre s remov so psili ljt case ie subtre t remov so psili ljt case t ie neither t remov fig let map with cost cutt cutt s must map t otherwis cannot distanc zero cutt therefor psili ljt sinc three case exhaust possibl map yield psili ljt take maximum correspond size give formula assert lemma fig illustr case one li ljt forest neither t remov lemma suppos desci descj suppos ljt tree ie proof sinc t first consid case two smallest set consist subtre cut maxim jcutt j fficutt t map with cost cutt fig clearli s must map t furthermor largest common rootcontain substructur must largest common rootcontain substructur s t mean psili ljt obtain includ two node t next consid case s t ie root two tree s t differ order get distanc zero two tree appli cut oper them remov tree entir thu psili ljt fig illustr case li ljt tree lemma suppos desci descj ls li lt lj k k d proof suppos two smallest set consist subtre cut maxim jcutt j deltac utt k least one follow case must hold case so psili ljt case case t let minimum cost map cutt three subcas examin s touch line then psili ljt b t touch line then psili ljt touch line s so exist h psili ljt h valu h rang k therefor take maximum correspond size ie psili ljt hg lemma suppos desci descj suppos li ljt tree ie ae proof sinc ljt tree t first show remov either s t would yield maximum size three case consid case remov then psili ljt cut children t would caus psili ljt therefor remov cannot yield maximum size case s remov then psili ljt t k assum without loss gener jt k equat impli remov subtre k node left t thu psili ljt hand cut children s leav s tree would map s t would lead psili ljt thu remov alon cannot yield maximum size case t remov proof similar case argument lead conclus order obtain maximum size neither t remov suppos s subtreest t two smallest set consist subtre cut maxim jcutt j fficutt minimum cost map cutt cutt least one follow case must hold case s touch line so psili ljt case t touch line so psili ljt case touch line ancestor order preserv sibl order preserv condit map cf section s t must thu t psili ljt map s cost psili ljt algorithm lemma lemma observ path li path lj j need comput fi t k k d separ sinc obtain comput fii j k thu consid node either root tree left sibl let keynodest contain node tree ie k g fig comput fi t procedur findlargest fig comput fi t d main algorithm summar fig now calcul size largest approxim common substructur lacss within distanc d i j build bottomup fashion anoth array fli use fii j d follow let postord number children i i leaf let postord number children j rg size lacss within distanc d i j fli j d size lacss within distanc d consid complex algorithm use array hold psi fi fl respect array requir od theta jt j theta jt space regard time complex given fii calcul fli j d requir ojt j theta jt time fix j procedur findlargest total time bound o ij theta jt ij theta theorem last term bound od theta jt j theta jt j theta minh height l number leav constant complex best current algorithm tree match base edit distanc even though problem hand appear harder tree match note calcul max ijt jjjt j ffii j g one could use faster algorithm run time ojt j theta jt j howev reason consid keynod formula specifi lemma prepar optim size forest forest store size valu array use calcul fi t could incorpor faster algorithm findlargest algorithm overal time complex would chang calcul fi t domin cost implement discuss appli algorithm find motif multipl rna secondari structur experi examin three phylogenet relat famili mrna sequenc chosen genbank pertain polioviru human rhinoviru coxsackieviru famili contain two sequenc shown tabl algorithm findlargest input tree integ d output fii j jkeynodestj jkeynodestj begin run procedur findlargest input i j run procedur findlargest input i j d procedur findlargest input output fi t li lj j li lj j ls li lt lj comput psili ljt lemma els begin comput psili ljt lemma fi t procedur findlargest input output fi t k k li comput psit li k lemma ii k lj j comput psi ljt k lemma iii k li lj j ls li lt lj comput psili ljt k lemma els begin comput psili ljt k lemma fi t fig algorithm comput fii j k famili sequenc tree file polioviru polio sabin strain file polmut file human rhinoviru rhino file coxsackieviru cox file tabl data use experi physiolog condit ie room temperatur rna molecul take singl structur may chang conform structur similar free energi trap local minima thu one consid optim structur structur within certain rang free energi hand loos rule thumb real structur rna molecul appear top suboptim structur sequenc base rank energi minimum energi one ie optim one top therefor fold noncod region select mrna sequenc collect roughli top suboptim structur sequenc transform suboptim structur tree use algorithm describ fig illustr rna secondari structur tree represent structur decompos five term stem hairpin bulg intern loop multibranch loop tree h repres hairpin node repres intern loop b repres bulg loop repres multibranch loop r repres helic stem region shown connect arc n special node use make sure tree connect tree consid order one order impos base upon natur molecul result tree mrna sequenc select genbank store separ file tree node cf tabl tree repres fulli parenthes notat root everi subtre preced node contain subtre thu exampl tree depict fig ii repres nrirmrbrmrhrhrh pair tree file ran algorithm findlargest find size largest approxim common substructur within distanc subtre pair i j locat one correspond substructur pair yield size substructur constitut candid motif calcul occurr number candid motif ad variabl length care vldc new root leav form vldc pattern v compar v tree file use pattern match techniqu develop convent denot match cost path portion path techniqu calcul minimum distanc v implicitli comput optim substitut vldc v allow zero cut node see fig way locat motif approxim occur or major occurr number motif respect distanc k refer number tree file approxim occur ie tree approxim contain m within distanc k of tree file u u u g c u u u u g u u u u g g g g g g g u u g u u g c c g u g u u gu u u u g c g u u c u u u c g c c u u gfig illustr typic rna secondari structur tree represent i normal polygon represent structur ii tree represent structur tabl summar result motif occur within distanc least tree correspond file tabl show number motif discov sequenc number distinct motif found common sequenc famili minimum maximum size common motif tabl show big motif found common three famili number sequenc secondari structur contain motif motif serv start point conduct studi common motif analysi one speed method encod candid motif suffix tree use statist sampl optim techniqu describ find motif r b fig match vldc pattern v tree both pattern tree hypothet one sole use illustr purpos root v would match node two leav v would match node respect node would cut distanc v would repres cost chang c v famili sequenc motif found common motif min size max size polioviru polio sabin strain polmut rhinoviru rhino coxsackieviru cox cvbpr tabl statist concern motif discov secondari structur mrna sequenc use experi motif found polio polmut rhino rhino cox cvbpr rbrbrbr tabl motif found common secondari structur polioviru human rhinoviru coxsack ieviru sequenc motif repres fulli parenthes notat root everi subtre preced node contain subtre motif tabl also show number sequenc suboptim structur contain motif propos algorithm discov motif also appli rna classif success experiment result show one get intersect motif sequenc famili indic close motif correspond close famili anoth applic algorithm appli tree calcul fii j allow one find repeatedli occur substructur or repeat short find repeat secondari structur across differ rna sequenc may help understand structur rna reader interest obtain program may send written request one author work base edit distanc origin metric permiss worthi metric eg therefor help locat subtl motif exist rna secondari structur algorithm present assum unit cost edit oper practic refin nonunit cost function reflect subtl differ rna secondari structur would interest score measur detect common substructur repeat tree anoth interest problem find largest consensu motif two input tree largest tree substructur within given distanc comparison differ type common substructur see also probabl base differ metric eg well applic remain explor acknowledg wish thank anonym review construct suggest pointer relev paper also thank wojcieok kasprzak nation cancer institut nat goodman whitehead institut mit chiayo chang use comment implement effort work support nation scienc foundat grant iri iri iri iri natur scienc engin research council canada grant ogp r nucleic acid research waveform correl tree match secondari structur comput predict polio viru align tree altern tree edit rna secondari struc ture comparison determin frequent recur substructur consensu largest common similar substructur problem tree embed plane largest common similar substructur root unord tree largest common similar substructur problem tree system approach fingerprint pattern recognit unifi view tree metric distanc transform imag repres quadtre algorithm compar multipl rna secondari structur compar multipl rna secondari structur use tree comparison structur descript inexact match exact approxim algorithm unord tree match treetotre correct problem metric root order tree base strongli structur preserv map comput method metric unroot unord tree bottomup comput method a metric tree comput method treetotre edit problem cardiovirul phenotyp coxsackieviru b determin singl site genom autom discoveri activ motif multipl rna secondari structur algorithm graph optim monomorph simpl fast algorithm edit distanc tree relat problem approxim tree match presenc variabl length care edit distanc undirect acycl graph tr ctr roger keay andri rakotoniraini contextori program proceed rd acm intern workshop data engin wireless mobil access septemb san diego ca usa m vilar f j ribada j graa approxim common pattern sharedforest proceed tenth intern confer inform knowledg manag octob atlanta georgia usa rolf backofen sven siebert fast detect common sequenc structur pattern rna journal discret algorithm v n p june s bhowmick wee keong ng sanjay madria constraintdriven join process web warehous data knowledg engin v n p april d c rei p b golgher a s silva a f laender automat web news extract use tree edit distanc proceed th intern confer world wide web may new york ny usa ada ouangraoua pascal ferraro laurent tichit serg dulucq local similar quotient order tree journal discret algorithm v n p march thoma kmpke distanc pattern structur similar journal machin learn research p n bourbaki p yuan s makrogianni object recognit use wavelet lg graph synthesi region pattern recognit v n p juli s bhowmick sanjay kumar madria wee keong ng detect repres relev web delta whoweda ieee transact knowledg data engin v n p februari dmitriy bespalov ali shokoufandeh william c regli wei sun scalespac represent model topolog match proceed eighth acm symposium solid model applic june seattl washington usa jiang andrea munger horst bunk median graph properti algorithm applic ieee transact pattern analysi machin intellig v n p octob yanhong zhai bing liu web data extract base partial tree align proceed th intern confer world wide web may chiba japan jun huan wei wang deepak bandyopadhyay jack snoeyink jan prin alexand tropsha mine protein famili specif residu pack pattern protein structur graph proceed eighth annual intern confer resaerch comput molecular biolog p march san diego california usa