t binari space partit fat rectangl a consid practic problem construct binari space partit bsp set n orthogon nonintersect twodimension rectangl bbb r aspect ratio rectangl s alpha constant alpha geq present nosqrtlog ntime algorithm build binari space partit size nosqrtlog n s also show m n rectangl s aspect ratio greater alpha construct bsp size nsqrtmosqrtlog n s nsqrtmosqrtlog n time constant proportion bigoh term linear log alpha extend result case input contain nonorthogon intersect object b introduct render set opaqu partial transpar object ir visual realist way fundament problem comput graphic central compon problem hiddensurfac remov given set ob ject viewpoint imag plane comput scene visibl viewpoint imag plane import hiddensurfac remov problem support provid nation scienc foundat research grant ccr armi research offic muri grant daah sloan fellowship nation scienc foundat nyi award match fund xerox corp grant us isra binat scienc foundat address box depart comput scienc duke univers durham nc email pankajcsdukeedu support provid armi research offic grant daah g work partial done author duke uni versiti address maxplanckinstitut fr informatik im stadtwald saarbrucken germani email eddiemathuriedu z author affili brown univers support provid part nation scienc foundat research grant ccr armi research offic muri grant daah address box depart comput scienc duke univers durham nc email tmaxcsdukeedu x support provid part nation scienc foundat research grant ccr armi research offic grant daah g armi research offic muri grant daah address box depart comput scienc duke univers durham nc email jsvcsdukeedu studi extens comput graphic comput geometri commun one conceptu simplest solut problem zbuffer algorithm algorithm sequenti process object object updat pixel imag plane cover object base distanc inform store zbuffer fast hiddensurfac remov algorithm obtain implement zbuffer hardwar howev cost hardwar zbuffer high specialpurpos costli graphic engin contain fast zbuffer zbuffer implement softwar gener ineffici even fast hardwar zbuffer present fast enough handl huge model contain hundr million polygon often display real time result method develop either cull away larg subset invis polygon decreas render load zbuffer when model larg eg see complet solv hiddensurfac remov problem when slow zbuffer one techniqu handl problem binari space partit bsp introduc fuch et al use bsp implement socal painter al gorithm hiddensurfac remov draw object display screen backtofront order in object occlud object earlier order gener possibl find backtofront order given viewpoint arbitrari set object fragment object bsp ensur viewpoint backtofront order determin fragment inform bsp set object tree whose node associ convex region space region associ leav tree form convex decomposit space interior region intersect object fragment creat bsp store appropri node bsp given viewpoint p backtofront order determin suitabl travers bsp node v bsp object one vs subtre separ vs subtre hyperplan viewpoint p lie one region bound hyperplan v travers recurs visit first child v correspond halfspac contain p child v effici travers thu hiddensurfac remov algorithm depend upon size bsp bsp subsequ proven versatil data structur applic mani problem aris practiceglob illumin shadow gener ray trace visibl problem solid geometri robot approxim algorithm network flow surfac simplif although sever simpl heurist develop construct bsp reason size provabl bound first obtain paterson yao show bsp size on construct n disjoint triangl ir optim worst case graphicsrel applic mani common environ like build compos larg orthogon rectangl moreov mani graphic algorithm approxim nonorthogon object orthogon bound box work bound box anoth paper paterson yao show bsp size on n exist n nonintersect orthogon rectangl ir bound optim worst case known lower bound exampl orthogon rectangl ir requir bsp n rectangl thin exampl paterson yao lower bound proof use configur thetan orthogon rect angl arrang p n theta n theta n grid bsp n rectangl construct aspect n configur thin rectangl rare occur practic mani real databas consist mainli fat rectangl ie aspect ratio rectangl bound constant examin four datasetsth sitterson hall orang unit methodist church fellowship hall sitterson hall lobbi databas univers north carolina chapel hill model soda hall univers california berkeleyshow rectangl model aspect ratio less natur ask whether bsp nearlinear size construct rectangl fat call rectangl fat aspect ratio the ratio longer side shorter side ff fix constant ff rectangl said thin aspect ratio greater ff paper consid follow problem given set n nonintersect orthogon twodimension rectangl ir thin remain fat construct bsp s first show construct bsp size o log n n fat rectangl ir ie show bsp size n o log n built bound come close lower bound omegagamma n m final prove two import extens re sult show np o log n size bsp exist p n input object nonorthogon unlik case orthogon object fat help reduc worstcas size bsp nonorthogon object particular exist set n fat triangl ir bsp nonorthogon object approxim orthogon bound box result bound box might intersect other motiv observ also consid problem n fat rectangl contain k intersect pair rectangl show construct bsp size n k o log n lower bound size bsp case constant proportion bigoh term linear log ff ff maximum aspect ratio fat rectangl algorithm construct bsp run time proport size bsp build except case nonorthogon object run time exce size factor p experi demonstr algorithm work well practic construct bsp nearlinear size rectangl fat perform better paterson yao algorithm orthogon rectangl far awar first work consid bsp practic common case two dimension fat polygon ir de berg consid weaker model case fat polyhedra ir a polyhedron said fat volum least constant fraction volum smallest sphere enclos it although result extend higher dimens one main ingredi algorithm on log nsize bsp set n fat rectangl long respect box b ie none vertic rectangl lie interior b prove result crucial use fat rectangl use procedur construct bsp size on fat rectangl algorithm repeatedli appli cut bisect set vertic rectangl input set subproblem long rectangl total size subproblem on point invok algorithm long rectangl improv size bsp log n simultan simul algorithm long rectangl partit vertic rectangl clever manner rest paper organ follow section give preliminari definit section show build on log nsize bsp n long rectangl show construct bsp size on section section present analyz better algorithm construct bsp size o log n extend result section construct bsp case object input i thin ii nonorthogon iii intersect conclud section open problem due lack space defer mani proof full version paper geometr preliminari binari space partit b set pairwis disjoint d gamma dimension polyhedr object ir tree recurs defin follow node v b repres convex region r v set object intersect r v region associ root ir itself v empti node v leaf b otherwis partit vs region r v two convex region cut set object v lie h v let h posit halfspac h gamma v neg halfspac bound h v region associ left right children v r v r tive left subtre v bsp set object right subtre v bsp set object g size b number node b suppos v node b algorithm region r v associ v box rectangular paral lelepip say rectangl r long respect r v none vertic r lie interior r v otherwis r said short long rectangl said edg lie boundari r v otherwis nonfre free cut cut plane divid two nonempti set cross rectangl s note plane contain free rectangl free cut free cut use prevent excess fragment object s often focu box b construct bsp rectangl intersect it given set rectangl r let set rectangl obtain clip rectangl r within b set point p let pb subset p lie interior b although bsp tree often discuss partit region repres node two convex region explicitli detail associ construct actual tree itself zaxi yaxi xaxi right face top face front face figur differ class rectangl bsp long fat rectangl let set fat rectangl assum rectangl long respect box b section show build bsp sb set rectangl clip within b box b six facestop bottom front back right left assum without loss gen eral back bottom left corner b origin ie back face b lie yzplane see figur rectangl belong top class two parallel edg contain top bottom face b similarli defin front right class long rectangl belong least one three class nonfre rectangl belong uniqu class see figur exampl rectangl belong differ class gener sb three class rectangl first exploit fat rectangl prove whenev three class present sb small number cut divid b box two class rectangl describ algorithm construct bsp rectangl belong two class first state two preliminari lemma use section first lemma character set rectangl long respect box belong one class second lemma appli two class long rectangl paramet real nonneg c box p set point interior c r set rectangl long respect c rectangl rc belong one class i exist face g box c contain one edg rectangl rc set vertic rectangl rc lie interior g time find plane h partit c two box c c jv c c box p set point interior c r set long rectangl respect c rectangl rc belong two class find two parallel partit c three box either ii jrc rectangl rc belong class reduc three class two class let b sb defin earlier assum without loss gener longest edg b parallel x axi rectangl sb belong front class partit two subset set r rectangl vertic and parallel right face box b set rectangl horizont and parallel top face box b see figur a let e edg b lie zaxi intersect rectangl r back face b segment parallel zaxi r denot project segment onto zaxi let r let z endpoint interv r lie interior e interior interv r note less jrj figur b project segment overlap similarli rectangl set defin project yaxi t let ycoordin vertic interv defin way divid b kl box draw plane plane figur b decomposit b kl box easili construct treelik fashion perform cut refer cut ffcut result box free rectangl such figur b divid box two box appli c set box b partit manner prove follow theorem decomposit b c place whole algorithm use fat rectangl s lemma set box c form process satisfi follow properti yaxi zaxi c xaxi r a z z b figur a rectangl belong set r b back face b dash line intersect back face ffcut i box c c two class rectangl ii bffc n box c endpoint e edg lie zaxi similarli defin l endpoint edg b lie yaxi c box c c contain rectangl r proof trivial sinc rectangl r togeth constitut front class suppos c contain rectangl set r rectangl r belong front class parallel right face b claim c cannot rectangl right class see claim consid edg c parallel zaxi endpoint edg zcoordin z z i contain rectangl r interv z z i must cover project rectangl r onto zaxi rectangl right class insid c must intersect one rectangl whose project cover z z i cannot happen sinc rectangl intersect other similar proof show c contain rectangl c free rectangl top class first show k l let respect b c denot length edg b parallel zaxi respect y axi xaxi assumpt a b c let r rectangl r dimens z x z x consid r project r onto zaxi suppos r lie interior edg e b lie zaxi sinc r rectangl front class parallel right face b know z rectangl support r set dimens z x z x x if k gamma cannot claim z case possibl z much less z see figur see follow length r henc length z z i least aff sinc everi altern interv least one rectangl r k bffc similar manner l also bffc impli b divid kl bffc box plane plane box c contain n rectangl henc n free cut made insid c free cut divid c n box impli set c bffc n box rectangl r sb cut kl piec edg piec form arrang r face arrang one kl rectangl r partit into k arrang edg boundari r face use free cut henc possibl free cut use box b divid kl cut k piec rectangl sb surviv prove two class long rectangl let c one box b partit section present algorithm construct r r z x figur project r the dash rectan shade rectangl right face b onto zxplane bsp set clip rectangl sc two class long rectangl recurs appli follow step box produc algorithm box contain rectangl sc free rectangl use free cut contain rectangl split c two box sc two class rectangl use lemma with split c three box use two parallel free cut sc one class rectangl split c two plane suggest lemma with first analyz algorithm two class long rectangl bsp produc follow struc ture step execut node v step invok descend v view lemma repeat execut step sc construct ojsc j log js c bsp ojsc node leaf tc one class rectangl total number rectangl leav js c j leaf v tree recurs invoc step build bsp size oj v j log js v j oj v j log js v detail sinc sum taken leav v tc total size bsp construct insid c ojsc j log js c j analyz overal algorithm long rect angl algorithm first appli ffcut rectangl sb describ section consid set box c produc ffcut box c contain two class rectangl by lemma i view discu sion box c c construct bsp sc size ojsc j log js c lemma ii iii impli total size bsp n bsp built time state follow theorem theorem let set n fat rectangl b box rectangl long respect b on log nsize bsp clip rectangl sb construct on log n time constant proportion bigoh term linear ff ff maximum aspect ratio rectangl remark algorithm two class long rectan gle use step algorithm paterson yao construct linears bsp orthogon segment plane rather on log n algorithm arbitrarilyori segment plane improv size bsp linear improv impli construct linears bsp long rect angl need improv result below except section bsp size on section present simpl algorithm construct bsp size on n fat rectangl use intuit gain on algorithm develop improv bsp algorithm section analyz improv algorithm section need definit describ algorithm bisect cut orthogon cut divid b two box bisect set vertic rectangl lie interior b algorithm fat rectangl proce phase phase sequenc three bisect cut exactli one cut perpendicular three orthogon direct phase box contain free rectangl use correspond free cut divid box two begin first phase box enclos rectangl n vertic interior sinc n rectangl four vertic continu execut phase bisect cut node vertex interior termin node contain long rectangl invok algorithm long rectangl construct bsp node crux analysi size bsp produc algorithm count mani piec one rectangl split subject specifi number phase effect use follow result due paterson yao lemma patersonyao rectangl subject phase cut with free cut use whenev possibl divid o rectangl theorem bsp ir size on construct n fat orthogon rectangl constant proportion bigoh term linear ff ff maximum aspect ratio input rectangl vertic interior one phase cut partit b box k vertic interior sinc start n rectangl n vertic number phase execut algorithm dlog n impli total number rectangl form phase execut on theta dlog ne stage node long rectangl henc theorem remark end section impli construct bsp node increas total size bsp constant factor prove theorem improv algorithm algorithm proce round round simul step algorithm long rectangl well partit vertic rectangl small number set approxim equal size begin ith round algorithm top bsp set box associ leav b contain least one rectan gle initi tree b consist one node q consist one box contain input rectangl algorithm maintain invari box long rectangl sb nonfre q empti done otherwis ith round box construct top subtre tb bsp set sb attach correspond leaf b give us new top subtre b i thu suffic describ build tree tb box b round let f sb set rectangl sb long respect b set k number vertic rectangl sb lie interior b note vertex vertex origin rectangl input set s assumpt rectangl f nonfre choos paramet a remain fix throughout round pick logfk optim size bsp algorithm creat see section describ ith round detail rectangl sb long appli algorithm describ section construct bsp sb otherwis perform sequenc cut two stage partit b follow separ stage appli ffcut describ section make cut respect rectangl f ie consid rectangl sb long respect b box form free rectangl appli free cut along rectangl let c result set box divid stage refin box c c appli cut similar one made section describ below recurs invok divid stage box c partit into let kc denot number vertic rectangl sc lie interior c set fc set rectangl f clip within c c free rectangl use free cut contain rectangl split c two box jf a noth rectangl fc belong two class let pc denot set vertic rectangl sc lie interior c appli two rectangl fc belong one class appli one cut h use lemma cut introduc divid stage made treelik fashion end divid stage set box box set sd contain free rectangl jf a notic appli cut c result box rectangl short respect c may becom long respect new box ignor new long rectangl next round except induc free cut analysi improv algorithm analyz size bsp construct algorithm time complex algorithm round algorithm construct top subtre tb box b set clip rectangl sb recal f set rectangl long respect b node c let tc subtre tb root c oe c number long rectangl fc nc number long rectangl sc n fc box correspond leaf tb let f number long rectangl sd note f count old long rectangl fd piec rectangl long respect b new long rectangl sd nfd piec rectangl short respect b becam long respect due cut made round f lemma box associ leaf tb a know nd k sinc rectangl sd n fd must piec rectangl short respect b k short rectangl henc sinc oe akd f ak a lemma follow box c tb use notat lc denot set leav tc lemma let c box associ node tb rectangl fc belong one class a lemma let c box associ node tb rectangl fc belong two class a lemma tree tb construct box b round follow properti bound sinc vertex interior sb lie interior one box lb next use lemma prove bound dlb fd similar argument prove bound jl b j let c set box b partit separ stage see figur let c box c sinc rectangl fc belong two class lemma impli separ stage divid stage z figur tree tb construct round a box c correspond leav top subtre therefor total number long rectangl box associ leav tb equat argument similar one use prove lemma also know therefor obtain we bound size bsp construct algorithm let sf denot maximum size bsp produc algorithm box contain f long rectangl k vertic interior theorem impli sf log f case k lemma iii construct subtre b size of log k one round recurs construct subtre box set leav lb henc k f everi box lb solut recurr constant proportion bigoh term linear log ff intuit behind solut round increas number old long rectangl constant factor also creat oa new long rectangl depth round olog a choos logfk balanc total increas number old rectangl over round total increas number new rectangl sinc oper node perform time linear number rectangl node bound obtain run time algorithm n begin first round obtain follow theorem theorem given set n rectangl ir aspect ratio rectangl bound constant ff construct bsp size o log time log n constant proportion bigoh term linear log ff extens section show modifi algorithm section handl follow three case i rectangl thin ii rectangl non orthogon iii input consist intersect fat rectangl fat thin rectangl let us assum input rectangl consist thin rectangl rectangl f given box b let f number long rectangl fb let k number vertic rectangl fb lie interior b let number rectangl tb algorithm use similar algorithm fat rectangl fix paramet logfk sb contain free rectangl use correspond free cut split b two box use algorithm long rectangl construct bsp b f k use algorithm paterson yao orthogon rectangl ir construct bsp f t perform one round algorithm describ section algorithm recurs invok box b split into let sk f t size bsp produc algorithm box k vertic interior f long rectangl fb thin rectangl analyz algorithm behavior section show sk f see detail f of log solut recurr constant proportion first bigoh term linear log ff follow theorem immedi theorem bsp size n o log n construct n o log n time n rectangl ir thin constant proportion bigoh term linear log ff ff maximum aspect ratio fat rectangl exist set thin rectangl rectangl ir bsp m fat rectangl nonorthogon rectangl suppos p object input nonorthogon rest fat rectangl algorithm use similar algorithm section except two place step check whether make free cut nonorthogon object too step number nonorthogon object node domin number fat rectangl use paterson yao algorithm triangl ir construct bsp size quadrat number object cubic time theorem bsp size np o log n construct np o log n time n object ir p nonorthogon rest fat rectangl constant proportion bigoh term linear log ff ff maximum aspect ratio fat rectangl intersect fat rectangl consid case n fat rectangl contain intersect pair intersect pair rectangl break one rectangl pair constant number smaller piec piec intersect rectangl pair process creat total n rectangl new ok rectangl may thin use algorithm section construct bsp rectangl theorem follow theorem bsp size n k o log n construct n k o log n time n rectangl ir k intersect pair rectangl constant proportion bigoh term linear log ff ff maximum aspect ratio fat rectangl exist set n rectangl ir contain k intersect pair bsp k conclus sinc worstcas complex bsp high triangl ir orthogon rectangl ir known exampl achiev worst case use mainli skinni object made natur assumpt object fat shown assumpt allow smaller worstcas size bsp implement algorithm practic result encourag present companion paper seem probabl bsp size smaller log n built n orthogon rectangl bound aspectratio ir lower bound n bound would interest see algorithm develop construct bsp optim size similar improv envis theorem even challeng open problem determin right assumpt made input object graphic display hardwar provabl fast practic effici algorithm develop hiddensurfac elimin object preliminari investig improv model graphic hardwar made grove et al acknowledg would like thank seth teller provid us soda hall dataset creat depart comput scienc univers california berkeley would also like thank walkthrough project depart comput scienc univers north carolina chapel hill provid us dataset sitterson hall orang unit methodist church fellowship hall sitterson hall lobbi r practic method construct binari space partit orthogon object surfac approxim geometr partit increas updat rate build walkthrough system automat modelspac subdivis potenti visibl set calcul motion plan use binari space partit model global diffus illumin imag synthesi subdivis algorithm comput display curv surfac near realtim objectprecis shadow gener use bsp treesmast thesi near realtim shadow gener use bsp tree fast objectprecis shadow gener areal light sourc use bsp tree linear size binari space partit fat ob ject survey objectspac hidden surfac re moval comput graphic principl practic visibl surfac gener priori tree structur object complex model hiddensurfac elimin maximum flow polyhedr domain sculpt interact solid model tool merg bsp tree yield polyhedr set oper applic bsp tree raytrac csg evalu effici binari space partit hiddensurfac remov solid model optim binari space partit orthogon object character ten hidden surfac algorithm visibl comput dens occlud polyhedr environ set oper polyhedra use binari space partit tree tr ctr john hershberg subhash suri csaba d toth binari space partit orthogon subdivis proceed twentieth annual symposium comput geometri june brooklyn new york usa csaba d tth binari space partit line segment limit number direct proceed thirteenth annual acmsiam symposium discret algorithm p januari san francisco california csaba d toth note binari plane partit proceed seventeenth annual symposium comput geometri p june medford massachusett unit state mark de berg micha streppel approxim rang search use binari space partit comput geometri theori applic v n p februari b aronov a efrat v koltun micha sharir union round object proceed twentieth annual symposium comput geometri june brooklyn new york usa